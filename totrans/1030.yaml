- en: Predicting Cryptocurrency Prices Using Regression Models
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://www.kdnuggets.com/2022/05/predicting-cryptocurrency-prices-regression-models.html](https://www.kdnuggets.com/2022/05/predicting-cryptocurrency-prices-regression-models.html)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: '![Predicting Cryptocurrency Prices Using Regression Models](../Images/3d4f7e9f8bda70d2c337985befa89fb4.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Source: [https://unsplash.com/s/photos/cryptocurrency](https://unsplash.com/s/photos/cryptocurrency)'
  prefs: []
  type: TYPE_NORMAL
- en: Introduction
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '* * *'
  prefs: []
  type: TYPE_NORMAL
- en: Our Top 3 Course Recommendations
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 1\. [Google Cybersecurity
    Certificate](https://www.kdnuggets.com/google-cybersecurity) - Get on the fast
    track to a career in cybersecurity.'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/e225c49c3c91745821c8c0368bf04711.png) 2\. [Google Data Analytics
    Professional Certificate](https://www.kdnuggets.com/google-data-analytics) - Up
    your data analytics game'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 3\. [Google IT Support
    Professional Certificate](https://www.kdnuggets.com/google-itsupport) - Support
    your organization in IT'
  prefs: []
  type: TYPE_NORMAL
- en: '* * *'
  prefs: []
  type: TYPE_NORMAL
- en: As of March 2022, the cryptocurrency market stands at over $2 trillion [1] but
    remains incredibly volatile, having previously hit $3 trillion in November 2021\.
    The same volatility is also seen within the individual cryptocurrencies, within
    the past month alone Etherium and Bitcoin have decreased by over 18% and 19% respectively.
    The number of new currencies coming onto the market is also increasing, with over
    18,000 cryptocurrencies in existence as of March 2022 [2].
  prefs: []
  type: TYPE_NORMAL
- en: This volatility is what makes long-term cryptocurrency predictions more difficult.
    In this article, we will go through how to get started with cryptocurrency predictions
    using linear regression models. We will look at predictions over a number of time
    intervals whilst using various model features, like opening price, high price,
    low price and volume. The cryptocurrencies looked at in this article include more
    established players Bitcoin and Etherium as well as those still in fairly early
    stages namely Polkadot and Stellar.
  prefs: []
  type: TYPE_NORMAL
- en: Method
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In this article, we will be using multiple linear regression. Regression models
    are used to determine the relationship between variables by fitting a line through
    the data. Simple linear regression is a model used to predict a dependent variable
    (for instance the closing price of a cryptocurrency) using one independent variable
    (such as opening price), whereas multiple linear regression takes into account
    several independent variables.
  prefs: []
  type: TYPE_NORMAL
- en: The data we will be using comes from CoinCodex [3] and provides daily opening,
    high, low and closing as well as the volume and the market cap. Various combinations
    of features were experimented with to produce the models with predictions also
    being made over daily and weekly intervals. The python sklearn package was used
    to train the models and the R2 value was used as a metric of the accuracy of the
    model, with 1 indicating a perfect model.
  prefs: []
  type: TYPE_NORMAL
- en: The data used and the models produced have been uploaded to a [Layer project](https://app.layer.ai/ellies/predictingCryptoPrices)
    and can be downloaded for further use and investigations. All the results and
    corresponding graphs can also be found in the [Layer project](https://app.layer.ai/ellies/predictingCryptoPrices).
    In this article we will discuss sections of the code used to implement the models.The
    full code can be accessed in this [collab notebook](https://colab.research.google.com/drive/1YpCQ2_V3hBjrIk_1plTwA3__w76krRYh#scrollTo=tfl6d3mifG4B).
  prefs: []
  type: TYPE_NORMAL
- en: 'In order to initialise the project and access the data and models you can run:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: The data was uploaded to the Layer project for each of the 4 cryptocurrency
    datasets (Bitcoing, Ethereum, Polkadot and Stellar) by defining the functions
    used to read in the data and annotating them with the dataset and resources decorators.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs: []
  type: TYPE_PRE
- en: You can run the following commands to access the datasets and save them to a
    pandas dataframe
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE2]'
  prefs: []
  type: TYPE_PRE
- en: Predictions
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Daily predictions
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: The first set of multiple regression models were built to predict the prices
    at daily intervals. The closing price was first predicted using opening, low and
    high price on that day. Daily prices over the course of 1 year were used with
    a 75%-25% train-test split. The below function was used to train the model for
    a given dataset.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE3]'
  prefs: []
  type: TYPE_PRE
- en: The function was running with the model decorator to save the model to the Layer
    project as shown below.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE4]'
  prefs: []
  type: TYPE_PRE
- en: To access all of the models used in this set of predictions you can run the
    below code.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE5]'
  prefs: []
  type: TYPE_PRE
- en: Table 1 below summarises the R2 statistics for the 4 cryptocurrencies using
    this model.
  prefs: []
  type: TYPE_NORMAL
- en: '![R2 statistics for the 4 cryptocurrencies using](../Images/90c4cd775c1228d08c14e3d1081f7655.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Table 1: Accuracy of predictions of cryptocurrency closing price using opening,
    low and high prices on that day'
  prefs: []
  type: TYPE_NORMAL
- en: The graphs below show the predicted values against the true values for the best
    and worst-performing currencies Polkadot and Stellar (Figure 1a and 1b).
  prefs: []
  type: TYPE_NORMAL
- en: '![Stellar predicted closing price](../Images/745296eed6eeecf78472f4cb778dea97.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Figure 1a: Stellar predicted closing price against the true closing price for
    the day using opening, low and high prices as features![Polkadot predicted closing
    price](../Images/264b3a4fefc056f5dd6f625797344b7e.png)'
  prefs: []
  type: TYPE_NORMAL
- en: 'Figure 1b: Polkadot predicted closing price against the true closing price
    for the day using opening, low and high prices as features'
  prefs: []
  type: TYPE_NORMAL
- en: From the graph and the R2 values, we can see that the linear regression model
    using opening, low and high price is very accurate for all 4 currencies, regardless
    of their level of maturity.
  prefs: []
  type: TYPE_NORMAL
- en: Next, we investigate whether adding the volume improves the model. The volume
    corresponds to the total number of trades taking place that day. Interestingly
    enough after fitting regression models using opening, low and high prices and
    the volume the results were largely identical. You can access the bitcoin_prediction_with_volume,
    ethereum_prediction_with_volume, polkadot_prediction_with_volume and stellar_prediction_with_volume
    models in the Layer project. Further investigation showed, that the coefficient
    for the volume variable was 0 across the 4 cryptocurrencies. This indicated the
    volume of trades of a cryptocurrency is not a good predictor of its price on that
    day.
  prefs: []
  type: TYPE_NORMAL
- en: Weekly predictions
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: In the next model, we look at predicting the end of week prices using the data
    from that weeks opening price on a Monday along with the low and high prices that
    week. For this model data from the past 5 years was used for Bitcoin, Ethereum
    and Stellar. For Polkadot, which was only launched in 2020, all of the historical
    data was used.
  prefs: []
  type: TYPE_NORMAL
- en: 'After downloading the data the low and high prices for each week were calculated
    and the opening and closing prices for the week were recorded. These datasets
    can also be accessed on Layer by running:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE6]'
  prefs: []
  type: TYPE_PRE
- en: Again, a 75%-25% train-test split was used and a multiple linear regression
    model was fitted using the opening, high and low prices for the week. The models
    can also be accessed on the Layer project. The R2 metric was again used for comparison
    with the results shown in Table 2 below.
  prefs: []
  type: TYPE_NORMAL
- en: '![ Accuracy of predictions of cryptocurrency closing price using opening, low
    and high prices](../Images/4701cb01eb8899d8ee5a66bf97e3b073.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Table 2: Accuracy of predictions of cryptocurrency closing price using opening,
    low and high prices'
  prefs: []
  type: TYPE_NORMAL
- en: The accuracy of the models when predicting with data over the course of a week
    were slightly worse than when predicting over the course of a day however, the
    accuracy itself was still very high. Even the worst performing model for the cryptocurrency
    Stellar achieve and R2 score of 0.985.
  prefs: []
  type: TYPE_NORMAL
- en: Conclusion
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Overall, linear regression models using the opening, low and high prices as
    features perform very well on both daily and weekly intervals. A natural extension
    of these models would be looking into predicting further into the future, for
    instance using this weeks data to predict the price next week.
  prefs: []
  type: TYPE_NORMAL
- en: '[1] [https://fortune.com/2022/03/02/crypto-market-cap-2-trillion/#:~:text=As%20of%2010%3A15%20a.m.,when%20it%20topped%20%243%20trillion](https://fortune.com/2022/03/02/crypto-market-cap-2-trillion/#:~:text=As%20of%2010%3A15%20a.m.,when%20it%20topped%20%243%20trillion).'
  prefs: []
  type: TYPE_NORMAL
- en: '[2] [https://www.investopedia.com/tech/most-important-cryptocurrencies-other-than-bitcoin/#:~:text=One%20reason%20for%20this%20is,communities%20of%20backers%20and%20investors](https://www.investopedia.com/tech/most-important-cryptocurrencies-other-than-bitcoin/#:~:text=One%20reason%20for%20this%20is,communities%20of%20backers%20and%20investors).'
  prefs: []
  type: TYPE_NORMAL
- en: '[3] https://coincodex.com/crypto/stellar/historical-data/'
  prefs: []
  type: TYPE_NORMAL
- en: '**[Eleonora Shantsila](https://www.linkedin.com/in/eleonora-shantsila-b51b2b124/)**
    is a full stack software engineer working at an events start up called Lounge,
    having previously worked as a full stack engineer in Financial Services. Eleonora
    has a background in Mathematics (BSc from St Andrews University) and Computational
    Science (MS from Harvard University) and enjoys working on data science projects
    in their spare time. Feel free to [connect on LinkedIn](https://www.linkedin.com/in/eleonora-shantsila-b51b2b124/).'
  prefs: []
  type: TYPE_NORMAL
- en: More On This Topic
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: '[3 Reasons Why You Should Use Linear Regression Models Instead of…](https://www.kdnuggets.com/2021/08/3-reasons-linear-regression-instead-neural-networks.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Building Predictive Models: Logistic Regression in Python](https://www.kdnuggets.com/building-predictive-models-logistic-regression-in-python)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[How to Make Large Language Models Play Nice with Your Software…](https://www.kdnuggets.com/how-to-make-large-language-models-play-nice-with-your-software-using-langchain)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Strategies for Optimizing Performance and Costs When Using Large…](https://www.kdnuggets.com/strategies-for-optimizing-performance-and-costs-when-using-large-language-models-in-the-cloud)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Comparing Linear and Logistic Regression](https://www.kdnuggets.com/2022/11/comparing-linear-logistic-regression.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[An Overview of Logistic Regression](https://www.kdnuggets.com/2022/02/overview-logistic-regression.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
