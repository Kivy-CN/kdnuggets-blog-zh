# 数据科学的基本数学：矩阵与矩阵乘积简介

> 原文：[https://www.kdnuggets.com/2021/02/essential-math-data-science-matrices-matrix-product.html](https://www.kdnuggets.com/2021/02/essential-math-data-science-matrices-matrix-product.html)

[评论](#comments)[![Image](../Images/e6b504358bea8f63e781d7dbce4b4afc.png)](https://www.essentialmathfordatascience.com/?utm_source=kdnuggets&utm_medium=blog&utm_campaign=kdnuggets_scalars_vectors)

### 矩阵和张量

正如你在 [数据科学的基本数学](https://bit.ly/3mpb4F2) 中看到的，向量是一种有用的数据存储和操作方式。你可以将它们几何地表示为箭头，或作为数字数组（其终点的坐标）。然而，创建更复杂的数据结构可能更有帮助——这就是矩阵需要引入的地方。

* * *

## 我们的前三个课程推荐

![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 1\. [谷歌网络安全证书](https://www.kdnuggets.com/google-cybersecurity) - 快速进入网络安全职业的快车道。

![](../Images/e225c49c3c91745821c8c0368bf04711.png) 2\. [谷歌数据分析专业证书](https://www.kdnuggets.com/google-data-analytics) - 提升你的数据分析技能

![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 3\. [谷歌IT支持专业证书](https://www.kdnuggets.com/google-itsupport) - 支持你的组织的IT工作

* * *

### 介绍

和向量一样，*矩阵* 是允许你组织数字的数据结构。它们是包含值的方形或矩形数组，按行和列组织。你可以将它们视为一个电子表格。通常，你会在数学的背景下看到*矩阵*这一术语，而在 Numpy 的背景下看到*二维数组*。

> **维度**
> 
> 在矩阵的背景下，*维度* 一词不同于向量几何表示的维度（空间的维度）。当我们说矩阵是二维数组时，意味着数组中有两个 *方向*：行和列。

### 矩阵符号

在这里，我将用粗体字母表示矩阵，例如 *A*：

![Equation](../Images/1e3859de92c28c620fd3fed24f7d6930.png)

矩阵 ***A*** 有两行两列，但你可以想象任意形状的矩阵。更一般地，如果矩阵有 *m* 行和 *n* 列且包含实值，你可以用以下符号来表征它：![Equation](../Images/112c6ef1621e38c3cf294b5a45aa93fa.png)

你可以用矩阵的名称（无粗体，因为矩阵条目是标量）加上下标中的行索引和列索引，用逗号分隔来引用矩阵条目。例如，***A[1,2]*** 表示第一行第二列的条目。

按惯例，第一个索引用于行，第二个索引用于列。例如，上述矩阵 ***A*** 中的条目 2 位于矩阵 ***A*** 的第二行和第一列，因此它被表示为 ***A[2,1]*** （如 [数据科学的基本数学](https://bit.ly/3mpb4F2) 中所示，数学符号通常使用的是从 1 开始的索引）。

你可以如下书写矩阵组件：

![方程](../Images/41fe351b69e7443e4a2e970d96146437.png)

### 形状

![图](../Images/38a06d30eb7c3028aa971109720af4b3.png)

*图 1：矩阵是二维数组。行数通常表示为 mm ，列数表示为 nn。*

数组的 *形状* 给出了每个维度的组件数量，如图 1 所示。由于这个矩阵是二维的（行和列），你需要两个值来描述形状（行数和列数，按此顺序）。

我们从使用方法 `np.array()` 创建一个 2D Numpy 数组开始：

[PRE0]

请注意，我们使用数组中的数组 (`[[]]`) 来创建 2D 数组。这与通过方括号的数量来创建 1D 数组不同。

与向量一样，可以访问 Numpy 数组的形状属性：

[PRE1]

[PRE2]

你可以看到，形状包含两个数字：它们分别对应于行数和列数。

### 索引

要获取矩阵条目，你需要两个索引：一个用于行索引，一个用于列索引。

使用 Numpy 时，索引过程与向量相同。你只需要指定两个索引。我们再来看以下矩阵 ***A***：

[PRE3]

可以使用以下语法获取特定条目：

[PRE4]

[PRE5]

`A[1, 2]` 返回行索引为一，列索引为二的组件（使用从零开始的索引）。

要获取完整的列，可以使用冒号：

[PRE6]

[PRE7]

这会返回第一列（索引零），因为冒号表示我们想要从第一行到最后一行的所有组件。类似地，要获取特定行，你可以这样做：

[PRE8]

[PRE9]

能够操作包含数据的矩阵是数据科学家的一项基本技能。检查数据的形状很重要，以确保它以你想要的方式组织。了解你需要的数据显示的形状也很重要，以便使用像 Sklearn 或 Tensorflow 这样的库。

**默认索引**

请注意，如果你从 2D 数组中指定一个单一的索引，Numpy 会将其视为第一个维度（行），并使用其他维度（列）的所有值。例如：

[PRE10]

[PRE11]

这与以下内容类似：

[PRE12]

[PRE13]

**向量和矩阵**

使用 Numpy 时，如果数组是一个向量（1D Numpy 数组），形状是一个单一的数字：

[PRE14]

[PRE15]

你可以看到 *v* 是一个向量。如果它是一个矩阵，形状有两个数字（分别表示行和列的数量）。例如：

[PRE16]

[PRE17]

你可以看到矩阵只有一行：形状的第一个数字是 1。再次使用两个方括号，`[[` 和 `]]`，允许你创建一个二维数组（一个矩阵）。

### 矩阵乘积

你可以在 [数据科学的基础数学](https://bit.ly/3mpb4F2) 中学习点积。矩阵的等效操作称为 *矩阵乘积*，或 *矩阵乘法*。它接受两个矩阵并返回另一个矩阵。这是线性代数中的核心操作。

### 矩阵与向量

矩阵乘积的简单情况是矩阵和向量之间的乘积（你可以将其视为矩阵乘积，其中一个矩阵只有一列）。

![图](../Images/1d9a37c4eec3a9c22944e02b7d36fb5d.png)

*图2：矩阵和向量之间乘积的步骤。*

图2 说明了矩阵和向量之间乘积的步骤。我们来考虑矩阵的第一行。你对向量（红色中的值 3 和 4）和你正在考虑的行（蓝色中的值 1 和 2）进行点积。你将值按对相乘：行中的第一个值与列向量中的第一个值相乘（*1⋅3*），行中的第二个值与向量中的第二个值相乘（*2⋅4*）。这给你结果矩阵的第一个分量（*1⋅3+2⋅4=11*）。

你可以看到矩阵-向量乘积与点积有关。就像将矩阵 AA 拆分成三行并应用点积（如在 [数据科学的基础数学](https://bit.ly/3mpb4F2) 中所示）。

让我们看看它如何在 Numpy 中运作。

[PRE18]

[PRE19]

注意我们使用了 `reshape()` 函数将向量重塑为一个 2 行 1 列的矩阵（`-1` 告诉 Numpy 去推测剩下的数字）。如果没有它，你会得到一个一维数组，而不是这里的二维数组（一个只有一列的矩阵）。

**矩阵列的加权**

还有另一种考虑矩阵乘积的方式。你可以认为向量包含的值对矩阵的每一列进行加权。这清楚地表明，向量的长度需要等于矩阵列数，向量在其上进行应用。

![图](../Images/2f5351efa1f863fda83cb2261bcc47cb.png)

*图3：向量值在加权矩阵的列。*

图3可能有助于可视化这个概念。你可以将向量值（3 和 4）视为施加在矩阵列上的权重。你之前看到的标量乘法规则会得到与之前相同的结果。

使用最后一个例子，你可以将 *A* 和 *v* 之间的点积写作：

![方程](../Images/64a2a6dec5c4de41ce3ffb16fad31515.png)

![方程](../Images/5df6bfdc1bba891269dcc265ee217033.png)

这很重要，因为正如你将在 [数据科学的基础数学](https://bit.ly/3mpb4F2) 中看到的那样，这表明 *Av* 是矩阵 *A* 列的线性组合，系数是来自 *v* 的值。

**形状**

此外，你可以看到矩阵和向量的形状必须匹配，才能进行点积。

![图](../Images/a92e6f94c2a80bd7fdedab0971aa957a.png)

*图4: 矩阵和向量之间点积所需的形状。*

图4总结了矩阵-向量乘积中涉及的形状，并显示矩阵的列数必须等于向量的行数。

### 矩阵乘积

*矩阵乘积*是两个矩阵的点积操作的等效形式。正如你将看到的，它类似于矩阵-向量乘积，但应用于第二个矩阵的每一列。

![图](../Images/a47ba608600705046e52abaecc6a54f0.png)

*图5: 矩阵乘积。*

图5展示了矩阵乘积的一个示例。你可以看到结果矩阵有两列，与第二个矩阵一致。第二个矩阵的第一列的值（3和4）加权两个列，结果填充了结果矩阵的第一列。同样，第二个矩阵的第二列的值（9和0）加权两个列，结果填充了结果矩阵的第二列。

使用Numpy，你可以像计算点积一样计算矩阵乘积：

[PRE20]

[PRE21]

**形状**

就像矩阵-向量乘积一样，如图6所示，第一个矩阵的列数必须与第二个矩阵的行数相匹配。

![图](../Images/53a3564daac9f13bc8cbefed22b8e52f.png)

*图6: 两个矩阵之间点积的形状必须匹配。*

结果矩阵的行数与第一个矩阵相同，列数与第二个矩阵相同。

让我们试试看。

[PRE22]

[PRE23]

矩阵*A*和*B*有不同的形状。让我们计算它们的点积：

[PRE24]

[PRE25]

你可以看到*A⋅B*的结果是一个3乘3的矩阵。这种形状来自*A*的行数（3）和*B*的列数（3）。

**计算协方差矩阵的矩阵乘积**

你可以通过计算包含变量的矩阵与其转置的乘积来计算数据集的协方差矩阵（关于协方差矩阵的更多细节请见[数据科学基础数学](https://bit.ly/3mpb4F2)）。然后，你将结果除以观察次数（或这个数字减去一，以进行贝塞尔校正）。你需要确保变量在计算之前已经中心化（可以通过减去均值来完成）。

让我们模拟以下变量*x*、*y*和*z*：

[PRE26]

使用Numpy，协方差矩阵为：

[PRE27]

[PRE28]

现在，使用矩阵乘积，你首先需要将变量堆叠成一个矩阵的列：

[PRE29]

[PRE30]

你可以看到变量`X`是一个100乘3的矩阵：100行对应观察值，3列对应特征。然后，你将此矩阵中心化：

[PRE31]

最后，你计算协方差矩阵：

[PRE32]

[PRE33]

你得到一个类似于函数`np.cov()`的协方差矩阵。重要的是要记住，矩阵与其转置的点积对应于协方差矩阵。

### 矩阵乘积的转置

两个矩阵点积的转置定义如下：

![方程](../Images/2aa29b7a5625a16da771e7d70883eb98.png)

例如，取以下矩阵 *A* 和 *B*：

[PRE34]

你可以检查 ![方程](../Images/83b1a0cdf30766ed77f5c2f846d1d054.png) 和 ![方程](../Images/d6bdacd69456fc7dbd03d4b9b4fabb84.png)的结果：

[PRE35]

[PRE36]

[PRE37]

[PRE38]

一开始可能会感到惊讶的是，括号中两个向量或矩阵的顺序必须改变才能满足等价性。让我们详细了解一下这个操作。

![图](../Images/f19e3a4ebad998abfa3e258d1619a770.png)

*图7：你必须改变向量和矩阵的顺序，以获得矩阵乘积的转置。*

图7显示，如果你改变向量和矩阵的顺序，矩阵乘积的转置等于转置的乘积。

**两个以上的矩阵或向量**

你可以将此属性应用于两个以上的矩阵或向量。例如，

![方程](../Images/31aefe885baae2573a91cb2ff2147dbe.png)

牢记这个属性。它解释了在操作矩阵和向量时你可能遇到的许多“外观调整”。用代码尝试这些操作是学习的好方法。

总之，矩阵乘积是线性代数中的一个关键概念，你将在 [数据科学中的基础数学](https://bit.ly/3mpb4F2) 中看到它如何与空间变换相关。

**个人简介：[Hadrien Jean](https://hadrienj.github.io/)** 是一名机器学习科学家。他拥有巴黎高等师范学校的认知科学博士学位，在那里他使用行为学和电生理数据进行听觉感知的研究。他曾在工业界工作，构建了用于语音处理的深度学习管道。在数据科学和环境交汇处，他从事使用深度学习应用于音频录音的生物多样性评估项目。他还定期在Le Wagon（数据科学训练营）创建内容并教授课程，并在他的博客中撰写文章（[hadrienj.github.io](http://hadrienj.github.io)）。

[原文](https://hadrienj.github.io/posts/Essential-Math-for-Data-Science-Introduction_to_matrices_and_matrix_product/)。经许可转载。

**相关：**

+   [数据科学中的基础数学：概率密度和概率质量函数](/2020/12/essential-math-data-science-probability-density-probability-mass-functions.html)

+   [矩阵分解解析](/2020/12/matrix-decomposition-decoded.html)

+   [数据科学中的基础数学：信息论](/2021/01/essential-math-data-science-information-theory.html)

### 更多相关内容

+   [停止学习数据科学以寻找目的，并寻找目的…](https://www.kdnuggets.com/2021/12/stop-learning-data-science-find-purpose.html)

+   [数据科学学习统计的最佳资源](https://www.kdnuggets.com/2021/12/springboard-top-resources-learn-data-science-statistics.html)

+   [成功数据科学家的5个特征](https://www.kdnuggets.com/2021/12/5-characteristics-successful-data-scientist.html)

+   [每个数据科学家都应该知道的三个R语言库（即使你使用Python）](https://www.kdnuggets.com/2021/12/three-r-libraries-every-data-scientist-know-even-python.html)

+   [9亿美元人工智能失败案例分析](https://www.kdnuggets.com/2021/12/9b-ai-failure-examined.html)

+   [是什么使Python成为初创公司的理想编程语言](https://www.kdnuggets.com/2021/12/makes-python-ideal-programming-language-startups.html)
