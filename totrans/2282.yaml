- en: 'Machine Learning: What is Bootstrapping?'
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://www.kdnuggets.com/2023/03/bootstrapping.html](https://www.kdnuggets.com/2023/03/bootstrapping.html)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: '![Machine Learning: What is Bootstrapping?](../Images/6167c512577033d97de3d8bd962e9065.png)'
  prefs: []
  type: TYPE_IMG
- en: Image by Author
  prefs: []
  type: TYPE_NORMAL
- en: Machine learning is a growing field that is transforming the way we process
    and analyze data.
  prefs: []
  type: TYPE_NORMAL
- en: '* * *'
  prefs: []
  type: TYPE_NORMAL
- en: Our Top 3 Course Recommendations
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 1\. [Google Cybersecurity
    Certificate](https://www.kdnuggets.com/google-cybersecurity) - Get on the fast
    track to a career in cybersecurity.'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/e225c49c3c91745821c8c0368bf04711.png) 2\. [Google Data Analytics
    Professional Certificate](https://www.kdnuggets.com/google-data-analytics) - Up
    your data analytics game'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 3\. [Google IT Support
    Professional Certificate](https://www.kdnuggets.com/google-itsupport) - Support
    your organization in IT'
  prefs: []
  type: TYPE_NORMAL
- en: '* * *'
  prefs: []
  type: TYPE_NORMAL
- en: Bootstrapping is an important technique in the world of machine learning. It
    is crucial for building robust and accurate models.
  prefs: []
  type: TYPE_NORMAL
- en: In this article, we will dive into what bootstrapping is and how it can be used
    in machine learning.
  prefs: []
  type: TYPE_NORMAL
- en: Also, we will explore the decision tree classifier and the Iris data set. It
    will be used to show bootstrapping in a real-world example.
  prefs: []
  type: TYPE_NORMAL
- en: Through this article, we aim to provide a comprehensive understanding of bootstrapping.
  prefs: []
  type: TYPE_NORMAL
- en: Also, we will cover its applications in machine learning. That will equip you
    with the knowledge to apply it to your own [machine learning projects](https://www.stratascratch.com/blog/30-project-ideas-to-showcase-your-machine-learning-skills/?utm_source=blog&utm_medium=click&utm_campaign=kdn+bootstrapping).
  prefs: []
  type: TYPE_NORMAL
- en: But first, what is bootstrapping?
  prefs: []
  type: TYPE_NORMAL
- en: What is Bootstrapping?
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Bootstrapping is a resampling technique that helps in estimating the uncertainty
    of a statistical model.
  prefs: []
  type: TYPE_NORMAL
- en: It includes sampling the original dataset with replacement and generating multiple
    new datasets of the same size as the original.
  prefs: []
  type: TYPE_NORMAL
- en: Each of these new datasets is then used to calculate the desired statistic,
    such as the mean or standard deviation.
  prefs: []
  type: TYPE_NORMAL
- en: This process is repeated multiple times, and the resulting values are used to
    construct a probability distribution for the desired statistic.
  prefs: []
  type: TYPE_NORMAL
- en: This technique is often used in machine learning to estimate the accuracy of
    a model, validate its performance, and identify areas that need improvement.
  prefs: []
  type: TYPE_NORMAL
- en: For example, we can use bootstrap sampling to calculate the population means.
    Also, the result would be as follows.
  prefs: []
  type: TYPE_NORMAL
- en: '![Machine Learning: What is Bootstrapping?](../Images/32e411bd1f65f31a8b485a7638bce566.png)'
  prefs: []
  type: TYPE_IMG
- en: Image by Author
  prefs: []
  type: TYPE_NORMAL
- en: We also will cover this example later in this article.
  prefs: []
  type: TYPE_NORMAL
- en: How to Use Bootstrapping in Machine Learning?
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Bootstrapping can be used in machine learning in several ways, including the
    estimation of model performance, model selection, and identifying the most important
    features in a dataset.
  prefs: []
  type: TYPE_NORMAL
- en: One of the popular use cases of bootstrapping in machine learning is to estimate
    the accuracy of a classifier, which we will do in this article.
  prefs: []
  type: TYPE_NORMAL
- en: Let’s start with an easy example of bootstrapping in Python as a warmup.
  prefs: []
  type: TYPE_NORMAL
- en: Bootstrapping in Calculating Mean
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: We will show how bootstrapping can be used to estimate the mean height of students
    in a school of 10,000 students.
  prefs: []
  type: TYPE_NORMAL
- en: The general approach is to calculate the mean by summing up all heights and
    dividing the sum by 10,000.
  prefs: []
  type: TYPE_NORMAL
- en: First, generate a sample of 10,000 randomly generated numbers (heights) using
    the NumPy library.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: Here is the output of the mean.
  prefs: []
  type: TYPE_NORMAL
- en: '![Machine Learning: What is Bootstrapping?](../Images/9b2eb41c916be41d7618d433b1ae8c40.png)'
  prefs: []
  type: TYPE_IMG
- en: Now, how can we calculate the height of these students just from 200 students?
  prefs: []
  type: TYPE_NORMAL
- en: In bootstrap sampling, we create several samples of the population by randomly
    selecting elements from the population with replacements.
  prefs: []
  type: TYPE_NORMAL
- en: In our example, the sample size will be 5\. It means there will be 40 samples
    for the population of 200 students.
  prefs: []
  type: TYPE_NORMAL
- en: With the code below, we will draw 40 samples, size of 5, from the students.
    (x)
  prefs: []
  type: TYPE_NORMAL
- en: This involves drawing random samples with replacements from the original sample
    to create 40 new samples.
  prefs: []
  type: TYPE_NORMAL
- en: What do I mean by replacements?
  prefs: []
  type: TYPE_NORMAL
- en: I mean first selecting one of 10,000, forgetting who I chose, then selecting
    one of 10,000 again.
  prefs: []
  type: TYPE_NORMAL
- en: You can select the same student, but there is a small chance of that. Replacements
    don’t sound that clever anymore, right?
  prefs: []
  type: TYPE_NORMAL
- en: Each new sample has a size of 5, which is smaller than the original sample.
    The mean of each new sample is calculated and stored in the sample_mean list.
  prefs: []
  type: TYPE_NORMAL
- en: Finally, the mean of all 40 sample means is calculated and represents the estimate
    of the population mean.
  prefs: []
  type: TYPE_NORMAL
- en: Here is the code.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs: []
  type: TYPE_PRE
- en: Here is the output.
  prefs: []
  type: TYPE_NORMAL
- en: '![Machine Learning: What is Bootstrapping?](../Images/640caf58b3e8287aba45e1407348b89f.png)'
  prefs: []
  type: TYPE_IMG
- en: It is pretty close, right?
  prefs: []
  type: TYPE_NORMAL
- en: Bootstrapping in Classification Task With a Decision Tree
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Here, we will see the usage of bootstrapping in classification with a decision
    tree by using the Iris data set. But first, let’s see what a decision tree is.
  prefs: []
  type: TYPE_NORMAL
- en: What Is a Decision Tree?
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: A [decision tree](https://www.stratascratch.com/blog/decision-tree-and-random-forest-algorithm-explained/?utm_source=blog&utm_medium=click&utm_campaign=kdn+bootstrapping)
    is one of the popular [machine learning algorithms](https://www.stratascratch.com/blog/machine-learning-algorithms-you-should-know-for-data-science/?utm_source=blog&utm_medium=click&utm_campaign=kdn+bootstrapping)
    that is widely used for both classification and regression problems. It is a tree-based
    model that involves making predictions by branching out from the root node and
    making decisions based on certain conditions.
  prefs: []
  type: TYPE_NORMAL
- en: The decision tree classifier is a specific implementation of this algorithm
    used to perform binary classification tasks.
  prefs: []
  type: TYPE_NORMAL
- en: The main goal of the decision tree classifier is to determine the most important
    features that contribute to the prediction of a target variable. The algorithm
    uses a greedy approach to minimize the impurity of the tree by selecting the feature
    with the highest information gain. The tree continues to split until the data
    is completely pure or until a stopping criterion is reached.
  prefs: []
  type: TYPE_NORMAL
- en: What Is the Iris Data Set?
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: The Iris data set is one of the popular data sets used to evaluate classification
    tasks.
  prefs: []
  type: TYPE_NORMAL
- en: This data set contains 150 observations of iris flowers, where each observation
    contains the features such as sepal length, sepal width, petal length, and petal
    width.
  prefs: []
  type: TYPE_NORMAL
- en: The target variable is the species of the iris plant.
  prefs: []
  type: TYPE_NORMAL
- en: The Iris data set is widely used in machine learning algorithms to evaluate
    the performance of different models and is also used as an example to demonstrate
    the concept of decision tree classifiers.
  prefs: []
  type: TYPE_NORMAL
- en: Let’s now see how to use bootstrapping and a decision tree in classification.
  prefs: []
  type: TYPE_NORMAL
- en: Coding of Bootstrapping
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: The code implements a bootstrapping technique for a machine learning model using
    the DecisionTreeClassifier from the sci-kit-learn library.
  prefs: []
  type: TYPE_NORMAL
- en: The first few lines load the Iris dataset and extract the feature data (X) and
    target data (y) from it.
  prefs: []
  type: TYPE_NORMAL
- en: The bootstrap function takes in the feature data (X), target data (y), and the
    number of samples (n_samples) to use in bootstrapping.
  prefs: []
  type: TYPE_NORMAL
- en: The function returns a list of trained models and a pandas data frame with precision,
    recall, F1 score, and the indices used for bootstrapping.
  prefs: []
  type: TYPE_NORMAL
- en: The bootstrapping process is done in a **for loop**.
  prefs: []
  type: TYPE_NORMAL
- en: For each iteration, the function uses the **np.random.choice** method to randomly
    select a sample of the feature data (X) and target data (y).
  prefs: []
  type: TYPE_NORMAL
- en: The sample data is then split into training and testing sets using the **train_test_split**
    method. The DecisionTreeClassifier is trained on the training data and then used
    to make predictions on the testing data.
  prefs: []
  type: TYPE_NORMAL
- en: The precision, recall, and F1 scores are calculated using the **metrics.precision_score**,
    **metrics.recall_score**, and **metrics.f1_score** methods from the sci-kit-learn
    library.  These scores are then added to a list for each iteration.
  prefs: []
  type: TYPE_NORMAL
- en: Finally, the results are saved to a pandas data frame with columns for precision,
    recall, F1 score, the trained models, and the indices used for bootstrapping.
    The data frame is then returned by the function.
  prefs: []
  type: TYPE_NORMAL
- en: Now, let's see the code.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE2]'
  prefs: []
  type: TYPE_PRE
- en: Now call the function.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE3]'
  prefs: []
  type: TYPE_PRE
- en: Show the results of the data frame that the function creates.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE4]'
  prefs: []
  type: TYPE_PRE
- en: '![Machine Learning: What is Bootstrapping?](../Images/97c75b51217d1d7b9f9a1aabeeb572b0.png)'
  prefs: []
  type: TYPE_IMG
- en: Now add the index column as the model number,
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE5]'
  prefs: []
  type: TYPE_PRE
- en: and sort the values by precision.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE6]'
  prefs: []
  type: TYPE_PRE
- en: To see the results better, we will make some data visualization.
  prefs: []
  type: TYPE_NORMAL
- en: '![Machine Learning: What is Bootstrapping?](../Images/29813bc53762f3d917a178aaa826eeb0.png)'
  prefs: []
  type: TYPE_IMG
- en: Bootstrapping Visualization
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: The code below creates 3 bar graphs to show the performance of bootstrapped
    models.
  prefs: []
  type: TYPE_NORMAL
- en: The performance of the models is measured by the precision, recall, and F1 scores.
    So, we will create a data frame called pred_df. This data frame stores the scores
    of the models.
  prefs: []
  type: TYPE_NORMAL
- en: The code creates a figure with 3 subplots.
  prefs: []
  type: TYPE_NORMAL
- en: The first subplot (ax2) is a bar graph that shows the precision scores of the
    top 5 models.
  prefs: []
  type: TYPE_NORMAL
- en: The x-axis shows the precision score, and the y-axis shows the model's index.
    For each bar, the value is displayed in the center of these 3 figures. The title
    of this graph is "Precision".
  prefs: []
  type: TYPE_NORMAL
- en: The second subplot (ax3) is a bar graph that shows the recall scores of the
    top 5 models. The x-axis shows the recall score, and the y-axis shows the model's
    index. The title of this graph is "Recall".
  prefs: []
  type: TYPE_NORMAL
- en: The third subplot (ax4) is a bar graph that shows the F1 scores of the top 5
    models. The x-axis shows the F1 score, and the y-axis shows the model's index.
    The title of this graph is "F1".
  prefs: []
  type: TYPE_NORMAL
- en: The overall title of the figure is "Bootstrapped Model Performance Metrics".
    We will display these images by using plt.show().
  prefs: []
  type: TYPE_NORMAL
- en: Here is the code.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE7]'
  prefs: []
  type: TYPE_PRE
- en: Here is the output.
  prefs: []
  type: TYPE_NORMAL
- en: '![Machine Learning: What is Bootstrapping?](../Images/31afacca2267a961f8a854a0a26a8812.png)'
  prefs: []
  type: TYPE_IMG
- en: Image by Author
  prefs: []
  type: TYPE_NORMAL
- en: It looks like Model 397 is our best model according to the precision and F1
    score.
  prefs: []
  type: TYPE_NORMAL
- en: Of course, if the recall is more important for your project, you can choose
    Model 718 or another.
  prefs: []
  type: TYPE_NORMAL
- en: Reproducing Best Results
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Now, we have already saved the indices to create reproducible results. We will
    select the 397th model and see the results whether the results are reproducible
    or not.
  prefs: []
  type: TYPE_NORMAL
- en: The following code starts by selecting a sample of the data (X and y) using
    the indices stored in the 397th row of the pred_df data frame.
  prefs: []
  type: TYPE_NORMAL
- en: The sample data is then split into training and testing datasets using the **train_test_split**
    method with a test size of 0.2 and a random state of 42.
  prefs: []
  type: TYPE_NORMAL
- en: Next, a decision tree classifier model is trained using the training data and
    stored in the model's list. The trained model is then used to make predictions
    on the test data using the **predict()** method.
  prefs: []
  type: TYPE_NORMAL
- en: Finally, the precision, recall, and F1 scores of the model are calculated using
    the **precision_score**, **recall_score**, and **f1_score** functions from the
    metrics module and printed to the console.
  prefs: []
  type: TYPE_NORMAL
- en: These scores evaluate the model's performance by measuring the model's ability
    to correctly classify the data and the level of false positives and false negatives
    generated by the model.
  prefs: []
  type: TYPE_NORMAL
- en: Here is the code.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE8]'
  prefs: []
  type: TYPE_PRE
- en: Here is the output.
  prefs: []
  type: TYPE_NORMAL
- en: '![Machine Learning: What is Bootstrapping?](../Images/09737f2f4e1c27cd68f730932eafbb6d.png)'
  prefs: []
  type: TYPE_IMG
- en: Conclusion
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In conclusion, bootstrapping is a powerful tool in machine learning that can
    be used to improve the performance of algorithms. By creating multiple subsets
    of the data, bootstrapping helps to reduce the risk of overfitting and improves
    the accuracy of the results.
  prefs: []
  type: TYPE_NORMAL
- en: We demonstrated how to use bootstrapping for the classification algorithm with
    a decision tree classifier.
  prefs: []
  type: TYPE_NORMAL
- en: By combining bootstrapping and decision tree classifier, we can create a powerful
    machine learning model that provides accurate and reliable results, which might
    be applied to other [classification algorithms](https://www.stratascratch.com/blog/overview-of-machine-learning-algorithms-classification/?utm_source=blog&utm_medium=click&utm_campaign=kdn+bootstrapping).
  prefs: []
  type: TYPE_NORMAL
- en: Understanding all the mentioned concepts is essential for data scientists and
    machine learning professionals. Mandatory, I would say! They allow you to make
    informed decisions about the tools and techniques they use to solve real-world
    problems.
  prefs: []
  type: TYPE_NORMAL
- en: '**[Nate Rosidi](https://www.stratascratch.com)** is a data scientist and in
    product strategy. He''s also an adjunct professor teaching analytics, and is the
    founder of [StrataScratch](https://www.stratascratch.com/), a platform helping
    data scientists prepare for their interviews with real interview questions from
    top companies. Connect with him on [Twitter: StrataScratch](https://twitter.com/StrataScratch)
    or [LinkedIn](https://www.linkedin.com/in/nathanrosidi/).'
  prefs: []
  type: TYPE_NORMAL
- en: More On This Topic
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: '[KDnuggets News, December 14: 3 Free Machine Learning Courses for…](https://www.kdnuggets.com/2022/n48.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[5 Machine Learning Skills Every Machine Learning Engineer Should…](https://www.kdnuggets.com/2023/03/5-machine-learning-skills-every-machine-learning-engineer-know-2023.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[A Solid Plan for Learning Data Science, Machine Learning, and Deep Learning](https://www.kdnuggets.com/2023/01/mwiti-solid-plan-learning-data-science-machine-learning-deep-learning.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[AI, Analytics, Machine Learning, Data Science, Deep Learning…](https://www.kdnuggets.com/2021/12/developments-predictions-ai-machine-learning-data-science-research.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Breaking the Data Barrier: How Zero-Shot, One-Shot, and Few-Shot…](https://www.kdnuggets.com/2023/08/breaking-data-barrier-zeroshot-oneshot-fewshot-learning-transforming-machine-learning.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Federated Learning: Collaborative Machine Learning with a Tutorial…](https://www.kdnuggets.com/2021/12/federated-learning-collaborative-machine-learning-tutorial-get-started.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
