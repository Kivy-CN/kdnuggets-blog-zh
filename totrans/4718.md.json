["```py\nratings_df = pd.read_csv('hospital_ratings.csv').drop(columns='Unnamed: 0')\n\nprint('Number of Hospitals: {}'.format(len(ratings_df.index)))\n\nratings_df.head(10)\n\n```", "```py\nNumber of Hospitals: 100\n\n```", "```py\n'below average' --> 5\n'average' --> 3 \n'above average' --> 1\n\n```", "```py\n'below average' --> 3 \n'average' --> 2 \n'above average' --> 1\n\n```", "```py\n'below average' --> 1 \n'average' --> 0 \n'above average' --> -1\n\n```", "```py\nMORTALITY_MAP = {\n    'below_average': 1,\n    'average': 0,\n    'above_average': -1\n}\n\nratings_df['mortality_rate'] = ratings_df['mortality_rate'].map(MORTALITY_MAP) # apply the map\nratings_df.head()\n\n```", "```py\nratings_df.corr()\n\n```", "```py\nratings_df.corr(method='spearman')\n\n```", "```py\nprescribers_df = pd.read_csv('prescriptions.csv').drop(columns='Unnamed: 0')\nprescribers_df.head(10)\n\n```", "```py\nprescribers_df = prescribers_df.groupby('prescriber_id').agg('sum')\nprescribers_df.head(10)\n\n```", "```py\nprescribers_df['opioid_prescription_ratio'] = (prescribers_df['num_opioid_prescriptions'] / \n                                               prescribers_df['num_prescriptions'])\n\n```", "```py\nprescribers_df.sort_values('opioid_prescription_ratio', ascending=False).head(10)\n\n```", "```py\ndef wilson_ci_lower_bound(num_pos, n, confidence=.95):\n    if n == 0:\n        return 0\n\n    z = stats.norm.ppf(1 - (1 - confidence) / 2) # Establish a z-score corresponding to a confidence level\n\n    p_hat = num_pos / n\n\n    # Rewrite formula in python\n    numerator = p_hat + (z**2 / (2*n)) - (z * math.sqrt((p_hat * (1 - p_hat) + (z**2 / (4*n))) / n))\n    denominator = 1 + ((z**2) / n)\n\n    return  numerator / denominator\n\n```", "```py\nprescribers_df['wilson_opioid_prescription_ratio'] = prescribers_df \\\n    .apply(lambda row: wilson_ci_lower_bound(row['num_opioid_prescriptions'], row['num_prescriptions']), axis=1)\n\nprescribers_df.sort_values('wilson_opioid_prescription_ratio', ascending=False).head(10)\n\n```"]