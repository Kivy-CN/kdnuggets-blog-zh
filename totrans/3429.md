# 处理（几乎）任何机器学习问题

> 原文：[https://www.kdnuggets.com/2016/08/approaching-almost-any-machine-learning-problem.html](https://www.kdnuggets.com/2016/08/approaching-almost-any-machine-learning-problem.html)

**由Abhishek Thakur，Searchmetrics Inc.高级数据科学家撰写**

平均水平的数据科学家每天处理大量数据。有人说超过60-70%的时间都花在数据清理、处理和将数据转化为适合机器学习模型应用的格式上。这篇文章重点关注第二部分，即应用机器学习模型，包括预处理步骤。本文讨论的管道源于我参与的100多个机器学习竞赛。必须指出的是，这里的讨论非常一般但很有用，实际上还有许多复杂的方法，由专业人士实践。

我们将使用python!

### 数据

在应用机器学习模型之前，数据必须转换为表格形式。这个过程是最耗时且困难的，下面的图示展示了这个过程。

![](../Images/ef6687bb8240699f296448972864d37d.png)

然后将机器学习模型应用于表格数据。表格数据是机器学习或数据挖掘中最常见的数据表示方式。我们有一个数据表，行中包含数据或X的不同样本及标签y。标签可以是单列或多列，这取决于问题的类型。我们将数据表示为X，标签表示为y。

### 标签类型

标签定义了问题，并可以有不同的类型，例如：

+   单列，二进制值（分类问题，一个样本只属于一个类别，且只有两个类别）

+   单列，实值（回归问题，预测单个值）

+   多列，二进制值（分类问题，一个样本属于一个类别，但类别数超过两个）

+   多列，实值（回归问题，预测多个值）

+   以及多标签（分类问题，一个样本可以属于多个类别）

### 评估指标

对于任何类型的机器学习问题，我们必须知道如何评估我们的结果，或者评估指标或目标是什么。例如，对于偏斜的二分类问题，我们通常选择接收者操作特征曲线下面积（ROC AUC或简称AUC）。对于多标签或多类别分类问题，我们通常选择类别交叉熵或多类别对数损失，而对于回归问题，则选择均方误差。

我不会详细讨论不同的评估指标，因为我们可能有很多不同类型，具体取决于问题。

### 库

要开始使用机器学习库，首先安装基础且最重要的库，例如numpy和scipy。

+   进行数据查看和操作：pandas ([http://pandas.pydata.org/](http://pandas.pydata.org/))

+   各种机器学习模型：scikit-learn ([http://scikit-learn.org/stable/](http://scikit-learn.org/stable/))

+   最佳梯度提升库：xgboost ([https://github.com/dmlc/xgboost](https://github.com/dmlc/xgboost))

+   对于神经网络：keras ([http://keras.io/](http://keras.io/))

+   绘制数据：matplotlib ([http://matplotlib.org/](http://matplotlib.org/))

+   监控进度：tqdm ([https://pypi.python.org/pypi/tqdm](https://pypi.python.org/pypi/tqdm))

我不使用 Anaconda ([https://www.continuum.io/downloads](https://www.continuum.io/downloads))。虽然它简单方便并且为你做了一切，但我想要更多的自由。选择权在你。

### 机器学习框架

在2015年，我提出了一个自动化机器学习框架，该框架仍在开发中，并将很快发布。在本文中，相同的框架将作为基础。该框架在下图中显示：

[![](../Images/67917490fbdb01f12e1d3d52ba80e0a9.png)](https://media.licdn.com/mpr/mpr/shrinknp_800_800/AAEAAQAAAAAAAAeqAAAAJDVkYTViYjM5LTZjOWMtNGVhYS1iYjljLWZhOWMyNzJkZGU1MQ.png)

*图源：A. Thakur 和 A. Krohn-Grimberghe，AutoCompete：机器学习竞赛框架，AutoML研讨会，国际机器学习会议2015*

在上面展示的框架中，粉色线条代表最常见的路径。在我们将数据提取并简化为表格格式后，可以开始构建机器学习模型。

第一步是识别问题。这可以通过查看标签来完成。必须知道问题是二分类、多分类还是回归问题。在识别问题后，我们将数据分成两个不同的部分，一个训练集和一个验证集，如下图所示。

![](../Images/a3ddcff4ccc903bce6eb8996747d0e84.png)

数据分割为训练集和验证集“必须”根据标签进行。对于任何类型的分类问题，使用分层拆分。在 Python 中，你可以很容易地使用 scikit-learn 实现这一点。

![](../Images/2afb7eca83a58c0dc890d549a98527ed.png)

对于回归任务，简单的K-Fold拆分应该足够。然而，也有一些复杂的方法，它们倾向于保持训练集和验证集的标签分布相同，这部分留给读者作为练习。

![](../Images/152dbbee815ca5077eee782730c1be65.png)

我在上面的示例中选择了`eval_size`或验证集的大小为完整数据的10%，但可以根据拥有的数据量选择这个值。

数据拆分完成后，将这部分数据留下，不要触碰。对训练集应用的任何操作必须保存，然后应用到验证集。验证集在任何情况下都不应与训练集合并。这样做会导致非常好的评估分数，并让用户满意，但实际上他/她会建立一个过度拟合的无用模型。

下一步是识别数据中的不同变量。我们通常处理三种类型的变量，即数值变量、分类变量和包含文本的变量。以著名的 Titanic 数据集 ([https://www.kaggle.com/c/titanic/data](https://www.kaggle.com/c/titanic/data)) 为例。

![](../Images/d2f1e23d36e48c6037e583baac8946fa.png)

在这里，生存状态是标签。我们已经在前一步将标签从训练数据中分离出来。接下来，我们有 pclass、sex 和 embarked。这些变量具有不同的水平，因此它们是分类变量。像 age、sibsp、parch 等变量是数值变量。Name 是一个具有文本数据的变量，但我认为它对预测生存状态并不有用。

首先分离出数值变量。这些变量不需要任何处理，因此我们可以开始对这些变量应用标准化和机器学习模型。

我们可以通过两种方式处理分类数据：

+   将分类数据转换为标签

![](../Images/a396bfd14528ff13740905abdaf37f3a.png)

+   将标签转换为二进制变量（独热编码）

![](../Images/6a38c90b9fe8de52a5bc78e3abdfe04e.png)

请记得在应用 OneHotEncoder 之前，首先使用 LabelEncoder 将类别转换为数字。

由于 Titanic 数据集中没有很好的文本变量示例，让我们制定处理文本变量的一般规则。我们可以将所有文本变量合并为一个，然后使用一些针对文本数据的算法，将其转换为数字。

文本变量可以按如下方式结合：

[![](../Images/2f45bd10b152be923a2f5cdbd88a6a64.png)](https://media.licdn.com/mpr/mpr/shrinknp_800_800/AAEAAQAAAAAAAAdhAAAAJDQ4ZGU0YTRkLTI2ZjctNDc3My05YjVjLWIzZGY3Y2Y1NzI5ZQ.png)

我们可以使用 CountVectorizer 或 TfidfVectorizer：

![](../Images/5a7b509c6e6740ab905d9840682b5374.png)

或

![](../Images/bfe12de70d35cb15eb03108be0fdfcef.png)

TfidfVectorizer 大多数时候比 CountVectorizer 表现更好，我发现以下参数对于 TfidfVectorizer 几乎总是有效。

![](../Images/56d69dd6ad0339e02ebbc2d8f79dd197.png)

如果你只在训练集上应用这些向量化器，请确保将其保存到硬盘，以便稍后在验证集上使用。

![](../Images/317e9a15abba9a733f02b5396e3e01d7.png)

* * *

## 我们的前三个课程推荐

![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 1\. [谷歌网络安全证书](https://www.kdnuggets.com/google-cybersecurity) - 快速进入网络安全职业生涯

![](../Images/e225c49c3c91745821c8c0368bf04711.png) 2\. [谷歌数据分析专业证书](https://www.kdnuggets.com/google-data-analytics) - 提升您的数据分析技能

![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 3\. [谷歌IT支持专业证书](https://www.kdnuggets.com/google-itsupport) - 支持您的组织进行IT支持

* * *

### 更多相关话题

+   [NExT-GPT简介：任意对任意的多模态大型语言模型](https://www.kdnuggets.com/introduction-to-nextgpt-anytoany-multimodal-large-language-model)

+   [接近机器学习过程的框架](https://www.kdnuggets.com/2018/05/general-approaches-machine-learning-process.html)

+   [SHAP：在Python中解释任何机器学习模型](https://www.kdnuggets.com/2022/11/shap-explain-machine-learning-model-python.html)

+   [如何在没有任何工作经验的情况下获得数据科学领域的第一份工作](https://www.kdnuggets.com/2021/02/first-job-data-science-without-work-experience.html)

+   [在参加任何免费的数据科学课程之前请阅读](https://www.kdnuggets.com/read-this-before-you-take-any-free-data-science-course)

+   [自然语言处理在现实世界中的应用范围：一种不同的解决方案](https://www.kdnuggets.com/2022/03/different-solution-problem-range-nlp-applications-real-world.html)
