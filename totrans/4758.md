# 多类文本分类模型比较与选择

> 原文：[https://www.kdnuggets.com/2018/11/multi-class-text-classification-model-comparison-selection.html](https://www.kdnuggets.com/2018/11/multi-class-text-classification-model-comparison-selection.html)

![c](../Images/3d9c022da2d331bb56691a9617b91b90.png) [评论](/2018/11/multi-class-text-classification-model-comparison-selection.html?page=2#comments)

**作者：[Susan Li](https://www.linkedin.com/in/susanli/)，高级数据科学家**

![图片](../Images/9b64f7c1a5f857cb61411ba48d204dbb.png)

图片来源：Pixabay

在处理给定数据集的[监督学习](https://en.wikipedia.org/wiki/Supervised_learning)问题时，我们尝试不同的算法和技术，以寻找可以生成一般假设的模型，然后对未来实例做出最准确的预测。相同的原则适用于文本（或文档）分类，其中有许多模型可以用来训练文本分类器。[“我应该使用什么机器学习模型？”这个问题的答案始终是“这要看情况。”即使是最有经验的数据科学家也无法在实验之前确定哪个算法表现最佳](https://docs.microsoft.com/en-us/azure/machine-learning/studio/algorithm-choice)。

这是我们今天要做的事情：使用我们在之前文章中介绍的所有文本分类方法（及更多），并比较我们训练的文本分类模型，以选择最适合我们问题的最准确的模型。

### 数据

我们使用了一个相对较大的 Stack Overflow 问题和标签数据集。数据可以在[Google BigQuery](https://bigquery.cloud.google.com/dataset/bigquery-public-data:stackoverflow)中获取，也可以通过这个云存储网址公开获取：[https://storage.googleapis.com/tensorflow-workshop-examples/stack-overflow-data.csv](https://storage.googleapis.com/tensorflow-workshop-examples/stack-overflow-data.csv)。

### 探索数据

![](../Images/a5cabad690901acd935be6fd74d840d2.png)

图 1

***10276752***

我们的数据中有超过 1000 万个词。

```py
my_tags = ['java','html','asp.net','c#','ruby-on-rails','jquery','mysql','php','ios','javascript','python','c','css','android','iphone','sql','objective-c','c++','angularjs','.net']
plt.figure(figsize=(10,4))
df.tags.value_counts().plot(kind='bar');
```

![](../Images/452d3fe88135ada3e259b741efa43955.png)

图 2

类别非常平衡。

我们想查看一些帖子和标签对。

```py
def print_plot(index):
    example = df[df.index == index][['post', 'tags']].values[0]
    if len(example) > 0:
        print(example[0])
        print('Tag:', example[1])

print_plot(10)
```

![](../Images/9be95e3d1a25f01dd32295fac28865e9.png)

图 3

```py
print_plot(30)
```

![](../Images/00beb827a9a27fc750727df3b6562c61.png)

图 4

正如你所看到的，文本需要进行清理。

### 文本预处理

到目前为止我们看到的文本清理技术在实践中效果很好。根据你可能遇到的文本类型，可能需要包括更复杂的文本清理步骤。但请记住，步骤越多，文本清理所需的时间就会越长。

对于这个特定的数据集，我们的文本清理步骤包括 HTML 解码、去除停用词、将文本转换为小写、去除标点符号、去除无效字符等等。

现在我们来看看清理后的帖子：

![](../Images/dec6390974584bf90a0941482a627b0c.png)

图5

好得多！

```py
df['post'].apply(lambda x: len(x.split(' '))).sum()
```

***3421180***

在文本清理和去除停用词后，我们只剩下300多万个词汇可以使用！

在分割数据集后，下一步包括特征工程。我们将把文本文档转换为词汇计数矩阵（CountVectorizer），然后将计数矩阵转换为标准化的tf-idf表示（tf-idf变换器）。之后，我们从[Scikit-Learn库](http://scikit-learn.org/stable/)中训练几个分类器。

```py
X = df.post
y = df.tags
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.3, random_state = 42)
```

### **适用于多项模型的朴素贝叶斯分类器**

在获取特征后，我们可以训练一个分类器来预测帖子的标签。我们将从[朴素贝叶斯](http://scikit-learn.org/stable/modules/naive_bayes.html#naive-bayes)分类器开始，它为这个任务提供了一个不错的基准。`scikit-learn`包括了几种这种分类器的变体；最适合文本的变体是多项式变体。

为了使向量化器 => 变换器 => 分类器更易于使用，我们将使用`Pipeline`类，该类在Scikit-Learn中表现得像一个复合分类器。

![](../Images/c3a81dd575687d97955c8bea7f4b2346.png)

图6

我们达到了74%的准确率。

### **线性支持向量机**

[线性支持向量机](http://scikit-learn.org/stable/modules/svm.html#svm) 被广泛认为是最好的文本分类算法之一。

![](../Images/8a17b5a7232e05f83bf4c7e26052b9d4.png)

图7

我们达到了更高的79%的准确率，比朴素贝叶斯提高了5%。

### 逻辑回归

逻辑回归是一种简单且易于理解的分类算法，并且逻辑回归可以很容易地推广到多类问题。

![](../Images/d7389cf061c3db22f58eda8311724fd2.png)

图8

我们实现了78%的准确率，比朴素贝叶斯高4%，比支持向量机低1%。

如你所见，通过遵循一些非常基本的步骤并使用简单的线性模型，我们在这个多类别文本分类数据集上达到了高达79%的准确率。

使用相同的数据集，我们将尝试一些高级技术，如词嵌入和神经网络。

现在，让我们尝试一些比单纯计数单词更复杂的特征。

* * *

## 我们的三大课程推荐

![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 1\. [谷歌网络安全证书](https://www.kdnuggets.com/google-cybersecurity) - 快速开启网络安全职业之路。

![](../Images/e225c49c3c91745821c8c0368bf04711.png) 2\. [谷歌数据分析专业证书](https://www.kdnuggets.com/google-data-analytics) - 提升你的数据分析技能

![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 3\. [谷歌IT支持专业证书](https://www.kdnuggets.com/google-itsupport) - 支持你所在组织的IT工作

* * *

### 相关主题

+   [Python和R中的机器学习算法比较](https://www.kdnuggets.com/2023/06/machine-learning-algorithms-python-r.html)

+   [线性回归模型选择：平衡简洁性与复杂性](https://www.kdnuggets.com/2023/02/linear-regression-model-selection-balancing-simplicity-complexity.html)

+   [什么是文本分类？](https://www.kdnuggets.com/2022/07/text-classification.html)

+   [最佳文本分类任务架构：基准测试…](https://www.kdnuggets.com/2023/04/best-architecture-text-classification-task-benchmarking-options.html)

+   [ChatGPT与Google Bard：技术差异比较](https://www.kdnuggets.com/2023/03/chatgpt-google-bard-comparison-technical-differences.html)

+   [深入探讨GPT模型：演变与性能比较](https://www.kdnuggets.com/2023/05/deep-dive-gpt-models.html)
