- en: Using AutoML to Generate Machine Learning Pipelines with TPOT
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://www.kdnuggets.com/2018/01/managing-machine-learning-workflows-scikit-learn-pipelines-part-4.html](https://www.kdnuggets.com/2018/01/managing-machine-learning-workflows-scikit-learn-pipelines-part-4.html)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: '![c](../Images/3d9c022da2d331bb56691a9617b91b90.png) [comments](#comments)'
  prefs: []
  type: TYPE_IMG
- en: 'Thus far in this series of posts we have:'
  prefs: []
  type: TYPE_NORMAL
- en: '[Introduced Scikit-learn''s pipelines](/2017/12/managing-machine-learning-workflows-scikit-learn-pipelines-part-1.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Showed how [grid search and pipelines together are a powerful tool](/2018/01/managing-machine-learning-workflows-scikit-learn-pipelines-part-2.html)
    for hyperparameter optimization
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Demonstrated [numerous combinations of models, pipelines, and grid searches
    all together](/2018/01/managing-machine-learning-workflows-scikit-learn-pipelines-part-3.html),
    and their evaluation and selection
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'This post will take a different approach to constructing pipelines. Certainly
    the title gives away this difference: instead of hand-crafting pipelines and hyperparameter
    optimization, and performing model selection ourselves, we will instead automate
    these processes. We will use the automated machine learning tool TPOT to do some
    of our heavy lifting.'
  prefs: []
  type: TYPE_NORMAL
- en: '![Header image](../Images/fc517000300a1dc91de487be20edfd12.png)'
  prefs: []
  type: TYPE_IMG
- en: But first, what is [automated machine learning (AutoML)](https://www.kdnuggets.com/2017/01/current-state-automated-machine-learning.html)?
  prefs: []
  type: TYPE_NORMAL
- en: 'Data scientist and leading automated machine learning proponent [Randy Olson](http://www.randalolson.com/)
    states that [effective machine learning design requires us to](https://www.kdnuggets.com/2016/05/tpot-python-automating-data-science.html/2):'
  prefs: []
  type: TYPE_NORMAL
- en: Always tune the hyperparameters for our models
  prefs:
  - PREF_BQ
  - PREF_UL
  type: TYPE_NORMAL
- en: Always try out many different models
  prefs:
  - PREF_BQ
  - PREF_UL
  type: TYPE_NORMAL
- en: Always explore numerous feature representations for our data
  prefs:
  - PREF_BQ
  - PREF_UL
  type: TYPE_NORMAL
- en: Therefore, at a fundamental level, we can consider AutoML to be the tasks of
    algorithm selection, hyperparameter tuning, iterative modeling, and model assessment.
  prefs: []
  type: TYPE_NORMAL
- en: 'For insight into why this is so, consider what AI Researcher and Stanford University
    PhD candidate [S. Zayd Enam](https://twitter.com/zaydenam) wrote some time ago
    in his fantastic blog post titled "[Why is machine learning ''hard''?](http://ai.stanford.edu/~zayd/why-is-machine-learning-hard.html)":'
  prefs: []
  type: TYPE_NORMAL
- en: 'The difficulty is that machine learning is a fundamentally hard debugging problem.
    Debugging for machine learning happens in two cases: 1) your algorithm doesn''t
    work or 2) your algorithm doesn''t work well enough.[...] Very rarely does an
    algorithm work the first time and so this ends up being where the majority of
    time is spent in building algorithms.'
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Basically, if an algorithm does not work, or does not do so well enough, and
    the process of choosing and refinining becomes iterative, this exposes an opportunity
    for automation, hence automated machine learning.
  prefs: []
  type: TYPE_NORMAL
- en: 'I have [previously attempted to capture](https://www.linkedin.com/pulse/case-machine-learning-business-matthew-mayo)
    AutoML''s essence as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: 'If, as [Sebastian Raschka has described it](https://www.kdnuggets.com/2016/05/explain-machine-learning-software-engineer.html),
    computer programming is about automation, and machine learning is "all about automating
    automation," then automated machine learning is "the automation of automating
    automation." Follow me, here: programming relieves us by managing rote tasks;
    machine learning allows computers to learn how to best perform these rote tasks;
    automated machine learning allows for computers to learn how to optimize the outcome
    of learning how to perform these rote actions.'
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: ''
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: This is a very powerful idea; while we previously have had to worry about tuning
    parameters and hyperparameters, automated machine learning systems can learn the
    best way to tune these for optimal outcomes by a number of different possible
    methods.
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: 'The rationale for AutoML stems from this idea: if numerous machine learning
    models must be built, using a variety of algorithms and a number of differing
    hyperparameter configurations, then this model building can be automated, as can
    the comparison of model performance and accuracy.'
  prefs: []
  type: TYPE_NORMAL
- en: So how do we actually do this? [TPOT](https://github.com/EpistasisLab/tpot)
    is a Python tool which "automatically creates and optimizes machine learning pipelines
    using genetic programming." TPOT works in tandem with Scikit-learn, describing
    itself as a Scikit-learn wrapper. TPOT is open source, written in Python, and
    aimed at simplifying a machine learning process by way of an AutoML approach based
    on [genetic programming](https://en.wikipedia.org/wiki/Genetic_programming). The
    end result is automated hyperparameter selection, modeling with a variety of algorithms,
    and exploration of numerous feature representations, all leading to iterative
    model building and model evaluation.
  prefs: []
  type: TYPE_NORMAL
- en: You can read [more about using TPOT here](https://www.kdnuggets.com/2016/05/tpot-python-automating-data-science.html),
    and can read an [interview with the project's (former) lead developer here](https://www.kdnuggets.com/2016/11/autoamted-machine-learning-interview-randy-olson-tpot.html).
  prefs: []
  type: TYPE_NORMAL
- en: '![TPOT](../Images/49a6192aa0b8ec1192da08cbbdf0e83e.png)'
  prefs: []
  type: TYPE_IMG
- en: And now back to the topic at hand. We are interested in using TPOT to generate
    optimized machine learning pipelines for us. You will likely be surprised at how
    easy it is to do so.
  prefs: []
  type: TYPE_NORMAL
- en: 'The code:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Note that almost everything we need is accomplished with [this single line](http://epistasislab.github.io/tpot/):'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: This begins the genetic programming-based hyperparameter selection, modeling
    with a variety of algorithms, and feature representations exploration. The result
    should be an optimized model.
  prefs: []
  type: TYPE_NORMAL
- en: When it is finished, TPOT will display the "best" model (based on test data
    accuracy) hyperparameters, and will also output the pipelines as an execution-ready
    Python script file for later use, and further investigation.
  prefs: []
  type: TYPE_NORMAL
- en: 'Let''s run the code with this:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs: []
  type: TYPE_PRE
- en: 'And here''s what happens:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE2]'
  prefs: []
  type: TYPE_PRE
- en: And there you have it. The process took just under 7 minutes to complete, and
    the resulting XGBoost-based pipeline was able to accurately classify 100% of test
    data instances. This is obviously a toy dataset, and the cross-validation score
    was not altered much at all during the genetic process, but since we have come
    this far with using iris for a variety of pipeline construction (including using
    TPOT), we are definitely ready to move beyond and onto some other data.
  prefs: []
  type: TYPE_NORMAL
- en: 'The above execution generates this Python pipeline script and saves it as `tpot_iris_pipeline.py''`:'
  prefs: []
  type: TYPE_NORMAL
- en: Remember that TPOT uses a genetic approach to optimization, and so subsequent
    executions result in different results. Don't blame me; blame evolution.
  prefs: []
  type: TYPE_NORMAL
- en: This process may have generated more questions than answers, especially if automated
    approaches to model optimization are new to you. We will revisit this in a future
    post to expand on these concepts. For now just remember that AutoML likely seems
    -- from a single example, mind you -- that it may be a powerful tool for model
    optimization.
  prefs: []
  type: TYPE_NORMAL
- en: You may want to follow this up by reading [The Current State of Automated Machine
    Learning](https://www.kdnuggets.com/2017/01/current-state-automated-machine-learning.html),
    an article I wrote one year ago, but which is still relevant.
  prefs: []
  type: TYPE_NORMAL
- en: '**Related:**'
  prefs: []
  type: TYPE_NORMAL
- en: '[Managing Machine Learning Workflows with Scikit-learn Pipelines Part 1: A
    Gentle Introduction](/2017/12/managing-machine-learning-workflows-scikit-learn-pipelines-part-1.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Managing Machine Learning Workflows with Scikit-learn Pipelines Part 2: Integrating
    Grid Search](/2018/01/managing-machine-learning-workflows-scikit-learn-pipelines-part-2.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Managing Machine Learning Workflows with Scikit-learn Pipelines Part 3: Multiple
    Models, Pipelines, and Grid Searches](/2018/01/managing-machine-learning-workflows-scikit-learn-pipelines-part-3.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '* * *'
  prefs: []
  type: TYPE_NORMAL
- en: Our Top 3 Course Recommendations
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 1\. [Google Cybersecurity
    Certificate](https://www.kdnuggets.com/google-cybersecurity) - Get on the fast
    track to a career in cybersecurity.'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/e225c49c3c91745821c8c0368bf04711.png) 2\. [Google Data Analytics
    Professional Certificate](https://www.kdnuggets.com/google-data-analytics) - Up
    your data analytics game'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 3\. [Google IT Support
    Professional Certificate](https://www.kdnuggets.com/google-itsupport) - Support
    your organization in IT'
  prefs: []
  type: TYPE_NORMAL
- en: '* * *'
  prefs: []
  type: TYPE_NORMAL
- en: More On This Topic
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: '[Machine Learning Pipeline Optimization with TPOT](https://www.kdnuggets.com/2021/05/machine-learning-pipeline-optimization-tpot.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[4 Ways to Generate Passive Income Using ChatGPT](https://www.kdnuggets.com/2023/03/4-ways-generate-passive-income-chatgpt.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Generate Music From Text Using Google MusicLM](https://www.kdnuggets.com/2023/06/generate-music-text-google-musiclm.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[3 Ways to Generate Hyper-Realistic Faces Using Stable Diffusion](https://www.kdnuggets.com/3-ways-to-generate-hyper-realistic-faces-using-stable-diffusion)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[How to Generate Synthetic Tabular Dataset](https://www.kdnuggets.com/2022/03/generate-tabular-synthetic-dataset.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Generate Synthetic Time-series Data with Open-source Tools](https://www.kdnuggets.com/2022/06/generate-synthetic-timeseries-data-opensource-tools.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
