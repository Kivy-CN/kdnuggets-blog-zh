["```py\n(\n    df.pipe(clean)\n    .pipe(analysis)\n)\n```", "```py\nimport pandas as pd\ndf = pd.read_csv('/work/Online Sales Data.csv')\ndf.head(3)\n```", "```py\n# data cleaning\ndf = df.drop_duplicates()\ndf = df.dropna()\ndf = df.reset_index(drop=True)\n\n# convert types\ndf['Product Category'] = df['Product Category'].astype('str')\ndf['Product Name'] = df['Product Name'].astype('str')\ndf['Date'] = pd.to_datetime(df['Date'])\n\n# data analysis\ndf['month'] = df['Date'].dt.month\nnew_df = df.groupby('month')['Units Sold'].mean()\n\n# data visualization\nnew_df.plot(kind='bar', figsize=(10, 5), title='Average Units Sold by Month');\n```", "```py\ndef load_data(path):\n    return pd.read_csv(path)\n\ndef data_cleaning(data):\n    data = data.drop_duplicates()\n    data = data.dropna()\n    data = data.reset_index(drop=True)\n    return data\n\ndef convert_dtypes(data, types_dict=None):\n    data = data.astype(dtype=types_dict)\n    ## convert the date column to datetime\n    data['Date'] = pd.to_datetime(data['Date'])\n    return data\n\ndef data_analysis(data):\n    data['month'] = data['Date'].dt.month\n    new_df = data.groupby('month')['Units Sold'].mean()\n    return new_df\n\ndef data_visualization(new_df,vis_type='bar'):\n    new_df.plot(kind=vis_type, figsize=(10, 5), title='Average Units Sold by Month')\n    return new_df\n```", "```py\npath = \"/work/Online Sales Data.csv\"\ndf = (pd.DataFrame()\n            .pipe(lambda x: load_data(path))\n            .pipe(data_cleaning)\n            .pipe(convert_dtypes,{'Product Category': 'str', 'Product Name': 'str'})\n            .pipe(data_analysis)\n            .pipe(data_visualization,'line')\n           )\n```"]