- en: Merging Pandas DataFrames in Python
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://www.kdnuggets.com/2020/12/merging-pandas-dataframes-python.html](https://www.kdnuggets.com/2020/12/merging-pandas-dataframes-python.html)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: '[comments](#comments)'
  prefs: []
  type: TYPE_NORMAL
- en: '**By [Dean McGrath](https://deanjmcgrath.com/), Aspiring Data Analyst**'
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure](../Images/145f203ebc56525355843ed2542e415c.png)'
  prefs: []
  type: TYPE_IMG
- en: Photo by [MILKOVÍ](https://unsplash.com/@milkovi?utm_source=medium&utm_medium=referral) on [Unsplash](https://unsplash.com/?utm_source=medium&utm_medium=referral)
  prefs: []
  type: TYPE_NORMAL
- en: '* * *'
  prefs: []
  type: TYPE_NORMAL
- en: Our Top 3 Course Recommendations
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 1\. [Google Cybersecurity
    Certificate](https://www.kdnuggets.com/google-cybersecurity) - Get on the fast
    track to a career in cybersecurity.'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/e225c49c3c91745821c8c0368bf04711.png) 2\. [Google Data Analytics
    Professional Certificate](https://www.kdnuggets.com/google-data-analytics) - Up
    your data analytics game'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 3\. [Google IT Support
    Professional Certificate](https://www.kdnuggets.com/google-itsupport) - Support
    your organization in IT'
  prefs: []
  type: TYPE_NORMAL
- en: '* * *'
  prefs: []
  type: TYPE_NORMAL
- en: Introduction
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: As Data Scientist, we will often find that we are required to analyse data from
    multiple data sources at the one time. To be successful at achieving this, we
    need to be able to merge different data sources using a variety of methods efficiently.
    Today we are going to look at using Pandas built-in `.merge()` function to join
    two data sources using several different join methods.
  prefs: []
  type: TYPE_NORMAL
- en: Getting Started
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: For those of you that are new to data science or haven’t been exposed to Python
    Pandas yet, we recommend first beginning with [Pandas Series & DataFrame Explained](https://towardsdatascience.com/pandas-series-dataframe-explained-a178f9748d46) or [Python
    Pandas Iterating a DataFrame](https://towardsdatascience.com/python-pandas-iterating-a-dataframe-eb7ce7db62f8).
    Both of these articles will provide you with the installation instructions and
    background knowledge for today's article.
  prefs: []
  type: TYPE_NORMAL
- en: Pandas Merge
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: The Pandas built-in function `.merge()` provides a powerful method for joining
    two DataFrames using database-style joins.
  prefs: []
  type: TYPE_NORMAL
- en: '**Syntax**'
  prefs: []
  type: TYPE_NORMAL
- en: The above Python snippet shows the syntax for Pandas .merge() function.
  prefs: []
  type: TYPE_NORMAL
- en: Parameters
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: '`right` — This will be the DataFrame that you are joining.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`how` — Here, you can specify how you would like the two DataFrames to join.
    The default is `inner` however, you can pass `left` for left outer join, `right` for
    right outer join and `outer` for a full outer join.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`on` — If both DataFrames contain a shared column or set of columns, then you
    can pass these to `on` as keys to merge.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`left_on` — Here, you can specify a column or list of labels that you would
    like to join the left DataFrame. This parameter is handy when the columns that
    you would like to join on in both DataFrames are named differently.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`right_on` — Same conditions apply as with `left_on` however, for the right
    DataFrame.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`left_index` — If you would like to join the left DataFrame using the index,
    then pass `True`.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`right_index` — If you would like to join the right DataFramse using the index,
    then pass `True.`'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`sort` — Here you can supply `True` if you would like the joined keys sorted
    in lexicographical order.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`suffixes` — If the two DataFrames share column label names, then you can specify
    the type of suffixes to apply to the overlapping. The default is `_x` for left
    and `_y` for right.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`indicator` — You can set this parameter to `True` if you would like to flag
    the source of the row. This flag will indicate whether the rows keys appeared
    in the left DataFrame only, the right DataFrame or in both DataFrames.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`validate` — Here, you can check to see how the DataFrames joined and the relationship
    between the keys. You can pass the following `1:1` to check if the keys are unique
    in the left and right DataFrames, `1:m` to check if the merged keys are unique
    to the left DataFrame only, `m:1` to check if the merged keys are unique to the
    right DataFrame only.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Practical Application
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Below we are going to work through several examples of how you can use the merge
    function yourself. The snippet provided below will assist you in creating two
    DataFrames that we will be using in the remainder of the story.
  prefs: []
  type: TYPE_NORMAL
- en: The above Python snippet creates two DataFrames that you can use to follow on
    with the below examples.
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure](../Images/14f1e8a1218cd26caaa194c2f1daa91d.png)'
  prefs: []
  type: TYPE_IMG
- en: The above console output shows the result of executing the Python snippet to
    create two DataFrames.
  prefs: []
  type: TYPE_NORMAL
- en: Inner Join
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: The inner join method is Pandas merge default. When you pass `how='inner'` the
    returned DataFrame is only going to contain the values from the joined columns
    that are common between both DataFrames.
  prefs: []
  type: TYPE_NORMAL
- en: The above Python snippet demonstrates how to join the two DataFrames using an
    inner join.
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure](../Images/fb30de3a07289cc89207e1155dae615d.png)'
  prefs: []
  type: TYPE_IMG
- en: The above image shows the console output after inner joining the two DataFrames.
  prefs: []
  type: TYPE_NORMAL
- en: From the above screenshot of the console output, we can see the effects of the
    inner join on the two DataFrames. As values `a`, `c`, `e` and `f` are not shared
    across the two DataFrames they do not appear in the console output. The output
    additionally demonstrates the default suffix application when dealing with a shared
    column label across two DataFrames.
  prefs: []
  type: TYPE_NORMAL
- en: Left Join
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Pandas left join functions in a similar way to the left outer join within SQL.
    The returned DataFrame is going to contain all the values from the left DataFrame
    and any value that matches a joining key during the merge from the right DataFrame.
  prefs: []
  type: TYPE_NORMAL
- en: The above Python snippet shows the syntax for merging the two DataFrames using
    a left join.
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure](../Images/89a582d52861273215519cbaac38d1d1.png)'
  prefs: []
  type: TYPE_IMG
- en: The above screenshot shows the console output for merging the two DataFrames
    using a left join.
  prefs: []
  type: TYPE_NORMAL
- en: If the right DataFrame does not match a value within the merged column `NaN`, *Not
    a Number*, will be inserted in the returned DataFrame.
  prefs: []
  type: TYPE_NORMAL
- en: Right Join
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Pandas right join performs a similar function to the left join however the join
    method is applied to the Right DataFrame.
  prefs: []
  type: TYPE_NORMAL
- en: The above Python snippet shows the syntax for merging the two DataFrames using
    Pandas right join.
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure](../Images/64ae2e7853d6cde563c7b5860c3316bd.png)'
  prefs: []
  type: TYPE_IMG
- en: The above screenshot shows the result of merging the two DataFrames using the
    right join.
  prefs: []
  type: TYPE_NORMAL
- en: As seen above, any key that does not exist from the right, in the left DataFrame,
    will have a `NaN` value inserted.
  prefs: []
  type: TYPE_NORMAL
- en: Outer Join
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Pandas outer join merges both DataFrames and essentially reflects the outcome
    of combining a left and right outer join. The outer join will return all values
    from both the left and right DataFrame. Where Pandas cannot find a value within
    the merging DataFrame `NaN` will be used in place.
  prefs: []
  type: TYPE_NORMAL
- en: The above Python snippet shows the syntax for joining the two DataFrames using
    an outer join.
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure](../Images/a13036a5997863b5d3cc1aa8e5201a32.png)'
  prefs: []
  type: TYPE_IMG
- en: The above screenshot shows the result of merging the two DataFrames using an
    outer join.
  prefs: []
  type: TYPE_NORMAL
- en: When merging two DataFrames using an outer join, it is sometimes useful information
    to know where the record within the new DataFrame originated. You can view the
    origin of a record by passing `indicator=True` as a parameter to the `.merge()` function
    which will create a new column titled `_merge`.
  prefs: []
  type: TYPE_NORMAL
- en: Summary
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: To be successful as a Data Scientist, you need to be skilled in handling data
    from multiple data sources often at the same time. Frequently we will need to
    combine data sources sometimes to enrich a dataset or merge historical snapshots
    within current data. Pandas provide a powerful method for joining dataset using
    the built-in `.merge()` function. Pandas `.merge()` function offers flexibility
    in the types of joins that you can create to achieve the desired output.
  prefs: []
  type: TYPE_NORMAL
- en: Thank you for taking the time to read our story — we hope you have found it
    valuable!
  prefs: []
  type: TYPE_NORMAL
- en: '**Bio: [Dean McGrath](https://deanjmcgrath.com/)** ([@DeanMcGrath8](https://twitter.com/DeanMcGrath8))
    is an Aspiring Data Analyst, and contributor to Towards Data Science.'
  prefs: []
  type: TYPE_NORMAL
- en: '[Original](https://towardsdatascience.com/python-pandas-merging-dataframes-aebbf898a9ff).
    Reposted with permission.'
  prefs: []
  type: TYPE_NORMAL
- en: '**Related:**'
  prefs: []
  type: TYPE_NORMAL
- en: '[Pandas on Steroids: End to End Data Science in Python with Dask](/2020/11/pandas-steroids-dask-python-data-science.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Every Complex DataFrame Manipulation, Explained & Visualized Intuitively](/2020/11/dataframe-manipulation-explained-visualized.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[10 Underrated Python Skills](/2020/10/10-underrated-python-skills.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: More On This Topic
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: '[Query Your Pandas DataFrames with SQL](https://www.kdnuggets.com/2021/10/query-pandas-dataframes-sql.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Using the apply() Method with Pandas Dataframes](https://www.kdnuggets.com/2022/07/apply-method-pandas-dataframes.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Combining Pandas DataFrames Made Simple](https://www.kdnuggets.com/2022/09/combining-pandas-dataframes-made-simple.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[How to Merge Pandas DataFrames](https://www.kdnuggets.com/2023/01/merge-pandas-dataframes.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[3 Ways to Merge Pandas DataFrames](https://www.kdnuggets.com/2023/03/3-ways-merge-pandas-dataframes.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Converting JSONs to Pandas DataFrames: Parsing Them the Right Way](https://www.kdnuggets.com/converting-jsons-to-pandas-dataframes-parsing-them-the-right-way)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
