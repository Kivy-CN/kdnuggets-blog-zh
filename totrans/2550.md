# 机器学习中的设计模式

> 原文：[https://www.kdnuggets.com/2021/07/design-patterns-machine-learning.html](https://www.kdnuggets.com/2021/07/design-patterns-machine-learning.html)

[评论](#comments)

**作者：[Ágoston Török](https://www.linkedin.com/in/agoston-torok/)，AGT International数据科学总监**

根据其[定义](https://en.wikipedia.org/wiki/Software_design_pattern)，设计模式是解决常见问题的可重用方案。在软件工程中，这一概念可以追溯到[1987](http://c2.com/doc/oopsla87.html)，当时Beck和Cunningham开始将其应用于编程。到了2000年代，设计模式——尤其是面向对象编程的SOLID设计原则——被认为是程序员的常识。快进15年，我们进入了[Software 2.0](https://karpathy.medium.com/software-2-0-a64152b37c35)时代：机器学习模型开始在越来越多的代码位置替代传统功能。如今，我们将软件视为传统代码、机器学习模型和底层数据的融合。这种融合需要无缝集成这些组件，而这往往因领域间历史和演变的不同而不简单。

> 如今，我们将软件视为传统代码、机器学习模型和底层数据的融合。

然而，设计模式尚未扩展以应对这一新时代的挑战。在Software 2.0中，常见挑战不仅出现在代码层面，还涉及问题定义、数据表示、训练方法、扩展性以及AI系统设计的伦理方面。这为机器学习*反模式*的实践创造了肥沃的土壤。不幸的是，如今甚至博客文章和会议中有时也会出现反模式：那些被认为能改进事物的做法，但实际上却使情况更糟。由于反模式也需要技能，实践者通常无法识别这些反模式。因此，接下来我将给出两个常见的机器学习挑战示例，但不会直接从设计模式开始，而是先介绍它们的解决方案反模式。

### 模型在评估指标上表现不佳

在常见场景中，在收集、清理和准备数据后，工程师训练第一个模型，发现其在测试数据上表现不佳。一个常见的反模式是用更复杂的模型（例如，通常是梯度提升树）替代第一个模型，并通过此来提高性能。这个反模式的一个变体可能是在此步骤之后通过例如模型平均来结合多个模型。

[![](../Images/1c3bdb1c6477244edad8338aec17a007.png)](https://i.ibb.co/60JgGn1/1-C2-Xo0-Cyun-Fmcf-C6k-BGOmw.png)

**唐纳德·克努斯**（Donald Knuth）著名的“过早优化是万恶之源”这句话已经有将近50年了，依然适用。图片由[tddcomics](https://www.instagram.com/tddcomics/)提供许可。

这些方法的问题在于它们只关注问题的一部分，即模型，并选择通过增加模型的复杂性来解决问题。这一步骤迫使我们接受较高的过拟合风险，并在可解释性与额外的预测能力之间进行权衡。尽管有一些有效的实践可以缓解这种选择的副作用（例如，LIME），但我们无法完全消除它们。

设计模式是错误分析。这实际上意味着查看我们的模型在哪些地方出现了错误，可以通过评估模型在不同测试集上的表现，甚至查看模型出错的个别案例来进行。尽管我们都听过“垃圾进，垃圾出”的说法，但仍然很少有人意识到即使是数据中的小不一致也非常真实。也许标签来自不同的评分者，每个评分者对标签指南有自己稍微不同的解释。也许数据收集的方式随着时间的推移发生了变化。错误分析对小数据问题的影响尤其显著。然而，我们还应记住，在相当一部分的大数据情况下，我们也面临长尾事件（例如，从入学考试中识别稀有人才）。

错误分析的真正力量在于我们无需在应用它时权衡可解释性或过拟合风险，实际上，单独应用它能够提供关于数据分布的关键知识。此外，错误分析还使我们能够选择以模型为中心（例如，更复杂的模型）和以数据为中心（例如，进一步清理步骤）的解决方案。

### 部署模型随时间的性能下降

模型经过广泛验证并部署到生产环境中。用户很满意并给予积极反馈。然而，一个月/季度/年后，报告显示预测存在缺陷。这通常是概念漂移的表现，即你的模型学习的输入与输出之间的连接随着时间发生了变化。有些地方的概念漂移是广为人知的（如词语语义、垃圾邮件检测），但“概念”漂移可以发生在任何领域。例如，口罩和社交距离规定也挑战了许多先前部署的计算机视觉模型。

[![](../Images/410662702e7d045dd21bc5e9cc6101cd.png)](https://i.ibb.co/xzZfH6B/1-L-k-Qqpm-VBd5-Qe-Fuv-En-Tg-Jg.png)

未经过再训练的机器学习系统假设输入和输出之间的学习关系没有变化。图像由[tddcomics](https://www.facebook.com/tddcomics)提供许可。

一个常见的反模式是将这些例子归因于噪声，并期望情况随着时间的推移而稳定。这不仅意味着缺乏行动，还意味着错误的归因，这在数据驱动的业务中应该一般不被鼓励。一个稍微更好的反模式是通过快速重新训练和部署新模型来回应报告。即使团队假设他们遵循敏捷软件开发原则并因此选择快速响应变化，这也是一个反模式。问题在于，这种解决方案解决的是症状而不是系统设计中的缺陷。

设计模式是对性能的持续评估，这意味着你期望漂移的发生，因此设计系统以尽快察觉到它。这是一种完全不同的方法，因为重点不在于反应的速度，而在于 *检测*的速度。这使整个系统处于一个更加可控的轨道上，给任何反应的优先级分配留出了更多空间。持续评估意味着建立流程和工具，持续生成一部分新数据的真实标签。在大多数情况下，这涉及到手动标记，通常使用众包服务。然而，在某些情况下，我们可以使用其他更复杂但在部署环境中不可行的模型和设备来生成真实标签。例如，在自动驾驶汽车的开发中，一个传感器（例如 LiDAR）的输入可以用于生成另一个传感器（例如摄像头）的真实标签。

### 机器学习的 SOLID 设计原则

我写关于设计模式的原因是，这个领域已经达到了成熟的水平，我们不仅应该分享最佳实践，还应该能够将其抽象为真正的设计模式。幸运的是，这项工作已经由多个小组开始。实际上，最近有两本关于这个主题的书籍出版了 [[1](https://www.oreilly.com/library/view/machine-learning-design/9781098115777/)], [[2](https://www.manning.com/books/deep-learning-design-patterns)]。我很喜欢阅读这些书籍，但仍然感到，尽管我们正在朝着正确的方向前进，我们仍然离为机器学习从业者制定 SOLID 设计原则还有几步之遥。我相信，虽然基础知识已经可用并被用于构建今天的 AI 驱动产品，但在设计模式和反模式上的工作是迈向软件 2.0 时代的重要一步。

[![](../Images/075e0ee3fd10aefc8311e6cd6e35ec47.png)](https://i.ibb.co/mFZj5Jk/1-l3d-Ype-C9z-S5tkkls-ZMOaq-Q.png)

设计模式是机器学习工艺的基础。图片来源于 [tddcomics](https://twitter.com/tddcomics)。

**简介: [Ágoston Török](https://www.linkedin.com/in/agoston-torok/)** 是 AGT International 的数据科学总监。

[原文](https://towardsdatascience.com/design-patterns-in-machine-learning-b73eea4882cd)。经授权转载。

**相关：**

+   [何时重新训练机器学习模型？运行这5项检查以决定时间表](/2021/07/retrain-machine-learning-model-5-checks-decide-schedule.html)

+   [2021年排名前六的数据科学在线课程](/2021/07/top-6-data-science-online-courses.html)

+   [你的机器学习代码消耗了多少内存？](/2021/07/memory-machine-learning-code-consuming.html)

* * *

## 我们的前三大课程推荐

![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 1\. [谷歌网络安全证书](https://www.kdnuggets.com/google-cybersecurity) - 快速进入网络安全职业道路。

![](../Images/e225c49c3c91745821c8c0368bf04711.png) 2\. [谷歌数据分析专业证书](https://www.kdnuggets.com/google-data-analytics) - 提升你的数据分析能力

![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 3\. [谷歌IT支持专业证书](https://www.kdnuggets.com/google-itsupport) - 支持你组织的IT需求

* * *

### 更多相关内容

+   [停止学习数据科学以寻求目的，找到目的后…](https://www.kdnuggets.com/2021/12/stop-learning-data-science-find-purpose.html)

+   [数据科学统计学习的顶级资源](https://www.kdnuggets.com/2021/12/springboard-top-resources-learn-data-science-statistics.html)

+   [一个90亿美元的AI失败，解析](https://www.kdnuggets.com/2021/12/9b-ai-failure-examined.html)

+   [成功数据科学家的5个特征](https://www.kdnuggets.com/2021/12/5-characteristics-successful-data-scientist.html)

+   [是什么让Python成为初创公司理想的编程语言](https://www.kdnuggets.com/2021/12/makes-python-ideal-programming-language-startups.html)

+   [每位数据科学家都应该知道的三个R库（即使你使用Python）](https://www.kdnuggets.com/2021/12/three-r-libraries-every-data-scientist-know-even-python.html)
