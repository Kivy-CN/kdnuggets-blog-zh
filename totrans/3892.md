# 在 Python 中有效使用 JSON 的 4 个技巧

> 原文：[https://www.kdnuggets.com/2020/09/4-tricks-effectively-use-json-python.html](https://www.kdnuggets.com/2020/09/4-tricks-effectively-use-json-python.html)

[评论](#comments)

**由 [Erik van Baaren](https://medium.com/@eriky), [Python 3 指南](https://python3.guide/)**

![图示](../Images/126e2354b612ada101cd10cb652dc896.png)

作者插图

Python 有两种数据类型，它们共同构成了处理 JSON 的完美工具：**字典**和**列表**。让我们来探讨如何：

+   加载和写入 JSON

+   在命令行上美化和验证 JSON

+   使用 JMESPath 对 JSON 文档进行高级查询

### 1\. 解码 JSON

Python 附带了一个强大且优雅的 [JSON 库](https://docs.python.org/3.8/library/json.html)。可以用以下方式导入：

```py
import json
```

解码 JSON 字符串就像 `json.loads(…)`（缩写为加载字符串）一样简单。

它转换为：

+   对象转为字典

+   数组转为列表，

+   布尔值、整数、浮点数和字符串将按它们的实际类型被识别，并在 Python 中转换为正确的类型

+   任何 `null` 将被转换为 Python 的 `None` 类型

这是 `json.loads` 的一个示例：

```py
>>> import json
>>> jsonstring = '{"name": "erik", "age": 38, "married": true}'
>>> **json.loads(jsonstring)**
{'name': 'erik', 'age': 38, 'married': True}
```

### 2\. 编码 JSON

另一种方法同样简单。使用 `json.dumps(…)`（缩写为‘转储到字符串’）将一个包含字典、列表和其他原生类型的 Python 对象转换为字符串：

```py
>>> myjson = {'name': 'erik', 'age': 38, 'married': True}
>>> **json.dumps(myjson)**
'{"name": "erik", "age": 38, "married": true}'
```

这是完全相同的文档，转换回字符串！如果你想让你的 JSON 文档对人类更易读，可以使用缩进选项：

```py
>>> print(json.dumps(myjson, indent=2))
{
  "name": "erik",
  "age": 38,
  "married": true
}
```

### 3\. 命令行使用

JSON 库也可以通过命令行使用，用于**验证**和**美化**你的 JSON：

```py
$ echo "{ \"name\": \"Monty\", \"age\": 45 }" | \
python3 -m json.tool
{
    "name": "Monty",
    "age": 45
}
```

附带说明：如果你使用 Mac 或 Linux 并有机会安装它，也可以查看 `jq` 命令行工具。它容易记住，输出有颜色，并且有很多额外的功能，如 [我关于成为命令行高手的文章](https://towardsdatascience.com/this-will-make-you-a-command-line-ninja-93a51cdb16b1) 中所述。

![图示](../Images/bd9c87b19426c42e16f3b2c85aa24f45.png)

jq 默认会美化你的 JSON

### 4\. 使用 JMESPath 在 JSON 中搜索

![图示](../Images/f3ce0370cfbe428e42c7aa78e160af16.png)

[截图](http://jmespath.org/) 作者

JMESPath 是一种用于 JSON 的查询语言。它允许你轻松获取 JSON 文档中的所需数据。如果你以前使用过 JSON，你可能知道获取嵌套值很简单。

例如：`doc["person"]["age"]` 将为你提供一个文档中年龄的嵌套值：

```py
{
  "persons": {
    "name": "erik",
    "age": "38"
  }
}
```

但如果你想从一个包含多个人的数组中提取所有年龄字段，如下所示的文档：

```py
{
  "persons": [
    { "name": "erik", "age": 38 },
    { "name": "john", "age": 45 },
    { "name": "rob", "age": 14 }
  ]
}
```

我们可以写一个简单的循环来遍历所有人员。很简单。但循环很慢，并给你的代码引入复杂性。这就是 JMESPath 的用武之地！

这个 JMESPath 表达式将完成任务：

```py
persons[*].age
```

它将返回一个包含所有年龄的数组：`[38, 45, 14]`。

假设你想过滤列表，只获取名字为 'erik' 的人的年龄。你可以通过过滤器实现：

```py
persons[?name=='erik'].age
```

你看这有多自然和快速？

JMESPath 并不是 Python 标准库的一部分，这意味着你需要通过 `pip` 或 `[pipenv](https://medium.com/better-programming/improve-your-python-package-management-with-pipenv-28093c007955)` 来安装它。例如，当 [使用](https://medium.com/better-programming/stop-installing-python-packages-globally-use-virtual-environments-a31dee9fb2de)`[pip](https://medium.com/better-programming/stop-installing-python-packages-globally-use-virtual-environments-a31dee9fb2de)`[ 在虚拟环境中](https://medium.com/better-programming/stop-installing-python-packages-globally-use-virtual-environments-a31dee9fb2de)：

```py
$ pip3 install jmespath
$ python3
Python 3.8.2 (default, Jul 16 2020, 14:00:26)
>>> import jmespath
>>> j = { "people": [{ "name": "erik", "age": 38 }] }
>>> jmespath.search(**"people[*].age"**, j)
[38]
>>>
```

你现在可以开始尝试了！一定要试试 [互动教程](https://jmespath.org/tutorial.html) 并查看 JMESPath 网站上的 [示例](https://jmespath.org/examples.html)！

如果你有更多的 JSON 提示或技巧，请在评论中分享！

**关注我** 在 [Twitter](https://twitter.com/erikyan) 上以获取我的最新文章，并确保 **访问我的** [**Python 3 指南**](https://python3.guide/)。这篇文章最初也发布在 [那里](https://python3.guide/data-processing/working-with-json)。

[**你需要理解的最重要的 Python 概念**](https://towardsdatascience.com/the-most-important-python-concept-that-you-need-to-understand-985b98bbb84)

了解 Python 语言的所有基础构件

**个人简介：[Erik van Baaren](https://medium.com/@eriky)** 是一名软件工程师及 [Python 3 指南](https://python3.guide/) 的站长，你可以在这里学习初学者和高级的 Python 话题。他也是 [Medium.com](https://medium.com/@eriky) 上技术文章的作者。

[原文](https://towardsdatascience.com/4-tricks-to-effectively-use-json-in-python-4ca18c3f91d0)。经许可转载。

**相关：**

+   [你应该知道的 3 个高级 Python 特性](/2020/07/3-advanced-python-features.html)

+   [为什么学习 Python？这里有 8 个数据驱动的理由](/2020/07/learn-python-8-data-driven-reasons.html)

+   [你不知道的 10 件关于 Scikit-Learn 的事](/2020/09/10-things-know-scikit-learn.html)

* * *

## 我们的前三个课程推荐

![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 1\. [谷歌网络安全证书](https://www.kdnuggets.com/google-cybersecurity) - 快速通道进入网络安全职业。

![](../Images/e225c49c3c91745821c8c0368bf04711.png) 2\. [谷歌数据分析专业证书](https://www.kdnuggets.com/google-data-analytics) - 提升你的数据分析技能

![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 3\. [谷歌 IT 支持专业证书](https://www.kdnuggets.com/google-itsupport) - 支持你的组织的 IT

* * *

### 更多相关话题

+   [如何有效使用 Pandas GroupBy](https://www.kdnuggets.com/2023/01/effectively-pandas-groupby.html)

+   [数据分析：分析数据的四种方法及其应用…](https://www.kdnuggets.com/2023/04/data-analytics-four-approaches-analyzing-data-effectively.html)

+   [如何有效管理镜像版本的 Docker 标签使用方法](https://www.kdnuggets.com/how-to-use-docker-tags-to-manage-image-versions-effectively)

+   [免费下载电子书：10 个实用的 Python 编程技巧](https://www.kdnuggets.com/2023/04/free-ebook-10-practical-python-programming-tricks.html)

+   [12 个针对 Python 开发的 VSCode 提示和技巧](https://www.kdnuggets.com/2023/05/12-vscode-tips-tricks-python-development.html)

+   [Python f-Strings 魔法：每个程序员都需要知道的 5 个颠覆性技巧](https://www.kdnuggets.com/python-fstrings-magic-5-gamechanging-tricks-every-coder-needs-to-know)
