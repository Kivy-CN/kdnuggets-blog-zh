# 你能在泰坦尼克号上生存吗？Python机器学习指南第二部分

> 原文：[https://www.kdnuggets.com/2016/07/titanic-machine-learning-guide-part-2.html](https://www.kdnuggets.com/2016/07/titanic-machine-learning-guide-part-2.html)

**Patrick Triest, SocialCops**.

> **编辑注**：这是关于Python机器学习的三部分入门系列的第二部分。如果需要，请先查看[昨天的文章](/2016/07/titanic-machine-learning-guide-part-1.html)。

**为什么选择机器学习？**

我们可以从这些数据中得出一些相当简单的结论：成为女性、身处头等舱以及是儿童都是提升你在这场灾难中生存机会的因素。

假设我们想编写一个程序来预测给定乘客是否会在灾难中幸存。这可以通过一个复杂的嵌套if-else语句系统以及某种加权评分系统来完成，但这样的程序将很长，编写起来乏味，难以概括，并且需要大量的调整。

这就是机器学习的用武之地：我们将构建一个从样本数据中学习的程序，以预测给定乘客是否会幸存。

**数据准备**

在将数据集输入机器学习算法之前，我们必须删除缺失值，并将其拆分为训练集和测试集。

如果我们对每一列进行计数，会发现某些字段的数据缺失较多。大多数机器学习算法在处理缺失值时会遇到困难，因此我们需要确保每一行都有每一列的值。

```py
titanic_df.count()

```

```py
pclass       1309
survived     1309
name         1309
sex          1309
age          1046
sibsp        1309
parch        1309
ticket       1309
fare         1308
cabin         295
embarked     1307
boat          486
body          121
home.dest     745
dtype: int64
```

```py
titanic_df = titanic_df.drop(['body','cabin','boat'], axis=1)
titanic_df["home.dest"] = titanic_df["home.dest"].fillna("NA")
titanic_df = titanic_df.dropna()
titanic_df.count()

```

```py
pclass       1043
survived     1043
name         1043
sex          1043
age          1043
sibsp        1043
parch        1043
ticket       1043
fare         1043
embarked     1043
home.dest    1043
dtype: int64

```

*[点击这里查看概要。](https://gist.github.com/triestpa/257c261111b03fede4e2580017a21727)*

大多数行在“boat”和“cabin”字段上缺少值，因此我们将从数据框中删除这些列。大量行也缺少“home.dest”字段；在这里，我们用“NA”填充缺失值。还有相当多的行缺少年龄值。我们已经看到，年龄可能对生存几率有显著影响，因此我们将删除所有缺少年龄值的行。当我们再次运行计数命令时，可以看到所有剩余的列现在包含相同数量的值。

现在我们需要将剩余的数据格式化为机器学习算法可以接受的形式。

```py
def preprocess_titanic_df(df):
    processed_df = df.copy()
    le = preprocessing.LabelEncoder()
    processed_df.sex = le.fit_transform(processed_df.sex)
    processed_df.embarked = le.fit_transform(processed_df.embarked)
    processed_df = processed_df.drop(['name','ticket','home.dest'],axis=1)
    return processed_df

processed_df = preprocess_titanic_df(titanic_df)

```

*[点击这里查看概要。](https://gist.github.com/triestpa/e10aff22cb9c2945142735dc0d315723)*

“sex”和“embarked”字段都是对应于类别的字符串值（即“Male”和“Female”），所以我们将对它们进行预处理。这个预处理器将这些字符串转换为整数键，使分类算法更容易找到模式。例如，“Male”和“Female”将分别转换为0和1。“name”、“ticket”和“home.dest”列包含非类别字符串值，因此在分类算法中使用起来困难，所以我们将从数据集中删除它们。

```py
X = processed_df.drop(['survived'], axis=1).values
y = processed_df['survived'].values

X_train, X_test, y_train, y_test = cross_validation.train_test_split(X,y,test_size=0.2)

```

*[点击这里查看要点。](https://gist.github.com/triestpa/0bce50e357c6c5f19811b975c5f9b604)*

接下来我们将数据集分为两个数组，“X”包含每一行中除了“survived”之外的所有值，“y”仅包含该行的“survived”值。分类算法将比较“X”的属性值与“y”对应的值，以检测不同属性值如何影响乘客生存的模式。

最后我们将“X”和“y”数组各自分成两部分——训练集和测试集。我们将训练集输入分类算法，以形成一个训练好的模型。模型形成后，我们将使用它对测试集进行分类，从而确定模型的准确性。这里我们进行了20/80的分割，即80%的数据集用于训练，20%用于测试。

* * *

## 我们的三大课程推荐

![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 1\. [谷歌网络安全证书](https://www.kdnuggets.com/google-cybersecurity) - 快速通道进入网络安全职业。

![](../Images/e225c49c3c91745821c8c0368bf04711.png) 2\. [谷歌数据分析专业证书](https://www.kdnuggets.com/google-data-analytics) - 提升你的数据分析技能

![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 3\. [谷歌IT支持专业证书](https://www.kdnuggets.com/google-itsupport) - 支持你的组织的IT

* * *

### 更多相关内容

+   [数据科学家需要专注以度过技术寒冬](https://www.kdnuggets.com/2023/08/data-scientists-need-specialize-survive-tech-winter.html)

+   [如果我必须重新开始学习数据科学，我会怎么做？](https://www.kdnuggets.com/2020/08/start-learning-data-science-again.html)

+   [何时使用集成技术是一个好的选择？](https://www.kdnuggets.com/2022/07/would-ensemble-techniques-good-choice.html)

+   [数据科学面试指南 - 第2部分：面试资源](https://www.kdnuggets.com/2022/04/data-science-interview-guide-part-2-interview-resources.html)

+   [数据科学面试指南 - 第1部分：结构](https://www.kdnuggets.com/2022/04/data-science-interview-guide-part-1-structure.html)

+   [想成为数据科学家？第1部分：你需要的10项硬技能](https://www.kdnuggets.com/want-to-become-a-data-scientist-part-1-10-hard-skills-you-need)
