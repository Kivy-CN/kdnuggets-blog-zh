# 如何使用Python的datetime

> 原文：[https://www.kdnuggets.com/2019/06/how-use-datetime.html](https://www.kdnuggets.com/2019/06/how-use-datetime.html)

[评论](#comments)

有关视频讲解、幻灯片以及其他数据处理教程，请访问[数据处理技巧与窍门](https://end-to-end-machine-learning.teachable.com/p/data-munging-tips-and-tricks/)课程页面。该课程免费。

### 在Python中处理日期和时间

* * *

## 我们的前三名课程推荐

![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 1. [Google网络安全证书](https://www.kdnuggets.com/google-cybersecurity) - 快速进入网络安全职业

![](../Images/e225c49c3c91745821c8c0368bf04711.png) 2. [Google数据分析专业证书](https://www.kdnuggets.com/google-data-analytics) - 提升你的数据分析能力

![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 3. [Google IT支持专业证书](https://www.kdnuggets.com/google-itsupport) - 支持你的组织的IT

* * *

[Python的datetime包](https://docs.python.org/3/library/datetime.html) 是一个处理日期和时间的方便工具集。通过我即将展示的五个技巧，你可以处理大部分日期时间处理需求。

在深入之前，了解一下日期时间是如何组合的很有帮助。基本的构建块是日期时间对象。不出所料，它是日期对象和时间对象的组合。日期对象只是年份、月份、日期的一组值，以及一系列处理这些值的函数。时间对象以类似的方式构建。它有小时、分钟、秒、微秒和时区的值。通过适当地选择这些值，可以表示任何时间。

![](../Images/5350fa6b7fc2d13b7fbf4e4129e7bf56.png)

### 1. **combine()**

```py
import datetime

# (hours, minutes)
start_time = datetime.time(7, 0)
# (year, month, day)
start_date = datetime.date(2015, 5, 1)
# Create a datetime object
start_datetime = datetime.datetime.combine(
    start_date, start_time)
```

处理日期时间的第一个技巧是通过组合日期和时间对象来创建它们。我们首先创建一个时间对象，传入小时7和分钟0。这表示7点钟。由于没有提供秒和微秒，这些值默认为零。然后我们通过传入年份、月份和日期来创建一个日期对象。

创建一个日期时间对象很简单。我们使用**combine()**函数，将日期对象和时间对象传递给它，以构建我们的日期时间对象。

由于命名约定的原因，调用日期时间可能会令人困惑。Datetime是包名、包内模块名和对象名。因此，当我们组合日期和时间时，我们会用看似冗余的**datetime.datetime**前缀来调用它。第一个**datetime**引用了包，第二个**datetime**引用了模块，而**combine()**是该模块中的一个函数。

### 2. timedelta

```py
# Differences between datetimes are timedelta objects. 
timedelta_total = end_datetime - start_datetime
# timedeltas have days, seconds, and microseconds
# They can be used to increment dates and times,
# accounting for quirks of dates and timezones.
end_datetime = start_datetime + timedelta_total
```

使用日期时间的第二个技巧是一个叫做`timedelta`的类型。它表示两个日期时间之间的差异。一个`timedelta`只有三个值：天、秒和微秒。任何两个日期时间之间的差异都可以以这种方式唯一表示。

`timedelta`非常有用，因为它允许我们对日期时间进行简单的加减运算。它们免去了考虑一个月有多少天、一天有多少秒以及闰年的麻烦。

### 3\. 时间戳

```py
# Number of seconds from 12:00 am, January 1, 1970, UTC
# is a computer-friendly way to handle time.
unix_epoch = timestamp(start_datetime)
start_datetime = fromtimestamp(1457453760)
```

获取日期时间最大效用的第三个技巧是使用时间戳。用天、小时、分钟和秒来工作对于计算机来说很尴尬。有规则和边界情况需要检查。为了简化日期和时间的处理，创建了[UNIX纪元](https://en.wikipedia.org/wiki/Unix_time)的概念。这是自1970年1月1日午夜12:00以来经过的秒数，使用的是[协调世界时](https://en.wikipedia.org/wiki/Coordinated_Universal_Time)（UTC +0时区）。这使得任何日期和时间都可以由一个单一、常见解释的浮点数表示。唯一的缺点是对于人类读者来说不直观。函数**timestamp()**和**fromtimestamp()**允许我们将人类可解释的日期时间对象转换为UNIX纪元，反之亦然，以便进行计算。

### 4\. 星期几

```py
# Gets the day of the week for a given date.
# Monday is 0, Sunday is 6
weekday_number = start_datetime.date().weekday()
```

我们包中的第四个技巧是**weekday()**函数。对于任何给定的日期，它会计算出该日期是星期几。使用时，调用**date()**函数来获取你的日期时间对象。这会隔离日期对象，忽略时间部分。然后调用它的**weekday()**函数。它返回一个从0到6的数字，其中0代表星期一，1代表星期二，依此类推，6代表星期天。它处理了所有跟踪星期几的细节，你无需再考虑这些。

### 5\. 日期字符串

```py
# Pass a date string and a code for interpreting it.
new_datetime = datetime.datetime.strptime(
    '2018-06-21', '%Y-%m-%d')
# Turn a datetime into a date string.
datestr = new_datetime.strftime('%Y-%m-%d')
print(datestr)

>> "2018-06-21"
```

最后，我们来到了第五个技巧，即将日期转换为字符串或从字符串转换。这在我们从文本文件中读取数据时特别有用，想要将文本日期转换为日期时间对象时非常实用。它还在我们希望将日期时间对象展示给用户，或导出到文本文件时也很有帮助。

为了实现这一点，我们使用**strptime()**和**strftime()**函数。在进行任何方向的转换时，我们需要提供一个指定格式的字符串。在这个代码片段中，'%Y'表示年份，'%m'表示两位数的月份，'%d'表示两位数的日期。

作为旁注，实际上有一种正确的表示日期的方式：'YYYY-MM-DD'。（国际标准，[ISO 8601](https://en.wikipedia.org/wiki/ISO_8601) 于1988年确立了这一标准。）例如，2018年7月31日应表示为'2018-07-31'。我强烈建议在选择日期格式时使用这种方式，以便于解释和兼容。然而，请注意，实际中存在大量日期格式。做好准备，可能需要进行一些复杂的转换，以便将所有数据转换成这种格式。

现在你掌握了五个最有用的日期时间技巧。

1.  **combine()**

1.  timedelta，

1.  转换时间戳的输入和输出，

1.  **weekday()** 和

1.  字符串格式化。

拥有这些工具，你在下一个 Python 项目中解决所有日期和时间挑战的成功几率已经达到90%。祝好运，愿它为你服务。

[原始内容](https://brohrer.github.io/datetime_tricks.html)。已获许可转载。

**相关：**

+   [Pandas DataFrame 索引](/2019/04/pandas-dataframe-indexing.html)

+   [数据科学家使用的 PyCharm](/2019/05/pycharm-data-scientists.html)

+   [如何（不）使用机器学习进行时间序列预测：避免陷阱](/2019/05/machine-learning-time-series-forecasting.html)

### 更多相关话题

+   [每个数据科学家都应该了解的三个 R 库（即使你使用 Python）](https://www.kdnuggets.com/2021/12/three-r-libraries-every-data-scientist-know-even-python.html)

+   [如何使用 Python 和机器学习预测足球比赛结果](https://www.kdnuggets.com/2023/01/python-machine-learning-predict-football-match-winners.html)

+   [学习如何使用 ChatGPT 学习 Python（或其他任何东西）](https://www.kdnuggets.com/2023/02/learn-python-chatgpt.html)

+   [如何（不）使用 Python 的海象操作符](https://www.kdnuggets.com/how-not-to-use-pythons-walrus-operator)

+   [停止在数据科学项目中硬编码 - 改用配置文件](https://www.kdnuggets.com/2023/06/stop-hard-coding-data-science-project-config-files-instead.html)

+   [这里是我使用的 AI 工具和技能，帮助我赚取 $10,000…](https://www.kdnuggets.com/2023/07/ai-tools-along-skills-make-10000-monthly-bs.html)
