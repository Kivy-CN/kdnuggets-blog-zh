# 用5行代码改变任何视频的背景

> 原文：[https://www.kdnuggets.com/2020/12/change-background-video-5-lines-code.html](https://www.kdnuggets.com/2020/12/change-background-video-5-lines-code.html)

[评论](#comments)

**作者：[Ayoola Olafenwa](https://www.linkedin.com/in/ayoola-olafenwa-003b901a9/)，独立AI研究员**

![图示](../Images/c90ef44af509ee9620dd55a0fd935595.png)

作者照片

* * *

## 我们的三大推荐课程

![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 1\. [谷歌网络安全证书](https://www.kdnuggets.com/google-cybersecurity) - 加速你的网络安全职业生涯

![](../Images/e225c49c3c91745821c8c0368bf04711.png) 2\. [谷歌数据分析专业证书](https://www.kdnuggets.com/google-data-analytics) - 提升你的数据分析能力

![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 3\. [谷歌IT支持专业证书](https://www.kdnuggets.com/google-itsupport) - 支持你所在的组织的IT工作

* * *

PixelLib是一个库，旨在实现对象分割在现实应用中的简便实现。PixelLib支持图像调整，即更改任何图像背景的能力。PixelLib现在支持视频调整，即更改视频和摄像头画面的背景。PixelLib采用对象分割技术，进行出色的前景和背景分离。PixelLib使用在pascalvoc数据集上训练的deeplabv3+模型，数据集支持20种对象类别。

[PRE0]

*支持的背景效果如下：*

**1** 用图片更改图像背景

**2** 为图片和视频的背景分配一个独特的颜色。

**3** 模糊图片和视频的背景。

**4** 将图片和视频的背景转换为灰度。

**5** 为视频创建虚拟背景。

安装PixelLib及其依赖项：

安装Tensorflow：(PixelLib支持tensorflow 2.0及以上版本)

+   *pip3 install tensorflow*

安装PixelLib：

+   pip3 install pixellib

如果已安装，使用以下命令升级到最新版本：

+   pip3 install pixellib — upgrade

### 目标对象的检测

在一些应用中，你可能希望在图片或视频中检测特定对象。deeplab模型默认会检测它支持的所有对象。现在可以筛选掉未使用的检测，专注于检测图片或视频中的特定对象。

*示例图片*

![图示](../Images/3844ccd3c79e2702e0710a8e6bb650ef.png)

来源：[Unsplash.com](https://unsplash.com/photos/D5mCL7Q_6Us) 作者 Strvnge Films

我们打算模糊上述图片的背景。

模糊图像背景的代码。

输出图像

![帖子图片](../Images/dd2a391896609ec6e19d2b2ecc8882b8.png)

我们的目标是完全模糊图片中人物的背景，但我们对其他对象的存在不满意。因此，需要修改代码以检测目标对象。

代码基本相同，只是我们在*blur_bg*函数中引入了一个额外的参数***detect***。

[PRE1]

**检测:** 这是决定要检测的目标对象的参数。检测的值被设置为***person***。这意味着模型将只检测图片中的人物。

![用于帖子图片](../Images/af4678c17099777cc6af3f59ac414219.png)

这是只显示目标对象的新图片。

如果我们只打算显示图片中的汽车，我们只需将**detect**的值从***person***改为***car***。

[PRE2]

![用于帖子图片](../Images/c831882ee424554647b31976a41d2941.png)

我们将目标对象设置为***car***，图片中其他所有对象都与背景一起被模糊处理。

***目标对象的彩色背景***

目标检测可以通过颜色效果来完成。

[PRE3]

![用于帖子图片](../Images/b849e912cc6dfe47cfae912cb1d5cbd9.png)

***使用新图片更改目标对象的背景***

***背景图片***

![图示](../Images/ccef7e7882379916a9c419cb6457e54e.png)

来源: [Unsplash.com by Dawid Zawila](https://unsplash.com/photos/9P2-bzjvIHk)

[PRE4]

![用于帖子图片](../Images/1602d3c22c22d9579a983ef93eeb1d1f.png)

***将目标对象的背景转换为灰度***

[PRE5]

![用于帖子图片](../Images/c08f9107b96b6938bb4eb9e9dfca052b.png)

阅读本文以全面了解使用PixelLib进行图片背景编辑。

[**用5行代码更改任何图片的背景**](https://towardsdatascience.com/change-the-background-of-any-image-with-5-lines-of-code-23a0ef10ce9a)

### ***使用PixelLib进行视频调整***

视频调整是改变任何视频背景的能力。

**模糊视频背景**

PixelLib使得只需五行代码即可方便地模糊任何视频的背景。

**示例视频**

*模糊视频文件的背景代码*

[PRE6]

我们导入了pixellib，并从pixellib中导入了*alter_bg*类。创建了该类的实例，并在类中添加了一个参数*model_type*并将其设置为***pb***。最后，我们调用了加载模型的函数。

**注意:** PixelLib支持两种类型的deeplabv3+模型，keras和tensorflow模型。keras模型是从tensorflow模型的检查点提取的。tensorflow模型的性能优于从检查点提取的keras模型。我们将使用tensorflow模型。可以从[这里](https://github.com/ayoolaolafenwa/PixelLib/releases/download/1.1/xception_pascalvoc.pb)下载tensorflow模型。

有三个参数决定背景模糊的程度。

*低:* 当设置为 true 时，背景会被稍微模糊。

*中等:* 当设置为 true 时，背景会被适度模糊。

*extreme:* 当它被设置为true时，背景会被深度模糊。

[PRE7]

这是模糊视频背景的代码行。该函数接受五个参数：

**video_path:** 这是我们要模糊背景的视频文件的路径。

**extreme:** 它被设置为true，视频的背景会被极度模糊。

**frames_per_second:** 这是设置输出视频文件每秒帧数的参数。在这种情况下，它被设置为10，即保存的视频文件将具有每秒10帧。

**output_video_name:**这是保存的视频。输出视频将保存在您的当前工作目录中。

**detect: **这是选择视频中目标对象的参数。它被设置为***person***。

**output video**

**Blur the Background of Camera’s Feeds**

[PRE8]

我们导入了cv2，并包含了捕获摄像头帧的代码。

[PRE9]

在模糊摄像头帧的代码中，我们将视频文件路径替换为捕获，即我们将处理一系列摄像头帧而不是视频文件。我们添加了额外的参数以显示摄像头帧：

**show_frames:** 这是处理显示模糊的摄像头帧的参数。

**frame_name:** 这是给显示的摄像头帧命名的名称。

**Output Video**

哇！PixelLib成功地在视频中模糊了我的背景。

### **Create a Virtual Background for a Video**

PixelLib使得为任何视频创建虚拟背景变得非常简单，您可以利用任何图像为视频创建虚拟背景。

**sample video**

**Image to serve as background for a video**

![Figure](../Images/c5bdc32590fbb45357cd1a3591bdaa5f.png)

来源: [Unsplash.com](https://unsplash.com/photos/rCbdp8VCYhQ) [by Handy Holmes](https://unsplash.com/photos/rCbdp8VCYhQ)

[PRE10]

这仍然是相同的代码，只是我们调用了函数*change_video_bg*来为视频创建虚拟背景。该函数接受我们要用作视频背景的图像路径。

**Output Video**

> 漂亮的演示！我们成功地为视频创建了一个虚拟的空间背景。

**Create a Virtual Background for Camera’s Feeds**

[PRE11]

这与我们用来模糊摄像头帧的代码类似。唯一的区别是我们调用了函数*change_camera_bg*。我们执行了相同的操作，替换了视频文件路径为捕获，并添加了相同的参数。

**Output Video**

> 哇！PixelLib成功为我的视频创建了虚拟背景。

**Color Video background**

PixelLib使得可以将任何颜色分配给视频的背景。

*给视频文件的背景着色的代码*

[PRE12]

这仍然是相同的代码，只是我们调用了函数*color_video*来为视频背景上色。函数*color_bg*接受参数*colors，*颜色的RGB值被设置为绿色。绿色的RGB值是(0, 128, 0)。

output video

[PRE13]

同样的视频，背景为白色

**Color the Background of Camera’s Feeds**

[PRE14]

它类似于我们用来为相机的画面创建虚拟背景的代码。唯一的区别是我们调用了函数*color_camera*。我们执行了相同的例程，将视频的文件路径替换为捕获，并添加了相同的参数。

**输出视频**

> 美丽的演示！我的背景成功地用PixelLib变成了绿色。

**灰度视频背景**

*将视频文件背景转为灰度的代码*

[PRE15]

输出视频

**注意：**视频的背景会被更改，视频中的物体会保持原始质量。

**将相机的画面背景转为灰度**

它类似于我们用来为相机画面上色的代码。唯一的区别是我们调用了函数*gray_camera*。我们执行了相同的例程，将视频文件路径替换为捕获，并添加了相同的参数。

> [访问PixelLib的官方GitHub仓库](https://github.com/ayoolaolafenwa/PixelLib)
> 
> [访问PixelLib的官方文档](https://pixellib.readthedocs.io/en/latest/)

通过以下方式联系我：

Email: [olafenwaayoola@gmail.com](https://mail.google.com/mail/u/0/#inbox)

Linkedin: [Ayoola Olafenwa](https://www.linkedin.com/in/ayoola-olafenwa-003b901a9/)

Twitter: [@AyoolaOlafenwa](https://twitter.com/AyoolaOlafenwa)

Facebook: [Ayoola Olafenwa](https://web.facebook.com/ayofen)

查看这些关于如何利用PixelLib进行图像和视频中的物体的语义和实例分割的文章。

[**用5行代码进行图像分割**](https://towardsdatascience.com/image-segmentation-with-six-lines-0f-code-acb870a462e8)

使用PixelLib进行语义和实例分割。

[**用5行代码进行视频分割**](https://towardsdatascience.com/video-segmentation-with-5-lines-of-code-87f798afb93)

视频的语义分割和实例分割。

[**用5行代码进行150类物体的语义分割**](https://towardsdatascience.com/semantic-segmentation-of-150-classes-of-objects-with-5-lines-of-code-7f244fa96b6c)

使用PixelLib对150类物体进行语义分割。

[**用7行代码进行自定义实例分割训练。**](https://towardsdatascience.com/custom-instance-segmentation-training-with-7-lines-of-code-ff340851e99b)

使用7行代码训练你的数据集以实现实例分割和物体检测。

**个人简介: [Ayoola Olafenwa](https://www.linkedin.com/in/ayoola-olafenwa-003b901a9/)** 是一位独立的人工智能研究员，专注于计算机视觉领域。

[原文](https://towardsdatascience.com/change-the-background-of-any-video-with-5-lines-of-code-7cc847394f5d)。经授权转载。

**相关：**

+   [用5行代码更改任何图像的背景](/2020/11/change-background-image-5-lines-code.html)

+   [计算机视觉路线图](/2020/10/roadmap-computer-vision.html)

+   [使用深度学习自动旋转图像](/2020/07/auto-rotate-images-deep-learning.html)

### 更多相关主题

+   [NExT-GPT 介绍：任何对任何的多模态大型语言模型](https://www.kdnuggets.com/introduction-to-nextgpt-anytoany-multimodal-large-language-model)

+   [用不到 15 行代码实现多模态深度学习](https://www.kdnuggets.com/2023/01/predibase-multi-modal-deep-learning-less-15-lines-code.html)

+   [如何从不同背景转行进入数据科学？](https://www.kdnuggets.com/2023/05/transition-data-science-different-background.html)

+   [SHAP：用 Python 解释任何机器学习模型](https://www.kdnuggets.com/2022/11/shap-explain-machine-learning-model-python.html)

+   [如何在没有工作经验的情况下获得数据科学领域的第一份工作](https://www.kdnuggets.com/2021/02/first-job-data-science-without-work-experience.html)

+   [在参加任何免费的数据科学课程之前请阅读此文](https://www.kdnuggets.com/read-this-before-you-take-any-free-data-science-course)
