# PyTorch Lightning 入门

> 原文：[https://www.kdnuggets.com/2022/12/getting-started-pytorch-lightning.html](https://www.kdnuggets.com/2022/12/getting-started-pytorch-lightning.html)

![PyTorch Lightning 入门](../Images/6394c873a8f46f44e1753428841f39c5.png)

编辑图像

# 什么是 PyTorch Lightning？

PyTorch Lightning 是一个强大的深度学习框架，支持可扩展的最先进的 AI 研究工作。它使您的代码保持结构化，避免了项目复杂性的不断增长。

但在我们继续了解代码复杂性包含的内容之前，让我们首先详细探索 PyTorch Lightning 中的结构化代码（在整篇文章中称为 Lightning）如何帮助我们加快模型构建过程。当您准备开始编写机器学习模型代码时，您通常会设计模型架构，并选择适合给定数据集的优化器。考虑到所有这些方面，您现在可以动手编写 Python 代码，其中包括迭代数据批次进行训练和验证的步骤。不要忘记任何机器学习项目中不可避免的周期性调试措施。

此外，代码复杂性涉及多个因素，如多 GPU 的利用、早期停止标准、检查点需求、16 位精度、TPU 加速器训练等。Lightning 允许在不更改 PyTorch 代码的情况下，在 CPU、GPU 或 TPU 上训练模型，并协助构建可重复的模型。

引用 [Lightning 创始人](https://towardsdatascience.com/from-pytorch-to-pytorch-lightning-a-gentle-introduction-b371b7caaf09) 的直接好处——“PyTorch Lightning 是为从事 AI 研究的专业研究人员和博士生创建的。它被设计为极其可扩展，同时使最先进的 AI 研究技术（如 TPU 训练）变得简单”

# 它与 PyTorch 有什么不同？

了解 PyTorch 的特性对于欣赏 Lightning 所提供的功能和优势至关重要。

PyTorch 是一个基于 Python 的开源库，广泛用于构建神经网络模型。与其最常见的替代品 TensorFlow 相比，它拥有庞大的社区基础，主要用于研究环境。如果您有兴趣了解 PyTorch 的基础知识，那么这份文档作为一个优秀的 [参考资料](https://pytorch-lightning.readthedocs.io/en/stable/notebooks/course_UvA-DL/01-introduction-to-pytorch.html) 是非常合适的。

尽管 PyTorch 是为研究人员设计的，但它很快就变成了与模型训练和调优相关的工程和代码驱动的工作。

Lightning 在 PyTorch 提供的灵活性基础上进行构建，用于模型训练，并促进多个前沿实验的快速迭代。它通过进一步结构化代码来提高代码的可读性，从而增强了可重复性。

大体上，代码保持相似，除了以下几点：

+   训练和验证循环已由 Trainer 抽象化。

+   此外，某些代码块，例如数据加载器、前向传递、优化器等，已被重构，以减少对开发者的详细要求。

例如，与 Pytorch 期望开发者插入检查点逻辑不同，Lightning 默认会自动保存模型检查点。Lightning 还提供了权重摘要、检查点、早停和 TensorBoard 日志的记录。

# 如何安装 PyTorch Lightning

你可以在终端（适用于 MAC/Linux）或命令行（适用于 Windows）中运行以下命令：

[PRE0]

# 欢迎来到 Lightning 的“Hello-World”

让我们构建一个图像分类模型来识别数字，使用 [MNIST 数据集](https://www.kaggle.com/competitions/digit-recognizer)。你可以在 [Pytorch 官方文档页面](https://pytorch.org/vision/stable/datasets.html) 学习如何通过 torchvision 模块导入多个数据集。

![PyTorch Lightning 入门](../Images/b380df6642df1155f35bf34938516f55.png)

来源：[机器学习大师](https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/)

构建任何神经网络模型的四个核心组件包括模型、数据、损失和优化器。

让我们从神经网络架构开始。

+   对于本演示，我们将构建一个 4 层（如果不显式计算输入层则为 3 层）全连接深度神经网络架构，包括输入层和输出层。

+   然而，方形图像（尺寸为 28 * 28）需要被矢量化或展平，以便神经网络可以作为输入处理。因此，输入层中的神经元数量等于图像的宽度 * 高度，即 784（28*28）。展平过程将每一行的值放置到一个向量中，如下所示。

![PyTorch Lightning 入门](../Images/d9bc151e1f993daaf4d882c935374ed7.png)

来源：[使用 Keras 的卷积神经网络（CNNs）实用指南](https://towardsdatascience.com/a-practical-guide-on-convolutional-neural-networks-cnns-with-keras-21421172005e)

+   另一方面，输出层中的神经元数量等于标签的数量，即 10（从 0 到 9 的数字）。

+   你可以选择隐藏层中的神经元数量。一般来说，较少的神经元可能会丢失输入层的信息，而更多的神经元则可能导致信息的重复。我们选择在第一个隐藏层中使用 128 个神经元，在第二个隐藏层中使用 256 个神经元。

+   神经网络架构如下图所示。

![PyTorch Lightning 入门](../Images/8e13e2ef9389df8e4cccf8038a8b4c82.png)

来源：[PyTorch Lightning 介绍](https://colab.research.google.com/drive/1Mowb4NzWlRCxzAFjOIJqUmmk_wAT-XP3#scrollTo=ohJoivXxaIgP)

+   你还需要指定一个前向传播函数，我们选择一个ReLu激活函数用于隐藏层，一个Softmax激活函数用于输出层。

+   网络中的训练或验证运行包括前向传播以计算输出概率，然后进行损失计算，以使用Adam优化器调整网络参数。

如上所述的神经网络架构、损失和优化器选择在下面的代码中展示（来源并修改自“[从PyTorch到PyTorch Lightning - 简介](https://colab.research.google.com/drive/1Mowb4NzWlRCxzAFjOIJqUmmk_wAT-XP3#scrollTo=x83-rnVKT8Wo)”）：

[PRE1]

你可以通过下面的代码下载训练数据和测试数据。

[PRE2]

请注意，当加载训练数据时，train参数设置为True，而对于测试数据，则设置为False。

训练数据还可以进一步拆分为训练集和验证集。

[PRE3]

# 附加内容

这篇文章解释了Lightning的好处，并演示了如何在python代码的帮助下构建你的第一个模型。此外，如果你更喜欢通过视频课程学习，你可以参考附加资源列表中的[简短视频教程](https://www.pytorchlightning.ai/tutorials)。

# 参考资料

+   [https://towardsdatascience.com/from-pytorch-to-pytorch-lightning-a-gentle-introduction-b371b7caaf09](https://towardsdatascience.com/from-pytorch-to-pytorch-lightning-a-gentle-introduction-b371b7caaf09)

+   [https://learnopencv.com/getting-started-with-pytorch-lightning/](https://learnopencv.com/getting-started-with-pytorch-lightning/)

+   [https://colab.research.google.com/drive/1F_RNcHzTfFuQf-LeKvSlud6x7jXYkG31#scrollTo=HOk9c4_35FKg](https://colab.research.google.com/drive/1F_RNcHzTfFuQf-LeKvSlud6x7jXYkG31#scrollTo=HOk9c4_35FKg)

**[Vidhi Chugh](https://vidhi-chugh.medium.com/)** 是一位AI策略师和数字化转型领导者，致力于在产品、科学和工程的交汇处构建可扩展的机器学习系统。她是一位获奖的创新领导者、作者和国际演讲者。她的使命是让机器学习民主化，并打破术语，让每个人都能参与到这场转型中。

* * *

## 我们的前三大课程推荐

![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 1\. [谷歌网络安全证书](https://www.kdnuggets.com/google-cybersecurity) - 快速进入网络安全职业的捷径。

![](../Images/e225c49c3c91745821c8c0368bf04711.png) 2\. [谷歌数据分析专业证书](https://www.kdnuggets.com/google-data-analytics) - 提升你的数据分析技能。

![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 3\. [谷歌IT支持专业证书](https://www.kdnuggets.com/google-itsupport) - 支持你的组织在IT领域。

* * *

### 更多相关话题

+   [深度学习库简介：PyTorch和Lightning AI](https://www.kdnuggets.com/introduction-to-deep-learning-libraries-pytorch-and-lightning-ai)

+   [5 个步骤入门 PyTorch](https://www.kdnuggets.com/5-steps-getting-started-pytorch)

+   [免费使用 Lightning AI Studio](https://www.kdnuggets.com/using-lightning-ai-studio-for-free)

+   [SQL 入门备忘单](https://www.kdnuggets.com/2022/08/getting-started-sql-cheatsheet.html)

+   [PyCaret 入门指南](https://www.kdnuggets.com/2022/11/getting-started-pycaret.html)

+   [机器学习中使用 Scikit-learn 进行分类入门](https://www.kdnuggets.com/getting-started-with-scikit-learn-for-classification-in-machine-learning)
