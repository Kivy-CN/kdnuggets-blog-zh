# 使用 Tensorflow 进行城市声音分类

> 原文：[https://www.kdnuggets.com/2016/09/urban-sound-classification-neural-networks-tensorflow.html/2](https://www.kdnuggets.com/2016/09/urban-sound-classification-neural-networks-tensorflow.html/2)

### 特征提取

为了从声音数据中提取有用的特征，我们将使用*Librosa*库。它提供了几种方法来从声音片段中提取不同的特征。我们将使用以下提到的方法来提取各种特征：

+   *melspectrogram*: 计算 Mel 标度功率谱图

+   *mfcc*: Mel 频率倒谱系数

+   *chorma-stft*: 从波形或功率谱图中计算色度图

+   *spectral_contrast*: 计算光谱对比度，使用[[1](http://ieeexplore.ieee.org/xpls/abs_all.jsp?arnumber=1035731)]中定义的方法

+   *tonnetz*: 计算音调质心特征（tonnetz），遵循[[2](http://dl.acm.org/citation.cfm?id=1178727)]的方法

为了简化从声音片段中提取特征的过程，定义了两个辅助方法。首先是*parse_audio_files*，它接受父目录名、父目录中的子目录和文件扩展名（默认为.wav）作为输入。然后，它会遍历所有子目录中的文件，并调用第二个辅助函数*extract_feature*。它接受文件路径作为输入，通过调用*librosa.load*方法读取文件，提取并返回上述讨论的特征。这两个方法是将原始声音片段转换为可直接输入分类器的信息特征（以及每个声音片段的类别标签）所需的全部内容。请记住，每个声音片段的类别标签在文件名中。例如，如果文件名是*108041-9-0-4.wav*，那么类别标签将是9。通过按“-”拆分字符串并取数组的第二项即可得到类别标签。

### 多层神经网络的分类

*注意：如果你想使用 scikit-learn 或任何其他库来训练分类器，随意使用。此教程的目标是提供 Tensorflow 中的神经网络实现用于分类任务。*

现在我们的数据集已经准备好了，让我们在 Tensorflow 中实现一个两层神经网络，将每个声音片段分类到不同的类别中。但在开始之前，让我们使用*one_hot_encode*方法将类别标签编码为独热向量，并通过以下代码将数据集划分为训练集和测试集。

以下代码定义了神经网络模型所需的配置参数，例如训练周期、每个隐藏层中的神经元数量以及学习率。

现在定义特征和类别标签的占位符，TensorFlow将在运行时用数据填充这些占位符。此外，为网络的隐藏层和输出层定义权重和偏置。为了引入非线性，我们在第一个隐藏层中使用sigmoid函数，在第二个隐藏层中使用tanh函数。由于我们处理的是多分类问题，因此输出层使用softmax作为非线性函数。

交叉熵成本函数将通过梯度下降优化器进行最小化，下面提供的代码初始化了成本函数和优化器。此外，定义并初始化变量以计算模型的预测准确率。

我们已经准备好了所有必要的部分。现在，让我们训练神经网络模型，视觉化每个周期是否有下降的成本，并使用以下代码对测试集进行预测：

![NN Cost Per Epoch](../Images/2a6c1c3b2ea1bec3aa6b6405f1e01422.png)

在本教程中，我们学习了如何从声音数据集中提取特征，并在Tensorflow中训练一个两层神经网络模型以对声音进行分类。在没有过多调优的情况下，上述神经网络架构在Urban8K数据集的fold1上达到了约**82%**的准确率。我鼓励你查看Librosa的文档，并尝试不同的神经网络配置，比如更改神经元数量、隐藏层数量以及引入dropout等。

![作者](../Images/f9c21800dc7ef2fdf98de5b260d7c466.png) Python笔记本可以在以下**[链接](https://github.com/aqibsaeed/Urban-Sound-Classification)**中找到。

**个人简介： [Aaqib Saeed](http://aqibsaeed.github.io/)** 是荷兰Twente大学计算机科学（专注于数据科学和智能服务）专业的研究生。

[原始链接](http://aqibsaeed.github.io/2016-09-03-urban-sound-classification-part-1/)。转载已获许可。

**相关内容：**

+   [最温和的Tensorflow入门指南 – 第1部分](/2016/08/gentlest-introduction-tensorflow-part-1.html)

+   [深度学习阅读组：带有随机深度的深度网络](/2016/09/deep-learning-reading-group-stochastic-depth-networks.html)

+   [跟上深度学习的步伐：7月更新](/2016/08/deep-learning-july-update.html)

* * *

## 我们的前3个课程推荐

![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 1\. [Google网络安全证书](https://www.kdnuggets.com/google-cybersecurity) - 快速进入网络安全职业生涯。

![](../Images/e225c49c3c91745821c8c0368bf04711.png) 2\. [Google数据分析专业证书](https://www.kdnuggets.com/google-data-analytics) - 提升你的数据分析技能

![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 3\. [Google IT支持专业证书](https://www.kdnuggets.com/google-itsupport) - 支持你的组织IT需求

* * *

### 更多相关主题

+   [卷积神经网络（CNNs）进行图像分类](https://www.kdnuggets.com/2022/05/image-classification-convolutional-neural-networks-cnns.html)

+   [使用 TensorFlow 训练图像分类模型的指南](https://www.kdnuggets.com/2022/12/guide-train-image-classification-model-tensorflow.html)

+   [使用 TensorFlow 和 Keras 构建并训练你的第一个神经网络](https://www.kdnuggets.com/2023/05/building-training-first-neural-network-tensorflow-keras.html)

+   [在尝试神经网络之前的 10 个简单步骤](https://www.kdnuggets.com/2021/12/10-simple-things-try-neural-networks.html)

+   [可解释的 PyTorch 神经网络](https://www.kdnuggets.com/2022/01/interpretable-neural-networks-pytorch.html)

+   [深度神经网络不会引领我们走向 AGI](https://www.kdnuggets.com/2021/12/deep-neural-networks-not-toward-agi.html)
