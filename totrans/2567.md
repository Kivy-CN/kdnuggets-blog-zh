# 使用 Voila 和 Saturn Cloud 创建并部署仪表盘

> 原文：[https://www.kdnuggets.com/2021/06/create-deploy-dashboards-voila-saturn-cloud.html](https://www.kdnuggets.com/2021/06/create-deploy-dashboards-voila-saturn-cloud.html)

[评论](#comments)

**由 [Dhrumil Patel](http://linkedin.com/in/dhrumilcse) 撰写，NVIDIA 性能分析实习生**

### ****过滤和可视化银行交易数据****

* * *

## 我们的前三大课程推荐

![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 1\. [谷歌网络安全证书](https://www.kdnuggets.com/google-cybersecurity) - 快速进入网络安全职业生涯。

![](../Images/e225c49c3c91745821c8c0368bf04711.png) 2\. [谷歌数据分析专业证书](https://www.kdnuggets.com/google-data-analytics) - 提升你的数据分析技能

![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 3\. [谷歌 IT 支持专业证书](https://www.kdnuggets.com/google-itsupport) - 支持你的组织 IT

* * *

处理和训练大数据集，将它们全部维护在一个地方，并将其部署到生产环境中是一项具有挑战性的工作。但如果我告诉你，只需几个点击就可以处理所有这些工作呢？

让我们了解一下如何轻松做到这一点。在本文中，我们将创建一个仪表盘（使用 Python 和 Voila），运行一个机器学习模型以移除欺诈交易，并用可视化展示剩余数据，然后将其发布到 Saturn Cloud 的生产服务器上以便于访问。以下是文章的提纲，如果你对细节已经熟悉，可以跳过一两个部分。

1.  什么是 [Saturn Cloud](https://www.saturncloud.io/s/freehosted/?utm_source=Dhrumil%3A%20Deploy%20Dashboards%20using%20Voila&utm_medium=try%20saturn)?

1.  创建仪表盘（包括数据过滤和可视化）

1.  部署仪表盘（本地和生产环境）

1.  参考资料

### **什么是 Saturn Cloud**

Saturn Cloud 是一个机器学习平台，自动化 DevOps 和 ML 基础设施。除此之外，他们使用 jupyter 和 dash 来扩展 python 以处理大量数据。以下是 Saturn Cloud 提供的一些其他功能：

+   你可以使用 [Dask](https://www.saturncloud.io/s/aboutdask/?utm_source=Dhrumil%3A%20Deploy%20Dashboards%20using%20Voila&utm_medium=dask) 在需要的多台机器上并行运行你的代码

+   你可以毫无麻烦地在 GPU 上运行你的代码

+   你可以在不依赖于单独团队的情况下部署你的工作

+   完全基于开源工具构建

+   它也可以在你的 AWS 账户中运行。此外，Saturn Cloud 连接到你现有的数据，你不必迁移它。添加所需的凭证就可以开始使用了。

+   你可以从 Google Colab 连接到 Dask。你也可以连接到任何可以托管 Python 的 GCP 服务。

这不是很酷吗？让我们了解如何创建仪表盘，并通过 Saturn 以几步简单的操作将其发布到生产环境中。

### **创建仪表盘**

****Voila 101****

在部署仪表板之前，首先，让我们使用 Python 和 [Voila](https://voila.readthedocs.io/en/stable/using.html) 创建一个基本的仪表板。使用 Voila 创建仪表板有三个主要组件：

1.  定义小部件（用于交互的按钮点击或搜索字段）

1.  一个逻辑（事件处理程序），用于你在第 1 步中创建的交互字段（可以是基于类或基于函数的）

1.  一个输出小部件（结果将显示在这里）

使用 [虚假交易数据](https://github.com/Dhrumilcse/fradulent-transaction/tree/main/data)，让我们构建一个仪表板，该仪表板在删除欺诈交易后提供过滤后的数据，并展示交易的多样性（以货币为参考）。假设你有一个可以识别欺诈交易的机器学习模型。为了简化本文，我们将仅使用 if 语句，但不用担心，我会告诉你如何导入自己的模型（如果你有的话）。

****一个基本仪表板****

首先，你需要定义一个小部件。对于我们的用例，我们希望用户上传数据，并在删除欺诈交易后提供过滤后的数据和图表。我们将从定义上传按钮开始。

![图片](../Images/19f777c4060441a3b64c55bcd45ead58.png)

这里我们有两个按钮——一个用于上传文件（upload_file），另一个（upload_btn）用于让我们的事件处理程序（upload_btn_eventhandler）知道何时执行操作。我知道，你一定在想我们的事件处理程序在哪里？我们将在下一步定义它。但在此之前，input_widgets 将两个按钮结合在一起，并通过我们的输出小部件（upload_btn_output）显示这些按钮。让我们先编写事件处理程序。

![图片](../Images/6e7538c21a32528d976edd818aa67416.png)

一旦点击上传按钮，我们的事件处理程序将获取文件并将其转换为 pandas dataframe，以便轻松处理数据。我通过句点分割文件名来查找文件扩展名，然后根据是否是 Excel 或 CSV 来存储数据。现在最后一步，输出小部件。如果你还记得，我们已经写了一个输出小部件，命名为 upload_btn_output，所以我们就这样做。

![图片](../Images/e5ac6929d289c10cd4c9980fe524c131.png)

如果你还没有，你需要安装 voila 如果你希望在本地运行它，相关说明可以在 [这里](https://voila.readthedocs.io/en/stable/using.html) 找到。但我将向你展示一种使用 Saturn Cloud 的简单方法。创建一个帐户并登录，在他们的仪表板上，你会看到“部署仪表板”，点击它，然后启动 jupyter lab。现在，将我们刚刚创建的 notebook 上传到 Saturn Cloud 的 jupyter lab 中。你可以在我的 GitHub 上找到完整的 jupyter notebook [这里](https://github.com/Dhrumilcse/fradulent-transaction)。此外，你还可以从 Saturn Cloud 提供的其他加速数据科学库和管道中进行选择。

![图片](../Images/c47f263cfbeb3c9898197d66b41612a8.png)

完成了吗？完美。现在复制URL，粘贴到新标签页中，并将…./your-username/dashboard/…. 替换为/your-username/dashboard/voila，然后导航到projects>examples>dashboard.ipynb并运行。你应该能看到我们的上传按钮。

如果你遇到任何问题，或者想了解更多关于在Saturn Cloud上使用Voila创建仪表板的内容，请参考这个[指南](https://www.saturncloud.io/docs/examples/dashboards/voila_dash/)。

![Image](../Images/839ab729adeaeb4de9d9070bbbe63f28.png)

****欺诈交易****

现在我们还没有任何过滤过的数据，我们只是上传了一个文件并存储了其内容。让我们再写一些代码来处理欺诈交易。

![Image](../Images/37002e3ab75a015e6c17a05793236ada.png)

我从虚假数据中生成了一个csv，你可以在这里找到，随意使用相同的。在这里，我将移除那些超出某一阈值的值，认为它们是欺诈的。假设所有金额大于1000的交易都是欺诈的。我们可以通过在upload_btn_eventhandler中写下以下内容来简单实现。

如果你的数据在云端，比如AWS，那完全没问题。你需要做的只是获取你的凭据，然后就可以开始了。你可以通过使用**s3fs**库来轻松完成这一点，它是一个用于访问AWS文件系统的Python库。你可以在[文档](https://s3fs.readthedocs.io/en/latest/)中阅读更多相关内容。

****使用预训练模型（额外）****

如果你有一个预训练模型想要使用，你可以像我下面这样导入它；但如果你只是想了解voila的工作原理，并且不打算导入机器学习模型，你可以跳过接下来的代码。我们基本上是使用joblib来加载计数向量器和模型，然后预测值。

![Image](../Images/caaa442c6517a07ed32ef50ed432aba2.png)

**过滤数据**

太棒了，现在我们有了没有欺诈交易的干净数据。我们来添加一点功能，基于货币过滤交易怎么样？我们可以通过创建另一个逻辑来轻松实现，就像我们为上传按钮创建的逻辑一样。现在，我们只是传递我们创建的干净数据框。让我们看一下代码：

![Image](../Images/45dd2e7bb33a83f44dccf50f4a4c4121.png)

我们在这里也将遵循相同的模式。首先，我们为货币列中的所有唯一值创建一个下拉列表。然后，我们创建一个事件处理程序，它将调用另一个函数common_filtering，这个函数将匹配货币并仅给出那些我们货币匹配的值，换句话说，就是过滤。然后，我们将其显示到我们刚刚创建的输出部件上。如果你使用的是我添加的相同数据文件，它应该看起来像这样。

![Image](../Images/f44c7193b27ca45fc05cc04b6ef141f0.png)

****可视化****

让我们继续可视化我们过滤后的数据。我们将制作一个显示货币数量的折线图，以查看交易在多种货币中的分布情况。

![Image](../Images/315f96b9e8825cddfe97a4b4df08a044.png)

首先，我们创建一个新的列 count，并统计每种货币的出现次数。然后我们将其作为我们的 plot_data，其中 X 轴为货币，Y 轴为计数。我们在这里使用 plotly —— import plotly as px —— 并保持一个单独的辅助函数供绘图使用。如果一切运行成功，你可以在仪表板上看到类似的条形图。

![Image](../Images/8c9ef764c2e2cb21af8b025bd8a74ad6.png)

瞧（玩笑话），你已经有了一个有效的仪表板。现在我们可以通过 Saturn Cloud 将其发布到生产环境，这就像点击几下鼠标一样简单。

### ****发布到生产环境****

要创建一个部署，进入项目页面并点击“创建部署”按钮。

![Image](../Images/0b656065f74037c9d74839db2cde035b.png)

**创建部署**

系统会提示你进入配置页面。如你所见，你只需设置一个名称和命令，就可以准备就绪。然而，Saturn Cloud 上有很多选项可以探索，你可以在 [这里](https://www.saturncloud.io/docs/using-saturn-cloud/jobs_and_deployments/#deployments) 找到。

![Image](../Images/6906f9964e2c6443c3de54292d00edd7.png)

**配置**

现在配置完成后，你将能够看到仪表板，点击 URL 旁的小播放按钮，一旦它激活，访问该 URL 以访问你的仪表板。

### ****附录****

在这篇文章中，我们介绍了什么是 Saturn Cloud 以及它如何加速你的端到端流程，如何使用 Voila 和 Python 创建仪表板，并通过 Saturn Cloud 以几个简单步骤发布到生产环境。拥有合适的工具会对你有很大帮助，如果你希望加快处理或数据科学流程，Saturn Cloud 就是其中之一。如果你有任何问题，随时通过 [twitter](https://twitter.com/dhrumilcse) 或 [Linkedin](https://linkedin.com/in/dhrumilcse) 联系我，或者直接来打个招呼。

**个人简介: [Dhrumil Patel](http://linkedin.com/in/dhrumilcse)** ([@Dhrumilcse](https://twitter.com/Dhrumilcse)) 是 NVIDIA 的绩效分析实习生。他的兴趣在于大规模数据处理和使用现代框架（如 Django）进行 Web 应用开发。他还在处理大量社交媒体数据时具有实际的 NLP 经验。除了工作，他还喜欢阅读和折纸。

**相关:**

+   [使用 Saturn Cloud 在 GPUs 上超级充电 Python 和 Pandas](/2021/05/super-charge-python-pandas-gpus-saturn-cloud.html)

+   [数据科学家，你需要知道如何编程](/2021/06/data-scientists-need-know-code.html)

+   [当好的数据分析未能提供预期结果时](/2020/11/good-data-analyses-fail.html)

### 更多相关内容

+   [为有效的 Tableau 和 Power BI 仪表板准备数据](https://www.kdnuggets.com/2022/06/prepare-data-effective-tableau-power-bi-dashboards.html)

+   [如何成功部署数据科学项目](https://www.kdnuggets.com/2022/01/successfully-deploy-data-science-projects.html)

+   [学习如何设计和部署负责任的 AI 系统](https://www.kdnuggets.com/2023/10/teradata-design-deploy-responsible-ai-systems-whitepaper)

+   [学习如何设计和部署负责任的 AI 系统](https://www.kdnuggets.com/2023/11/teradata-design-deploy-responsible-ai-systems-whitepaper)

+   [调查：机器学习项目仍然经常无法部署](https://www.kdnuggets.com/survey-machine-learning-projects-still-routinely-fail-to-deploy)

+   [使用 Heroku 部署机器学习 Web 应用程序](https://www.kdnuggets.com/2022/04/deploy-machine-learning-web-app-heroku.html)
