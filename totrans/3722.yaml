- en: Convert Text Documents to a TF-IDF Matrix with tfidfvectorizer
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://www.kdnuggets.com/2022/09/convert-text-documents-tfidf-matrix-tfidfvectorizer.html](https://www.kdnuggets.com/2022/09/convert-text-documents-tfidf-matrix-tfidfvectorizer.html)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: '![Convert Text Documents to a TF-IDF Matrix with tfidfvectorizer](../Images/ea146363649f10588191481680069128.png)'
  prefs: []
  type: TYPE_IMG
- en: Image by Author
  prefs: []
  type: TYPE_NORMAL
- en: TF-IDF Matrix
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '* * *'
  prefs: []
  type: TYPE_NORMAL
- en: Our Top 3 Course Recommendations
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 1\. [Google Cybersecurity
    Certificate](https://www.kdnuggets.com/google-cybersecurity) - Get on the fast
    track to a career in cybersecurity.'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/e225c49c3c91745821c8c0368bf04711.png) 2\. [Google Data Analytics
    Professional Certificate](https://www.kdnuggets.com/google-data-analytics) - Up
    your data analytics game'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 3\. [Google IT Support
    Professional Certificate](https://www.kdnuggets.com/google-itsupport) - Support
    your organization in IT'
  prefs: []
  type: TYPE_NORMAL
- en: '* * *'
  prefs: []
  type: TYPE_NORMAL
- en: Term frequency Inverse document frequency (TFIDF) is a statistical formula to
    convert text documents into vectors based on the relevancy of the word. It is
    based on the bag of the words model to create a matrix containing the information
    about less relevant and most relevant words in the document.
  prefs: []
  type: TYPE_NORMAL
- en: TF-IDF is particularly useful in NLP tasks, topic modeling, and machine learning
    tasks. It helps algorithms to use the importance of the words to predict outcomes.
  prefs: []
  type: TYPE_NORMAL
- en: Term Frequency (TF)
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: It is the ratio of the occurrence of the word (w) in document (d) per the total
    number of words in the documents. With this simple formulation, we are measuring
    the frequency of a word in the document.
  prefs: []
  type: TYPE_NORMAL
- en: For example, if the sentence has 6 words and contains two “the”, the TF ratio
    of this word would be (2/6).
  prefs: []
  type: TYPE_NORMAL
- en: '![Convert Text Documents to a TF-IDF Matrix with tfidfvectorizer](../Images/5c8c14fee12eaf0d8ba615d71cb138b5.png)'
  prefs: []
  type: TYPE_IMG
- en: Inverse Document Frequency (IDF)
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: IDF calculates the importance of a word in a corpus D. The most frequently used
    words like “of, we, are” have little to no significance. It is calculated by dividing
    the total number of documents in the corpus by the number of documents containing
    the word.
  prefs: []
  type: TYPE_NORMAL
- en: '![Convert Text Documents to a TF-IDF Matrix with tfidfvectorizer](../Images/16abe43f41aedbfc910c6a903f3bddfb.png)'
  prefs: []
  type: TYPE_IMG
- en: '![Equation](../Images/8ba048fac8868603a0b21c6a49b320b1.png)'
  prefs: []
  type: TYPE_IMG
- en: Term Frequency Inverse Document Frequency (TFIDF)
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: TF-IDF is the product of term frequency and inverse document frequency. It gives
    more importance to the word that is rare in the corpus and common in a document.
  prefs: []
  type: TYPE_NORMAL
- en: '![Equation](../Images/7a052e35193f0b3503b881a4c94a92a0.png)'
  prefs: []
  type: TYPE_IMG
- en: 'TF-IDF Matrix example from [Vaibhav Jayaswal](https://towardsdatascience.com/text-vectorization-term-frequency-inverse-document-frequency-tfidf-5a3f9604da6d)’s
    blog:'
  prefs: []
  type: TYPE_NORMAL
- en: 'There are two documents in a corpus: Text A and Text B. We will use them to
    create a TF-IDF matrix.'
  prefs: []
  type: TYPE_NORMAL
- en: '**Text A**: Jupiter is the largest planet'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Text B**: Mars is the fourth planet from the sun'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The table below shows the values of TF for A and B, IDF, and TFIDF for A and
    B.
  prefs: []
  type: TYPE_NORMAL
- en: '| **Words** | **TF ( A )** | **TF ( B )** | **IDF** | **TFIDF ( A )** | **TFIDF
    ( B )** |'
  prefs: []
  type: TYPE_TB
- en: '| jupiter  | 1/5 | 0 | In (2/1)=0.69 | 0.138 | 0 |'
  prefs: []
  type: TYPE_TB
- en: '| is  | 1/5 | 1/8 | In (2/2)=0 | 0 | 0 |'
  prefs: []
  type: TYPE_TB
- en: '| the  | 1/5 | 2/8 | In (2/2)=0 | 0 | 0 |'
  prefs: []
  type: TYPE_TB
- en: '| largest  | 1/5 | 0 | In (2/1)=0.69 | 0.138 | 0 |'
  prefs: []
  type: TYPE_TB
- en: '| planet  | 1/5 | 1/8 | In (2/2)=0 | 0.138 | 0 |'
  prefs: []
  type: TYPE_TB
- en: '| mars  | 0 | 1/8 | In (2/1)=0.69 | 0 | 0.086 |'
  prefs: []
  type: TYPE_TB
- en: '| fourth  | 0 | 1/8 | In (2/1)=0.69 | 0 | 0.086 |'
  prefs: []
  type: TYPE_TB
- en: '| from  | 0 | 1/8 | In (2/1)=0.69 | 0 | 0.086 |'
  prefs: []
  type: TYPE_TB
- en: '| sun  | 0 | 1/8 | In (2/1)=0.69 | 0 | 0.086 |'
  prefs: []
  type: TYPE_TB
- en: TF-IDF Tutorial
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In this tutorial, we are going to use [TfidfVectorizer](https://scikit-learn.org/stable/modules/generated/sklearn.feature_extraction.text.TfidfVectorizer.html)
    from scikit-learn to convert the text and view the TF-IDF matrix.
  prefs: []
  type: TYPE_NORMAL
- en: In the code below, we have a small corpus of 4 documents. First, we will create
    a vectorizer object using `TfidfVectorizer()` and fit and transform the text data
    into vectors. After that, we will use vectorizers to extract the names of the
    words.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: We will now use TF-IDF tokens and vectors to create a pandas dataframe.
  prefs: []
  type: TYPE_NORMAL
- en: Convert the vectors to arrays and add it to the data argument.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Four indexes are created manually.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: tfidf_tokens names are added to columns
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs: []
  type: TYPE_PRE
- en: The pandas data frame shows columns as the words and rows as the documents.
  prefs: []
  type: TYPE_NORMAL
- en: In the dataframe below, every word has an important value based on the TF-IDF
    formula.
  prefs: []
  type: TYPE_NORMAL
- en: '![Convert Text Documents to a TF-IDF Matrix with tfidfvectorizer](../Images/00058e9f63c30b797e53e48c157e8975.png)'
  prefs: []
  type: TYPE_IMG
- en: TF-IDF For Text Classification
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Let’s go one step further and use the TF-IDF to convert text into vectors and
    then use it to train a text classification model.  For training the model, we
    will be using [Spotify App Reviews](https://www.kaggle.com/datasets/mfaaris/spotify-app-reviews-2022)
    data from Kaggle.
  prefs: []
  type: TYPE_NORMAL
- en: We will use read_csv to load the data and view the first five rows.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE2]'
  prefs: []
  type: TYPE_PRE
- en: We will be only using **Review** and **Rating** columns for training the models.
  prefs: []
  type: TYPE_NORMAL
- en: '![Convert Text Documents to a TF-IDF Matrix with tfidfvectorizer](../Images/0035918d7a48bd8a3d485ccd3106943a.png)'
  prefs: []
  type: TYPE_IMG
- en: We will transform the **Review** column to vectors and set **Rating** as the
    target. After that, we will split the dataset for training and testing.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE3]'
  prefs: []
  type: TYPE_PRE
- en: We won’t be going deep into feature engineering, text processing, or hyperparameter
    optimization. We will select a simple model (SGDClassifier) and train it on X_train
    and y_train.
  prefs: []
  type: TYPE_NORMAL
- en: For model validation, we will predict the values using X_test and print classification
    report.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE4]'
  prefs: []
  type: TYPE_PRE
- en: As we can observe, we got a 0.69 F1 score by training it on the default configuration.
    We can improve model performance by cross-validation, hyper-parameter optimization, 
    text cleaning and processing, and feature engineering.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE5]'
  prefs: []
  type: TYPE_PRE
- en: '"Thank you for reading the tutorial. I hope I made a difference in making you
    understand the fundamentals of TF-IDF. If you have any further questions just
    type below or reach out on LinkedIn."'
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: '**[Abid Ali Awan](https://www.polywork.com/kingabzpro)** ([@1abidaliawan](https://twitter.com/1abidaliawan))
    is a certified data scientist professional who loves building machine learning
    models. Currently, he is focusing on content creation and writing technical blogs
    on machine learning and data science technologies. Abid holds a Master''s degree
    in Technology Management and a bachelor''s degree in Telecommunication Engineering.
    His vision is to build an AI product using a graph neural network for students
    struggling with mental illness.'
  prefs: []
  type: TYPE_NORMAL
- en: More On This Topic
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: '[Classifying Long Text Documents Using BERT](https://www.kdnuggets.com/2022/02/classifying-long-text-documents-bert.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Converting Text Documents to Token Counts with CountVectorizer](https://www.kdnuggets.com/2022/10/converting-text-documents-token-counts-countvectorizer.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[How to Use ChatGPT to Convert Text into a PowerPoint Presentation](https://www.kdnuggets.com/2023/08/chatgpt-convert-text-powerpoint-presentation.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[GPT4All is the Local ChatGPT for your Documents and it is Free!](https://www.kdnuggets.com/2023/06/gpt4all-local-chatgpt-documents-free.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[How to Convert an RGB Image to Grayscale](https://www.kdnuggets.com/2019/12/convert-rgb-image-grayscale.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Convert Python Dict to JSON: A Tutorial for Beginners](https://www.kdnuggets.com/convert-python-dict-to-json-a-tutorial-for-beginners)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
