["```py\npip install pandas sqlalchemy\n```", "```py\n# Import necessary packages\nimport pandas as pd\nimport psycopg2\nfrom sqlalchemy import create_engine\n\n# creating the new db\nengine = create_engine(\n    \"sqlite:///kdnuggets.db\")\n\n# read the CSV dataset\ndata = pd.read_csv(\"/work/air_pollution new.csv\")\n\ncol = ['2017', '2018', '2019', '2020', '2021', '2022', '2023']\n\nfor s in col:\n    data[s] = pd.to_numeric(data[s], errors='coerce')\n\n    data = data.dropna(subset=[s])\n```", "```py\n# save the dataframe as a SQLite table\ndata.to_sql('countries_poluation', engine, if_exists='replace')\n```", "```py\nimport pandas as pd\nimport psycopg2\nfrom sqlalchemy import create_engine\n\n# establish a connection with the database\nengine = create_engine(\"sqlite:///kdnuggets.db\")\n\n# read the sqlite table\ntable_df = pd.read_sql_table(\n    \"countries_poluation\",\n    con=engine,\n    columns=['city', 'country', '2017', '2018', '2019', '2020', '2021', '2022',\n       '2023']\n)\n\ntable_df.head()\n```", "```py\n# read table data using sql query\nsql_df = pd.read_sql(\n    \"SELECT city,[2023] FROM countries_poluation ORDER BY [2023] DESC LIMIT 5\",\n    con=engine\n)\n\nprint(sql_df)\n```", "```py\n city  2023\n0       Lahore  97.4\n1        Hotan  95.0\n2      Bhiwadi  93.3\n3  Delhi (NCT)  92.7\n4     Peshawar  91.9\n```", "```py\naverage_air = sql_df['2023'].mean()\nprint(f\"The average of top 5 cities: {average_air:.2f}\")\n```", "```py\nThe average of top 5 cities: 94.06\n```", "```py\nsql_df.plot(x=\"city\",y=\"2023\",kind = \"barh\");\n```"]