- en: Detecting Data Drift for Ensuring Production ML Model Quality Using Eurybia
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://www.kdnuggets.com/2022/07/detecting-data-drift-ensuring-production-ml-model-quality-eurybia.html](https://www.kdnuggets.com/2022/07/detecting-data-drift-ensuring-production-ml-model-quality-eurybia.html)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: In the rest of this article, we will focus on a step-by-step data drift study
    using Eurybia an open-source python library. Detecting data drift is an important
    step to ensure the quality of machine learning models in production. This detection
    strongly favors robust AI maintainability over time.
  prefs: []
  type: TYPE_NORMAL
- en: '* * *'
  prefs: []
  type: TYPE_NORMAL
- en: Our Top 3 Course Recommendations
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 1\. [Google Cybersecurity
    Certificate](https://www.kdnuggets.com/google-cybersecurity) - Get on the fast
    track to a career in cybersecurity.'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/e225c49c3c91745821c8c0368bf04711.png) 2\. [Google Data Analytics
    Professional Certificate](https://www.kdnuggets.com/google-data-analytics) - Up
    your data analytics game'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 3\. [Google IT Support
    Professional Certificate](https://www.kdnuggets.com/google-itsupport) - Support
    your organization in IT'
  prefs: []
  type: TYPE_NORMAL
- en: '* * *'
  prefs: []
  type: TYPE_NORMAL
- en: '![Detecting Data Drift for Ensuring Production ML Model Quality Using Eurybia](../Images/15f602b6c3985943485046c1ad53411e.png)'
  prefs: []
  type: TYPE_IMG
- en: Eurybia demo, image by Author
  prefs: []
  type: TYPE_NORMAL
- en: What is Data Drift and Why Should You Care?
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Machine learning models are usually trained on data from historical databases.
    Models are then deployed in a production environment. Predictions from the production
    environment are made on freshly available data.
  prefs: []
  type: TYPE_NORMAL
- en: As such, historical data used to train the model and data used to predict the
    results might differ. This difference between datasets is named data drift.
  prefs: []
  type: TYPE_NORMAL
- en: Production ML models sometimes face performance drop over time. This decrease
    can be attributed either (or both) to the operational use or to the data drift.
  prefs: []
  type: TYPE_NORMAL
- en: How to Detect Data Drift?
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: To detect data drift, several methods such as comparing the distributions of
    the dataset features using statistical tests are available.
  prefs: []
  type: TYPE_NORMAL
- en: The python library Eurybia uses a method consisting in training a **binary classification
    model** (named “*datadrift classifier*”). This model tries to predict whether
    a sample belongs to the training/baseline dataset or to the production/current
    dataset.
  prefs: []
  type: TYPE_NORMAL
- en: '![Detecting Data Drift for Ensuring Production ML Model Quality Using Eurybia](../Images/2f5aee8dd8e202cad0e4a20476d24a70.png)'
  prefs: []
  type: TYPE_IMG
- en: How the datadrift classifier works, image by Author
  prefs: []
  type: TYPE_NORMAL
- en: It is then possible to study the **explainability** of the created “*datadrift
    classifier*”. This is a great advantage since the explainability provides a detailed
    analysis of what drifted along with a strong rationale for further study and understanding
    of the data drift. In addition to explainability, the performance of the “*datadrift
    classifier”* provides a measure of the data drift.
  prefs: []
  type: TYPE_NORMAL
- en: 'Data Drift: What Are We Looking For?'
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: What feature changed the most ?
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Feature importance of each feature included in the “*datadrift classifier*”
    can be extracted. It allows to prioritize the study of features that changed the
    most.
  prefs: []
  type: TYPE_NORMAL
- en: Does the data drift affect the model predictions ?
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Eurybia puts into perspective the data drift along with the feature importance
    of the deployed model. The more important a feature is for the deployed model,
    the more problematic the drift of the feature is.
  prefs: []
  type: TYPE_NORMAL
- en: What is the variation of each feature?
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: It is possible to observe the feature distribution of each feature in both baseline
    and current datasets.
  prefs: []
  type: TYPE_NORMAL
- en: What is the impact of data drift?
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Eurybia plots the predicted probabilities distributions based on the baseline
    dataset and the production dataset. We can measure the difference between this
    distibution with the Jensen Shannon Divergence.
  prefs: []
  type: TYPE_NORMAL
- en: Can we measure the data drift?
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Eurybia provides performance metrics (AUC of the “*datadrift classifier*” and
    Jensen Shannon Divergence of the predicted probabilities distributions) for data
    drift, which notably allows tracking over time.
  prefs: []
  type: TYPE_NORMAL
- en: Demonstration of Data Drift Detection with Eurybia
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'You can install the package through pip:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: Let’s Use Eurybia!
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: In the rest of this article, we will focus on a step-by-step data drift study
    using Eurybia.
  prefs: []
  type: TYPE_NORMAL
- en: We will use the famous “House Prices” dataset from [Kaggle](https://www.kaggle.com/c/house-prices-advanced-regression-techniques).
    Data will be split into two distinct datasets. Data from 2006 will be used to
    train a regressor able to predict the selling price of a house. Then, the price
    of houses sold in 2007 will be predicted using the previously created model.
  prefs: []
  type: TYPE_NORMAL
- en: We will then try to detect the drift of this regressor, based on the data drift
    of 2006 vs. 2007 datasets.
  prefs: []
  type: TYPE_NORMAL
- en: '**Let’s start by loading the dataset:**'
  prefs: []
  type: TYPE_NORMAL
- en: '**Building supervised model:**'
  prefs: []
  type: TYPE_NORMAL
- en: '**And use Eurybia to detect data drift…**'
  prefs: []
  type: TYPE_NORMAL
- en: '**Step 1 — Import**'
  prefs: []
  type: TYPE_NORMAL
- en: '**Step 2 — Initialise a SmartDrift Object**'
  prefs: []
  type: TYPE_NORMAL
- en: 'Optional parameters:'
  prefs: []
  type: TYPE_NORMAL
- en: '**“deployed_model”**: Indicate here the model used to provide predictions.
    This parameter allows combining of data drift results with the prediction model.
    It thus provides hints about the potential impact of data drift on the deployed
    model performances.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '“**Encoding**”: If a specific encoder has been used to prepare the dataset
    to provide the *“deployed_model”* with modified data, it should be indicated here.
    Eurybia will then be able to integrate it and get back to the original data format.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Step 3 — Compile**'
  prefs: []
  type: TYPE_NORMAL
- en: 'Optional parameters:'
  prefs: []
  type: TYPE_NORMAL
- en: '“**full_validation**”: False/True (default: False). The full validation consists
    in analyzing the modalities consistency between columns.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '“**date_compile_auc ”**: date to specify a date to be indicated when saving
    the results. This might be useful when computing the drift for a past data set.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**“datadrift_file”**: Name of the CSV file containing the data drift performance
    history. This parameter is useful when the drift is evaluated over time.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Step 4 — Generate Html Report**'
  prefs: []
  type: TYPE_NORMAL
- en: 'Optional parameters:'
  prefs: []
  type: TYPE_NORMAL
- en: '“**title_description **”: short subtitle to describe the report.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '“**project_info_file**”: path to yaml file. The file could contain multiple
    informations to be added to the report such as general information, dataset description,
    data preparation, or model training.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: How to Understand Eurybia’s Outputs
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Eurybia is designed to generate an HTML report for analysis. All the plots provided
    in the HTML report are also available in Jupyter notebooks.
  prefs: []
  type: TYPE_NORMAL
- en: '![Detecting Data Drift for Ensuring Production ML Model Quality Using Eurybia](../Images/427852ab9371adcd67d6dd98d14b9072.png)'
  prefs: []
  type: TYPE_IMG
- en: Eurybia Report index, image by Author
  prefs: []
  type: TYPE_NORMAL
- en: 'The report can be browsed with tabs and is separated as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Index: home page'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Project information: report context and information'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Consistency Analysis: highlighting differences between the two datasets'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Data drift: In-depth data drift analysis'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Datadrift classifier model performances**'
  prefs: []
  type: TYPE_NORMAL
- en: The data drift detection method is based on the ability of a model classifier
    to identify whether a sample belongs to one or another dataset. For this purpose,
    a target (0) is assigned to the baseline dataset and a second target (1) to the
    current dataset. A classification model (catboost) is trained to predict this
    target. As such, the data drift classifier performance is related to the difference
    between two datasets. A marked difference will lead to an easy classification
    (final AUC close to 1). Similar datasets will lead to poor data drift classifier
    performance (final AUC close to 0.5).
  prefs: []
  type: TYPE_NORMAL
- en: '![Detecting Data Drift for Ensuring Production ML Model Quality Using Eurybia](../Images/c703373236fb724a2e4ef16220c26fb4.png)'
  prefs: []
  type: TYPE_IMG
- en: Datadrift classifier model performance, image by Author
  prefs: []
  type: TYPE_NORMAL
- en: The closer the AUC is from 0.5 the less the data drifted. The closer the AUC
    is from 1 the more the data drifted
  prefs: []
  type: TYPE_NORMAL
- en: '**Importance of features in data drift**'
  prefs: []
  type: TYPE_NORMAL
- en: Bar chart representing the feature importance of each variable included in the
    “*datadrift classifier*”.
  prefs: []
  type: TYPE_NORMAL
- en: '![Detecting Data Drift for Ensuring Production ML Model Quality Using Eurybia](../Images/97cfbcc3bf0fba8ea857fdda97bfe75b.png)'
  prefs: []
  type: TYPE_IMG
- en: Importance of features in data drift, image by Author
  prefs: []
  type: TYPE_NORMAL
- en: This graph highlights variables that drifted the most. This might help to prioritize
    the subsequent deeper study of specific variables.
  prefs: []
  type: TYPE_NORMAL
- en: Feature importance overview
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Eurybia HTML reports also contain a scatter plot depicting, for each feature,
    the feature importance of *the deployed model* as a function of the “*datadrift
    classifier*” feature importance. This highlights the real importance of a data
    drift for the deployed model classification.
  prefs: []
  type: TYPE_NORMAL
- en: '![Detecting Data Drift for Ensuring Production ML Model Quality Using Eurybia](../Images/95b89e12f85e4d74c8f7432f4367e844.png)'
  prefs: []
  type: TYPE_IMG
- en: Feature importance overview, image by Author
  prefs: []
  type: TYPE_NORMAL
- en: 'Graphical interpretation based on the feature location:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Top left: Feature important to the deployed model and with low data drift'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Bottom left: Feature with moderated importance to the deployed model and with
    low data drift'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Bottom right: Feature with moderated importance to the deployed model but with
    high data drift. This feature might need your attention.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Top right: Feature important to the deployed model and high drift. This feature
    requires your attention.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Univariate analysis
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: The univariate analysis is supported by the graphical analysis of the 2 datasets’
    distributions, making easier the study of the most important feature for drift
    detection.
  prefs: []
  type: TYPE_NORMAL
- en: '![Detecting Data Drift for Ensuring Production ML Model Quality Using Eurybia](../Images/11439a554a0b7045156dd767c876d943.png)'
  prefs: []
  type: TYPE_IMG
- en: Univariate analysis, image by Author
  prefs: []
  type: TYPE_NORMAL
- en: With the Eurybia report, in the drop-down menu, the features are sorted by their
    importance in the data drift classification. For categorical features, the possible
    values are sorted by descending difference between the two datasets.
  prefs: []
  type: TYPE_NORMAL
- en: '**Distribution of predicted values**'
  prefs: []
  type: TYPE_NORMAL
- en: The distribution of predicted values helps the visualization of output predictions
    provided by the deployed model on both baseline and current datasets. A difference
    in distributions might reflect a data drift.
  prefs: []
  type: TYPE_NORMAL
- en: '![Detecting Data Drift for Ensuring Production ML Model Quality Using Eurybia](../Images/cab662b411781e0011fe265abef16add.png)'
  prefs: []
  type: TYPE_IMG
- en: Distribution of predicted values, image by Author
  prefs: []
  type: TYPE_NORMAL
- en: Jensen Shannon Divergence (JSD). The JSD measures the effect of a data drift
    on the deployed model performance. A value close to 0 indicates similar data distributions,
    while a value close to 1 tends to show distinct data distributions with a negative
    effect on the deployed model performance.
  prefs: []
  type: TYPE_NORMAL
- en: '![Detecting Data Drift for Ensuring Production ML Model Quality Using Eurybia](../Images/14c671aba52f214fbb7443e9721f675a.png)'
  prefs: []
  type: TYPE_IMG
- en: Jensen Shannon Divergence, image by Author
  prefs: []
  type: TYPE_NORMAL
- en: '**Historical Data drift**'
  prefs: []
  type: TYPE_NORMAL
- en: Eurybia can compile the data drift over the years with sales up to 2010.
  prefs: []
  type: TYPE_NORMAL
- en: '![Detecting Data Drift for Ensuring Production ML Model Quality Using Eurybia](../Images/b557d064c4dcf148a9310d9946f089fe.png)'
  prefs: []
  type: TYPE_IMG
- en: Historical Data drift, image by Author
  prefs: []
  type: TYPE_NORMAL
- en: The “Datadrift classifier AUC” and “Jensen Shannon Datadrift” provide 2 helpful
    indicators of data drift.
  prefs: []
  type: TYPE_NORMAL
- en: While AUC striclty focuses on data evolution, JSD evaluates the impact of data
    evolution on the predictions of the deployed model.
  prefs: []
  type: TYPE_NORMAL
- en: In other words, a marked drift of a single variable with low feature importance
    for the deployed model should cause a high AUC but potentially a low JSD.
  prefs: []
  type: TYPE_NORMAL
- en: If You Want To Go Further…
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Tutorials on the different uses of Eurybia can be found [**here**](https://github.com/MAIF/eurybia/tree/master/tutorial)**.**
  prefs: []
  type: TYPE_NORMAL
- en: I hope that Eurybia will be useful in monitoring ML models in production. Any
    feedback and ideas are very welcomed..! [**Eurybia**](https://github.com/MAIF/eurybia) is
    open source! Feel free to contribute by commenting on this post or on the [GitHub
    discussions](https://github.com/MAIF/eurybia/discussions).
  prefs: []
  type: TYPE_NORMAL
- en: '[**Thomas Bouché**](https://medium.com/@thomas.bouche_2245) is a Data Scientist
    at MAIF.'
  prefs: []
  type: TYPE_NORMAL
- en: More On This Topic
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: '[Managing Model Drift in Production with MLOps](https://www.kdnuggets.com/2023/05/managing-model-drift-production-mlops.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Data Quality Dimensions: Assuring Your Data Quality with Great Expectations](https://www.kdnuggets.com/2023/03/data-quality-dimensions-assuring-data-quality-great-expectations.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Data Masking: The Core of Ensuring GDPR and other Regulatory…](https://www.kdnuggets.com/2023/05/data-masking-core-ensuring-gdpr-regulatory-compliance-strategies.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Ensuring Reliable Few-Shot Prompt Selection for LLMs](https://www.kdnuggets.com/2023/07/ensuring-reliable-fewshot-prompt-selection-llms.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Deploying Your Machine Learning Model to Production in the Cloud](https://www.kdnuggets.com/deploying-your-ml-model-to-production-in-the-cloud)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[5 Free Tools For Detecting ChatGPT, GPT3, and GPT2](https://www.kdnuggets.com/2023/02/5-free-tools-detecting-chatgpt-gpt3-gpt2.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
