["```py\nmonth_ARPU AS\n(SELECT\n     visit_month,\n     Avg(revenue) AS ARPU \nFROM\n     (SELECT\n          Cust_id,\n          Datediff(MONTH, ‘2010-01-01’, transaction_date) AS visit_month,\n          Sum(transaction_size) AS revenue \n     FROM   transactions \n     WHERE  transaction_date &gt; Dateadd(‘year’, -1, CURRENT_DATE)\n     GROUP BY\n           1,\n           2)\nGROUP BY 1)\n```", "```py\nWITH monthly_visits AS\n(SELECT\n     DISTINCT\n     Datediff(month, ‘2010-01-01’, transaction_date) AS visit_month,\n     cust_id \nFROM            transactions \nWHERE\ntransaction_date &gt; dateadd(‘year’, -1, current_date)),\n\n(SELECT\navg(churn_rate)\nFROM\n     (SELECT\n          current_month,\n          Count(CASE\n               WHEN cust_type='churn' THEN 1\n               ELSE NULL\n       END)/count(cust_id) AS churn_rate \n     FROM\n          (SELECT\n               past_month.visit_month + interval ‘1 month’ AS current_month,\n               past_month.cust_id,\n               CASE\n                    WHEN this_month.cust_id IS NULL THEN 'churn'\n                    ELSE 'retained'\n               END AS cust_type \n          FROM\n               monthly_visits past_month \n          LEFT JOIN monthly_visits this_month ON\n                    this_month.cust_id=past_month.cust_id\n                    AND this_month.visit_month=past_month.visit_month + interval ‘1 month’\n          )data\n     GROUP BY 1)\n)\n```"]