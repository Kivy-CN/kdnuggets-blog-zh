# 使用 NumPy 实现人工神经网络及图像分类

> 原文：[https://www.kdnuggets.com/2019/02/artificial-neural-network-implementation-using-numpy-and-image-classification.html](https://www.kdnuggets.com/2019/02/artificial-neural-network-implementation-using-numpy-and-image-classification.html)

![c](../Images/3d9c022da2d331bb56691a9617b91b90.png) [评论](/2019/02/artificial-neural-network-implementation-using-numpy-and-image-classification.html?page=2#comments)

![](../Images/5f757b54b8113b34e602f5c2cef47590.png)

本教程从头开始使用 NumPy 在 Python 中构建人工神经网络，以对 Fruits360 数据集进行图像分类应用。本教程中使用的所有内容（即图像和源代码），除了彩色 Fruits360 图像外，均为我书中的专有权利，书名为***“Ahmed Fawzy Gad《使用深度学习与 CNNs 的实用计算机视觉应用》”。2018 年 12 月，Apress，978-1-4842-4167-7***。这本书在 Springer 上可以找到，链接为：[https://springer.com/us/book/9781484241660](https://springer.com/us/book/9781484241660)。

本教程中使用的源代码可以在我的 GitHub 页面找到：[https://github.com/ahmedfgad/NumPyANN](https://github.com/ahmedfgad/NumPyANN)

本书中使用的示例涉及使用人工神经网络 (ANN) 对 Fruits360 图像数据集进行分类。该示例并未假设读者已经提取了特征或实现了 ANN，因为它讨论了适合使用的特征集是什么，并且如何从头开始在 NumPy 中实现 ANN。Fruits360 数据集包含60种水果，如苹果、番石榴、鳄梨、香蕉、樱桃、枣、猕猴桃、桃子等。为了简化问题，本示例只处理4个选定类别：Braeburn 苹果、Meyer 柠檬、芒果和覆盆子。每个类别大约有491张训练图像和162张测试图像。图像大小为100x100像素。

### 特征提取

这本书从选择合适的特征集开始，以实现最高的分类准确率。根据下面显示的4个选定类别的样本图像，它们的颜色似乎不同。这就是为什么颜色特征适合用于此任务的原因。

![](../Images/5144782453ae88a2f3f04a8244732c5f.png)

RGB 颜色空间不能将颜色信息与其他类型的信息（如光照）隔离。因此，如果使用 RGB 表示图像，则三个通道都会参与计算。因此，使用一个将颜色信息隔离到单个通道中的颜色空间（如 HSV）会更好。在这种情况下，颜色通道是色相通道（H）。下图显示了之前展示的四个样本的色相通道。我们可以注意到每张图像的色相值与其他图像不同。

![](../Images/95d2d57c5c54bab7efe5c74f5d9c5d5f.png)

色调通道的大小仍为 100x100。如果整个通道应用于 ANN，那么输入层将有 10,000 个神经元。网络仍然非常庞大。为了减少使用的数据量，我们可以使用直方图来表示色调通道。该直方图将有 360 个箱子，反映色调值的可能值数量。以下是 4 张样本图像的直方图。使用 360 个箱子的色调通道直方图时，似乎每个水果都投票给直方图中的某些特定箱子。与使用 RGB 色彩空间中的任何通道相比，不同类别之间的重叠较少。例如，苹果直方图中的箱子范围从 0 到 10，而芒果的箱子范围从 90 到 110。每个类别之间的间隔使得减少分类模糊性变得更容易，从而提高预测准确性。

![](../Images/6e96815abd2c84e2d0d8b6e32f3d197c.png)

这是从 4 张图像计算色调通道直方图的代码。

[PRE0]

通过遍历所用的 4 个图像类别中的所有图像，我们可以从所有图像中提取特征。下面的代码执行了这一操作。根据 4 个类别中的图像数量（1,962）以及从每张图像中提取的特征向量长度（360），创建了一个全零的 NumPy 数组，并保存在 **dataset_features** 变量中。为了存储每张图像的类别标签，创建了另一个名为 **outputs** 的 NumPy 数组。苹果的类别标签是 0，柠檬是 1，芒果是 2，覆盆子是 3。代码期望在根目录中运行，其中有 4 个文件夹，文件夹名称与列表 **fruits** 中列出的水果名称相对应。它遍历所有文件夹中的所有图像，提取每张图像的色调直方图，为每张图像分配一个类别标签，最后使用 pickle 库保存提取的特征和类别标签。你也可以使用 NumPy 保存结果 NumPy 数组，而不是 pickle。

[PRE1]

目前，每个图像使用一个包含 360 个元素的特征向量来表示。这些元素经过筛选，以仅保留最相关的元素用于区分 4 个类别。减少后的特征向量长度为 102 而不是 360。使用较少的元素有助于加快训练速度。**dataset_features** 变量的形状将是 **1962x102**。有关减少特征向量长度的更多信息，可以参考书籍。

到目前为止，训练数据（特征和类别标签）已经准备好了。接下来是使用 NumPy 实现人工神经网络（ANN）。

* * *

## 我们的前三个课程推荐

![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 1\. [谷歌网络安全证书](https://www.kdnuggets.com/google-cybersecurity) - 快速进入网络安全职业的快车道。

![](../Images/e225c49c3c91745821c8c0368bf04711.png) 2\. [谷歌数据分析专业证书](https://www.kdnuggets.com/google-data-analytics) - 提升你的数据分析技能

![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 3\. [谷歌IT支持专业证书](https://www.kdnuggets.com/google-itsupport) - 支持您的组织在IT方面

* * *

### 更多相关话题

+   [成为优秀数据科学家所需的5项关键技能](https://www.kdnuggets.com/2021/12/5-key-skills-needed-become-great-data-scientist.html)

+   [每个初学者数据科学家都应该掌握的6种预测模型](https://www.kdnuggets.com/2021/12/6-predictive-models-every-beginner-data-scientist-master.html)

+   [2021年最佳ETL工具](https://www.kdnuggets.com/2021/12/mozart-best-etl-tools-2021.html)

+   [使用管道编写干净的Python代码](https://www.kdnuggets.com/2021/12/write-clean-python-code-pipes.html)

+   [使用卷积神经网络（CNNs）进行图像分类](https://www.kdnuggets.com/2022/05/image-classification-convolutional-neural-networks-cnns.html)

+   [停止学习数据科学以寻找目标，并找到目标后再…](https://www.kdnuggets.com/2021/12/stop-learning-data-science-find-purpose.html)
