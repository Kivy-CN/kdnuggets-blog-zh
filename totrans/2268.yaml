- en: Deep Learning with R
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://www.kdnuggets.com/2023/05/deep-learning-r.html](https://www.kdnuggets.com/2023/05/deep-learning-r.html)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: '![Deep Learning with R](../Images/a12e3fec2c14e7244e1ca348fa621207.png)'
  prefs: []
  type: TYPE_IMG
- en: Image from Bing Image Creator
  prefs: []
  type: TYPE_NORMAL
- en: Introduction
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '* * *'
  prefs: []
  type: TYPE_NORMAL
- en: Our Top 3 Course Recommendations
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 1\. [Google Cybersecurity
    Certificate](https://www.kdnuggets.com/google-cybersecurity) - Get on the fast
    track to a career in cybersecurity.'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/e225c49c3c91745821c8c0368bf04711.png) 2\. [Google Data Analytics
    Professional Certificate](https://www.kdnuggets.com/google-data-analytics) - Up
    your data analytics game'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 3\. [Google IT Support
    Professional Certificate](https://www.kdnuggets.com/google-itsupport) - Support
    your organization in IT'
  prefs: []
  type: TYPE_NORMAL
- en: '* * *'
  prefs: []
  type: TYPE_NORMAL
- en: Who hasn’t been amused by technological advancements particularly in [artificial
    intelligence](https://saturncloud.io/glossary/artificial-intelligence), from Alexa
    to Tesla self-driving cars and a myriad other innovations? I marvel at the advancements
    every other day but what’s even more interesting is, when you get to have an idea
    of what underpins those innovations. Welcome to [Artificial Intelligence](https://saturncloud.io/glossary/artificial-intelligence) and
    to the endless possibilities of [deep learning](https://saturncloud.io/glossary/deep-learning).
    If you’ve been wondering what it is, then you’re home.
  prefs: []
  type: TYPE_NORMAL
- en: In this tutorial, I’ll deconstruct the terminology and take you through how
    to perform a deep learning task in R. To note, this article will assume that you
    have some basic understanding of [machine learning](https://saturncloud.io/glossary/machine-learning) concepts
    such as [regression](https://saturncloud.io/glossary/regression), classification,
    and [clustering](https://saturncloud.io/glossary/clustering/).
  prefs: []
  type: TYPE_NORMAL
- en: 'Let’s start with definitions of some terminologies surrounding the concept
    of deep learning:'
  prefs: []
  type: TYPE_NORMAL
- en: '[Deep learning](https://saturncloud.io/glossary/deep-learning/) is a branch
    of machine learning that teaches computers to mimic the cognitive functions of
    the human brain. This is achieved through the use of artificial neural networks
    that help to unpack complex patterns in data sets. With deep learning, a computer
    can classify sounds, images, or even texts.'
  prefs: []
  type: TYPE_NORMAL
- en: Before we dive into the specifics of Deep learning, it would be nice to understand
    what machine learning and artificial intelligence are and how the three concepts
    relate to each other.
  prefs: []
  type: TYPE_NORMAL
- en: '[Artificial intelligence](https://saturncloud.io/glossary/artificial-intelligence/):
    This is a branch of computer science that is concerned with the development of
    machines whose functioning mimics the human brain.'
  prefs: []
  type: TYPE_NORMAL
- en: '**Machine learning**: This is a subset of Artificial Intelligence that enables
    computers to learn from data.'
  prefs: []
  type: TYPE_NORMAL
- en: With the above definitions, we now have an idea of how deep learning relates
    to artificial intelligence and machine learning.
  prefs: []
  type: TYPE_NORMAL
- en: The diagram below will help show the relationship.
  prefs: []
  type: TYPE_NORMAL
- en: '![Deep Learning with R](../Images/8a21ab290890dfba333613947867f24f.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Two crucial things to note about deep learning are:'
  prefs: []
  type: TYPE_NORMAL
- en: Requires huge volumes of data
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Requires high-performance computing power
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Neural Networks
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: These are the building blocks of deep learning models. As the name suggests,
    the word neural comes from neurons, just like the neurons of the human brain.
    Actually, the architecture of deep neural networks gets its inspiration from the
    structure of the human brain.
  prefs: []
  type: TYPE_NORMAL
- en: A neural network has an input layer, one hidden layer and an output layer. This
    network is called a shallow neural network. When we have more than one hidden
    layer, it becomes a deep neural network, where the layers could be as many as
    100’s.
  prefs: []
  type: TYPE_NORMAL
- en: The image below shows what a neural network looks like.
  prefs: []
  type: TYPE_NORMAL
- en: '![Deep Learning with R](../Images/fad2d6bb6d4d335f1f11aa3f711f9608.png)'
  prefs: []
  type: TYPE_IMG
- en: This brings us to the question of how to build deep learning models in R? Enter
    kera!
  prefs: []
  type: TYPE_NORMAL
- en: '[Keras](https://saturncloud.io/glossary/Keras) is an open-source deep learning
    library that makes it easy to use neural networks in machine learning. This library
    is a wrapper that uses [TensorFlow](https://saturncloud.io/glossary/tensorflow/)
    as a backend engine. However, there are other options for the backend such as
    Theano or CNTK.'
  prefs: []
  type: TYPE_NORMAL
- en: Let us now install both [TensorFlow](https://saturncloud.io/glossary/tensorflow)
    and Keras.
  prefs: []
  type: TYPE_NORMAL
- en: Start with creating a virtual environment using reticulate
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: Now that our configurations are set, we can head over to how we can use deep
    learning to solve a classification problem.
  prefs: []
  type: TYPE_NORMAL
- en: Brief about the Data
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: The data I’ll use for this tutorial is from an ongoing Salary Survey done by [https://www.askamanager.org](https://www.askamanager.org/).
  prefs: []
  type: TYPE_NORMAL
- en: The main question asked in the form is how much money do you make, plus a couple
    of more details such as industry, age, years of experience, etc. The details are
    collected into a Google sheet from which I obtained the data.
  prefs: []
  type: TYPE_NORMAL
- en: The problem we want to solve with data is to be able to come up with a deep
    learning model that predicts how much someone could potentially earn given information
    such as age, gender, years of experience, and highest level of education.
  prefs: []
  type: TYPE_NORMAL
- en: Load the libraries that we’ll require.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs: []
  type: TYPE_PRE
- en: Import the data
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE2]'
  prefs: []
  type: TYPE_PRE
- en: Select the columns that we need
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE3]'
  prefs: []
  type: TYPE_PRE
- en: Data Cleaning
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Remember the computer science GIGO concept? (Garbage in Garbage Out). Well,
    this concept is perfectly applicable here as it is in other domains. The results
    of our training will largely depend on the quality of the data we use. This is
    what brings data cleaning and transformation, a critical step in any [Data Science](https://saturncloud.io/glossary/data-science)
    project.
  prefs: []
  type: TYPE_NORMAL
- en: Some of the key issues data cleaning seeks to address are; consistency, missing
    values, spelling issues, outliers, and data types. I won’t go into the details
    on how those issues are tackled and this is for the simple reason of not wanting
    to digress from the subject matter of this article. Therefore, I’ll use the cleaned
    version of the data but if you’re interested in knowing how the cleaning bit was
    handled, check this article out.
  prefs: []
  type: TYPE_NORMAL
- en: Data Transformations
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Artificial neural networks accept numeric variables only and seeing that some
    of our variables are of categorical nature, we will need to encode such into numbers.
    This is what forms part of the [data preprocessing](https://saturncloud.io/glossary/data-preprocessing) step,
    which is necessary because more often than not, you won’t get data that is ready
    for modeling.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE4]'
  prefs: []
  type: TYPE_PRE
- en: Seeing that we want to solve a classification, we need to categorize the annual
    salary into two classes so that we use it as the response variable.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE5]'
  prefs: []
  type: TYPE_PRE
- en: Split the Data
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: As in the basic machine learning approaches; regression, classification, and
    clustering, we will need to split our data into training and testing sets. We
    do this using the 80-20 rules, which is 80% of the dataset for training and 20%
    for testing. This is not cast on stones, as you can decide to use any split ratios
    as you see fit, but keep in mind that the training set should have a good share
    of the percentages.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE6]'
  prefs: []
  type: TYPE_PRE
- en: Keras takes in inputs in the form of matrices or arrays. We use the as.matrix
    function for the conversion. Also, we need to scale the predictor variables and
    then we convert the response variable to categorical data type.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE7]'
  prefs: []
  type: TYPE_PRE
- en: Instantiate the model
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Create a sequential model onto which we’ll add layers using the pipe operator.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE8]'
  prefs: []
  type: TYPE_PRE
- en: Configure the Layers
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'The **input_shape** specifies the shape of the input data. In our case, we
    have obtained that using the **ncol** function. **activation**: Here we specify
    the activation function; a mathematical function that transforms the output to
    a desired non-linear format before passing it to the next layer.'
  prefs: []
  type: TYPE_NORMAL
- en: '**units**: the number of neurons in each layer of the neural network.'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE9]'
  prefs: []
  type: TYPE_PRE
- en: Configure the Model Learning Process
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: We use the compile method to do this. The function takes three arguments;
  prefs: []
  type: TYPE_NORMAL
- en: '**optimizer** : This object specifies the training procedure. **loss** : This
    is the function to minimize during optimization. Options available are mse (mean
    square error), binary_crossentropy and categorical_crossentropy.'
  prefs: []
  type: TYPE_NORMAL
- en: '**metrics** : What we use to monitor the training. Accuracy for classification
    problems.'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE10]'
  prefs: []
  type: TYPE_PRE
- en: Model Fitting
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'We can now fit the model using the fit method from Keras. Some of the arguments
    that fit takes in are:'
  prefs: []
  type: TYPE_NORMAL
- en: '**epochs** : An epoch is an iteration over the training dataset.'
  prefs: []
  type: TYPE_NORMAL
- en: '**batch_size** : The model slices the matrix/array passed to it into smaller
    batches over which it iterates during training.'
  prefs: []
  type: TYPE_NORMAL
- en: '**validation_split** : Keras will need to slice a portion of the training data
    to obtain a validation set that will be used to evaluate model performance for
    each epoch.'
  prefs: []
  type: TYPE_NORMAL
- en: '**shuffle** : Here you Indicate whether you want to shuffle your training data
    before each epoch.'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE11]'
  prefs: []
  type: TYPE_PRE
- en: Evaluate the model
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: To obtain the accuracy value of the model use the evaluate function as below.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE12]'
  prefs: []
  type: TYPE_PRE
- en: Prediction
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: To predict on new data use the predict_classes function from keras library as
    below.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE13]'
  prefs: []
  type: TYPE_PRE
- en: Conclusion
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: This article has taken you through the basics of deep learning with Keras in
    R. You’re welcome to dive deeper for better understanding, play around with the
    parameters, get your hands dirty with data preparation, and perhaps scale the
    computations by leveraging the power of cloud computing.
  prefs: []
  type: TYPE_NORMAL
- en: '**[Clinton Oyogo](https://www.linkedin.com/in/oyogo-clinton-53359198/)** writer
    at [Saturn Cloud](https://saturncloud.io/) believes that analyzing data for actionable
    insights is a crucial part of his day-to-day work. With his skills in data visualization,
    data wrangling, and machine learning, he takes pride in his work as a data scientist.'
  prefs: []
  type: TYPE_NORMAL
- en: '[Original](https://saturncloud.io/blog/deep-learning-with-r/). Reposted with
    permission.'
  prefs: []
  type: TYPE_NORMAL
- en: More On This Topic
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: '[A Solid Plan for Learning Data Science, Machine Learning, and Deep Learning](https://www.kdnuggets.com/2023/01/mwiti-solid-plan-learning-data-science-machine-learning-deep-learning.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[AI, Analytics, Machine Learning, Data Science, Deep Learning…](https://www.kdnuggets.com/2021/12/developments-predictions-ai-machine-learning-data-science-research.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[15 Free Machine Learning and Deep Learning Books](https://www.kdnuggets.com/2022/10/15-free-machine-learning-deep-learning-books.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[KDnuggets News, November 2: The Current State of Data Science…](https://www.kdnuggets.com/2022/n43.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[15 More Free Machine Learning and Deep Learning Books](https://www.kdnuggets.com/2022/11/15-free-machine-learning-deep-learning-books.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Using Datawig, an AWS Deep Learning Library for Missing Value Imputation](https://www.kdnuggets.com/2021/12/datawig-aws-deep-learning-library-missing-value-imputation.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
