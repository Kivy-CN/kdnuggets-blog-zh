# 使用PuLP的Python中的线性规划与离散优化

> 原文：[https://www.kdnuggets.com/2019/05/linear-programming-discrete-optimization-python-pulp.html](https://www.kdnuggets.com/2019/05/linear-programming-discrete-optimization-python-pulp.html)

![c](../Images/3d9c022da2d331bb56691a9617b91b90.png) [评论](/2019/05/linear-programming-discrete-optimization-python-pulp.html?page=2#comments)

### 介绍

[离散优化](https://neos-guide.org/optimization-tree)是优化方法学的一个分支，处理离散量，即非连续函数。它在诸如[金融投资](https://study.com/academy/lesson/financial-applications-of-linear-programs-for-portfolio-selection-financial-planning-financial-mix-strategy.html)、[饮食规划](https://neos-guide.org/content/diet-problem)、[制造过程](https://www.quora.com/How-do-I-solve-a-manufacturing-problem-in-linear-programming)和[专业体育的球员或赛程选择](https://www2.cs.duke.edu/courses/fall10/cps296.1/joe_siyang.pdf)等应用中非常普遍。

**线性和（混合）整数规划**是解决可以在离散优化框架内制定的问题的技术。

* * *

## 我们的三大课程推荐

![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 1\. [Google 网络安全证书](https://www.kdnuggets.com/google-cybersecurity) - 快速进入网络安全职业轨道。

![](../Images/e225c49c3c91745821c8c0368bf04711.png) 2\. [Google 数据分析专业证书](https://www.kdnuggets.com/google-data-analytics) - 提升你的数据分析技能。

![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 3\. [Google IT 支持专业证书](https://www.kdnuggets.com/google-itsupport) - 支持组织的IT工作。

* * *

了解这些优化技术对数据科学家和机器学习（ML）从业者非常有用，因为离散和连续优化是现代ML和AI系统的核心，以及[数据驱动的商业分析流程](https://www.edx.org/course/optimization-methods-business-analytics-mitx-15-053x)。

> 虽然有许多商业优化工具，但亲自体验程序化的优化方式是无价的。

[强大而高效的求解器的理论发展有着悠久而丰富的历史](https://www.math.uni-bielefeld.de/documenta/vol-ismp/25_bixby-robert.pdf)。然而，着眼于实际应用，我们将跳过这些历史，直接进入学习如何使用程序化工具来制定和解决这类优化问题的部分。

Python中有许多优秀的优化包。在这篇文章中，我们将专门讨论**PuLP**。但在进入Python库之前，让我们先了解一下我们可以用它解决的问题类型。

### 一个或两个示例问题

假设你**负责高中午餐的饮食计划**。你的工作是确保学生从所选食品中获得适当的营养平衡。

![figure-name](../Images/cc1791bd3331a710354cda68b1034bf5.png)

然而，在预算和饮食中需要的食品种类方面存在一些限制，以使其保持趣味性。下表详细展示了每种食品的完整营养价值以及其最大/最小每日摄入量。

![figure-name](../Images/80504d2fed858a2034654b5f912068ff.png)

> 离散优化问题很简单：**在这些约束条件下最小化午餐成本**（不仅限于总卡路里，还包括每种营养成分，如胆固醇、维生素 A、钙等）。

实质上，用一种随意的数学语言描述，这个问题是，

![figure-name](../Images/b3f4683b5a2bee3460a4f052d1062356.png)

注意这些不等式关系都是线性的，即变量***f***由常数系数乘积，结果项由常数限制界定，这使得该问题可以用线性规划（LP）技术解决。

你可以想象，这种问题在**商业战略**中可能非常频繁出现。与营养值不同，你将会处理利润和其他类型的商业收益，而价格/份量可能会变成以千美元计的项目成本。作为经理，你的工作是选择那些在不超过项目总预算的情况下能带来最大投资回报的项目。

![figure-name](../Images/b158cff8a7351caa31c5d982227b7f36.png)

类似的优化问题也可能出现在**工厂生产计划**中，其中最大生产能力将是所用机器的函数，而各个产品将具有不同的利润特性。作为生产工程师，你的工作可能是仔细分配机器和劳动力资源，以最大化利润，同时满足所有的产能约束。

![figure-name](../Images/4526a207f2070ab0d3104d4136f95403.png)

从根本上说，这些来自不同领域的问题的共同点在于，它们涉及在一组线性***目标函数***约束下最大化或最小化一个线性***目标函数***。

对于饮食问题，目标函数是总成本，我们试图最小化它。约束条件由每种营养成分的最小值和最大值给出。

### PuLP — 一个用于线性优化的 Python 库

Python 生态系统中有许多库用于这类优化问题。**PuLP** 是一个开源的[**线性规划**](https://en.wikipedia.org/wiki/Linear_programming)（LP）包，主要使用 Python 语法，并配备了许多行业标准的求解器。它还与各种开源和商业 LP 求解器良好集成。

你可以通过 pip 安装它（以及一些额外的求解器）

```py
$ sudo pip install pulp            *# PuLP*
$ sudo apt-get install glpk-utils  *# GLPK*
$ sudo apt-get install coinor-cbc  *# CoinOR*

```

[有关安装和测试的详细说明在此](https://pythonhosted.org/PuLP/index.html)。然后，只需从库中导入所有内容。

```py
from pulp import *

```

查看解决线性规划问题的精彩视频。

### **如何表述优化问题？**

首先，我们使用 PuLP 中的 `**LpProblem**` 方法创建一个 LP 问题。

```py
prob = LpProblem("Simple Diet Problem",LpMinimize)

```

然后，我们需要创建一批 [Python 字典](https://www.kdnuggets.com/2019/12/python-dictionary-methods.html) 对象，包含我们从表中获得的信息。代码如下，

```py
# Read the first few rows dataset in a Pandas DataFrame
# Read only the nutrition info not the bounds/constraints
df = pd.read_excel("diet - medium.xls",nrows=17)

# Create a list of the food items
food_items = list(df['Foods'])

# Create a dictinary of costs for all food items
costs = dict(zip(food_items,df['Price/Serving']))

# Create a dictionary of calories for all food items
calories = dict(zip(food_items,df['Calories']))

# Create a dictionary of total fat for all food items
fat = dict(zip(food_items,df['Total_Fat (g)']))

# Create a dictionary of carbohydrates for all food items
carbs = dict(zip(food_items,df['Carbohydrates (g)']))

```

为了简洁，我们在此未显示完整代码。你可以获取所有营养成分并为它们创建单独的字典。

然后，我们创建一个食物项变量的字典，**下界 = 0** 和 **类别连续**，即优化解可以取任何大于零的实数值。

请注意下界的重要性。

> 在我们看来，食物的任何部分都不可能是负数或无限数量，但数学并不知道这一点。

如果没有明确声明这一界限，解决方案可能会变得毫无意义，因为求解器可能会尝试提出负数量的食物选择来减少总成本，同时仍满足营养要求！

```py
food_vars = LpVariable.dicts("Food",food_items,lowBound=0,cat='Continuous')

```

接下来，我们开始通过添加主要目标函数来构建 LP 问题。请注意使用了`**lpSum**` 方法。

```py
prob += lpSum([costs[i]*food_vars[i] for i in food_items])

```

我们进一步通过添加卡路里约束来构建这个模型，

```py
prob += lpSum([calories[f] * food_vars[f] for f in food_items]) >= 800.0
prob += lpSum([calories[f] * food_vars[f] for f in food_items]) <= 1300.0

```

我们可以将所有营养约束堆积在一起。为了简化，我们仅添加了四个关于脂肪、碳水化合物、纤维和蛋白质的约束。代码如下，

```py
# Fat
prob += lpSum([fat[f] * food_vars[f] for f in food_items]) >= 20.0, "FatMinimum"
prob += lpSum([fat[f] * food_vars[f] for f in food_items]) = 130.0, "CarbsMinimum"
prob += lpSum([carbs[f] * food_vars[f] for f in food_items]) = 60.0, "FiberMinimum"
prob += lpSum([fiber[f] * food_vars[f] for f in food_items]) = 100.0, "ProteinMinimum"
prob += lpSum([protein[f] * food_vars[f] for f in food_items]) <= 150.0, "ProteinMaximum"

```

我们已经完成了问题的表述！

> 在任何优化场景中，难点在于将问题以结构化的方式进行表述，这种方式是求解器能够接受的。

我们已经完成了困难的部分。现在，运行求解器并检查解决方案就是相对简单的部分了。

### 更多相关主题

+   [线性规划 101：数据科学家的入门指南](https://www.kdnuggets.com/2023/02/linear-programming-101-data-scientists.html)

+   [超参数优化：10 个顶级 Python 库](https://www.kdnuggets.com/2023/01/hyperparameter-optimization-10-top-python-libraries.html)

+   [3 种基于研究的高级提示技术提高 LLM 效率……](https://www.kdnuggets.com/3-research-driven-advanced-prompting-techniques-for-llm-efficiency-and-speed-optimization)

+   [使用 TPOT 优化机器学习管道](https://www.kdnuggets.com/2021/05/machine-learning-pipeline-optimization-tpot.html)

+   [SQL 查询优化技术](https://www.kdnuggets.com/2023/03/sql-query-optimization-techniques.html)

+   [数据库优化：SQL 中的索引探索](https://www.kdnuggets.com/2023/07/database-optimization-exploring-indexes-sql.html)
