- en: Microsoft’s DoWhy is a Cool Framework for Causal Inference
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://www.kdnuggets.com/2020/08/microsoft-dowhy-framework-causal-inference.html](https://www.kdnuggets.com/2020/08/microsoft-dowhy-framework-causal-inference.html)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: '[comments](#comments)![Figure](../Images/27984cc5951ff202de0bcd5f9a01e9b0.png)'
  prefs: []
  type: TYPE_NORMAL
- en: Source: [https://www.microsoft.com/en-us/research/blog/dowhy-a-library-for-causal-inference/](https://www.microsoft.com/en-us/research/blog/dowhy-a-library-for-causal-inference/)
  prefs: []
  type: TYPE_NORMAL
- en: 'I recently started a new newsletter focus on AI education. TheSequence is a
    no-BS( meaning no hype, no news etc) AI-focused newsletter that takes 5 minutes
    to read. The goal is to keep you up to date with machine learning projects, research
    papers and concepts. Please give it a try by subscribing below:'
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: '[![Image](../Images/f2aed90f956dea213be7c9bbf9cd7072.png)](https://thesequence.substack.com/)'
  prefs: []
  type: TYPE_NORMAL
- en: The human mind has a remarkable ability to associate causes with a specific
    event. From the outcome of an election to an object dropping on the floor, we
    are constantly associating chains of events that cause a specific effect. Neuropsychology
    refers to this cognitive ability as causal reasoning. Computer science and economics
    study a specific form of causal reasoning known as causal inference which focuses
    on exploring relationships between two observed variables. Over the years, machine
    learning has produced many methods for causal inference but they remain mostly
    difficult to use in mainstream applications. Recently, Microsoft Research [open
    sourced DoWhy](https://github.com/Microsoft/dowhy), a framework for causal thinking
    and analysis.
  prefs: []
  type: TYPE_NORMAL
- en: 'The challenge with causal inference is not that is a new discipline, quite
    the opposite, but that the current methods represent a very small and simplistic
    version of causal reasoning. Most models that try to connect causes such as linear
    regression rely on empirical analysis that makes some assumption about the data.
    Pure causal inference relies on counterfactual analysis which is a closer representation
    to how humans make decisions. Imagine a scenario in which you are traveling with
    your families for vacations to an unknown destination. Before and after the vacation
    you are wrestling with a few counterfactual questions:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Image for post](../Images/ffba3fde7fced1bc9c40aed9bda8c03f.png)'
  prefs: []
  type: TYPE_IMG
- en: Answering these questions is the focus of causal inference. Unlike supervised
    learning, causal inference depends on estimation of unobserved quantities. This
    if often known as the “fundamental problem” of causal inference which implies
    that a model never has a purely objective evaluation through a held-out test set.
    In our vacation example, you can either observe the effects on going on vacation
    or not going on vacations but never both. This challenge forces causal inference
    to make critical assumptions about the data generation process. Traditional machine
    learning frameworks for causal inference try to take shortcuts around the “fundamental
    problem” resulting on a very frustrating experience for data scientists and developers.
  prefs: []
  type: TYPE_NORMAL
- en: Introducing DoWhy
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: '[*Microsoft’s DoWhy*](https://github.com/Microsoft/dowhy)* is a Python-based
    library for causal inference and analysis that attempts to streamline the adoption
    of causal reasoning in machine learning applications. Inspired by Judea Pearl’s
    do-calculus for causal inference, DoWhy combines several causal inference methods
    under a simple programming model that removes many of the complexities of traditional
    approaches. Compared to its predecessors, DoWhy makes three key contributions
    to the implementation of causal inference models.*'
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Provides a principled way of modeling a given problem as a causal graph so that
    all assumptions explicit.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Provides a unified interface for many popular causal inference methods, combining
    the two major frameworks of graphical models and potential outcomes.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Automatically tests for the validity of assumptions if possible and assesses
    robustness of the estimate to violations.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Conceptually, DoWhy was created following two guiding principles: asking causal
    assumptions explicit and testing robustness of the estimates to violations of
    those assumptions. In other words, DoWhy separates the identification of a causal
    effect from the estimation of its relevance which enables the inference of very
    sophisticated causal relationships.'
  prefs: []
  type: TYPE_NORMAL
- en: 'To accomplish its goal, DoWhy models any causal inference problem in a workflow
    with four fundamental steps: model, identify, estimate and refute.'
  prefs: []
  type: TYPE_NORMAL
- en: '![Image for post](../Images/b55878179e0fa1b2292042e7d5ac64b0.png)'
  prefs: []
  type: TYPE_IMG
- en: '**Model:** DoWhy models each problem using a graph of causal relationships.
    The current version of DoWhy supports two formats for graph input: [gml](http://www.fim.uni-passau.de/index.php?id=17297&L=1) (preferred)
    and [dot](http://www.graphviz.org/documentation/). The graph might include prior
    knowledge of the causal relationships in the variables but DoWhy does not make
    any immediate assumptions.'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '**Identify:** Using the input graph, DoWhy finds all possible ways of identifying
    a desired causal effect based on the graphical model. It uses graph-based criteria
    and do-calculus to find potential ways find expressions that can identify the
    causal effect'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '**Estimate:** DoWhy estimates the causal effect using statistical methods such
    as matching or instrumental variables. The current version of DoWhy supports estimation
    methods based such as propensity-based-stratification or propensity-score-matching
    that focus on estimating the treatment assignment as well as regression techniques
    that focus on estimating the response surface.'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '**Verify:** Finally, DoWhy uses different robustness methods to verify the
    validity of the causal effect.'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Using DoWhy
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: 'Developers can start using DoWhy by installing the Python module using the
    following command:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: Like any other machine learning program, the first step of a DoWhy application
    is to load the dataset. In this example, imagine that we are trying to infer the
    correlation between different medical treatments and outcomes represented by the
    following dataset.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs: []
  type: TYPE_PRE
- en: 'DoWhy relies on pandas dataframes to capture the input data:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE2]'
  prefs: []
  type: TYPE_PRE
- en: 'At this point, we simply need about four steps to infer causal relationships
    between the variables. The four steps correspond to the four operations of DoWhy:
    model, estimate, infer and refute. We can start by modeling the problem as a causal
    graph:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE3]'
  prefs: []
  type: TYPE_PRE
- en: '![Figure](../Images/81e4efbfb3e0988df9ae8b3da5f9812f.png)'
  prefs: []
  type: TYPE_IMG
- en: Source: [https://microsoft.github.io/dowhy/](https://microsoft.github.io/dowhy/)
  prefs: []
  type: TYPE_NORMAL
- en: 'The next step is to identify the causal relationships in the graph:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE4]'
  prefs: []
  type: TYPE_PRE
- en: 'Now we can estimate the causal effect and determine if the estimation is correct.
    This example uses linear regression for simplicity:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE5]'
  prefs: []
  type: TYPE_PRE
- en: '![Figure](../Images/7c60ca71247bc9e15574a17f6f6fe6ea.png)'
  prefs: []
  type: TYPE_IMG
- en: Source: [https://microsoft.github.io/dowhy/](https://microsoft.github.io/dowhy/)
  prefs: []
  type: TYPE_NORMAL
- en: 'Finally, we can use different technique to refute the causal estimator:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE6]'
  prefs: []
  type: TYPE_PRE
- en: DoWhy is a very simple and useful framework to implement causal inference models.
    The current version can be used as a standalone library or integrated into popular
    deep learning frameworks such as TensorFlow or PyTorch. The combination of multiple
    causal inference methods under a single framework and the four-step simple programming
    model makes DoWhy incredibly simple to use for data scientist tackling causal
    inference problems.
  prefs: []
  type: TYPE_NORMAL
- en: '[Original](https://medium.com/dataseries/microsofts-dowhy-is-a-cool-framework-for-causal-inference-d14013657f35).
    Reposted with permission.'
  prefs: []
  type: TYPE_NORMAL
- en: '**Related:**'
  prefs: []
  type: TYPE_NORMAL
- en: '[Facebook Uses Bayesian Optimization to Conduct Better Experiments in Machine
    Learning Models](/2020/08/facebook-bayesian-optimization-better-experiments-machine-learning.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Learning by Forgetting: Deep Neural Networks and the Jennifer Aniston Neuron](/2020/06/learning-forgetting-deep-neural-networks-jennifer-aniston.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Netflix’s Polynote is a New Open Source Framework to Build Better Data Science
    Notebooks](/2020/08/netflix-polynote-open-source-framework-better-data-science-notebooks.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '* * *'
  prefs: []
  type: TYPE_NORMAL
- en: Our Top 3 Course Recommendations
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 1\. [Google Cybersecurity
    Certificate](https://www.kdnuggets.com/google-cybersecurity) - Get on the fast
    track to a career in cybersecurity.'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/e225c49c3c91745821c8c0368bf04711.png) 2\. [Google Data Analytics
    Professional Certificate](https://www.kdnuggets.com/google-data-analytics) - Up
    your data analytics game'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 3\. [Google IT Support
    Professional Certificate](https://www.kdnuggets.com/google-itsupport) - Support
    your organization in IT'
  prefs: []
  type: TYPE_NORMAL
- en: '* * *'
  prefs: []
  type: TYPE_NORMAL
- en: More On This Topic
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: '[Unify Batch and ML Systems with Feature/Training/Inference Pipelines](https://www.kdnuggets.com/2023/09/hopsworks-unify-batch-ml-systems-feature-training-inference-pipelines)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Risk Management Framework for AI/ML Models](https://www.kdnuggets.com/2022/03/risk-management-framework-aiml-models.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Social User Authentication in Django Framework](https://www.kdnuggets.com/2023/01/social-user-authentication-django-framework.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[The Only Prompting Framework for Every Use](https://www.kdnuggets.com/the-only-prompting-framework-for-every-use)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Free Microsoft Excel for Beginners Course](https://www.kdnuggets.com/2022/09/free-microsoft-excel-beginners-course.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Visual ChatGPT: Microsoft Combine ChatGPT and VFMs](https://www.kdnuggets.com/2023/03/visual-chatgpt-microsoft-combine-chatgpt-vfms.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
