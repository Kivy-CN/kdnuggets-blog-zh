# 我在Python中从零实现分类器的所学

> 原文：[https://www.kdnuggets.com/2017/02/learned-implementing-classifier-scratch-python.html](https://www.kdnuggets.com/2017/02/learned-implementing-classifier-scratch-python.html)

**作者：Jean-Nicholas Hould，[JeanNicholasHould.com](http://JeanNicholasHould.com/?utm_source=kdnugget)。**

> 本文是作者[《学习机器学习》](http://www.jeannicholashould.com/learning-machine-learning.html)系列的一部分。内容基于[《Python机器学习》](https://www.amazon.com/gp/product/1783555130/ref=as_li_tl?ie=UTF8&camp=1789&creative=9325&creativeASIN=1783555130&linkCode=as2&tag=nickhould-20&linkId=79334fab95b99f2021c47f06697c40c3)的第1章和第2章。

* * *

## 我们的前三大课程推荐

![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 1\. [谷歌网络安全证书](https://www.kdnuggets.com/google-cybersecurity) - 快速入门网络安全职业生涯。

![](../Images/e225c49c3c91745821c8c0368bf04711.png) 2\. [谷歌数据分析专业证书](https://www.kdnuggets.com/google-data-analytics) - 提升你的数据分析能力

![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 3\. [谷歌IT支持专业证书](https://www.kdnuggets.com/google-itsupport) - 支持你的组织进行IT管理

* * *

对新手来说，机器学习可能会让人感到畏惧。机器学习独自工作的概念相当抽象。这在实际操作中是如何运作的呢？

为了揭开机器学习算法背后的神秘面纱，我决定从零实现一个简单的机器学习算法。我不会使用像*scikit-learn*这样已经实现了许多算法的库。相反，我会编写所有代码，以实现一个工作的二元分类器算法。这个练习的目标是理解其内部运作。

### 那么，什么是二元分类器？

分类器是一种机器学习算法，根据一组特征确定输入元素的类别。例如，可以使用分类器预测一瓶啤酒的类别，基于其特征。这些特征可能包括其酒精含量、香气、外观等。机器学习分类器可以用来预测一瓶8%酒精含量、100 IBU并具有强烈橙子香气的啤酒是一种印度淡色艾尔。

在机器学习中，有三种主要任务类型：无监督学习、监督学习和强化学习。分类器算法属于监督学习类别。监督学习意味着我们事先知道正确答案。期望的输出是已知的。在啤酒的例子中，我们可以现实地拥有一个描述啤酒及其类别的数据集。我们可以训练分类器算法来预测这些类别，基于啤酒的特征。

二分类器将元素分为两组。零或一。真或假。IPA或非IPA。

### 构建机器学习模型

构建和使用机器学习模型有四个步骤。

1.  预处理

1.  学习

1.  评估

1.  预测

![](../Images/ab50ecd3646752080fe903493cb7c77b.png)

来源：[Python机器学习](https://www.amazon.com/gp/product/1783555130/ref=as_li_tl?ie=UTF8&camp=1789&creative=9325&creativeASIN=1783555130&linkCode=as2&tag=nickhould-20&linkId=79334fab95b99f2021c47f06697c40c3) 作者：塞巴斯蒂安·拉什卡。

### 预处理

预处理是构建机器学习模型的第一步。在这一步，你获取并准备数据以供未来使用。你清理数据，整理数据，并从中选择你想要使用的特征。

以下任务可以被视为“预处理”的一部分：

+   从原始数据中提取特征

+   清理和格式化数据

+   移除多余的特征（或高度相关的特征）

+   减少特征数量以提高性能

+   标准化特征数据的范围（也称为[特征缩放](https://en.wikipedia.org/wiki/Feature_scaling)）

+   随机划分你的数据集：训练数据集和测试数据集

### 学习或训练

一旦你的数据集准备好使用，第二步是选择一个算法来执行你期望的任务。在我们的例子中，我们选择的算法是一个叫做感知器的二分类器。有许多算法被设计用来执行不同的任务。它们各有优缺点。

在这一步，你可以测试一些算法，查看它们的表现，并选择表现最好的一个。有多种指标可以用来衡量机器学习模型的性能。根据Raschka的说法，“一个常用的指标是分类准确率，它被定义为正确分类实例的比例”。在这一步，你将对机器学习算法的参数进行调整，这些参数被称为超参数。

在这篇文章中，我们将主要关注机器学习工作流的这一部分。我们将深入探讨算法的内部工作原理。如果你对机器学习工作流的其他部分感兴趣，我会在文章末尾链接到一个很棒的笔记本。

### 评估

当模型在数据集上“训练”完成后，它可以在新的未见数据上进行评估。这里的目标是测量[泛化误差](https://en.wikipedia.org/wiki/Generalization_error)。这个指标测量“算法在对之前未见数据进行预测时的准确性”。一旦你对结果满意，你可以使用你的机器学习模型进行预测。

### 介绍感知器

我们将重新实现的算法是[感知器](https://en.wikipedia.org/wiki/Perceptron)，这是最早的机器学习算法之一。

感知器算法简单但强大。给定一个训练数据集，算法会自动学习“最佳权重系数，这些系数与输入特征相乘以决定神经元是否激活”。

但是，算法是如何做到这一点的呢？

### 算法

这是算法的序列：

首先，我们用权重初始化一个数组，初始值为零。数组的长度等于特征的数量加一。这个额外的特征是“阈值”。值得注意的是，对于感知器算法，特征必须是数值型的。

```py
 self.w_ = np.zeros(1 + X.shape[1]) 
```

其次，我们开始一个等于迭代次数`n_iter`的循环。这是数据科学家定义的超参数。

```py
 for _ in range(self.n_iter): 
```

第三，我们对每个训练数据点及其目标进行循环。目标是我们希望算法最终预测的期望输出。由于这是一个二分类器，目标值要么是`-1`，要么是`1`。它们是二进制值。

基于数据点特征，算法将预测类别：`1`或`-1`。预测计算是特征与其相应权重的矩阵乘法。我们在这个乘法结果上加上阈值。如果结果大于0，预测类别是`1`。如果结果小于0，预测类别是`-1`。

在每次数据点的迭代中，如果预测不准确，算法将调整权重。在最初的几次迭代中，预测不太可能准确，因为权重尚未调整多次，它们还没有开始收敛。这些调整是根据目标值和预测值之间的差异进行的。这个差异乘以学习率`eta`，这是一个由数据科学家设定的在零到一之间的超参数。`eta`越高，对权重的修正就越大。如果预测准确，算法不会调整权重。

只有当两个类别线性可分时，感知器才会收敛。简单来说，如果你能画一条直线完全分隔两个类别，算法将会收敛。否则，算法将继续迭代并调整权重，直到达到最大迭代次数`n_iter`。

![](../Images/81a651a78516e9af6e96c47b4ee0f87f.png)

来源：[Python机器学习](https://www.amazon.com/gp/product/1783555130/ref=as_li_tl?ie=UTF8&camp=1789&creative=9325&creativeASIN=1783555130&linkCode=as2&tag=nickhould-20&linkId=79334fab95b99f2021c47f06697c40c3) 作者：Sebastian Raschka。

### 完整代码

来源：[Python机器学习](https://www.amazon.com/gp/product/1783555130/ref=as_li_tl?ie=UTF8&camp=1789&creative=9325&creativeASIN=1783555130&linkCode=as2&tag=nickhould-20&linkId=79334fab95b99f2021c47f06697c40c3) 作者：Sebastian Raschka。

### 三个学习点

### 1\. 学习率、迭代次数与收敛

如 `learning rate` 和 `number of iteration` 这样的参数，如果直接使用像 `scikit-learn` 这样的库中的算法，可能会显得非常抽象。很难理解它们的实际作用。通过实现算法，我现在清楚了它们在感知器（Perceptron）中的含义。

**学习率**

学习率是一个比率，用于在预测不准确时修正权重。这个值需要介于零和一之间。如下面的代码片段所示，`fit` 函数将对每个观察值进行迭代，调用 `predict` 函数，然后根据目标值和预测值之间的差异调整权重，并乘以学习率。

更高的学习率意味着算法将更积极地调整权重。在每次迭代中，如果预测值不准确，权重将被调整。

**迭代次数**

迭代次数是算法遍历训练数据集的次数。如果将迭代次数设置为一，算法将仅遍历一次数据集，并为每个数据点更新一次权重。结果模型很可能不如具有更高迭代次数的模型准确。在大型数据集中，较高的迭代次数是有成本的。

`learning rate` 和 `number of iteration` 是密切相关的。它们需要一起调整。例如，如果你有一个非常低的 `learning rate`，这意味着算法在每次迭代中只会轻微调整权重，你可能需要更高的迭代次数。

### 2\. 线性代数

重要的是要提到，感知器算法的能力归因于线性代数。整个算法可以通过线性代数公式来描述。如果你在大学时从未学习过线性代数，这些公式会显得难以理解。像 [可汗学院](https://www.khanacademy.org/math/linear-algebra) 这样的地方是了解线性代数的好起点。它也是一个很好的复习这个主题的地方。

对我来说，这里主要的学习是线性代数对这个机器学习算法的重要性。

### 3\. 类型一切

这个学习实际上是我在编写本文的过程中重新学到的概念。它并不特定于机器学习，也与感知器无关。

在 2012 年，当我学习 Ruby on Rails 这款 Web 应用程序开发框架时，我意识到将教程中的所有代码示例输入一遍确实帮助我记忆和理解了这些概念。我花了几周的时间在跟随教程时编写代码。不复制粘贴。我输入了所有的代码。这听起来可能很愚蠢，但这对掌握概念极有帮助。在这个过程中，我不可避免地犯了错，并花时间弄清楚问题出在哪里。这些时刻非常关键，因为那时你通常会停下来思考。

如果你在阅读 Perceptron 代码时，不要从 [代码库](https://github.com/rasbt/python-machine-learning-book/blob/master/code/ch02/ch02.ipynb) 中复制粘贴代码。将其输入到你自己的 Jupyter Notebook 中。把所有内容都输入。不要被动阅读。参与其中，输入代码，你会更快地掌握这些概念。

### 下一步

在这篇文章中，我的目标是分享我对算法的理解以及在重新实现它时所获得的经验。然而，你可以做的不仅仅是重新实现模型。你实际上可以将其与真实数据结合使用，以进行一些简单的预测。在 Python 机器学习中，Raschka 使用 Perceptron 来[预测鸢尾花的类别](https://github.com/rasbt/python-machine-learning-book/blob/master/code/ch02/ch02.ipynb)，基于花朵的萼片和花瓣长度。使用实际数据后，你可以评估模型，并对未见过的数据进行预测。

**个人简介：** **让-尼古拉斯·霍尔德** 是来自 [加拿大蒙特利尔的数据科学家](http://jeannicholashould.com/?utm_source=kdnugget)。JeanNicholasHould.com 的作者。

[原文](http://www.jeannicholashould.com/what-i-learned-implementing-a-classifier-from-scratch.html)。转载已获许可。

**相关：**

+   [数据集策划中的网页抓取，第一部分：收集精酿啤酒数据](/2017/02/web-scraping-dataset-curation-part-1.html)

+   [在 Python 中整理数据](/2017/01/tidying-data-python.html)

+   [数据科学中的中心极限定理](/2016/08/central-limit-theorem-data-science.html)

### 更多相关内容

+   [从理论到实践：构建一个 k-最近邻分类器](https://www.kdnuggets.com/2023/06/theory-practice-building-knearest-neighbors-classifier.html)

+   [我从使用 ChatGPT 进行数据科学中学到了什么](https://www.kdnuggets.com/what-i-learned-from-using-chatgpt-for-data-science)

+   [在 Python 中实现 DBSCAN](https://www.kdnuggets.com/2022/08/implementing-dbscan-python.html)

+   [KDnuggets 新闻，8月24日：在 Python 中实现 DBSCAN • 如何…](https://www.kdnuggets.com/2022/n34.html)

+   [理解和实现 Python 中的遗传算法](https://www.kdnuggets.com/understanding-and-implementing-genetic-algorithms-in-python)

+   [从头开始学习机器学习：决策树](https://www.kdnuggets.com/2022/11/machine-learning-scratch-decision-trees.html)
