# Scikit-learn 的最佳机器学习框架与扩展

> 原文：[https://www.kdnuggets.com/2021/03/best-machine-learning-frameworks-extensions-scikit-learn.html](https://www.kdnuggets.com/2021/03/best-machine-learning-frameworks-extensions-scikit-learn.html)

[评论](#comments)

很多包实现了 [Scikit-learn](https://scikit-learn.org/) 估算器 API。

如果你已经熟悉 Scikit-learn，你会发现这些库的集成非常简单。

使用这些包，我们可以扩展 Scikit-learn 估算器的功能，我将在本文中展示如何使用其中的一些。

### 数据格式

在本节中，我们将探讨可以用来处理和转换数据的库。

### [Sklearn-pandas](https://github.com/scikit-learn-contrib/sklearn-pandas)

你可以使用这个包将 ‘DataFrame’ 列映射到 Scikit-learn 转换中。然后，你可以将这些列组合成特征。

要开始使用这个包，通过 pip 安装 ‘sklearn-pandas’。‘DataFrameMapper’ 可以用于将 pandas 数据框列映射到 Scikit-learn 转换中。我们来看看怎么做。

首先，创建一个虚拟的 DataFrame：

[PRE0]

`DataFrameMapper` 接受一个元组列表——第一个项的名称是 [Pandas](https://pandas.pydata.org/) DataFrame 中的列名。

第二个传递的项目是将应用于列的转换类型。

例如，‘[LabelBinarizer](https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.LabelBinarizer.html)’ 可以应用于 ‘Uni’ 列，而 ‘Age’ 列使用 ‘[StandardScaler](https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.StandardScaler.html)’ 进行缩放。

[PRE1]

在定义映射器之后，接下来我们使用它来拟合和转换数据。

[PRE2]

映射器的 `transformed_names_` 属性可以用来显示转换后的结果名称。

[PRE3]

![scikit-learn 扩展](../Images/e20ec6b1d2a971d30cf79b13060e9d58.png)

将 `df_out=True` 传递给映射器将返回你的结果作为 Pandas DataFrame。

[PRE4]

![scikit-learn 扩展 ](../Images/3af27754b889c66f1b59217310b36c41.png)

### [Sklearn-xarray](https://phausamann.github.io/sklearn-xarray/)

这个包结合了来自 [xarray](http://xarray.pydata.org/en/stable/) 的 n 维标记数组和 [Scikit-learn](http://scikit-learn.org/stable/) 工具。

你可以将 Scikit-learn 估算器应用于 ‘xarrays’ 而不丢失它们的标签。你还可以：

+   确保 Sklearn 估算器与 xarray DataArrays 和 Datasets 之间的兼容性，

+   使估算器能够更改样本数量，

+   具有预处理转换器。

Sklearn-xarray 基本上是 xarray 和 Scikit-learn 之间的桥梁。为了使用它的功能，通过 pip 或 ‘conda’ 安装 ‘sklearn-xarray’。

这个包有封装器，可以让你在 xarray DataArrays 和 Datasets 上使用 sklearn 估算器。为了说明这一点，我们首先创建一个 ‘DataArray’。

[PRE5]

![scikit-learn 扩展 ](../Images/72abea9b124f6c109fed33700306eb55.png)

从 Sklearn 中选择一个变换应用于此‘DataArray’。在这种情况下，[让我们应用](https://phausamann.github.io/sklearn-xarray/content/wrappers.html)‘StandardScaler’。

[PRE6]

![scikit-learn 扩展](../Images/0608abb02873fc4fb3286eac01d25fda.png)

包装的估算器可以无缝地在 Sklearn 管道中使用。

[PRE7]

在拟合该管道时，你只需传入 DataArray。

同样，DataArrays 可以用于交叉验证的网格搜索。

为此，你需要从 ‘sklearn-xarray’ 创建一个 ‘CrossValidatorWrapper’ 实例。

[PRE8]

之后，你将把‘gridsearch’拟合到‘DataArray’ 数据类型中的 X 和 y。

### 自动机器学习

有没有将 Sklearn 集成到 Auto-ML 中以获得更好效果的工具和库？有的，以下是一些示例。

### [Auto-sklearn](https://automl.github.io/auto-sklearn/master/)

使用这个，你可以通过 Scikit-learn 执行自动化机器学习。对于设置，你需要手动[安装](https://automl.github.io/auto-sklearn/master/installation.html)一些依赖项。

[PRE9]

接下来，通过 pip 安装‘auto-sklearn’。

使用这个工具时，你无需担心算法选择和超参数调整。Auto-sklearn 会为你完成这些工作。

这得益于[最新的进展](https://proceedings.neurips.cc/paper/2015/file/11d0e6287202fced83f79975ec59a3a6-Paper.pdf)在贝叶斯优化、元学习和集成构建方面。

使用时，你需要选择一个分类器或回归器，并将其拟合到训练集上。

[PRE10]

### [Auto_ViML](https://github.com/AutoViML) – 自动变体可解释机器学习（发音为“Auto_Vimal”）

给定一个特定的数据集，Auto_ViML 尝试不同的模型和特征。最终它会选择表现最佳的模型。

该包还在构建模型时选择尽可能少的特征。这为你提供了一个较少复杂且更易解释的模型。该包还：

+   帮助你通过建议对缺失值、格式化和添加变量进行数据清理；

+   自动分类变量，无论是文本、数据还是数值；

+   当详细程度设置为 1 或 2 时，自动生成模型性能图；

+   允许你使用‘featuretools’进行特征工程；

+   当‘Imbalanced_Flag’设置为‘True’时，处理不平衡数据

要查看其实际效果，可以通过 pip 安装‘autoviml’。

[PRE11]

### [TPOT –](http://proceedings.mlr.press/v64/olson_tpot_2016.pdf) 基于树的管道优化工具

这是一个基于 Python 的自动机器学习工具。它使用遗传编程来优化机器学习管道。

它探索多个管道以确定最适合你的数据集的管道。

通过 pip 安装‘tpot’来开始使用它。运行‘tpot’后，你可以将生成的管道保存在文件中。探索过程完成或终止时，文件将被导出。

下面的代码片段展示了如何在数字数据集上创建分类管道。

[PRE12]

### [Feature Tools](https://github.com/alteryx/featuretools)

这是一个自动特征工程工具。它通过将时间序列和关系数据集转化为特征矩阵来工作。

通过pip安装‘featuretools[complete]’以开始使用它。

深度特征合成（DFS）可用于自动特征工程。

首先，定义一个包含数据集中所有实体的字典。在‘featuretools’中，实体是单个表。之后，定义不同实体之间的关系。

下一步是将实体、关系列表和目标实体传递给DFS。这将为你提供特征矩阵及相应的特征定义列表。

[PRE13]

### [Neuraxle](https://www.neuraxle.org/)

你可以使用Neuraxle进行超参数调整和AutoML。通过pip安装‘neuraxle’以开始使用它。

除了Scikit-learn，Neuraxle还兼容Keras、TensorFlow和PyTorch。它还具有：

+   并行计算和序列化，

+   通过提供关键抽象进行时间序列处理。

要使用Neuraxle进行Auto-ml，你需要：

+   一个定义的管道

+   一个验证分割器

+   通过‘ScoringCallback’定义评分指标

+   一个选择的‘hyperparams’仓库

+   一个选择的‘hyperparams’优化器

+   一个‘AutoML’循环

在这里查看完整[示例](https://www.neuraxle.org/stable/hyperparameter_tuning.html)。

### 实验框架

现在是一些你可以用于机器学习实验的SciKit工具。

### [SciKit-Learn实验室](https://scikit-learn-laboratory.readthedocs.io/en/latest/)

SciKit-Learn实验室是一个你可以用来运行机器学习实验的命令行工具。要开始使用它，通过pip安装`skll`。

然后，你需要获得一个`SKLL`格式的数据集。

接下来，为实验创建一个[配置文件](https://skll.readthedocs.io/en/latest/run_experiment.html#create-config)，然后在终端中运行实验。

[PRE14]

实验完成后，多个文件将存储在[结果](https://skll.readthedocs.io/en/latest/run_experiment.html#results)文件夹中。你可以使用这些文件来检查实验。

### Neptune

[Scikit-learn与Neptune的集成](https://docs.neptune.ai/integrations/sklearn.html) 允许你使用Neptune记录实验。例如，你可以记录Scikit-learn回归器的总结。

[PRE15]

查看这个[笔记本](https://colab.research.google.com/github/neptune-ai/neptune-examples/blob/master/integrations/sklearn/docs/Neptune-Scikit-learn.ipynb#scrollTo=GvDSBSrOx-R4)获取完整示例。

### 模型选择

现在，让我们转到专注于模型选择和优化的SciKit库。

### [Scikit-optimize](https://scikit-optimize.github.io/stable/)

该库实现了用于序列模型优化的方法。通过pip安装‘scikit-optimize’以开始使用这些功能。

Scikit-optimize可以通过基于贝叶斯定理的贝叶斯优化来执行超参数调整。

你可以使用 ‘BayesSearchCV’ 来利用这个定理获得最佳参数。一个 Scikit-learn 模型作为第一个参数传递给它。

[PRE16]

拟合后，你可以通过 ‘best_params_’ 属性获取模型的最佳参数。

### [Sklearn-deap](https://github.com/rsteca/sklearn-deap)

Sklearn-deap 是一个用于实现 [进化算法](https://en.wikipedia.org/wiki/Evolutionary_algorithm) 的包。它减少了你找到模型最佳参数所需的时间。

它不会尝试每一种可能的组合，而是只演化出最佳性能的组合。通过 pip 安装 ‘sklearn-deap’。

[PRE17]

### 生产模型导出

接下来，让我们看看可以用来将模型导出到生产环境的 Scikit 工具。

### [sklearn-onnx](https://github.com/onnx/sklearn-onnx/)

sklearn-onnx 使得将 Sklearn 模型转换为 [ONNX](https://onnx.ai/) 成为可能。

要使用它，你需要通过 pip 安装 ‘skl2onnx’。一旦你的管道准备好，你可以使用 ‘to_onnx’ 函数来 [转换](http://onnx.ai/sklearn-onnx/auto_tutorial/plot_abegin_convert_pipeline.html) 模型为 ONNX。

[PRE18]

### [Treelite](https://treelite.readthedocs.io/en/latest/)

这是一个用于决策树集成的模型编译器。

它处理各种基于树的模型，如随机森林和梯度提升树。

你可以用它来导入 Scikit-learn 模型。在这里，‘model’ 是一个 Scikit-learn 模型对象。

[PRE19]

### 模型检查和可视化

在这一部分，让我们看看可以用于模型可视化和检查的库。

### [Dtreeviz](https://github.com/parrt/dtreeviz/)

dtreeviz 用于决策树可视化和模型解释。

[PRE20]

![](../Images/d12bd6f8518cbf2053f0378db032cb43.png)

### [Eli5](https://github.com/TeamHG-Memex/eli5/)

eli5 是一个可以用于调试和检查机器学习分类器的包。你还可以用它来解释它们的预测。

例如，Scikit-learn 估计器权重的解释可以如下所示：

[PRE21]

![scikit-learn 扩展 ](../Images/2f9114ee1b717a317a3ddf58fa13bfc1.png)

### 其他 SciKit 工具

### [dabl](https://github.com/amueller/dabl)– 数据分析基线库

dabl 提供了常见机器学习任务的样板代码。它仍在积极开发中，因此不建议用于生产系统。

[PRE22]

### [skorch](https://github.com/skorch-dev/skorch)

Skorch 是一个用于 PyTorch 的 Scikit-learn 包装器。

它让你在 Scikit-learn 中使用 PyTorch。它支持多种数据类型，如 PyTorch Tensors、NumPy 数组和 Python 字典。

[PRE23]

### 最后的想法

在这篇文章中，我们深入探讨了一些扩展 Scikit-learn 生态系统的流行工具和库。

如你所见，这些工具可以用来：

+   处理和转换数据，

+   实现自动化机器学习，

+   执行自动特征选择，

+   进行机器学习实验，

+   选择适合你问题的最佳模型和管道，

+   导出模型以用于生产……

……还有更多！

在您的 Scikit-learn 工作流中试试这些包，您可能会惊讶于它们的便利性。

**简介：德里克·姆维提** 是一位数据科学家，对分享知识充满热情。他是数据科学社区的积极贡献者，常在 Heartbeat、Towards Data Science、Datacamp、Neptune AI、KDnuggets 等博客上发布内容。他的内容在互联网上的浏览量已超过一百万次。德里克还是一名作者和在线讲师。他还与多个机构合作，实施数据科学解决方案并提升其员工技能。您可能会对他的[Python 完整数据科学与机器学习训练营课程](https://www.udemy.com/course/data-science-bootcamp-in-python/?referralCode=9F6DFBC3F92C44E8C7F4)感兴趣。

[原文](https://neptune.ai/blog/the-best-ml-framework-extensions-for-scikit-learn)。经许可转载。

**相关内容：**

+   [数据科学、数据可视化和机器学习的顶级 Python 库](/2020/11/top-python-libraries-data-science-data-visualization-machine-learning.html)

+   [深度学习、自然语言处理和计算机视觉的顶级 Python 库](/2020/11/top-python-libraries-deep-learning-natural-language-processing-computer-vision.html)

+   [在 TensorFlow 中修剪机器学习模型](/2020/12/pruning-machine-learning-models-tensorflow.html)

* * *

## 我们的三大课程推荐

![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 1\. [谷歌网络安全证书](https://www.kdnuggets.com/google-cybersecurity) - 快速进入网络安全职业道路。

![](../Images/e225c49c3c91745821c8c0368bf04711.png) 2\. [谷歌数据分析专业证书](https://www.kdnuggets.com/google-data-analytics) - 提升您的数据分析能力

![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 3\. [谷歌 IT 支持专业证书](https://www.kdnuggets.com/google-itsupport) - 支持您的组织进行 IT 支持

* * *

### 更多相关内容

+   [停止学习数据科学以寻找目的，并寻找目的去…](https://www.kdnuggets.com/2021/12/stop-learning-data-science-find-purpose.html)

+   [学习数据科学的统计学顶级资源](https://www.kdnuggets.com/2021/12/springboard-top-resources-learn-data-science-statistics.html)

+   [一项 90 亿美元的人工智能失败，深度剖析](https://www.kdnuggets.com/2021/12/9b-ai-failure-examined.html)

+   [成功数据科学家的 5 个特征](https://www.kdnuggets.com/2021/12/5-characteristics-successful-data-scientist.html)

+   [是什么让 Python 成为初创公司的理想编程语言](https://www.kdnuggets.com/2021/12/makes-python-ideal-programming-language-startups.html)

+   [每个数据科学家都应该了解的三个 R 库（即使你使用 Python）](https://www.kdnuggets.com/2021/12/three-r-libraries-every-data-scientist-know-even-python.html)
