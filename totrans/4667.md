# 使用Python和PuLP进行线性规划和离散优化

> 原文：[https://www.kdnuggets.com/2019/05/linear-programming-discrete-optimization-python-pulp.html](https://www.kdnuggets.com/2019/05/linear-programming-discrete-optimization-python-pulp.html)

![c](../Images/3d9c022da2d331bb56691a9617b91b90.png) [评论](/2019/05/linear-programming-discrete-optimization-python-pulp.html?page=2#comments)

### 介绍

[离散优化](https://neos-guide.org/optimization-tree)是处理离散量即非连续函数的优化方法的一部分。它在[金融投资](https://study.com/academy/lesson/financial-applications-of-linear-programs-for-portfolio-selection-financial-planning-financial-mix-strategy.html)、[饮食规划](https://neos-guide.org/content/diet-problem)、[制造过程](https://www.quora.com/How-do-I-solve-a-manufacturing-problem-in-linear-programming)和[职业体育的球员或赛程选择](https://www2.cs.duke.edu/courses/fall10/cps296.1/joe_siyang.pdf)等各种应用中都很常见。

**线性和（混合）整数规划**是解决可以在离散优化框架内进行表述的问题的技术。

* * *

## 我们的前三名课程推荐

![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 1\. [谷歌网络安全证书](https://www.kdnuggets.com/google-cybersecurity) - 快速进入网络安全职业生涯。

![](../Images/e225c49c3c91745821c8c0368bf04711.png) 2\. [谷歌数据分析专业证书](https://www.kdnuggets.com/google-data-analytics) - 提升您的数据分析水平

![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 3\. [谷歌IT支持专业证书](https://www.kdnuggets.com/google-itsupport) - 支持您的组织进行IT工作

* * *

对数据科学家和机器学习（ML）从业者来说，掌握这些优化技术非常有用，因为离散和连续优化是现代ML和AI系统的核心，也用于[数据驱动的商业分析流程](https://www.edx.org/course/optimization-methods-business-analytics-mitx-15-053x)。

> 尽管有许多商业优化工具，但拥有程序化优化经验是非常宝贵的。

[优化问题的理论发展历程](https://www.math.uni-bielefeld.de/documenta/vol-ismp/25_bixby-robert.pdf)悠久而丰富。然而，关注实际应用时，我们将跳过这段历史，直接进入学习如何使用程序化工具来表述和解决这些优化问题的部分。

Python中有许多优秀的优化包。在本文中，我们将特别讨论**PuLP**。但在介绍Python库之前，让我们了解一下可以用它解决的那种问题。

### 一个（或两个）示例问题

假设你是**负责高中午餐计划**的人。你的工作是确保学生从选择的食物中获得适当的营养平衡。

![figure-name](../Images/cc1791bd3331a710354cda68b1034bf5.png)

然而，预算限制和饮食中需要的食物种类也有一些限制，以使其有趣。下表详细显示了每种食物的完整营养价值及其最大/最小日摄入量。

![figure-name](../Images/80504d2fed858a2034654b5f912068ff.png)

> 离散优化问题很简单：**在这些约束条件下最小化午餐成本**（对总卡路里及每种营养成分，例如胆固醇、维生素 A、钙等）。

从本质上讲，简单的数学语言描述，这个问题是，

![figure-name](../Images/b3f4683b5a2bee3460a4f052d1062356.png)

请注意，这些不等式关系都是线性的，即变量***f***由常数系数乘以，结果项由常数限制所界定，这使得这个问题可以通过线性规划技术解决。

你可以想象这种问题可能在**商业策略**中极为频繁出现。与营养价值不同，你将处理利润和其他类型的商业收益，而价格/份量可能会变成以千美元计的项目成本。作为经理，你的工作是选择那些在不超过项目总预算的情况下提供最大投资回报的项目。

![figure-name](../Images/b158cff8a7351caa31c5d982227b7f36.png)

类似的优化问题也可能出现在**工厂生产计划**中，其中最大生产能力将是所使用机器的函数，而各个产品会有不同的利润特性。作为一名生产工程师，你的工作可能是仔细分配机器和劳动力资源，以在满足所有生产能力约束的同时最大化利润。

![figure-name](../Images/4526a207f2070ab0d3104d4136f95403.png)

从根本上说，这些来自不同领域的问题的共同点在于，它们都涉及到在一组线性***目标函数***约束下，最大化或最小化线性***不等式或等式约束***。

对于饮食问题，目标函数是我们试图最小化的总成本。不等式约束由每种营养成分的最小和最大界限给出。

### PuLP — 一个用于线性优化的 Python 库

Python 生态系统中有许多库用于这类优化问题。**PuLP** 是一个开源的 [**线性规划**](https://en.wikipedia.org/wiki/Linear_programming) (LP) 包，它主要使用 Python 语法，并配备了许多行业标准的求解器。它还与多种开源和商业 LP 求解器良好集成。

你可以通过 pip 安装它（以及一些额外的求解器）

```py
$ sudo pip install pulp            *# PuLP*
$ sudo apt-get install glpk-utils  *# GLPK*
$ sudo apt-get install coinor-cbc  *# CoinOR*

```

[关于安装和测试的详细说明在这里](https://pythonhosted.org/PuLP/index.html)。然后，只需从库中导入所有内容。

```py
from pulp import *

```

在这里查看关于解决线性规划的一个很好的视频。

### **如何制定优化问题？**

首先，我们使用方法`**LpProblem**`在 PuLP 中创建一个线性规划问题。

```py
prob = LpProblem("Simple Diet Problem",LpMinimize)

```

然后，我们需要用表中的信息创建一系列的[Python 字典](https://www.kdnuggets.com/2019/12/python-dictionary-methods.html)对象。代码如下所示，

```py
# Read the first few rows dataset in a Pandas DataFrame
# Read only the nutrition info not the bounds/constraints
df = pd.read_excel("diet - medium.xls",nrows=17)

# Create a list of the food items
food_items = list(df['Foods'])

# Create a dictinary of costs for all food items
costs = dict(zip(food_items,df['Price/Serving']))

# Create a dictionary of calories for all food items
calories = dict(zip(food_items,df['Calories']))

# Create a dictionary of total fat for all food items
fat = dict(zip(food_items,df['Total_Fat (g)']))

# Create a dictionary of carbohydrates for all food items
carbs = dict(zip(food_items,df['Carbohydrates (g)']))

```

为了简洁，我们没有展示完整的代码。你可以获取所有营养成分并为它们创建单独的字典。

然后，我们创建一个食品项目变量的字典，**下界 =0** 和 **类别连续**，即优化解可以取任何大于零的实数值。

注意下界的重要性。

> 在我们看来，不能将食品量视为负值或无限量，但数学并不知道这一点。

如果没有明确声明这个界限，解决方案可能会不合逻辑，因为求解器可能会尝试使用负数的食品量来减少总成本，同时仍然满足营养要求！

```py
food_vars = LpVariable.dicts("Food",food_items,lowBound=0,cat='Continuous')

```

接下来，我们开始构建线性规划问题，通过添加主要目标函数来完成。注意使用`**lpSum**`方法。

```py
prob += lpSum([costs[i]*food_vars[i] for i in food_items])

```

我们进一步通过添加卡路里约束来扩展这一点，

```py
prob += lpSum([calories[f] * food_vars[f] for f in food_items]) >= 800.0
prob += lpSum([calories[f] * food_vars[f] for f in food_items]) <= 1300.0

```

我们可以将所有的营养约束汇总起来。为简化起见，我们仅对脂肪、碳水化合物、纤维和蛋白质添加了四个约束。代码如下所示，

```py
# Fat
prob += lpSum([fat[f] * food_vars[f] for f in food_items]) >= 20.0, "FatMinimum"
prob += lpSum([fat[f] * food_vars[f] for f in food_items]) = 130.0, "CarbsMinimum"
prob += lpSum([carbs[f] * food_vars[f] for f in food_items]) = 60.0, "FiberMinimum"
prob += lpSum([fiber[f] * food_vars[f] for f in food_items]) = 100.0, "ProteinMinimum"
prob += lpSum([protein[f] * food_vars[f] for f in food_items]) <= 150.0, "ProteinMaximum"

```

我们已经完成了问题的制定！

> 在任何优化场景中，困难的部分是将问题以结构化的方式制定出来，以便求解器能够处理。

我们已经完成了困难的部分。现在，运行求解器并检查解是相对简单的部分。

### 更多相关话题

+   [数据科学家的线性规划 101](https://www.kdnuggets.com/2023/02/linear-programming-101-data-scientists.html)

+   [超参数优化：10 个顶级 Python 库](https://www.kdnuggets.com/2023/01/hyperparameter-optimization-10-top-python-libraries.html)

+   [3 种基于研究的高级提示技术，提高 LLM 效率…](https://www.kdnuggets.com/3-research-driven-advanced-prompting-techniques-for-llm-efficiency-and-speed-optimization)

+   [使用 TPOT 进行机器学习管道优化](https://www.kdnuggets.com/2021/05/machine-learning-pipeline-optimization-tpot.html)

+   [SQL 查询优化技术](https://www.kdnuggets.com/2023/03/sql-query-optimization-techniques.html)

+   [数据库优化：探索 SQL 中的索引](https://www.kdnuggets.com/2023/07/database-optimization-exploring-indexes-sql.html)
