- en: 'Data Cleaning in SQL: How To Prepare Messy Data for Analysis'
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://www.kdnuggets.com/data-cleaning-in-sql-how-to-prepare-messy-data-for-analysis](https://www.kdnuggets.com/data-cleaning-in-sql-how-to-prepare-messy-data-for-analysis)
  id: totrans-1
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: '![Data Cleaning in SQL: How To Prepare Messy Data for Analysis](../Images/cefee85bcf1824dbe72931f73db523ea.png)'
  id: totrans-2
  prefs: []
  type: TYPE_IMG
- en: Image generated with Segmind SSD-1B model
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
- en: Excited to start analyzing data using SQL? Well, you may have to wait just a
    bit. But why?
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
- en: Data in database tables can often be messy. Your data may contain missing values,
    duplicate records, outliers, inconsistent data entries, and more. So cleaning
    the data before you can analyze it using SQL is super important.
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
- en: When you're learning SQL, you can spin up database tables, alter them, update
    and delete records as you like. But in practice, this is almost never the case.
    You may not have permission to alter tables, update and delete records. But you’ll
    have read access to the database and will be able to run a bunch of SELECT queries.
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
- en: In this tutorial, we’ll spin up a database table, populate it with records,
    and see how we can clean the data with SQL. Let's start coding!
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
- en: Creating a Database Table with Records
  id: totrans-8
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'For this tutorial, let’s create an `employees` table like so:'
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  id: totrans-10
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'Next, let’s insert some fictional sample records into the table:'
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE1]'
  id: totrans-12
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: If you can tell, I’ve used a small set of first and last names to sample from
    and construct the name field for the records. You can be more creative with the
    records, though.
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
- en: '**Note**: All the queries in this tutorial are for [MySQL](https://www.mysql.com/).
    But you’re free to use the RDBMS of your choice.'
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
- en: 1\. Missing Values
  id: totrans-15
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Missing values in data records are always a problem. So you have to handle them
    accordingly.
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
- en: A naive approach is to drop all the records that contain missing values for
    one or more fields. However, you should not do this unless you’re sure there is
    no other better way of handling missing values.
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
- en: 'In the `employees` table, we see that there is a NULL value in the ‘department’
    column (see row of employee_id 13) indicating that the field is missing:'
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE2]'
  id: totrans-19
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: '![Data Cleaning in SQL: How To Prepare Messy Data for Analysis](../Images/182a6d2a11cfa7a62989c7966dae25e5.png)'
  id: totrans-20
  prefs: []
  type: TYPE_IMG
- en: 'You can use the [COALESCE() function](https://dev.mysql.com/doc/refman/8.0/en/comparison-operators.html#function_coalesce)
    to use the ‘Unknown’ string for the NULL value:'
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE3]'
  id: totrans-22
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: 'Running the above query should give you the following result:'
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
- en: '![Data Cleaning in SQL: How To Prepare Messy Data for Analysis](../Images/0c9890c3c0762ab25515a03e3561d51e.png)'
  id: totrans-24
  prefs: []
  type: TYPE_IMG
- en: 2\. Duplicate Records
  id: totrans-25
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Duplicate records in a database table can distort the results of analysis. We’ve
    chosen the employee_id as the primary key in our database table. So we’ll not
    have any repeating employee records in the `employee_data` table.
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
- en: 'You can still the SELECT DISTINCT statement:'
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE4]'
  id: totrans-28
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: 'As expected, the result set contains all the 20 records:'
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
- en: '![Data Cleaning in SQL: How To Prepare Messy Data for Analysis](../Images/e5d4d878576c2bc007f8781ef7f5a7ac.png)'
  id: totrans-30
  prefs: []
  type: TYPE_IMG
- en: 3\. Data Type Conversion
  id: totrans-31
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'If you notice, the ‘hire_date’ column is currently VARCHAR and not a date type.
    To make it easier when working with dates, it’s helpful to use the [STR_TO_DATE()](https://dev.mysql.com/doc/refman/8.0/en/date-and-time-functions.html#function_str-to-date)
    function like so:'
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE5]'
  id: totrans-33
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: Here, we’ve only selected the ‘hire_date’ column amongst others and haven’t
    performed any operations on the date values. So the query output should be the
    same as that of the previous query.
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
- en: But if you want to perform operations such as adding an offset date to the values,
    this function can be helpful.
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
- en: 4\. Outliers
  id: totrans-36
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Outliers in one or more numeric fields can skew analysis. So we should check
    for and remove outliers so as to filter out the data that is not relevant.
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
- en: But deciding which values constitute outliers requires domain knowledge and
    data using knowledge of both the domain and historical data.
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
- en: In our example, let's say we *know* that the ‘salary’ column has an upper limit
    of 100000\. So any entry in the ‘salary’ column can be at most 100000\. And entries
    greater than this value are outliers.
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
- en: 'We can check for such records by running the following query:'
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE6]'
  id: totrans-41
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: 'As seen, all entries in the ‘salary’ column are valid. So the result set is
    empty:'
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
- en: '![Data Cleaning in SQL: How To Prepare Messy Data for Analysis](../Images/0c5dd3614ce2ebe99e7e9742d9e30e4e.png)'
  id: totrans-43
  prefs: []
  type: TYPE_IMG
- en: 5\. Inconsistent Data Entry
  id: totrans-44
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Inconsistent data entries and formatting are quite common especially in date
    and string columns.
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
- en: In the `employees` table, we see that the record corresponding to employee ‘joe
    smith’ is not in the title case.
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
- en: 'But for consistency let''s select all the names formatted in the title case.
    You have to use the [CONCAT()](https://dev.mysql.com/doc/refman/8.0/en/string-functions.html#function_concat)
    function in conjunction with [UPPER()](https://dev.mysql.com/doc/refman/8.0/en/string-functions.html#function_upper)
    and [SUBSTRING()](https://dev.mysql.com/doc/refman/8.0/en/string-functions.html#function_substring)
    like so:'
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE7]'
  id: totrans-48
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: '![Data Cleaning in SQL: How To Prepare Messy Data for Analysis](../Images/f20a9e444f3ac9c7ff43f46a632d57a9.png)'
  id: totrans-49
  prefs: []
  type: TYPE_IMG
- en: 6\. Validating Ranges
  id: totrans-50
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: When talking about outliers, we mentioned how we’d like the upper limit on the
    ‘salary’ column to be 100000 and considered any salary entry above 100000 to be
    an outlier.
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
- en: 'But it''s also true that you don''t want any negative values in the ‘salary’
    column. So you can run the following query to validate that all employee records
    contain values between 0 and 100000:'
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE8]'
  id: totrans-53
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: 'As seen, the result set is empty:'
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
- en: '![Data Cleaning in SQL: How To Prepare Messy Data for Analysis](../Images/b58b8b318272b4a2d110c21337adb4fc.png)'
  id: totrans-55
  prefs: []
  type: TYPE_IMG
- en: 7\. Deriving New Columns
  id: totrans-56
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Deriving new columns is not essentially a data cleaning step. However, in practice,
    you may need to use existing columns to derive new columns that are more helpful
    in analysis.
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
- en: For example, the `employees` table contains a ‘hire_date’ column. A more helpful
    field is, perhaps, a ‘years_of_service’ column that indicates how long an employee
    has been with the company.
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: 例如，`employees` 表包含一个 'hire_date' 列。一个更有帮助的字段可能是 'years_of_service' 列，表示员工在公司工作的时间长短。
- en: 'The following query finds the difference between the current year and the year
    value in ‘hire_date’ to compute the ‘years_of_service’:'
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: 以下查询计算当前年份与 'hire_date' 年份之间的差异，以计算 'years_of_service'：
- en: '[PRE9]'
  id: totrans-60
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: 'You should see the following output:'
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: 你应该看到以下输出：
- en: '![Data Cleaning in SQL: How To Prepare Messy Data for Analysis](../Images/dcf584bdbc66099479f9feeac668d13f.png)'
  id: totrans-62
  prefs: []
  type: TYPE_IMG
  zh: '![SQL 数据清理：如何为分析准备混乱数据](../Images/dcf584bdbc66099479f9feeac668d13f.png)'
- en: As with other queries we’ve run, this does not modify the original table. To
    add new columns to the original table, you need to have permissions to ALTER the
    database table.
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: 与我们运行的其他查询一样，这不会修改原始表。要向原始表中添加新列，你需要具有 ALTER 数据库表的权限。
- en: Wrapping Up
  id: totrans-64
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 总结
- en: I hope you understand how relevant data cleaning tasks can improve data quality
    and facilitate more relevant analysis. You’ve learned how to check for missing
    values, duplicate records, inconsistent formatting, outliers, and more.
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: 我希望你了解相关的数据清理任务如何提升数据质量并促进更相关的分析。你已经学会了如何检查缺失值、重复记录、不一致的格式、异常值等。
- en: Try spinning up your own relational database table and run some queries to perform
    common data cleaning tasks. Next, learn about [SQL for data visualization](/sql-for-data-visualization-how-to-prepare-data-for-charts-and-graphs).
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: 尝试启动你自己的关系数据库表，并运行一些查询以执行常见的数据清理任务。接下来，了解一下[数据可视化的 SQL](https://www.kdnuggets.com/sql-for-data-visualization-how-to-prepare-data-for-charts-and-graphs)。
- en: '**[](https://twitter.com/balawc27)**[Bala Priya C](https://www.kdnuggets.com/wp-content/uploads/bala-priya-author-image-update-230821.jpg)****
    is a developer and technical writer from India. She likes working at the intersection
    of math, programming, data science, and content creation. Her areas of interest
    and expertise include DevOps, data science, and natural language processing. She
    enjoys reading, writing, coding, and coffee! Currently, she''s working on learning
    and sharing her knowledge with the developer community by authoring tutorials,
    how-to guides, opinion pieces, and more. Bala also creates engaging resource overviews
    and coding tutorials.'
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: '**[](https://twitter.com/balawc27)**[Bala Priya C](https://www.kdnuggets.com/wp-content/uploads/bala-priya-author-image-update-230821.jpg)**是来自印度的开发者和技术作家。她喜欢在数学、编程、数据科学和内容创作的交集处工作。她的兴趣和专长领域包括
    DevOps、数据科学和自然语言处理。她喜欢阅读、写作、编码和喝咖啡！目前，她正在通过编写教程、操作指南、观点文章等与开发者社区分享她的知识。Bala 还创建了引人入胜的资源概述和编码教程。**'
- en: '* * *'
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: '* * *'
- en: Our Top 3 Course Recommendations
  id: totrans-69
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 我们的三大课程推荐
- en: '![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 1\. [Google Cybersecurity
    Certificate](https://www.kdnuggets.com/google-cybersecurity) - Get on the fast
    track to a career in cybersecurity.'
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: '![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 1\. [谷歌网络安全证书](https://www.kdnuggets.com/google-cybersecurity)
    - 快速进入网络安全职业生涯。'
- en: '![](../Images/e225c49c3c91745821c8c0368bf04711.png) 2\. [Google Data Analytics
    Professional Certificate](https://www.kdnuggets.com/google-data-analytics) - Up
    your data analytics game'
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: '![](../Images/e225c49c3c91745821c8c0368bf04711.png) 2\. [谷歌数据分析专业证书](https://www.kdnuggets.com/google-data-analytics)
    - 提升你的数据分析水平'
- en: '![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 3\. [Google IT Support
    Professional Certificate](https://www.kdnuggets.com/google-itsupport) - Support
    your organization in IT'
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: '![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 3\. [谷歌 IT 支持专业证书](https://www.kdnuggets.com/google-itsupport)
    - 支持你的组织的 IT'
- en: '* * *'
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: '* * *'
- en: More On This Topic
  id: totrans-74
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 更多内容
- en: '[SQL for Data Visualization: How to Prepare Data for Charts and Graphs](https://www.kdnuggets.com/sql-for-data-visualization-how-to-prepare-data-for-charts-and-graphs)'
  id: totrans-75
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[数据可视化的 SQL：如何为图表和图形准备数据](https://www.kdnuggets.com/sql-for-data-visualization-how-to-prepare-data-for-charts-and-graphs)'
- en: '[A Faster Way to Prepare Time-Series Data with the AI & Analytics Engine](https://www.kdnuggets.com/2021/12/piexchange-faster-way-prepare-timeseries-data-ai-analytics-engine.html)'
  id: totrans-76
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[通过 AI 和分析引擎更快地准备时间序列数据](https://www.kdnuggets.com/2021/12/piexchange-faster-way-prepare-timeseries-data-ai-analytics-engine.html)'
- en: '[Prepare Your Data for Effective Tableau & Power BI Dashboards](https://www.kdnuggets.com/2022/06/prepare-data-effective-tableau-power-bi-dashboards.html)'
  id: totrans-77
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[为有效的 Tableau 和 Power BI 仪表板准备数据](https://www.kdnuggets.com/2022/06/prepare-data-effective-tableau-power-bi-dashboards.html)'
- en: '[How to Prepare for a Data Science Interview](https://www.kdnuggets.com/2022/12/prepare-data-science-interview.html)'
  id: totrans-78
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[如何准备数据科学面试](https://www.kdnuggets.com/2022/12/prepare-data-science-interview.html)'
- en: '[Collection of Guides on Mastering SQL, Python, Data Cleaning, Data…](https://www.kdnuggets.com/collection-of-guides-on-mastering-sql-python-data-cleaning-data-wrangling-and-exploratory-data-analysis)'
  id: totrans-79
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[掌握 SQL、Python、数据清洗、数据处理与探索性数据分析的指南合集](https://www.kdnuggets.com/collection-of-guides-on-mastering-sql-python-data-cleaning-data-wrangling-and-exploratory-data-analysis)'
- en: '[The Importance of Data Cleaning in Data Science](https://www.kdnuggets.com/2023/08/importance-data-cleaning-data-science.html)'
  id: totrans-80
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[数据清洗在数据科学中的重要性](https://www.kdnuggets.com/2023/08/importance-data-cleaning-data-science.html)'
