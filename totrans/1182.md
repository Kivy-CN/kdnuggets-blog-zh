# 什么时候重新训练机器学习模型？运行这 5 项检查来决定计划

> 原文：[https://www.kdnuggets.com/2021/07/retrain-machine-learning-model-5-checks-decide-schedule.html](https://www.kdnuggets.com/2021/07/retrain-machine-learning-model-5-checks-decide-schedule.html)

[评论](#comments)

**由** [**Emeli Dral**](https://twitter.com/EmeliDral)**，Evidently AI 的首席技术官兼联合创始人 &** [**Elena Samuylova**](https://twitter.com/elenasamuylova/)**，Evidently AI 的首席执行官兼联合创始人**

世界和数据是动态的。但大多数机器学习模型是静态的。一旦它们投入生产，随着时间的推移，它们变得不那么相关了。[数据分布会演变，行为模式会变化](https://evidentlyai.com/blog/machine-learning-monitoring-data-and-concept-drift)，模型需要更新以跟上新的现实。

* * *

## 我们的前 3 个课程推荐

![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 1\. [谷歌网络安全证书](https://www.kdnuggets.com/google-cybersecurity) - 快速进入网络安全职业生涯。

![](../Images/e225c49c3c91745821c8c0368bf04711.png) 2\. [谷歌数据分析专业证书](https://www.kdnuggets.com/google-data-analytics) - 提升你的数据分析水平

![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 3\. [谷歌 IT 支持专业证书](https://www.kdnuggets.com/google-itsupport) - 支持你的组织 IT

* * *

通常的过程是在定义的时间间隔内重新训练模型。这看起来相当简单：使用新数据、旧的训练管道，再次拟合模型。

但是我们应该多久做一次？是每天、每周还是每月？还是每次获得一批新数据时？

![Image](../Images/6633c2014ec57d3088ba2179d982447e.png)

太常见的情况是，答案是基于直觉或便利性。有人选择一个合理的时间间隔并安排定期的重新训练任务。

相反，我们可以采取一种更数据驱动的方法。为了更精确地规划模型维护，我们可以提前进行一些检查。

根据模型的重要性，你可能需要检查所有的模型或只是其中的一些。

### 检查 #1。模型是否已经足够好？

在制定重新训练计划之前，检查一下训练是否完成是有帮助的！也许，模型尚未达到其最佳性能？

最简单的方法是查看传统的学习曲线。

![Image](../Images/f0988021c2e694e56e03bef78e14da42.png)

如何进行？我们可以固定用来评估模型性能的测试集。然后，通过在不同部分的训练数据上训练模型来运行一组实验。

我们可以使用随机分割方法，通过改变训练规模进行迭代。这样，我们可以专注于数据量对性能的影响。

![Image](../Images/1353e1f20c4313d1a9f55092a6d2800a.png)

我们可以从中学到两点：1）我们需要多少数据才能达到最佳性能 2）模型是否在现有训练数据下达到了这一平台。

**有时我们会发现模型不需要我们拥有的所有数据。** 例如，我们有多年的销售数据，但使用仅一年数据的训练结果质量相同。

我们可能会丢弃多余的数据以使模型更轻量化。

**在其他情况下，我们可能会看到模型质量不断提升**。模型渴望更多的数据！还有更多步骤需要完成，以使模型达到最佳状态。

![图片](../Images/7d75b4bc993a559419e6f57d29fb3c70.png)

与其考虑重新训练模型以维持其质量，不如规划持续改进。只要我们获得足够的新数据，就可以利用这些数据来实现更好的性能。

这个第一次测试也提供了数据的规模和“密度”的感觉。我们需要10个、100个还是1000个观察才能看到对模型性能的有意义的影响？我们需要一天还是一个月来收集这么多的新数据？

这是一个有用的知识！

### 检查 #2\. 事情变化得有多快？

当我们创建机器学习模型时，我们假设现实世界的过程是有一定稳定性的。否则，从过去学习就没有什么意义了！

我们也知道事情会发生变化。当处理动态过程时，我们也可以假设这些新模式积累的速度是一定的。

然后我们可以尝试计算这个！

让我们拿着模型，看看如果我们模拟其过去的应用，它“持续”了多久。

![图片](../Images/f57dc5e2baea3ed6c05cdd2eefc14927.png)

我们可以使用一些较旧的数据部分来训练模型，然后将其“应用”到后来的时期。就像我们用保留集一样，不过这里我们简单地使用几个连续的部分。

我们可以从一个单点估计开始，看看性能下降得有多快。

![图片](../Images/886251abc0b3af2682dc5aedba2e68cd.png)

如果我们有足够的历史数据，我们可以多次重复检查，然后平均结果。只需留意潜在的异常值和稀有事件！

![图片](../Images/4187c122c80bd37ca886503946959293.png)

**有时我们会发现一个“旧”模型表现得和新模型一样好。** 有些人喜欢频繁重新训练模型以保持其“新鲜”，但这并不总是合理的。

不要修复没有坏的东西！

如果不需要频繁重新训练，您可以使用更轻量的服务架构。您还可以减少随之而来的技术错误风险。组织开销也是如此，尤其是当新模型需要审批过程时。

![图片](../Images/7cf2c1d846f0a3770216da28a8ebe87a.png)

**在其他情况下，您可能会发现模型老化得非常快！** 提前了解这一点有助于设置适当的监控和准备基础设施。

你可能会决定重新考虑你的训练方法，以使模型更加稳定。例如，更改特征工程或模型架构，使其在测试集上的性能略低，但在长期内更稳定。在其他情况下，你可能会使用较短的训练周期来训练模型，但进行频繁的校准，或考虑主动学习。

我们可能还会面临重新训练模型能力的限制。

这引出了下一个检查点。

### 检查 #3。我们什么时候获得新数据？

![图片](../Images/ad4cb68a76433b6c053208581142e7d7.png)

在这里，我们关注的是业务流程，而不是数据。

有时，我们几乎立即获得真实世界的反馈。例如，你推荐一篇文章阅读，你很快就能知道用户是否点击了链接。

在其他情况下，你可以用来重新训练模型的新数据可能会有延迟。

如果你有一个较长的预测周期，你必须等待以知道你的预测是否正确。对于其他任务，你需要一个单独的标记过程。有时，限制来自于数据的移动或生成方式。例如，手动数据输入每月进行一次。

![图片](../Images/4d963f1ef664d1112a0b9573247d2a02.png)

我们可能会发现自己处于两种情况之一。

**在某些情况下，模型在新数据到达之前就已经退化。** 这成为一个限制因素。

如果我们没有及时获取数据以重新训练模型，我们可能需要重新考虑方法。例如，创建一个具有不同重新训练周期的模型集成，或将机器学习与规则或人机协作结合起来。作为最后手段，我们也可以调整我们的性能期望，准备应对降低的模型质量。

**在其他情况下，新数据会在模型退化之前开始累积。** 在这种情况下，我们有选择的余地。

我们当然可以在数据到达后的任何时候简单地启动重新训练。如果我们想更精确一点，有办法做到这一点。

继续阅读！

### 检查 #4。我们需要多少数据才能看到改进？

假设新数据每天到达，但模型只有在30天后才会退化。那么，最佳的行动是什么？我们应该每天、每周还是每月重新训练一次？

![图片](../Images/93da0c9a4e5c92b0642fc2c37d89f2a3.png)

我们可以通过检查新数据桶是否带来了我们想要的改进来做出更精确的判断。

问题是，有时添加一小部分新数据不会改变任何东西。存在一些最小的数据量，它对性能有明显的影响。

我们可以对此进行评估。

为此，我们选择一个已知退化时期的测试集。我们知道性能何时下降：然后我们可以检查是否在新数据上重新训练会改善性能。

![图片](../Images/36e21e33e0b86cf04f120b86ea13917b.png)

我们可以在数据到达时逐步添加数据。然后，观察它对测试性能的影响。

我们常常需要等待一段时间以收集“有用”的数据——例如，至少一周的数据以捕捉相关的季节性模式。

结果是，我们实际选择的重新训练窗口可能比看起来要窄！一方面，它受数据提供速度的限制。另一方面，受收集足够数据以使重新训练产生效果的需求限制。

![Image](../Images/0c8d71d262bc407a56865915a599e208.png)

在这个时间框架内，你可以根据实际情况和用例的需求选择适当的时期。

### 检查 #5。我们应该保留旧数据吗？

还有一个常见的问题。我们应该如何重新训练模型？我们应该添加一些新数据并丢弃一些旧数据吗？我们应该不断增加训练集吗？

这是我们可以进行的额外检查。

我们可以模仿在选择的间隔进行模型重新训练，然后检查如果我们开始丢弃旧数据，情况会如何变化。

![Image](../Images/2433693530f83ace89e16563af95b574.png)

我们常常发现，排除旧数据没有区别。那么，保持训练更轻量化可能是明智的做法。

更重要的是，有时这会让模型更好！如果你有一个动态的使用案例，保持旧的无关数据可能会导致性能下降。提前知道这一点是好的。

当然，我们也可能看到目前保留所有数据是有意义的。你可以稍后再重复检查。

### 下一步是什么？

通过这些检查，你可以为模型维护做好准备。你可以设置你的重新训练管道，以便在选择的间隔准备好更新。

尽管如此，我们不能仅仅依赖我们的时间表。我们还需要现实检查。这意味着，在模型上线后监控它们。

为了获得可见性，我们可以建立一个[监控仪表板](https://github.com/evidentlyai/evidently)或安排定期检查，以计算实际的模型性能（如果我们有真实情况），否则监控输入数据的统计分布漂移和异常值。

![Image](../Images/19db7390f4ca668c6a5a3a66023ce064.png)

即使是稳定的模型也可能面临[数据和概念漂移](https://evidentlyai.com/blog/machine-learning-monitoring-data-and-concept-drift)或某些稀有事件。在这种情况下，我们可能需要比计划更早地介入。

另一方面，如果情况看起来稳定，我们可以比计划更长时间跳过更新。

定期计划重新训练并辅以持续监控通常是让模型达到承诺性能的最佳策略！

**链接**

你可以在[这里](https://evidentlyai.com/blog/retrain-or-not-retrain)找到这篇文章的扩展版本。

[机器学习监控检查清单](/2021/03/machine-learning-model-monitoring-checklist.html)

**Emeli Dral** 是Evidently AI的联合创始人兼首席技术官，她创建了用于分析和监控ML模型的工具。此前，她共同创办了一家工业AI初创公司，并在Yandex Data Factory担任首席数据科学家。她是Coursera上的机器学习和数据分析课程的共同作者，该课程拥有超过100,000名学生。

[https://twitter.com/EmeliDral](https://twitter.com/EmeliDral)

**Elena Samuylova** 是Evidently AI的联合创始人兼首席执行官。此前，她共同创办了一家工业AI初创公司，并在Yandex Data Factory担任业务发展主管。自2014年以来，她与从制造业到零售业的公司合作，提供基于ML的解决方案。2018年，Elena被Product Management Festival评选为“欧洲50位女性产品经理”之一。

[https://twitter.com/elenasamuylova/](https://twitter.com/elenasamuylova/)

**相关：**

+   [从机器学习错误中学习](/2021/03/learning-from-machine-learning-mistakes.html)

+   [机器学习模型监控检查清单：7件事需要跟踪](/2021/03/machine-learning-model-monitoring-checklist.html)

+   [MLOps：模型监控101](/2021/01/mlops-model-monitoring-101.html)

### 更多相关内容

+   [使用Jupysql和GitHub Actions计划和运行ETL](https://www.kdnuggets.com/2023/05/schedule-run-etls-jupysql-github-actions.html)

+   [合规检查中的深度学习：有什么新变化？](https://www.kdnuggets.com/2022/05/deep-learning-compliance-checks-new.html)

+   [使用Pandas进行7项关键数据质量检查](https://www.kdnuggets.com/7-essential-data-quality-checks-with-pandas)

+   [从这些GitHub仓库学习机器学习](https://www.kdnuggets.com/2023/01/learn-machine-learning-github-repositories.html)

+   [了解如何在设备上仅需几步运行Alpaca-LoRA](https://www.kdnuggets.com/2023/05/learn-run-alpacalora-device-steps.html)

+   [在本地使用LM Studio运行LLM](https://www.kdnuggets.com/run-an-llm-locally-with-lm-studio)
