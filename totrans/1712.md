# 使用R进行流程挖掘：介绍。

> 原文：[https://www.kdnuggets.com/2017/11/process-mining-r-introduction.html](https://www.kdnuggets.com/2017/11/process-mining-r-introduction.html)

**作者：Seppe vanden Broucke，KU鲁汶大学**

当今的组织采用了各种信息支持系统来支持其业务流程。这些支持系统记录和记录了大量的数据，其中包含了与原始业务流程中任务的发生相关联的各种*事件*。[*流程挖掘*](http://www.dataminingapps.com/dma_research/process-analytics/)的领域从这些事件日志作为分析的基石出发，旨在从组织中“实时发生”的操作流程中获取建模、改进和扩展的知识。因此，流程挖掘可以被看作是业务流程管理（BPM）和数据挖掘领域的交叉点。

* * *

## 我们的前 3 个课程推荐。

![Google网络安全证书](https://www.kdnuggets.com/google-cybersecurity) - 快速迈入网络安全职业生涯的快车道。

![Google数据分析专业证书](https://www.kdnuggets.com/google-data-analytics) - 提升您的数据分析能力。

![Google IT支持专业证书](https://www.kdnuggets.com/google-itsupport) - 支持您在IT领域的组织。

* * *

在流程挖掘领域中最著名的任务称为*流程发现*（有时也称为流程识别），分析人员的目标是从数据中推导出一个即时的流程模型，而不是从一个作为描述模型起点并试图将实际数据与此模型对齐。流程挖掘依赖于现有的方法，尽管事件数据所带来的特定环境和要求导致了各种特定的工具和算法的出现。与传统数据挖掘相比，分析人员通常使用一个平坦的实例表进行工作，而流程挖掘则从一个*分层且具有内在顺序的*数据集开始。事件日志是由记录一个流程实例执行的多个步行组成的，每个步行本身由多个事件组成。这些事件根据其执行顺序进行排序。因此，流程挖掘的一个主要用例是将这个复杂的数据集抽象为一个可视化表示，即一个流程模型，突出显示频繁的行为、瓶颈或任何对最终用户可能感兴趣的数据维度。

传统的数据挖掘工具如R、SAS或Python在过滤、查询和分析平面表方面功能强大，但由于事件日志的特殊性质，尚未被过程挖掘社区广泛使用以实现上述任务。相反，出现了一系列独立的工具，包括但不限于：Disco、Minit、ProcessGold、Celonis Discovery、ProM等。在本文中，我们希望通过使用更传统的数据科学编程语言R，快速介绍如何创建丰富的过程映射。这将在上述工具可能不可用的情况下提供帮助，同时还提供了如何通过或更容易地将典型的过程挖掘任务与其他更与数据挖掘相关的任务相结合的提示。此外，与数据一起直接操作的操作方式将显示出，开始使用过程发现是非常简单的。我们选择R作为我们的“工作语言”，因为现代R的流畅性（即“tidyverse”包，特别是“dplyr”）使得其相对易读和简洁，尽管没有理由不能像Python等其他工具一样工作得很好。

我们将使用Disco提供的“[示例事件日志](http://www.dataminingapps.com/dma_research/process-analytics/)”作为运行示例。首先，我们加载一些需要的库，并定义一些辅助函数并加载事件日志：

[PRE0]

分析过程的关键步骤是：对于事件日志中的每个事件行，我们要确定（i）前一个活动，即在同一案例中该活动开始之前最近停止的活动，以及（ii）后续活动，即在同一案例中该活动完成后最快开始的活动。为此，我们首先给每个事件分配一个递增的行号，并用此行号构建两个新列来引用事件日志中的后续事件和前一个事件：

[PRE1]

使用这个准备好的事件日志数据集，我们已经可以获得许多有趣的描述性统计和洞察。例如，下面的代码块提供了事件日志中不同变体（路径）的概述：

[PRE2]

与许多过程一样，有几个变体构成了大部分的过程实例，其后是“长尾巴”行为：

![](../Images/e8a0c33bdf2881846042dc9a1b798f31.png)

接下来，我们构建两个只包含我们需要用于可视化过程映射的列的数据框，分别用于活动和边。我们还将在此步骤中计算事件持续时间。

[PRE3]

这后者需要一些周到的思考。虽然一个明确的 (ActivityA-ActivityB) 列表足以构建过程图，但我们需要考虑正确计算弧出现的次数以计算频率和其他指标。因此，我们首先将 (Case Identifier，RowNum，NextNum) 列表与 (Case Identifier，PrevNum，RowNum) 进行合并，并过滤出弧的一个端点等于 NA 的所有条目。然后，我们应用“distinct”运算符，以确保我们获得一个唯一列表，尽管在行号级别上，而不是在活动名称级别上。这样可以确保我们的频率计数保持正确。然后，我们可以通过连接事件日志本身上的两个端点，在活动级别上找出每个弧的端点。然后，对于每个弧，我们选择案例标识符、端点行号（“a”和“b”）、端点的活动名称、端点的活动开始和完成时间，以及基于端点的弧的持续时间，即弧的等待时间。

这是我们开始构建过程图所需要的所有信息。我们将使用优秀的“igraph”包来可视化过程图。然而，直接在 R 中绘制结果默认情况下效果不佳。可悲的是，igraph 像大多数绘图工具一样，是建立在图可以非常不结构化的假设上（想想社交网络图），因此面向过程的图的布局看起来不太吸引人。幸运的是，igraph 提供了强大的导出功能，我们可以利用它们的好处。在这里，我们将我们的图导出为 dot 文件格式，并使用“Graphviz”来执行实际的布局和生成结果图像。

让我们通过创建一个带有活动和弧的中位数持续时间注释的过程图来尝试这一点。首先，我们将为活动和边分别定义两个颜色渐变，并定义另一个小的辅助函数，然后构建包含持续时间信息的两个新的活动和边数据框：

[PRE4]

### 进一步了解

+   [如何在几秒钟内处理数百万行的 DataFrame](https://www.kdnuggets.com/2022/01/process-dataframe-millions-rows-seconds.html)

+   [机器学习过程的框架](https://www.kdnuggets.com/2018/05/general-approaches-machine-learning-process.html)

+   [在 Python 中处理 CSV 文件的 3 种方法](https://www.kdnuggets.com/2022/10/3-ways-process-csv-files-python.html)

+   [自然语言处理的简介](https://www.kdnuggets.com/2022/06/gentle-introduction-natural-language-processing.html)

+   [AI 中的爬山算法介绍](https://www.kdnuggets.com/2022/07/introduction-hill-climbing-algorithm-ai.html)

+   [SMOTE 简介](https://www.kdnuggets.com/2022/11/introduction-smote.html)
