- en: CSV Files for Storage? No Thanks. There’s a Better Option
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://www.kdnuggets.com/2021/08/csv-files-storage-better-option.html](https://www.kdnuggets.com/2021/08/csv-files-storage-better-option.html)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: '[comments](#comments)'
  prefs: []
  type: TYPE_NORMAL
- en: '**By [Dario Radečić](https://www.linkedin.com/in/darioradecic/), Consultant
    at NEOS**'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/d14607bf88dee7dbf39799962a09bbb6.png)'
  prefs: []
  type: TYPE_IMG
- en: Photo by [David Emrich](https://unsplash.com/@davidemrich?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText) on [Unsplash](https://unsplash.com/?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText)
  prefs: []
  type: TYPE_NORMAL
- en: Everyone and their grandmother know what a CSV file is. Parquet, not so much. *Is
    it a type of flooring?* Well, yes, but no — it’s a highly efficient data storage
    format, and you’ll learn all about it today.
  prefs: []
  type: TYPE_NORMAL
- en: CSVs are everywhere — from company reports to machine learning datasets. It’s
    a data format that’s simple and intuitive to work with — just open a file, and
    you have direct access to the data. It’s not as good as it sounds, for the reasons
    you’ll read in a bit.
  prefs: []
  type: TYPE_NORMAL
- en: There are many alternatives to CSVs — such as Excel, SQLite databases, and HDFs
    — but one in particular stands above the competition. That’s Parquet.
  prefs: []
  type: TYPE_NORMAL
- en: 'Today’s article answers the following questions:'
  prefs: []
  type: TYPE_NORMAL
- en: What’s wrong with CSVs?
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: What’s a Parquet data format?
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: CSV or Parquet? Which one should you use?
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: What’s wrong with CSVs?
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: I love CSVs, and so do you, probably. Pretty much any piece of software can
    generate CSV files, even plain text editors. If you’re into data science and machine
    learning, just head over to [Kaggle.com](https://www.kaggle.com/) — almost all
    tabular datasets are in this format.
  prefs: []
  type: TYPE_NORMAL
- en: CSVs are row-orientated, which means they’re slow to query and difficult to
    store efficiently. That’s not the case with Parquet, which is a column-orientated
    storage option. The size difference between those two is enormous for identical
    datasets, as you’ll see shortly.
  prefs: []
  type: TYPE_NORMAL
- en: Adding insult to injury, anyone can open and modify a CSV file. That’s why you
    should never use this type of format as a database. There are safer alternatives.
  prefs: []
  type: TYPE_NORMAL
- en: But let’s dial into what’s really important to companies — **time** and **money**.
    You’ll likely store data in the cloud, either as a basis for web applications
    or machine learning models. Cloud service providers will charge you based on the
    amount of data scanned or the amount of data stored. Neither looks good for CSVs.
  prefs: []
  type: TYPE_NORMAL
- en: 'Let’s look at the storage pricing for Amazon S3 first. The numbers were taken
    from [here](https://blog.openbridge.com/how-to-be-a-hero-with-powerful-parquet-google-and-amazon-f2ae0f35ee04):'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/7135321fc9ab9fb9bd49c4d317f2affb.png)'
  prefs: []
  type: TYPE_IMG
- en: Image 1 — Amazon S3 storage pricing for different data formats (image by author)
  prefs: []
  type: TYPE_NORMAL
- en: Yikes. Parquet files take much less disk space than CSVs (column *Size on Amazon
    S3*) and are faster to scan (column *Data Scanned*). As a result, the identical
    dataset is 16 times cheaper to store in Parquet format!
  prefs: []
  type: TYPE_NORMAL
- en: 'Next, let’s take a look at the speed increase with Apache Parquet:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/cde5d1c5b280a6901edec4f09d325fd1.png)'
  prefs: []
  type: TYPE_IMG
- en: Image 2 — Amazon S3 storage and query pricing comparison for different data
    formats (image by author)
  prefs: []
  type: TYPE_NORMAL
- en: Once again — yikes! Parquet is 99.7% cheaper if your original CSV file is 1TB
    in size.
  prefs: []
  type: TYPE_NORMAL
- en: So no, CSVs are nowhere near a good option when your data is big — both time
    and dollar wise.
  prefs: []
  type: TYPE_NORMAL
- en: But what’s a Parquet data format exactly?
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: It’s an alternative format for storing data. It’s open source and licensed under
    Apache.
  prefs: []
  type: TYPE_NORMAL
- en: Both CSV and Parquet formats are used to store data, but they can’t be any more
    different internally. CSVs are what you call *row storage*, while Parquet files
    organize the data in columns.
  prefs: []
  type: TYPE_NORMAL
- en: 'Here’s what that means. Imagine you have the following data:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/a854a06b4e48249c7e7da1cbb69b7f45.png)'
  prefs: []
  type: TYPE_IMG
- en: Image 3 — Dummy table data (image by author)
  prefs: []
  type: TYPE_NORMAL
- en: 'Here’s how the previous table would be organized in both row and column storage:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/c529e06ae2f92f3745a38a2e8891e977.png)'
  prefs: []
  type: TYPE_IMG
- en: Image 4 — Row vs. column storage (image by author)
  prefs: []
  type: TYPE_NORMAL
- en: In a nutshell, column storage files are more lightweight, as adequate compression
    can be done for each column. That’s not the case with row storage, as one row
    usually contains multiple data types.
  prefs: []
  type: TYPE_NORMAL
- en: 'Apache Parquet is designed for efficiency. The column storage architecture
    is the reason why, as it allows you to skip data that isn’t relevant quickly.
    This way both queries and aggregations are faster, resulting in hardware savings
    (read: it’s cheaper).'
  prefs: []
  type: TYPE_NORMAL
- en: In a nutshell, Parquet is a more efficient data format for bigger files. You
    will save both time and money by using Parquet over CSVs.
  prefs: []
  type: TYPE_NORMAL
- en: If you’re a Python guy, working with CSV files in Pandas should sound familiar.
    Let’s see how the library handles Parquet files next.
  prefs: []
  type: TYPE_NORMAL
- en: Hands-on CSV and Parquet comparison
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: You’ll use the [NYSE stock prices dataset](https://www.kaggle.com/dgawlik/nyse?select=prices.csv) for
    this hands-on part. The CSV file is around 50MB in size — nothing big — but you’ll
    see how much disk space Parquet will save.
  prefs: []
  type: TYPE_NORMAL
- en: 'To start, load in the CSV file with Python’s Pandas:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: 'Here’s how it looks like:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/0651ecc4b1d1f15616a4ea75d9af4779.png)'
  prefs: []
  type: TYPE_IMG
- en: Image 5 — Head of NYSE stock prices dataset — CSV (image by author)
  prefs: []
  type: TYPE_NORMAL
- en: 'You’ll have to use the `to_parquet()` function to save the dataset. It works
    the same as the `to_csv()`, for the most part, so using it won’t feel different:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs: []
  type: TYPE_PRE
- en: 'The dataset is now saved. Let’s see how to load it before comparing file sizes.
    Pandas has `read_parquet()` function for reading Parquet data files:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE2]'
  prefs: []
  type: TYPE_PRE
- en: 'Here’s how the dataset looks like:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/9f7b652826b990832a6a981428f64bc7.png)'
  prefs: []
  type: TYPE_IMG
- en: Image 6 — Head of NYSE stock prices dataset — Parquet (image by author)
  prefs: []
  type: TYPE_NORMAL
- en: Both datasets are identical. The command `df.equals(df_parquet)` will print `True` to
    the console, so feel free to use it for verification.
  prefs: []
  type: TYPE_NORMAL
- en: 'So, are there any decreases in file size? Umm, yeah:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/652fc4de3649e290bb33e192e18073e8.png)'
  prefs: []
  type: TYPE_IMG
- en: Image 7 — CSV vs. Parquet file sizes on NYSE stock prices dataset (image by
    author)
  prefs: []
  type: TYPE_NORMAL
- en: That’s roughly four times less in disk space usage.
  prefs: []
  type: TYPE_NORMAL
- en: '*Does it matter for 50MB datasets?* Probably not, but the savings scale on
    larger datasets, too. That’s especially important if you’re storing data on the
    cloud and paying for the overall size.'
  prefs: []
  type: TYPE_NORMAL
- en: That’s something to think about.
  prefs: []
  type: TYPE_NORMAL
- en: '*Loved the article? Become a *[*Medium member*](https://medium.com/@radecicdario/membership)* to
    continue learning without limits. I’ll receive a portion of your membership fee
    if you use the following link, with no extra cost to you: *[*https://medium.com/@radecicdario/membership*](https://medium.com/@radecicdario/membership)'
  prefs: []
  type: TYPE_NORMAL
- en: Stay connected
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Follow me on [Medium](https://medium.com/@radecicdario) for more stories like
    this
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Sign up for my [newsletter](https://mailchi.mp/46a3d2989d9b/bdssubscribe)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Connect on [LinkedIn](https://www.linkedin.com/in/darioradecic/)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Bio: [Dario Radečić](https://www.linkedin.com/in/darioradecic/)** is a consultant
    at NEOS.'
  prefs: []
  type: TYPE_NORMAL
- en: '[Original](https://towardsdatascience.com/csv-files-for-storage-no-thanks-theres-a-better-option-72c78a414d1d).
    Reposted with permission.'
  prefs: []
  type: TYPE_NORMAL
- en: '**Related:**'
  prefs: []
  type: TYPE_NORMAL
- en: '[5 Python Data Processing Tips & Code Snippets](/2021/07/python-tips-snippets-data-processing.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[How to Query Your Pandas Dataframe](/2021/08/query-pandas-dataframe.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Pandas not enough? Here are a few good alternatives to processing larger and
    faster data in Python](/2021/07/pandas-alternatives-processing-larger-faster-data-python.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '* * *'
  prefs: []
  type: TYPE_NORMAL
- en: Our Top 3 Course Recommendations
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 1\. [Google Cybersecurity
    Certificate](https://www.kdnuggets.com/google-cybersecurity) - Get on the fast
    track to a career in cybersecurity.'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/e225c49c3c91745821c8c0368bf04711.png) 2\. [Google Data Analytics
    Professional Certificate](https://www.kdnuggets.com/google-data-analytics) - Up
    your data analytics game'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 3\. [Google IT Support
    Professional Certificate](https://www.kdnuggets.com/google-itsupport) - Support
    your organization in IT'
  prefs: []
  type: TYPE_NORMAL
- en: '* * *'
  prefs: []
  type: TYPE_NORMAL
- en: More On This Topic
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: '[3 Ways to Process CSV Files in Python](https://www.kdnuggets.com/2022/10/3-ways-process-csv-files-python.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[There and Back Again… a RAPIDS Tale](https://www.kdnuggets.com/2023/06/back-again-rapids-tale.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Is There a Way to Bridge the MLOps Tools Gap?](https://www.kdnuggets.com/2022/08/way-bridge-mlops-tools-gap.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[From CSV to Complete Analytical Report with ChatGPT in 5 Simple Steps](https://www.kdnuggets.com/from-csv-to-complete-analytical-report-with-chatgpt-in-5-simple-steps)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[From Oracle to Databases for AI: The Evolution of Data Storage](https://www.kdnuggets.com/2022/02/oracle-databases-ai-evolution-data-storage.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Cloud Storage Adoption is the Need of the Hour for Business](https://www.kdnuggets.com/2022/02/cloud-storage-adoption-need-hour-business.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
