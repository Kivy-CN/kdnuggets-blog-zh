# 使用人工智能识别塞伦盖蒂相机陷阱图像中的野生动物

> 原文：[https://www.kdnuggets.com/2020/02/using-ai-identify-wildlife-images-serengeti.html](https://www.kdnuggets.com/2020/02/using-ai-identify-wildlife-images-serengeti.html)

[评论](#comments)

**由 [Marek Rogala](https://www.linkedin.com/in/marrogala/) 和 [Jędrzej Świeżewski, PhD](https://www.linkedin.com/in/swiezew/) [Appsilon](https://appsilon.com/)**

一个用于生物多样性研究的机会...

* * *

## 我们的前三大课程推荐

![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 1\. [谷歌网络安全证书](https://www.kdnuggets.com/google-cybersecurity) - 快速进入网络安全职业的快车道。

![](../Images/e225c49c3c91745821c8c0368bf04711.png) 2\. [谷歌数据分析专业证书](https://www.kdnuggets.com/google-data-analytics) - 提升你的数据分析技能

![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 3\. [谷歌IT支持专业证书](https://www.kdnuggets.com/google-itsupport) - 支持你组织的IT需求

* * *

相机陷阱成像（自动拍摄野生动物物种的摄影）正成为生物多样性保护工作的黄金标准。它能够在前所未有的规模上准确监测大片土地。然而，使用这些设备生成的数据量巨大，使得人类分析非常困难。随着机器学习和计算机视觉的最新发展，我们获得了处理这个问题的工具，为生物多样性社区提供了利用由热量和运动触发的系统自动生成知识的潜力。

![图](../Images/03a373af4a8cc9ecf8e46e92aa13c817.png)

相机陷阱，或许比人工调查员干扰更小，但仍然引起关注

### …以及对机器学习社区的挑战

我们最近参加了**Hakuna-ma Data**，这是由[DrivenData](https://www.drivendata.org/competitions/59/camera-trap-serengeti/page/145/)与[微软AI for Earth](https://www.microsoft.com/en-us/ai/ai-for-earth)合作组织的比赛，要求参与者构建一个能够在不同时间和地点良好泛化的野生动物检测算法。与以往的比赛不同，这次比赛中研究人员、数据科学家和开发人员无法直接访问测试图像集，而是需要提交他们的模型，由活动组织者在微软Azure中执行。来自全球的811名参与者使用10个季节的公开数据训练他们的模型，最后将解决方案提交至第11季的私有数据集进行测试。

我们祝贺所有参赛者以及*ValAn_picekl*团队获得了12,000美元的大奖。我们也很自豪地宣布，我们在最终排行榜中获得了第五名，并且愿意分享我们是如何实现这一成就的。

你可以在[这里](https://colab.research.google.com/github/Appsilon/serengeti_try_it_yourself/blob/master/classify_images_on_colab.ipynb)的Google Colab笔记本中试用我们的最终模型。

### 我们的方法

比赛涉及处理大量图像，因此必须使用快速的神经网络框架，并配备强大的GPU。我们从Google Cloud Platform配置了虚拟机，配备了足够强大的GPU（从Tesla K80到Tesla V100，用于最重的计算任务）。通常，我们会并行运行几个虚拟机以加快实验速度。我们使用Python代码，在GitHub仓库中协调关键代码部分，并利用笔记本进行快速实验和模型性能的可视化检查。我们在Fast.ai（PyTorch后台）中构建模型，并利用[Weights & Biases](https://www.wandb.com/)跟踪我们的实验。

根据之前对数据集的[研究](https://www.pnas.org/content/115/25/E5716)，我们决定使用ResNet 50，这是一种相当适中的深度架构。由于我们在比赛接近尾声时才加入，因此选择不实验其他（或更深的）架构。在看到这个架构的初步结果有前景后，我们决定专注于改进这些结果。

由于时间紧迫，我们必须优化策略。我们使用了敏捷的方法：快速创建了我们的“最小可行产品”（MVP）解决方案，然后根据其结果进行了大量迭代。最初，每五天允许提交一次，这给了我们一种自然的冲刺节奏。

数据集本身具有挑战性：660万张相对较大分辨率的照片——几TB的数据。我们重新使用了其中一个参与者提供的数据集版本，在这个版本中，照片的分辨率显著缩小（每边缩小4倍）。

![图像类别和出现百分比](../Images/317f4a3731b22e9118ed502993f0a611.png)

数据集非常不平衡——大约75%的图像是空的。最常见的动物是角马、斑马和汤普森的瞪羚。另一方面，有一些超级稀有的动物，如steenbok或蝙蝠，只能在少数几张照片中看到。

![图](../Images/74b46d7bdee3dcddb6f66523f5aa0f2e.png)

在自然界中罕见——犀牛是数据集中最不常见的物种之一

### 成功的5个关键因素

我们相信以下5个关键因素对我们模型的成功贡献最大：

### **1\. 大型验证集**

这对于确保模型的良好泛化至关重要，因为我们是在最后一个赛季——一个私有的、未公开的数据集上进行评估的。每个赛季来自不同的年份。我们决定将整个赛季（第8赛季）保留用于验证——我们希望它包含许多图像（几乎有一百万张！），并且相对较新——因为测试集包含的是尚未发布的第11赛季。这个选择还得到了对各赛季间个体物种分布的研究支持。我们注意到，只有最后三个赛季（第8、9和10赛季）包含了一些相对稀有物种的照片。

### **2\. 使用递增分辨率的训练**

我们将训练过程分为三个阶段。每个阶段包括先训练网络的最终层，然后训练所有层。在每个阶段，我们都在逐渐更高分辨率的图像上训练模型，从而使训练时间更长而不发生过拟合。我们使用的最大分辨率是512×384，这仍然是每个维度提供图像的四分之一。

最终模型在以下阶段进行训练：

1.  在128×96 px图像上进行网络最终层的5个周期训练

1.  在128×96 px图像上进行5个周期的训练

1.  在256×192 px图像上进行网络最终层的5个周期训练

1.  在256×192 px图像上进行所有层的5个周期训练

1.  在512×384 px图像上进行网络最终层的5个周期训练

1.  在512×384 px图像上进行所有层的5个周期训练

这种方法显著加快了我们的训练速度——即便是处理128×96图像的模型也达到了良好的准确性，我们可以比512×384模型训练得更快。在此，我们要特别感谢Pavel Pleskov，他是比赛的参与者，以健康竞争的精神，与社区分享了一个缩小版的数据集，节省了我们的下载时间，并使更多的参与者能够加入。

### **3\. 数据增强 / 单周期拟合**

在训练过程中，我们使用了标准的图像增强方法（水平翻转、小幅旋转、小幅缩放、小幅变形和光照调整），以防止模型在像素级别过拟合，并帮助其泛化。我们使用了[Leslie Smith的单周期策略](https://arxiv.org/pdf/1803.09820.pdf)来加快训练速度。

### **4\. 激进的欠采样**

我们从训练集中剔除了大量最常见类别的样本（例如，95%的空照片），以便在训练过程中对来自较少见类别的样本施加更多压力。这使得我们能够显著加快训练速度，帮助模型专注于输入空间中的挑战部分。这里的一个警告是需要聪明地去除这些样本——保留训练集中包含多只动物的样本，因为这些样本对模型来说更具挑战性。

![图像](../Images/b843ba700b8e735ff3b98deeceb8be35.png)

一张图片中包含多只动物——这是对ML模型的一个挑战性案例

### **5\. 损失检查 / 后处理**

使我们能将准确性推向顶级位置的是深入分析数据和初始模型给出的结果。我们想查看哪些图像我们处理错误，以及在我们预测的置信度范围内发生了什么。为了最小化损失并优化我们的提交，我们研究了各个类别，并检查了我们最容易失分的地方。

在这一阶段，我们选择了从所有图像中进行简单推断机制，而不仅仅是单个图像。我们从每个序列的第一张图像中获取预测（再次由验证集上的结果指导），除非序列中后面的照片中某个物种的最大预测值更高并超过某个阈值（这样我们允许，例如，“其他鸟”在序列后面的帧中飞过来影响预测）。对于“空”的类别也是类似，我们从序列中的第一张照片中获取预测，除非在后来的照片中，该类别的预测低于某个阈值（这样，如果动物只出现在后面，"空"的预测会适当地降低）。

接下来，我们处理了每种物种的预测值范围，并进行了基础线性变换的网格搜索，以最小化验证集上的损失。这大大提高了得分——很可能是通过使模型返回的概率更好地反映数据集中物种的分布。

### 回顾一下——我们希望做的事情

我们还有一些其他想尝试的想法，但由于我们是在比赛结束前仅三周才加入的，因此没有尝试。特别是：

### **焦点损失**

目前的数据集高度不平衡。除了我们实施的激进下采样方法（见上文），另一种选择是使用修改后的损失函数，即焦点损失。虽然 [首次提出](https://arxiv.org/pdf/1708.02002.pdf) 是在目标检测的背景下，但最近也在不平衡分类问题中得到应用。

### **更多的训练时间，更多的周期**

各种迹象表明，我们的模型可能只是需要更长时间的训练才能取得更好的得分。虽然担心过拟合，我们采取了保守的训练安排，不过如果有更多时间，我们希望在各个阶段探索更长时间的训练（见上文）。

### **使用两阶段方法：动物位置检测和动物分类**

我们考虑使用两阶段的方法，第一阶段的模型专注于动物的存在，而不考虑其物种，第二阶段的模型专注于物种分类。这种方法可以提高准确性，并且在以前的研究中有所建议。由于时间有限，我们选择不尝试这种方法。

比赛结束后，我们了解到微软AI for Earth的Siyu Yang和Dan Morris在这一领域的出色工作。他们建立了[一种动物检测模型](https://medium.com/microsoftazure/accelerating-biodiversity-surveys-with-azure-machine-learning-9be53f41e674)。该模型识别照片中的动物，并为正向预测提供边界框。该模型的强大之处在于其训练数据来自多个地理位置。

他们建议使用一种通用模型来检测动物位置，以及一个针对项目和地点的特定模型来进行物种分类。一大优势是，第二个模型可以准确地专注于动物，这显然有助于提高准确性。这种方法在识别图像中的多种动物时也能大大帮助。

### **数据清理**

在调查我们模型的表现时，我们注意到许多标记错误的例子（例如，在一系列图像中仅显示了一只斑马的腿——标记为空的图像被我们的模型以高确定性分类为斑马）。还有许多夜间拍摄的图像，人工标注者未发现任何动物，而模型却非常确定地看到了它们。在手动调整这些图像的色彩水平后，黑暗确实揭示了检测到的动物。这一事实涉及一个非常重要的话题：我们应该建立复制标注者工作的模型（这种方法由比赛规则推荐），还是应专注于在捕获的图像中尽可能准确地检测动物的模型。

### 我们为何加入以及这对我们的意义。

比赛让我们深入了解了野生动物图像分类的世界。我们对结果非常满意，并且在处理这些模型时非常愉快。我们能够展示和完善我们的计算机视觉技能，这对我们的[AI for Good](https://appsilon.com/ai-for-good/)计划至关重要。我们目前正在为加蓬国家公园管理局构建一个野生动物图像分类器的试点版本，并将应用我们的新知识。敬请关注我们即将发布的项目。我们决心展示AI可以对生活和我们共同分享的世界产生切实的积极影响。

### **关注Appsilon数据科学的社交媒体**

+   在[Twitter](https://twitter.com/appsilon)上关注[@Appsilon](https://twitter.com/appsilon)。

+   在[LinkedIn](https://www.linkedin.com/company/appsilon)上关注Appsilon。

+   注册我们的公司[通讯](https://appsilon.com/blog/)。

+   试用我们的R Shiny[开源](https://appsilon.com/opensource/)包。

+   注册[AI for Good](https://appsilon.com/ai-for-good/)通讯。

+   我们正在招聘[软件工程师](https://appsilon.com/careers/)。

[原文](https://appsilon.com/using-ai-identify-wildlife-camera-trap-images-serengeti/)。经许可转载。

**相关：**

+   [创建你自己的计算机视觉沙盒]( /2020/02/computer-vision-sandbox.html)

+   [从 NeurIPS 2019 看现代 AI 的全景]( /2020/01/modern-ai-from-neurips-2019.html)

+   [AI 和机器学习在我们日常生活中的应用]( /2020/02/ai-machine-learning-everyday-life.html)

### 更多相关主题

+   [识别机器学习可解决问题的 4 个因素](https://www.kdnuggets.com/2022/04/4-factors-identify-machine-learning-solvable-problems.html)

+   [如何识别时间序列数据集中的缺失数据](https://www.kdnuggets.com/how-to-identify-missing-data-in-timeseries-datasets)

+   [使用管道编写清晰的 Python 代码](https://www.kdnuggets.com/2021/12/write-clean-python-code-pipes.html)

+   [停止学习数据科学以寻找目标，并通过寻找目标…](https://www.kdnuggets.com/2021/12/stop-learning-data-science-find-purpose.html)

+   [成为优秀数据科学家需要的 5 个关键技能](https://www.kdnuggets.com/2021/12/5-key-skills-needed-become-great-data-scientist.html)

+   [每个初学者数据科学家应掌握的 6 个预测模型](https://www.kdnuggets.com/2021/12/6-predictive-models-every-beginner-data-scientist-master.html)
