# 使用 Python 掌握数据准备的 7 个步骤

> 原文：[https://www.kdnuggets.com/2017/06/7-steps-mastering-data-preparation-python.html](https://www.kdnuggets.com/2017/06/7-steps-mastering-data-preparation-python.html)

数据准备、清理、预处理、清洗、处理。无论您选择哪个术语，它们都指代机器学习、数据挖掘和数据科学领域中一组大致相关的建模前数据活动。

![CRISP-DM中的数据准备](../Images/46d01de23b57f7116bef588b1995aa70.png)

数据准备在[CRISP-DM模型](https://en.wikipedia.org/wiki/Cross_Industry_Standard_Process_for_Data_Mining)中的应用。

* * *

## 我们的前三大课程推荐

![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 1\. [Google 网络安全证书](https://www.kdnuggets.com/google-cybersecurity) - 快速进入网络安全职业生涯。

![](../Images/e225c49c3c91745821c8c0368bf04711.png) 2\. [Google 数据分析专业证书](https://www.kdnuggets.com/google-data-analytics) - 提升您的数据分析水平

![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 3\. [Google IT 支持专业证书](https://www.kdnuggets.com/google-itsupport) - 支持您的组织的 IT

* * *

例如，万象百科全书将[数据清理](https://en.wikipedia.org/wiki/Data_cleansing)定义为：

> ...是检测和修正（或删除）记录集、表格或数据库中的损坏或不准确记录的过程，涉及识别数据中不完整、不正确、不准确或不相关的部分，然后替换、修改或删除脏数据或粗略数据。数据清理可以通过数据处理工具进行交互式操作，或通过脚本批量处理。

[数据处理](https://en.wikipedia.org/wiki/Data_wrangling)，作为对比，维基百科定义为：

> ...是将数据从一种“原始”形式手动转换或映射到另一种格式，以便更方便地使用数据，借助半自动化工具完成。这可能包括进一步的数据清理、数据可视化、数据聚合、训练统计模型以及许多其他潜在用途。数据清理作为一个过程通常遵循一系列通用步骤，首先从数据源中提取原始数据，使用算法（例如排序）或将数据解析到预定义的数据结构中“清理”原始数据，最后将结果内容存储到数据存储器中以便存储和未来使用。

尽管我首先要指出我对术语“[数据终端](http://www.computerhope.com/jargon/d/datasink.htm)”并不感到兴奋，但我会继续说，在“将数据从一种‘原始’形式映射到另一种形式……”的背景下，它指的是“识别数据中的不完整、不正确、不准确或无关部分，然后替换、修改或删除这些脏数据或粗糙数据”，一直到“训练统计模型”，我喜欢将数据准备看作包括在内，或者说“从数据源到但不包括模型构建的所有内容。”这就是我们将继续使用的模糊但却奇异准确的定义。

但请记住，这篇文章涵盖了一组特定的数据准备技术，根据要求，可能会在特定情况下使用额外的或完全不同的技术。你会发现这里所持的建议既是传统的，又是通用的。

### 第一步：为准备工作做好准备

首先，让我们强调一下其他人已经告诉你的：可以说这个数据准备阶段并不是机器学习任务的初步步骤，而实际上是典型机器学习任务中一个重要的组成部分（甚至是多数）。但就我们的目的而言，我们将数据准备从建模中分离出来作为一个独立的过程。

由于 Python 是生态系统的一部分，我们将要讨论的大部分内容将与[Pandas](http://pandas.pydata.org/)相关。对于未接触过的人来说，Pandas 是一个数据操作和分析库，是 Python 科学编程栈的基石之一，非常适合许多与数据准备相关的任务。

数据准备可以在上面展示的 CRISP-DM 模型中看到（尽管可以合理地认为“数据理解”也符合我们的定义）。我们也可以将数据准备等同于 KDD 过程的框架——特别是前三个主要步骤——即**选择**、**预处理**和**转换**。我们可以将这些步骤细分为更细的粒度，但在宏观层面上，这些 KDD 过程的步骤包含了数据整理的内容。

![KDD 过程](../Images/d8eb8e24aba62cd437bb352025aca7d7.png)

KDD 过程。

尽管读者应该能够在没有太多额外资源的情况下跟随本指南，但对于那些对 Pandas 有更全面了解的人，可以在以下资源中找到有用的信息：

+   [10分钟了解Pandas](http://pandas.pydata.org/pandas-docs/stable/10min.html)，Pandas 文档

+   [Pandas 数据结构简介](http://www.gregreda.com/2013/10/26/intro-to-pandas-data-structures/)，作者：Greg Reda

+   [现代 Pandas（分为 7 部分）](http://tomaugspurger.github.io/modern-1.html)，作者：Tom Augspurger

关于数据准备过程的反馈来自三位内部人士——Sebastian Raschka、Clare Bernard 和 Joe Boutros——在继续之前，请阅读这次采访：

+   [数据准备技巧、窍门和工具：与内部人士的访谈](/2016/10/data-preparation-tips-tricks-tools.html)，作者：Matthew Mayo

### 步骤 2：探索性数据分析

[探索性数据分析](https://en.wikipedia.org/wiki/Exploratory_data_analysis)（EDA）是任何更大数据分析、数据科学或机器学习项目的一个组成部分。在处理数据之前理解数据不仅仅是个不错的主意，如果你计划完成任何有意义的事情，这是一个优先事项。在她的文章[探索性数据分析的价值](/2017/04/value-exploratory-data-analysis.html)中，Chloe Mawer 解释道：

> 从高层次来看，EDA（探索性数据分析）是使用视觉和定量方法来理解和总结数据集的实践，而不对其内容做出任何假设。在进入机器学习或统计建模之前，这是一个至关重要的步骤，因为它提供了开发适当模型所需的背景，并正确解释结果。

基本的要点是，我们需要了解数据的组成，才能有效选择预测算法或规划数据准备的剩余步骤。随便将数据集投入最热门的算法，并希望得到最好的结果，这不是一种策略。

了解我们的需求也很重要：如果将人类可读的输出作为主要优先级来解释结果，那么使用神经网络可能无法满足要求。在特定场景下，决策树可能不会提供最高的分类准确度，但任何在准确度上的妥协可能会被接受，以换取可解读的过程（*并* 引发恶意邮件）。

Chloe 说明，EDA 通常包括以下方法的组合：

+   对原始数据集中每个字段的单变量可视化和汇总统计。

+   对数据集中每个变量与感兴趣的目标变量（例如流失时间、支出）之间关系的双变量可视化和汇总统计。

+   多变量可视化用于理解数据中不同领域之间的交互。

+   维度减少以理解数据中导致观察结果之间最大方差的字段，并允许处理减少量的数据。

+   将数据集中相似的观察结果聚类为不同的组，通过将数据合并为几个小数据点，可以更容易地识别行为模式。

需要注意的是，她的文章强调了在 EDA 过程中可视化的重要性，而不仅仅是简单的汇总。此外，我们不会花太多时间在 EDA 的更高级方面（维度减少与观察结果的聚类）上，因为我希望在不久的将来写一些更深入的内容。

要了解探索性数据分析为何重要（以及为何常常得不到应有的重视），[阅读 Chloe 的文章](/2017/04/value-exploratory-data-analysis.html)。

![EDA鸢尾花](../Images/a693b17e7e06f6bb8261edf83d6e2fed.png)

[鸢尾花数据集](https://en.wikipedia.org/wiki/Iris_flower_data_set)的分布可视化摘录。

关于应用于泰坦尼克号数据集的探索性数据分析过程的示例，请阅读：

+   [泰坦尼克号探索性数据分析](https://github.com/TarekDib03/titanic-EDA/blob/master/Titanic%20-%20Project.ipynb)，作者 Tarek Dib

要了解如何使用[Seaborn](https://seaborn.pydata.org/)这一统计数据可视化库来可视化数据集分布，请参见：

+   [数据集分布可视化](http://seaborn.pydata.org/tutorial/distributions.html)，Seaborn文档

一对可能对数据探索有用的附加库：

+   [Dora](https://github.com/NathanEpstein/Dora) - Python中的探索性数据分析工具，作者 Nathan Epstein

+   [pandas-profiling](https://github.com/JosPolfliet/pandas-profiling) - 从pandas DataFrame对象创建HTML报告，作者 Jos Polfliet

关于分类数据的简要说明，请参见以下内容：

+   [数据科学的定性研究方法？](/2017/05/qualitative-research-methods-data-science.html)，作者 Kevin Gray

+   [在Python中生成词云](https://github.com/amueller/word_cloud)，作者 Andreas Mueller

### 第3步：处理缺失值

处理缺失数据的策略有很多种，且没有一种策略适用于所有情况。有些人会说“永远不要使用包含空值的实例。”而其他人则争辩“永远不要用属性的均值替代缺失值。”相反，你可能会听到一些更复杂的方法被全盘认可，例如“仅在将数据集初步划分为已知类别的数量后，再使用簇内回归计算缺失值才是有效的。”

别听这些话。 “从不”和“仅仅”等不灵活的断言在数据精细化的复杂世界中毫无价值；不同类型的数据和过程建议不同的最佳实践来处理缺失值。然而，由于这种知识既基于经验又基于领域，我们将重点关注可以应用的更基本策略。

![缺失部分](../Images/ec3c609ca1c1cd7e4305cd72bb8f609a.png)

另一个烦人的缺失值。

一些处理缺失值的常见方法包括：

+   删除实例

+   删除属性

+   对所有缺失值进行属性均值填充

+   对所有缺失值进行属性中位数填充

+   对所有缺失值进行属性众数填充

+   使用回归填充属性缺失值

如上所述，所采用的建模方法类型显然会影响你的决策——例如，决策树不适合处理缺失值。此外，你可以从技术上考虑任何你能想到的统计方法来确定数据集中的缺失值，但所列方法是经过验证并且常用的方法。

由于我们在这里讨论的是基于 Python 和 Pandas 的内容，以下是相关信息：

+   [处理缺失数据](http://pandas.pydata.org/pandas-docs/stable/missing_data.html)，Pandas 文档

+   [pandas.DataFrame.fillna](https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.fillna.html)，Pandas 文档

有很多方法可以在 Pandas DataFrame 中填充缺失值，用你想要的值来替换它们。以下是一些基本示例：

关于处理缺失值，特别是填补缺失值的更多观点，请参见：

+   [如何处理数据中的缺失值：第一部分](https://clevertap.com/blog/how-to-treat-missing-values-in-your-data-part-i/)，作者：Jacob Joseph

+   [如何处理数据中的缺失值：第二部分](https://clevertap.com/blog/how-to-treat-missing-values-in-your-data-part-ii)，作者：Jacob Joseph

### 相关话题更多信息

+   [每个数据科学家都应该知道的三种 R 库（即使你使用 Python）](https://www.kdnuggets.com/2021/12/three-r-libraries-every-data-scientist-know-even-python.html)

+   [使用管道编写干净的 Python 代码](https://www.kdnuggets.com/2021/12/write-clean-python-code-pipes.html)

+   [是什么使 Python 成为初创公司的理想编程语言](https://www.kdnuggets.com/2021/12/makes-python-ideal-programming-language-startups.html)

+   [停止学习数据科学以寻找目标，并通过找到目标来…](https://www.kdnuggets.com/2021/12/stop-learning-data-science-find-purpose.html)

+   [成为优秀数据科学家所需的 5 个关键技能](https://www.kdnuggets.com/2021/12/5-key-skills-needed-become-great-data-scientist.html)

+   [每个初学者数据科学家应掌握的 6 种预测模型](https://www.kdnuggets.com/2021/12/6-predictive-models-every-beginner-data-scientist-master.html)
