- en: How to Query Your Pandas Dataframe
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://www.kdnuggets.com/2021/08/query-pandas-dataframe.html](https://www.kdnuggets.com/2021/08/query-pandas-dataframe.html)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: '[comments](#comments)'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/a8d0cccf6912098661a5651e49f5b19c.png)'
  prefs: []
  type: TYPE_IMG
- en: Photo by [Bruce Hong](https://unsplash.com/@hongqi?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText) on [Unsplash](https://unsplash.com/s/photos/pandas?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText) [1].
  prefs: []
  type: TYPE_NORMAL
- en: Table of Contents
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Introduction
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Multiple Conditions
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Merging On Multiple, Specific Columns
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Summary
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: References
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Introduction
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Whether you are transitioning from a data engineer/data analyst or wanting to
    become a more efficient data scientist, querying your dataframe can prove to be
    quite a useful method of returning specific rows that you want. It is important
    to note that there is a specific query function for pandas, appropriately named, `query`.
    However, I will instead be discussing the other ways that you can mimic querying,
    filtering, and merging your data. We will present common scenarios or questions
    that you would ask to your data, and rather than SQL, we will do it with Python.
    In the paragraphs below, I will outline some simple ways of querying rows for
    your pandas dataframe with the Python programming language.
  prefs: []
  type: TYPE_NORMAL
- en: Multiple Conditions
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '![](../Images/c4301593d28a895ed778e4be49d690c6.png)'
  prefs: []
  type: TYPE_IMG
- en: Sample data. Screenshot from Author [2].
  prefs: []
  type: TYPE_NORMAL
- en: As data scientists or data analysts, we want to return specific rows of data.
    One of these scenarios is where you want to apply multiple conditions, all in
    the same line of code. In order to display my example, I have created some fake
    sample data of a first and last name, as well as their respective gender and birthdate.
    This data is displayed above in the screenshot.
  prefs: []
  type: TYPE_NORMAL
- en: The example multiple conditions will essentially answer a specific question,
    just like when you use SQL. The question is, what percent of our data is Male
    gender **OR** a person who was born between 2010 and 2021.
  prefs: []
  type: TYPE_NORMAL
- en: 'Here is the code that will solve that question (*there are a few ways to answer
    this question, but here is my specific way of doing it*):'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: To better visualize this code, I have also included this screenshot of that
    same code from above, along with the output/result. You can also apply these conditions
    to return the actual rows instead of getting the fraction or percent of rows out
    of the total rows.
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/fc423a030c4f9c0cba64fa830739c97b.png)'
  prefs: []
  type: TYPE_IMG
- en: Conditions code. Screenshot by Author [3].
  prefs: []
  type: TYPE_NORMAL
- en: 'Here is the order of commands we performed:'
  prefs: []
  type: TYPE_NORMAL
- en: Return rows with Male `Gender`
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Include the **OR** function `|`
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Return the rows of `Birthdate` > 2010 and 2021
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Combine those all, and then divide by the total amount of rows
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: As you can see, this code is similar to something you would see in SQL. I personally
    think it is easier in pandas because it can be less code, while also being able
    to visually see all the code in one easy spot, without having to scroll up and
    down (*but this format is just my preference*).
  prefs: []
  type: TYPE_NORMAL
- en: Merging On Multiple, Specific Columns
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '![](../Images/bf66ad20c341f188e72538bc2f7ad90e.png)'
  prefs: []
  type: TYPE_IMG
- en: Merged dataframe result. Screenshot by Author [4].
  prefs: []
  type: TYPE_NORMAL
- en: We have probably seen how to merge dataframes together in other tutorials, so
    I wanted to add a unique approach that I have not really seen out there, which
    is merging on multiple, specific columns. In this scenario, we want to join two
    dataframes where two fields are shared between them. You could tell that if there
    are even more columns, this method could be even more useful.
  prefs: []
  type: TYPE_NORMAL
- en: 'We have our first dataframe, which is df, then we are merging our columns on
    a second dataframe, df2\. Here is that code to achieve our expected result:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs: []
  type: TYPE_PRE
- en: To better visualize this merging and code, I have presented the screenshot below.
    You see what the second dataframe looks like below, with the `First` and `Last` names,
    just like they are in the first dataframe, but with a new column, `Numeric`. Then,
    we have out specific columns that we wanted to merge on, while returning columns `Gender`, `Birthdate`,
    and the new `Numeric` column as well. The columns are a list of columns, which
    is named `cols`.
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/3c22fe3a3266917661b738b689540476.png)'
  prefs: []
  type: TYPE_IMG
- en: Merging dataframe. Screenshot by Author [5].
  prefs: []
  type: TYPE_NORMAL
- en: As you can see, this way of merging dataframes is a simple way to achieve the
    same results that you would get from a SQL query.
  prefs: []
  type: TYPE_NORMAL
- en: Summary
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: In this tutorial, we saw two common questions or queries that you would perform
    in SQL, but instead, have performed them with pandas dataframes in Python.
  prefs: []
  type: TYPE_NORMAL
- en: '*To summarize, here are the two scenarios we worked with:*'
  prefs: []
  type: TYPE_NORMAL
- en: Returning the percent of rows out of the total dataset from multiple conditions
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Merging on multiple, specific columns to return a final dataframe with a new
    column
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: I hope you found my article both interesting and useful. Please feel free to
    comment down below if you agree or disagree with these methods. Why or why not?
    These can certainly be clarified even further, but I hope I was able to shed some
    light on some of the ways you can use pandas and Python instead of SQL. Thank
    you for reading!
  prefs: []
  type: TYPE_NORMAL
- en: Please feel free to check out my profile, [Matt Przybyla](https://medium.com/u/abe5272eafd9?source=post_page-----c6f7d64164bc--------------------------------),
    and other articles, as well as reach out to me on LinkedIn.
  prefs: []
  type: TYPE_NORMAL
- en: I am not affiliated with these companies.
  prefs: []
  type: TYPE_NORMAL
- en: '**References**'
  prefs: []
  type: TYPE_NORMAL
- en: '[1] Photo by [Bruce Hong](https://unsplash.com/@hongqi?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText) on [Unsplash](https://unsplash.com/s/photos/pandas?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText),
    (2018)'
  prefs: []
  type: TYPE_NORMAL
- en: '[2] M. Przybyla, sample data screenshot, (2021)'
  prefs: []
  type: TYPE_NORMAL
- en: '[3] M. Przybyla, conditions code screenshot, (2021)'
  prefs: []
  type: TYPE_NORMAL
- en: '[4] M. Przybyla, merged dataframe result screenshot, (2021)'
  prefs: []
  type: TYPE_NORMAL
- en: '[5] M. Przybyla, merging dataframe screenshot, (2021)'
  prefs: []
  type: TYPE_NORMAL
- en: '**Bio: [Matthew Przybyla](https://www.linkedin.com/in/matthew-przybyla-0a095b31/)**
    is Senior Data Scientist at Favor Delivery, and a freelance technical writer,
    especially in data science.'
  prefs: []
  type: TYPE_NORMAL
- en: '[Original](https://towardsdatascience.com/how-to-query-your-pandas-dataframe-c6f7d64164bc).
    Reposted with permission.'
  prefs: []
  type: TYPE_NORMAL
- en: '**Related:**'
  prefs: []
  type: TYPE_NORMAL
- en: '[Data Scientist vs Machine Learning Engineer – what are their skills?](/2021/04/data-scientist-machine-learning-engineer-skills.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Pandas vs SQL: When Data Scientists Should Use Each Tool](/2021/06/pandas-vs-sql.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[5 Python Data Processing Tips & Code Snippets](/2021/07/python-tips-snippets-data-processing.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '* * *'
  prefs: []
  type: TYPE_NORMAL
- en: Our Top 3 Course Recommendations
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 1\. [Google Cybersecurity
    Certificate](https://www.kdnuggets.com/google-cybersecurity) - Get on the fast
    track to a career in cybersecurity.'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/e225c49c3c91745821c8c0368bf04711.png) 2\. [Google Data Analytics
    Professional Certificate](https://www.kdnuggets.com/google-data-analytics) - Up
    your data analytics game'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 3\. [Google IT Support
    Professional Certificate](https://www.kdnuggets.com/google-itsupport) - Support
    your organization in IT'
  prefs: []
  type: TYPE_NORMAL
- en: '* * *'
  prefs: []
  type: TYPE_NORMAL
- en: More On This Topic
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: '[5 Key Skills Needed To Become a Great Data Scientist](https://www.kdnuggets.com/2021/12/5-key-skills-needed-become-great-data-scientist.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[6 Predictive Models Every Beginner Data Scientist Should Master](https://www.kdnuggets.com/2021/12/6-predictive-models-every-beginner-data-scientist-master.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[The Best ETL Tools in 2021](https://www.kdnuggets.com/2021/12/mozart-best-etl-tools-2021.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Query Your Pandas DataFrames with SQL](https://www.kdnuggets.com/2021/10/query-pandas-dataframes-sql.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Stop Learning Data Science to Find Purpose and Find Purpose to…](https://www.kdnuggets.com/2021/12/stop-learning-data-science-find-purpose.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[A $9B AI Failure, Examined](https://www.kdnuggets.com/2021/12/9b-ai-failure-examined.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
