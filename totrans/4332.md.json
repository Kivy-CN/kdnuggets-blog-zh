["```py\nimport numpy as np\nimport pandas as pd\n\nmarketing = pd.read_csv(\"/content/DirectMarketing.csv\")\nmarketing.head()\n```", "```py\nthresh = len(marketing) * 0.6\nmarketing.dropna(axis=1, thresh=thresh, inplace=True)\n```", "```py\nlow = np.quantile(marketing.Salary, 0.05)\nhigh = np.quantile(marketing.Salary, 0.95)\n\nmarketing = marketing[marketing.Salary.between(low, high)]\n```", "```py\ncols = marketing.select_dtypes(include='object').columns\nfor col in cols:\n    ratio = len(marketing[col].value_counts()) / len(marketing)\n    if ratio < 0.05:\n    marketing[col] = marketing[col].astype('category')\n```", "```py\ndef drop_missing(df):\n    thresh = len(df) * 0.6\n    df.dropna(axis=1, thresh=thresh, inplace=True)\n    return df\n\ndef remove_outliers(df, column_name):\n    low = np.quantile(df[column_name], 0.05)\n    high = np.quantile(df[column_name], 0.95)\n    return df[df[column_name].between(low, high, inclusive=True)]\n\ndef to_category(df):\n    cols = df.select_dtypes(include='object').columns\n    for col in cols:\n        ratio = len(df[col].value_counts()) / len(df)\n        if ratio < 0.05:\n            df[col] = df[col].astype('category')\n    return df\n```", "```py\nmarketing_cleaned = (marketing.\n                       pipe(drop_missing).\n                       pipe(remove_outliers, 'Salary').\n                       pipe(to_category))\n```", "```py\ndef copy_df(df):\n   return df.copy()\n\nmarketing_cleaned = (marketing.\n                       pipe(copy_df).\n                       pipe(drop_missing).\n                       pipe(remove_outliers, 'Salary').\n                       pipe(to_category))\n```", "```py\nmarketing.shape\n(1000,10)\n\nmarketing.dtypes\nAge            object\nGender         object\nOwnHome        object\nMarried        object\nLocation       object\nSalary          int64\nChildren        int64\nHistory        object\nCatalogs        int64\nAmountSpent     int64\n\nmarketing_cleaned.dtypes\n(900,10)\n\nmarketing_cleaned.dtypes\nAge            category\nGender         category\nOwnHome        category\nMarried        category\nLocation       category\nSalary            int64\nChildren          int64\nHistory        category\nCatalogs          int64\nAmountSpent       int64\n```"]