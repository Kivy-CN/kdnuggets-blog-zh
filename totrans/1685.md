# 《时间序列入门——三步法》

> 原文：[https://www.kdnuggets.com/2018/03/time-series-dummies-3-step-process.html](https://www.kdnuggets.com/2018/03/time-series-dummies-3-step-process.html)

[评论](#comments)

**由 Chris St. Jeor 和 Sean Ankenbruck，Zencos**

在享受了一顿令人满意的中式外卖后，你心不在焉地打开了免费的幸运饼干。瞥了一眼里面的预言，你读到：“你有一个梦会成真。”你嗤之以鼻，把那小纸片扔掉，咬了一口饼干。作为一个聪明且理性的人，你知道这个预言微不足道——没有人能预测未来。然而，这个想法可能是不完整的。有一种方法可以非常准确地预测未来：时间序列建模。

* * *

## 我们的三大课程推荐

![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 1\. [Google 网络安全证书](https://www.kdnuggets.com/google-cybersecurity) - 快速进入网络安全职业生涯。

![](../Images/e225c49c3c91745821c8c0368bf04711.png) 2\. [Google 数据分析专业证书](https://www.kdnuggets.com/google-data-analytics) - 提升你的数据分析技能

![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 3\. [Google IT 支持专业证书](https://www.kdnuggets.com/google-itsupport) - 支持你的组织进行 IT 工作

* * *

时间序列建模可能无法告诉你何时会遇到你生命中的爱人，或者你应该穿蓝色还是红色领带去工作，但它非常擅长利用历史数据来识别现有模式，并利用这些模式预测未来会发生什么。与大多数高级分析解决方案不同，时间序列建模是一种低成本的解决方案，可以提供强大的洞察力。

本文将讲解构建高质量时间序列模型的三个基本步骤：使数据平稳、选择合适的模型和评估模型准确性。本文中的示例使用了一家主要汽车营销公司的历史页面浏览数据。

### 第一步：使数据平稳

时间序列涉及使用按时间（分钟、小时、天、周等）均匀间隔索引的数据。由于时间序列数据的离散性质，许多时间序列数据集都包含季节性和/或趋势元素。时间序列建模的第一步是考虑现有的季节（固定时间段内的重复模式）和/或趋势（数据中的上升或下降走势）。考虑这些内嵌的模式就是我们所说的数据平稳化。可以在下图的图1和图2中看到趋势和季节性数据的示例。

![Image](../Images/4193944adcb0067c3ed247eb798e730e.png)

*图1：上升趋势数据示例*![Image](../Images/63607051018efa77882c94164fea3902.png)

*图2：季节性数据示例*

### 什么是平稳性？

如前所述，时间序列建模的第一步是去除数据中存在的趋势或季节效应，以使其平稳。我们一直提到*平稳性*，但究竟是什么意思呢？

平稳序列是指其均值不再是时间的函数。在趋势数据中，随着时间的推移，序列的均值要么增加，要么减少（想想房价随着时间的稳定上涨）。对于季节性数据，序列的均值会随着季节的变化而波动（想想每24小时的温度升降）。

### 我们如何实现平稳性？

有两种方法可以实现平稳性，一是对数据进行差分，二是线性回归。进行差分时，你需要计算连续观察值之间的差异。使用线性回归时，你需要在模型中包含季节性成分的二进制指示变量。在决定应用哪种方法之前，我们需要先探索数据。我们使用SAS视觉分析绘制了历史每日页面浏览量。

![图片](../Images/66a0d98d8b7cbfdc781033f67c33987d.png)

*图3：原始页面浏览量的时间序列图*

初始模式似乎每七天重复一次，表明存在每周的季节性。页面浏览量随时间的持续增加表明存在轻微的上升趋势。我们对数据有了大致了解后，应用了平稳性统计检验，即扩展的迪基-福勒（ADF）检验。ADF检验是一种单位根检验，用于检测序列是否平稳。这里不深入细节，但单位根指示序列是否非平稳，因此我们使用此检验来确定处理趋势或季节的适当方法（差分或回归）。根据对上述数据的ADF检验结果，我们通过对星期几的虚拟变量进行回归来去除七天的季节性，并通过差分去除趋势。下图显示了处理后的平稳数据。

![图片](../Images/efc6cc474068dd6241ce271a12a29466.png)

*图4：去除季节和趋势后的平稳数据*

### 步骤2：建立你的时间序列模型

现在数据已经平稳，时间序列建模的第二步是建立基准预测水平。我们还应注意，大多数基准预测并不需要进行数据平稳化的第一步。这一步骤仅在更高级的模型中需要，例如我们将要讨论的ARIMA模型。

### 建立基准预测水平

有几种时间序列模型可以使用。为了建立一个能够准确预测未来页面浏览量（或你感兴趣的其他内容）的模型，需要决定适合你的数据的模型类型。

最简单的选择是假设未来的 y 值（你感兴趣的预测变量）等于当前的 y 值。这被认为是最基本的，或称为“朴素模型”，即最新的观察值是明天最可能的结果。

第二种模型是平均模型。在这个模型中，数据集中的所有观察值都被赋予相等的权重。未来的 y 预测值是观察数据的平均值。如果数据是平稳的，这种预测可能相当准确，但如果数据存在趋势或季节性成分，预测结果将非常差。使用平均模型的页面查看数据的预测值见下文。

![Image](../Images/317b10b247af0777058d122686282f14.png)

*图5：平均（均值）模型预测*

如果数据有季节性或趋势元素，那么更好的基准模型选择是实现一个指数平滑模型（ESM）。ESM 在上面提到的朴素模型和平均模型之间找到了一种平衡，其中最新的观察值被赋予最大权重，所有以前观察值的权重以指数方式递减。ESM 还允许将季节性和/或趋势成分纳入模型中。下表提供了一个初始权重为 0.7 以 0.3 的速率指数递减的示例。

| **观察值** | **权重 (α = 0.7)** |
| --- | --- |
| Yt（当前观察值） | 0.7 |
| Yt-1 | 0.21 |
| Yt-2 | 0.063 |
| Yt-3 | 0.0189 |
| Yt-4 | 0.00567 |

*表1：过去观察值对 Y 的指数递减效应示例*

有各种类型的指数平滑模型（ESM）可以用于时间序列预测。使用的理想模型将取决于你拥有的数据类型。下表提供了一个快速指南，根据数据中的趋势和季节组合选择什么类型的ESM。

| **指数平滑模型类型** | **趋势** | **季节** |
| --- | --- | --- |
| 简单ESM |  |  |
| Linear ESM | X |  |
| 季节性 ESM |  | X |
| Winters ESM | X | X |

*表2：模型选择表*

由于数据中存在强烈的七天季节性和上升趋势，我们选择了加法型 Winters ESM 作为新的基准模型。生成的预测在延续轻微上升趋势方面做得不错，并捕捉到了七天季节性。然而，数据中仍有更多的模式可以去除。

![Image](../Images/66da7daba447fb8e7a7d63aaf21b6c2a.png)

*图6：加法型 Winters ESM 预测*

### ARIMA建模

在确定了最能解释数据中趋势和季节性的模型后，你*最终*会拥有足够的信息来生成一个不错的预测，如上图 2 所示。然而，这些模型仍然有限，因为它们没有考虑兴趣变量在前期时间段内的自我相关性。我们将这种相关性称为自相关，它在时间序列数据中很常见。如果数据具有自相关性（如我们的数据），则可能需要额外的建模来进一步改进基线预测。

为了捕捉时间序列模型中的自相关效应，有必要实施自回归积分滑动平均（或 ARIMA）模型。ARIMA 模型包括用于考虑季节和趋势的参数（如使用星期几的虚拟变量和差分），但也允许包含自回归和/或滑动平均项来处理数据中固有的自相关。通过使用适当的 ARIMA 模型，我们可以进一步提高页面浏览量预测的准确性，如下图 3 所示。

![图片](../Images/fc8b6515e5df9eab2837fe356c258be5.png)

*图 7: 季节性 ARIMA 模型预测*

### 第三步：评估模型准确性

尽管你可以看到每个模型的准确性有所提高，但仅凭视觉识别哪个模型具有最佳准确性并不总是可靠的。计算 MAPE（均绝对百分比误差）是一种快速简便的方法来比较提议模型的整体预测准确性——MAPE 越低，预测准确性越好。比较之前讨论的各个模型的 MAPE，很容易看出季节性 ARIMA 模型提供了最佳的预测准确性。请注意，还有其他几种比较统计数据可以用于模型比较。

| **模型误差验证** |
| --- |
| **模型** | **MAPE** |
| 朴素 | 9.0 |
| 平均值 | 10.2 |
| Winters ESM | 6.9 |
| 季节性 ARIMA | 4.4 |

*表 3: 模型误差率比较*

### 总结

总结来说，构建强大的时间序列预测模型的诀窍是尽可能去除噪声（趋势、季节性和自相关），以便数据中唯一未被解释的变化是纯随机的。我们发现，带有星期几回归变量的季节性 ARIMA 模型提供了最准确的预测。与上述提到的朴素、平均和 ESM 模型相比，ARIMA 模型的预测更为准确。

尽管没有时间序列模型可以帮助你处理感情生活，但你可以利用多种时间序列模型来预测从页面浏览量到能源销售的任何事物。准确预测你的兴趣变量的关键是首先了解你的数据，其次应用最符合数据需求的模型。

**克里斯·圣·杰奥**，Zencos数据科学团队的顾问，帮助企业从数据中找到可操作的见解。在担任爱达荷州劳工部经济学家期间，克里斯为技术相关方提供了劳动力预测和经济影响分析。克里斯拥有经济学学士学位和北卡州立大学高级分析学院的分析学硕士学位。他对机器学习和预测建模的热情仅次于对家庭的热情。无论是在徒步旅行还是探索新的博物馆，他总是和妻子及两个孩子一起不断活动。

**肖恩·安肯布鲁克** 带着丰富的背景加入了Zencos团队，拥有政府、投资银行、批发能源交易和网页应用开发的经验。他对代码充满热情，并乐于利用自己的技能解决复杂问题。在处理分析项目之外，肖恩会花时间为Zencos博客撰写文章，通过数据讲述有趣的故事。作为北卡罗来纳州本地人，肖恩在北卡州立大学获得了商业学士学位和分析学硕士学位。

**相关内容：**

+   [时间序列分析：入门指南](/2017/01/time-series-analysis-primer.html)

+   [使用广义加性模型进行时间序列分析](/2017/04/time-series-analysis-generalized-additive-models.html)

+   [时间序列数据的自动特征工程](/2017/11/automated-feature-engineering-time-series-data.html)

### 更多相关内容

+   [成为伟大数据科学家需要的5项关键技能](https://www.kdnuggets.com/2021/12/5-key-skills-needed-become-great-data-scientist.html)

+   [每个初学者数据科学家应掌握的6种预测模型](https://www.kdnuggets.com/2021/12/6-predictive-models-every-beginner-data-scientist-master.html)

+   [2021年最佳ETL工具](https://www.kdnuggets.com/2021/12/mozart-best-etl-tools-2021.html)

+   [停止学习数据科学以寻找目标，并通过寻找目标来…](https://www.kdnuggets.com/2021/12/stop-learning-data-science-find-purpose.html)

+   [一项90亿美元的AI失败案例分析](https://www.kdnuggets.com/2021/12/9b-ai-failure-examined.html)

+   [建立强大的数据团队](https://www.kdnuggets.com/2021/12/build-solid-data-team.html)
