# 卷积神经网络的直观解释

> 原文：[https://www.kdnuggets.com/2016/11/intuitive-explanation-convolutional-neural-networks.html](https://www.kdnuggets.com/2016/11/intuitive-explanation-convolutional-neural-networks.html)

**由 [Ujjwal Karn](https://ujjwalkarn.me/) 编写。**

**卷积神经网络是什么，它们为何重要？**

卷积神经网络（**ConvNets** 或 **CNNs**）是一类神经网络，在图像识别和分类等领域已被证明非常有效。ConvNets 在识别面孔、物体和交通标志方面取得了成功，同时也为机器人和自动驾驶汽车提供了视觉支持。

![convnets use.png](../Images/7748ce554a355790e730098db0a86116.png)

**图 1：来源 [1]**

在 **图 1** 中，ConvNet 能够识别场景，系统能够建议相关的标签，例如“桥梁”、“铁路”和“网球”，而 **图 2** 显示了 ConvNets 被用于识别日常物品、人类和动物的示例。最近，ConvNets 在一些自然语言处理任务（如句子分类）中也表现出色。

![Screen Shot 2016-08-07 at 4.17.11 PM.png](../Images/ccc07aae6c66f4bb30726c2997a95724.png)

##### 图 2：来源 [2]

因此，ConvNets 是今天大多数机器学习从业者的重要工具。然而，理解 ConvNets 并第一次学习使用它们有时可能会让人感到望而却步。本文的主要目的是帮助理解卷积神经网络如何在图像上工作。

如果你对神经网络不太熟悉，我建议你先阅读 [这篇关于多层感知机的简短教程](http://ujjwalkarn.me/2016/08/09/quick-intro-neural-networks/) 来了解它们的工作原理，然后再继续。多层感知机在本文中被称为“全连接层”。

#### LeNet 架构（1990 年代）

LeNet 是最早的一批卷积神经网络之一，推动了深度学习领域的发展。这项由 Yann LeCun 进行的开创性工作被命名为 [LeNet5](http://yann.lecun.com/exdb/publis/pdf/lecun-01a.pdf)，这是自 1988 年以来许多成功迭代的成果。当时，LeNet 架构主要用于字符识别任务，如读取邮政编码、数字等。

接下来，我们将直观地了解 LeNet 架构如何学习识别图像。近年来提出了几种新的架构，它们在 LeNet 的基础上进行了改进，但它们都使用了 LeNet 的主要概念，如果你对前者有清晰的理解，它们相对更容易理解。

![Screen Shot 2016-08-07 at 4.59.29 PM.png](../Images/a8fc34dea1cebd5aeb8736caf96e53fe.png)

##### 图 3：一个简单的 ConvNet。来源 [5]

**图 3**中的卷积神经网络在架构上类似于原始的LeNet，并将输入图像分类为四类：狗、猫、船或鸟（原始LeNet主要用于字符识别任务）。从上图可以看出，当输入为船图像时，网络在所有四个类别中正确地分配了船（0.94）的最高概率。输出层中所有概率的总和应为1（在本帖后面解释）。

上面**图 3**中的ConvNet有四个主要操作：

1.  卷积

1.  非线性（ReLU）

1.  池化或子采样

1.  分类（全连接层）

这些操作是*每个*卷积神经网络的基本构建块，因此理解这些操作如何工作是发展对ConvNets良好理解的重要步骤。我们将尝试理解下面每个操作的直觉。

#### 图像是一个像素值矩阵

实质上，每个图像都可以表示为像素值矩阵。

![8-gif.gif](../Images/95a0b5d309f5a500e50c29884bf02f1b.png)

###### 图 4：每个图像都是一个像素值矩阵。来源 [6]

[通道](https://en.wikipedia.org/wiki/Channel_(digital_image))是一个传统术语，用来指代图像的某个组件。标准数字相机拍摄的图像将有三个通道——红色、绿色和蓝色——你可以将这些想象为三个叠在一起的二维矩阵（每种颜色一个），每个矩阵的像素值范围从0到255。

[灰度](https://en.wikipedia.org/wiki/Grayscale "Grayscale")图像则只有一个通道。为了本帖的目的，我们将只考虑灰度图像，因此我们将只有一个二维矩阵来表示图像。矩阵中每个像素的值范围从0到255——0表示黑色，255表示白色。

#### 卷积步骤

ConvNets的名称源自[“卷积”运算符](https://en.wikipedia.org/wiki/Convolution)。在ConvNet的情况下，卷积的主要目的是从输入图像中提取特征。卷积通过使用输入数据的小方块来学习图像特征，从而保持像素之间的空间关系。我们不会在这里深入卷积的数学细节，但会尝试理解它如何在图像上工作。

如上所述，每个图像可以视为一个像素值矩阵。考虑一个5 x 5图像，其像素值仅为0和1（注意对于灰度图像，像素值范围从0到255，下面的绿色矩阵是一个特例，其中像素值仅为0和1）：

![Screen Shot 2016-07-24 at 11.25.13 PM](../Images/113af8d18204fc9f1acc99c287a0da88.png)

另外，考虑下面的另一个3 x 3矩阵：

![Screen Shot 2016-07-24 at 11.25.24 PM](../Images/b7821d30b80d65701e63e230f851dff1.png)

然后，5 x 5图像和3 x 3矩阵的卷积可以通过下图中的动画计算得到：![Convolution_schematic](../Images/1a23e603601fbcb937a792689e209f91.png)

###### 图5：卷积操作。输出矩阵称为卷积特征或**特征图**。来源 [7]

花一点时间理解上面的计算过程。我们将橙色矩阵在原始图像（绿色）上滑动1像素（也称为‘步幅’），对于每个位置，我们进行元素逐一相乘（两个矩阵之间），然后将乘法输出相加以得到最终整数，这个整数形成输出矩阵（粉色）的一个元素。请注意，3×3矩阵在每一步只“看到”输入图像的一部分。

在CNN术语中，3×3矩阵称为‘**滤波器**’或‘内核’或‘特征检测器’，通过在图像上滑动滤波器并计算点积形成的矩阵称为‘卷积特征’或‘激活图’或‘**特征图**’。重要的是要注意，滤波器作为特征检测器从原始输入图像中提取特征。

从上面的动画可以明显看出，滤波器矩阵的不同值会为相同的输入图像生成不同的特征图。例如，考虑以下输入图像：

![111.png](../Images/fdd2207625369b1488033a9ce74ac160.png)

在下表中，我们可以看到对上述图像应用不同滤波器的卷积效果。如图所示，我们可以通过在卷积操作之前更改滤波器矩阵的数值来执行边缘检测、锐化和模糊等操作[8]——这意味着不同的滤波器可以检测图像中的不同特征，例如边缘、曲线等。更多示例见第8.2.4节[这里](http://docs.gimp.org/en/plug-in-convmatrix.html)。

![Screen Shot 2016-08-05 at 11.03.00 PM.png](../Images/5ba80b2c13837d95579808846e8af58d.png)

* * *

## 我们的三大课程推荐

![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 1\. [Google 网络安全证书](https://www.kdnuggets.com/google-cybersecurity) - 快速进入网络安全职业。

![](../Images/e225c49c3c91745821c8c0368bf04711.png) 2\. [Google 数据分析专业证书](https://www.kdnuggets.com/google-data-analytics) - 提升您的数据分析技能

![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 3\. [Google IT支持专业证书](https://www.kdnuggets.com/google-itsupport) - 支持您的组织IT

* * *

### 了解更多相关主题

+   [直观解释协作过滤](https://www.kdnuggets.com/2022/09/intuitive-explanation-collaborative-filtering.html)

+   [使用卷积神经网络（CNNs）进行图像分类](https://www.kdnuggets.com/2022/05/image-classification-convolutional-neural-networks-cnns.html)

+   [卷积神经网络的全面指南](https://www.kdnuggets.com/2023/06/comprehensive-guide-convolutional-neural-networks.html)

+   [用 PyTorch 构建卷积神经网络](https://www.kdnuggets.com/building-a-convolutional-neural-network-with-pytorch)

+   [支持向量机：直观的方法](https://www.kdnuggets.com/2022/08/support-vector-machines-intuitive-approach.html)

+   [线性回归与逻辑回归：简明解释](https://www.kdnuggets.com/2022/03/linear-logistic-regression-succinct-explanation.html)
