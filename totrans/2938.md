# 使用 Spark、Optimus 和 Twint 在几分钟内分析推文

> 原文：[https://www.kdnuggets.com/2019/05/analyzing-tweets-nlp-spark-optimus-twint.html](https://www.kdnuggets.com/2019/05/analyzing-tweets-nlp-spark-optimus-twint.html)

![c](../Images/3d9c022da2d331bb56691a9617b91b90.png) [comments](/2019/05/analyzing-tweets-nlp-spark-optimus-twint.html?page=2#comments) ![figure-name](../Images/158845770b9097a4963776d6c8df466e.png)

### 介绍

如果你在这里，很可能你对分析推文（或类似的东西）感兴趣，并且你有很多推文，或者能够获取这些推文。最令人烦恼的事情之一就是获取 Twitter 应用程序、进行认证以及其他所有步骤。如果你使用 Pandas，几乎无法扩展到更大的规模。

那么，如何处理一个不需要通过 Twitter API 进行认证的系统，它可以获取几乎无限的推文并具备分析它们的能力，使用 NLP 及更多功能。你将大吃一惊，因为这正是我现在要展示给你的。

### 获取项目和仓库

![figure-name](../Images/0afff08895ea09d9967d745fe9c90c7f.png) [https://matrixds.com/](https://matrixds.com/)

你可以很容易地跟随我展示的内容。只需复制这个 MatrixDS 项目：

[**MatrixDS | 数据项目工作台**](https://matrixds.com/)

*MatrixDS 是一个构建、分享和管理各种规模数据项目的平台。* [community.platform.matrixds.com](https://community.platform.matrixds.com/community/project/5ccc9c4b3175e0603c394444/files)

![figure-name](../Images/49dc0eb58479ce87d4d33757b68ce13e.png)

另外，还有一个包含所有内容的 GitHub 仓库：

[**FavioVazquez/twitter_optimus_twint**](https://github.com/FavioVazquez/twitter_optimus_twint)

*使用 Twint、Optimus 和 Apache Spark 分析推文。 - FavioVazquez/twitter_optimus_twint* [github.com](https://github.com/FavioVazquez/twitter_optimus_twint)

使用 MatrixDS，你实际上可以免费运行笔记本，获取数据并进行分析，如果你想了解更多，请去尝试。

### 获取 Twint 和 Optimus

![figure-name](../Images/d49ee9761db3018624e8da2a75534fdd.png)

Twint 利用 Twitter 的搜索操作符，让你从特定用户处抓取推文，从与某些主题、标签和趋势相关的推文中抓取，或从推文中筛选出 *敏感* 信息，如电子邮件和电话号码。

使用我共同创建的库 Optimus，你可以清理数据、准备数据、分析数据、创建分析器和图表，并进行机器学习和深度学习，所有这些都是分布式进行的，因为在后端我们有 Spark、TensorFlow、Sparkling Water 和 Keras。

首先让我们安装你需要的一切，当你在 Matrix 项目中时，前往 Analyze Tweets 笔记本并运行（你也可以从 JupyterLab 终端执行这操作）：

[PRE0]

之后，我们需要安装 Twint，执行以下命令：

[PRE1]

这将下载一个 scr/ 文件夹，所以我们需要进行一些配置：

[PRE2]

然后要导入 Twint，我们需要运行：

[PRE3]

[PRE4]

最后：

[PRE5]

Optimus 已在第一步中安装，所以我们只需启动它（这将为你启动一个 Spark 集群）：

[PRE6]

### 设置 Twint 以抓取推文

![figure-name](../Images/c6d42439029e2f5090ec93963e5d389c.png)[https://www.theverge.com/2015/11/3/9661180/twitter-vine-favorite-fav-likes-hearts](https://www.theverge.com/2015/11/3/9661180/twitter-vine-favorite-fav-likes-hearts)

[PRE7]

如果你在笔记本上运行，你还需要运行：

[PRE8]

### 搜索数据科学推文

![figure-name](../Images/15d7cd1e1b1b0ee760bfebf1484940b4.png)

我将开始分析抓取关于数据科学的推文，你可以将其更改为你想要的任何内容。

为此我们只需运行这个：

[PRE9]

[PRE10]

让我为你解释这段代码。在最后一节中，当我们运行代码时：

[PRE11]

我们启动了一个新的 Twint 配置。之后，我们需要传递我们想要抓取推文的不同选项。以下是配置选项的完整列表：

[PRE12]

所以在这段代码中：

[PRE13]

我们设置了搜索词，然后格式化响应（只是检查一下），只获取 20 条推文，限制 = 1（它们是按 20 的增量增加的），最后使结果与 Pandas 兼容。

然后我们运行：

[PRE14]

我们开始搜索。结果是：

[PRE15]

看起来不是很好，但我们得到了我们想要的结果。推文！

### 将结果保存到 Pandas 中

![figure-name](../Images/4b2054e82dc2febdc44394a2b860dfc3.png)

可惜 Twint 和 Spark 之间没有直接连接，但我们可以用 Pandas 处理结果，然后将其传递给 Optimus。

我创建了两个简单的函数，你可以在实际项目中看到它们，这些函数帮助你处理 Pandas 和这个部分的奇怪 Twint API。所以当我们运行这个：

[PRE16]

你将看到：

[PRE17]

这是我们刚刚查询得到的列。处理这些数据有很多不同的方法，但在这篇文章中，我只会使用其中的一些。因此，要将 Twint 的结果转换为 Pandas，我们运行：

[PRE18]

你将看到这个 Pandas DF：

![figure-name](../Images/16619ee77856d1eb13a972582d73bc74.png)

好多了，不是吗？

### 情感分析（简单方法）

![figure-name](../Images/67b470446e10c47f12b1b93ad24a8739.png)

我们将对一些推文进行情感分析，使用 Optimus 和 TextBlob 这两个 NLP 库。我们需要做的第一件事是清理这些推文，为此 Optimus 是最佳选择。

为了将数据保存为 Optimus（Spark）DF，我们需要运行：

[PRE19]

我们将使用 Optimus 删除重音符号和特殊字符（在实际工作场景中你需要做更多的工作，比如删除链接、图片和停用词），为此：

[PRE20]

然后我们需要从 Spark 中收集这些推文，以便将它们放入 Python 列表中，为此：

[PRE21]

然后，为了分析这些推文的情感，我们将使用 TextBlob 的*sentiment*函数：

[PRE22]

[PRE23]

这将给我们：

[PRE24]

中性

[PRE25]

中性

[PRE26]

积极

[PRE27]

中性

[PRE28]

消极

[PRE29]

积极

[PRE30]

中性

[PRE31]

积极

[PRE32]

消极

[PRE33]

积极

[PRE34]

中性

[PRE35]

中性

以及其他的。

好吧，这非常简单，但它不会扩展，因为最后我们是从 Spark 中收集数据，因此驱动程序的 RAM 是限制。我们来做得更好一点。

* * *

## 我们的前三个课程推荐

![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 1\. [谷歌网络安全证书](https://www.kdnuggets.com/google-cybersecurity) - 快速进入网络安全职业道路。

![](../Images/e225c49c3c91745821c8c0368bf04711.png) 2\. [谷歌数据分析专业证书](https://www.kdnuggets.com/google-data-analytics) - 提升你的数据分析能力

![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 3\. [谷歌 IT 支持专业证书](https://www.kdnuggets.com/google-itsupport) - 支持你所在组织的 IT

* * *

### 相关主题更多内容

+   [使用微调的 SciBERT NER 模型和 Neo4j 分析科学文章](https://www.kdnuggets.com/2021/12/analyzing-scientific-articles-finetuned-scibert-ner-model-neo4j.html)

+   [数据分析：分析数据的四种方法及其应用…](https://www.kdnuggets.com/2023/04/data-analytics-four-approaches-analyzing-data-effectively.html)

+   [通过智能节点属性演变模型分析未来成功的概率…](https://www.kdnuggets.com/2022/02/analyzing-probability-future-success-intelligence-node-attributes-evolution-model.html)

+   [使用 SQL 分析多样性与包容性](https://www.kdnuggets.com/2022/11/analyzing-diversity-inclusion-sql.html)

+   [掌握数据分析的力量：分析数据的四种方法](https://www.kdnuggets.com/2023/03/master-power-data-analytics-four-approaches-analyzing-data.html)

+   [使用 Hugging Face 和 Gradio 在 5 分钟内构建 AI 聊天机器人](https://www.kdnuggets.com/2023/06/build-ai-chatbot-5-minutes-hugging-face-gradio.html)
