- en: Generating Text with RNNs in 4 Lines of Code
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://www.kdnuggets.com/2018/06/generating-text-rnn-4-lines-code.html](https://www.kdnuggets.com/2018/06/generating-text-rnn-4-lines-code.html)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: '![c](../Images/3d9c022da2d331bb56691a9617b91b90.png) [comments](#comments)'
  prefs: []
  type: TYPE_IMG
- en: Generating text is one of those projects that seems like a lot of fun to machine
    learning and NLP beginners, but one which is also pretty daunting. Or, at least
    it was for me.
  prefs: []
  type: TYPE_NORMAL
- en: 'Thankfully, there are all sorts of great materials online for learning how
    RNNs can be used for generating text, ranging from the theoretical to the technically
    in-depth to those decidedly focused on the practical. There are also some very
    good posts which [cover it all](http://karpathy.github.io/2015/05/21/rnn-effectiveness/)
    and are now considered canon in this space. All of these materials share one thing
    in particular: at some point along the way, you have to build and tune an RNN
    to do the work.'
  prefs: []
  type: TYPE_NORMAL
- en: While this is a obviously a worthwhile undertaking, especially for the sake
    of learning, what if you are OK with a much higher level of abstraction, whatever
    your reason may be? What if you are a data scientist that requires a building
    block in the form of an RNN text generator to plug into your project? Or, what
    if, as a newcomer, you simply want to get your hands a bit -- but not too -- dirty,
    as a means of testing the water or as motivation to dig down further?
  prefs: []
  type: TYPE_NORMAL
- en: In that vein, let's take a look at [textgenrnn](https://github.com/minimaxir/textgenrnn),
    a project which allows you to "easily train your own text-generating neural network
    of any size and complexity on any text dataset with a few lines of code." textgenrnn
    is authored by Max Woolf, an Associate Data Scientist at BuzzFeed, and former
    Apple Software QA Engineer.
  prefs: []
  type: TYPE_NORMAL
- en: textgenrnn is a built on top of Keras and TensorFlow, and can be used to generate
    both character and word level text (character level is the default). The network
    architecture uses attention-weighting and skip-embedding for accelerated training
    and improved quality, and allows for the tuning of a number of hyperparameters,
    such as RNN size, RNN layers, and the inclusion of bidirectional RNNs. You can
    read more about textgenrnn and its features and architecture at its [Github repo](https://github.com/minimaxir/textgenrnn)
    or in this [introductory blog post](http://minimaxir.com/2018/05/text-neural-networks/).
  prefs: []
  type: TYPE_NORMAL
- en: '![Image](../Images/17a900e37b077effb7be6c76c3d7527a.png)'
  prefs: []
  type: TYPE_IMG
- en: Since the "Hello, World!" for text generation (at least, in my mind) seems to
    be generating Trump tweets, let's go with that. textgenrnn's default pretrained
    model can be trained on new texts easily -- though you can also use textgenrnn
    to train a new model (just add new_model=True to any of its train functions) --
    and since we want to see how quickly we can get generating tweets, let's go that
    route.
  prefs: []
  type: TYPE_NORMAL
- en: Acquiring the Data
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: I grabbed a selection of Donald Trump's tweets -- Jan 1, 2014 - Jun 11, 2018
    (yesterday, at time of writing), which clearly includes tweets from both before
    and after his inauguration as President of the United States -- from [Trump Twitter
    Archive](http://www.trumptwitterarchive.com/archive), a site which makes querying
    and downloading tweets from the President painless. I chose only to grab the text
    from the tweets in that date range, since I don't care about any of the metadata,
    and saved it to a text file I appropriately called `trump-tweets.txt`.
  prefs: []
  type: TYPE_NORMAL
- en: '[![Image](../Images/05ded0f38c126d07de8ca31bff7f3f09.png)](https://image.ibb.co/mdzied/trump_tweets_archive.jpg)'
  prefs: []
  type: TYPE_NORMAL
- en: Training the Model
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Let's see how uncomplicated it is to generate text with textgenrnn. The following
    4 lines are all we need to import the library, create a text generation object,
    train the model on the `trump-tweets.txt` file for 10 epochs, and then generate
    some sample tweets.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: 'After about 30 minutes, here''s what''s generated (on the 10th epoch):'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs: []
  type: TYPE_PRE
- en: 'Leaving politics aside, and given that we are only using ~12K tweets for training
    in a mere 10 epochs, these generated tweets are not... terrible. Want to play
    with [temperature](https://www.quora.com/What-is-Temperature-in-LSTM) (the textgenrnn
    default is 0.5) to get some more creative tweets? Let''s try it out:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE2]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE3]'
  prefs: []
  type: TYPE_PRE
- en: 'Well, that''s less convincing. How about something more conservative, which
    the model is more confident of:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE4]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE5]'
  prefs: []
  type: TYPE_PRE
- en: Well now, some of these are seemingly more legible.
  prefs: []
  type: TYPE_NORMAL
- en: 'Of course, this isn''t perfect. There are all sorts of other things we could
    have tried, and the good news is that, if you don''t want to implement your own
    solution, textgenrnn can be used to perform many of these things (again, see the
    [Github repo](https://github.com/minimaxir/textgenrnn)):'
  prefs: []
  type: TYPE_NORMAL
- en: Train our own model from scratch
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Train with more sample data for a greater number of iterations
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Tune other hyperparameters
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Preprocess the data a bit (at the very least to eliminate the fake URLs)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Kind of fun. I'm interested in seeing how a default textgenrnn model performs
    out-of-the-box against a custom, well-tuned model. Maybe something for next time.
  prefs: []
  type: TYPE_NORMAL
- en: '**Related**:'
  prefs: []
  type: TYPE_NORMAL
- en: '[5 Machine Learning Projects You Should Not Overlook, June 2018](/2018/06/5-machine-learning-projects-overlook-jun-2018.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Getting Started with spaCy for Natural Language Processing](/2018/05/getting-started-spacy-natural-language-processing.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Find Out What Celebrities Tweet About the Most](/2017/10/what-celebrities-tweet-about-most.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '* * *'
  prefs: []
  type: TYPE_NORMAL
- en: Our Top 3 Course Recommendations
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 1\. [Google Cybersecurity
    Certificate](https://www.kdnuggets.com/google-cybersecurity) - Get on the fast
    track to a career in cybersecurity.'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/e225c49c3c91745821c8c0368bf04711.png) 2\. [Google Data Analytics
    Professional Certificate](https://www.kdnuggets.com/google-data-analytics) - Up
    your data analytics game'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 3\. [Google IT Support
    Professional Certificate](https://www.kdnuggets.com/google-itsupport) - Support
    your organization in IT'
  prefs: []
  type: TYPE_NORMAL
- en: '* * *'
  prefs: []
  type: TYPE_NORMAL
- en: More On This Topic
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: '[Stop Learning Data Science to Find Purpose and Find Purpose to…](https://www.kdnuggets.com/2021/12/stop-learning-data-science-find-purpose.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[A $9B AI Failure, Examined](https://www.kdnuggets.com/2021/12/9b-ai-failure-examined.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Top Resources for Learning Statistics for Data Science](https://www.kdnuggets.com/2021/12/springboard-top-resources-learn-data-science-statistics.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[The 5 Characteristics of a Successful Data Scientist](https://www.kdnuggets.com/2021/12/5-characteristics-successful-data-scientist.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[What Makes Python An Ideal Programming Language For Startups](https://www.kdnuggets.com/2021/12/makes-python-ideal-programming-language-startups.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Three R Libraries Every Data Scientist Should Know (Even if You Use Python)](https://www.kdnuggets.com/2021/12/three-r-libraries-every-data-scientist-know-even-python.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
