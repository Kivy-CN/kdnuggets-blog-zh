- en: How to Do Hyperparameter Tuning on Any Python Script in 3 Easy Steps
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://www.kdnuggets.com/2020/04/hyperparameter-tuning-python.html](https://www.kdnuggets.com/2020/04/hyperparameter-tuning-python.html)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: '[comments](#comments)'
  prefs: []
  type: TYPE_NORMAL
- en: '**By [Jakub Czakon](https://www.linkedin.com/in/jakub-czakon-2b797b69/?originalSubdomain=pl),
    Neptune.ai**.'
  prefs: []
  type: TYPE_NORMAL
- en: '![Python](../Images/48653af31024defdcd657420253f346a.png)'
  prefs: []
  type: TYPE_IMG
- en: You wrote a Python script that trains and evaluates your machine learning model.
    Now, you would like to automatically tune hyperparameters to improve its performance?
  prefs: []
  type: TYPE_NORMAL
- en: I got you!
  prefs: []
  type: TYPE_NORMAL
- en: In this article, I show you how to convert your script into an objective function
    that can be optimized with any hyperparameter optimization library.
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/e0074c461140259d5cecec92bd0d7474.png)'
  prefs: []
  type: TYPE_IMG
- en: It will take just 3 steps, and you will be tuning model parameters like there
    is no tomorrow.
  prefs: []
  type: TYPE_NORMAL
- en: Ready?
  prefs: []
  type: TYPE_NORMAL
- en: Let’s go!
  prefs: []
  type: TYPE_NORMAL
- en: 'I suppose your ***main.py*** script looks something like this one:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: 'Step 1: Decouple search parameters from code'
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Take the parameters that you want to tune and put them in a dictionary at the
    top of your script. By doing that, you effectively decouple search parameters
    from the rest of the code.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs: []
  type: TYPE_PRE
- en: 'Step 2: Wrap training and evaluation into a function'
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Now, you can put the entire training and evaluation logic inside of a ***train_evaluate*** function.
    This function takes parameters as input and outputs the validation score.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE2]'
  prefs: []
  type: TYPE_PRE
- en: 'Step 3: Run Hypeparameter Tuning script'
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: We are almost there.
  prefs: []
  type: TYPE_NORMAL
- en: All you need to do now is to use this ***train_evaluate*** function as an objective
    for the black-box optimization library of your choice.
  prefs: []
  type: TYPE_NORMAL
- en: I will use [Scikit Optimize](https://neptune.ai/blog/scikit-optimize), which
    I have described in great detail in another article, but you can use any hyperparameter
    optimization library out there.
  prefs: []
  type: TYPE_NORMAL
- en: 'In a nutshell I:'
  prefs: []
  type: TYPE_NORMAL
- en: define the search ***SPACE***,
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: create the ***objective***function that to be minimized,
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: run the optimization via ***forest_minimize***function.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: In this example, I try **100** different configurations starting with **10** randomly
    chosen parameter sets.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE3]'
  prefs: []
  type: TYPE_PRE
- en: This is it.
  prefs: []
  type: TYPE_NORMAL
- en: The ***results*** object contains information about the **best score** **and
    parameters** that produced it.
  prefs: []
  type: TYPE_NORMAL
- en: '**Note:**'
  prefs: []
  type: TYPE_NORMAL
- en: If you want to** visualize your training and save diagnostic charts** after
    it finishes, then you can add one callback and one function call to **log every
    hyperparameter search** to Neptune. Just use this [helper function from neptune-contrib](https://neptune-contrib.readthedocs.io/_modules/neptunecontrib/monitoring/skopt.html#NeptuneMonitor) library.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE4]'
  prefs: []
  type: TYPE_PRE
- en: 'Now, when you run your parameter sweep, you see the following:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/d3998fa6921a2e0309b148132c5981aa.png)'
  prefs: []
  type: TYPE_IMG
- en: Check out the [skopt hyperparameter sweep experiment](https://ui.neptune.ai/jakub-czakon/blog-hpo/e/BLOG-369/charts) with
    all the code, charts, and results.
  prefs: []
  type: TYPE_NORMAL
- en: Final thoughts
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: In this article, you’ve learned how to optimize hyperparameters of pretty much
    any Python script in just 3 steps.
  prefs: []
  type: TYPE_NORMAL
- en: Hopefully, with this knowledge, you will build better machine learning models
    with less effort.
  prefs: []
  type: TYPE_NORMAL
- en: Happy training!
  prefs: []
  type: TYPE_NORMAL
- en: '[Original](https://neptune.ai/blog/hyperparameter-tuning-on-any-python-script).
    Reposted with permission.'
  prefs: []
  type: TYPE_NORMAL
- en: '**Related:**'
  prefs: []
  type: TYPE_NORMAL
- en: '[Practical Hyperparameter Optimization](https://www.kdnuggets.com/2020/02/practical-hyperparameter-optimization.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[How to Automate Hyperparameter Optimization](https://www.kdnuggets.com/2019/06/automate-hyperparameter-optimization.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Keras Hyperparameter Tuning in Google Colab Using Hyperas](https://www.kdnuggets.com/2018/12/keras-hyperparameter-tuning-google-colab-hyperas.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '* * *'
  prefs: []
  type: TYPE_NORMAL
- en: Our Top 3 Course Recommendations
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 1\. [Google Cybersecurity
    Certificate](https://www.kdnuggets.com/google-cybersecurity) - Get on the fast
    track to a career in cybersecurity.'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/e225c49c3c91745821c8c0368bf04711.png) 2\. [Google Data Analytics
    Professional Certificate](https://www.kdnuggets.com/google-data-analytics) - Up
    your data analytics game'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 3\. [Google IT Support
    Professional Certificate](https://www.kdnuggets.com/google-itsupport) - Support
    your organization in IT'
  prefs: []
  type: TYPE_NORMAL
- en: '* * *'
  prefs: []
  type: TYPE_NORMAL
- en: More On This Topic
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: '[Three R Libraries Every Data Scientist Should Know (Even if You Use Python)](https://www.kdnuggets.com/2021/12/three-r-libraries-every-data-scientist-know-even-python.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[What Makes Python An Ideal Programming Language For Startups](https://www.kdnuggets.com/2021/12/makes-python-ideal-programming-language-startups.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Stop Learning Data Science to Find Purpose and Find Purpose to…](https://www.kdnuggets.com/2021/12/stop-learning-data-science-find-purpose.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[A $9B AI Failure, Examined](https://www.kdnuggets.com/2021/12/9b-ai-failure-examined.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Top Resources for Learning Statistics for Data Science](https://www.kdnuggets.com/2021/12/springboard-top-resources-learn-data-science-statistics.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[The 5 Characteristics of a Successful Data Scientist](https://www.kdnuggets.com/2021/12/5-characteristics-successful-data-scientist.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
