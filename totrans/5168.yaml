- en: Top Five SQL Window Functions You Should Know For Data Science Interviews
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://www.kdnuggets.com/2022/01/top-five-sql-window-functions-know-data-science-interviews.html](https://www.kdnuggets.com/2022/01/top-five-sql-window-functions-know-data-science-interviews.html)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: '![Top Five SQL Window Functions You Should Know For Data Science Interviews](../Images/de892b475bedeefa0235111dd9749785.png)'
  prefs: []
  type: TYPE_IMG
- en: SQL is the universal language in the data world and is the most important skill
    to nail down as a data professional.
  prefs: []
  type: TYPE_NORMAL
- en: '* * *'
  prefs: []
  type: TYPE_NORMAL
- en: Our Top 3 Course Recommendations
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 1\. [Google Cybersecurity
    Certificate](https://www.kdnuggets.com/google-cybersecurity) - Get on the fast
    track to a career in cybersecurity.'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/e225c49c3c91745821c8c0368bf04711.png) 2\. [Google Data Analytics
    Professional Certificate](https://www.kdnuggets.com/google-data-analytics) - Up
    your data analytics game'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 3\. [Google IT Support
    Professional Certificate](https://www.kdnuggets.com/google-itsupport) - Support
    your organization in IT'
  prefs: []
  type: TYPE_NORMAL
- en: '* * *'
  prefs: []
  type: TYPE_NORMAL
- en: The reason SQL is so important is that it is the main skill that is required
    during the data wrangling phase. A lot of data exploration, data manipulation,
    pipeline development, and dashboard creation is done through SQL.
  prefs: []
  type: TYPE_NORMAL
- en: What separates great data scientists from good data scientists is that great
    data scientists can wrangle data as much as the capabilities of SQL allow. A big
    part of being able to fully use all that SQL has to offer is by knowing how to
    use window functions.
  prefs: []
  type: TYPE_NORMAL
- en: With that said, let’s dive into it!
  prefs: []
  type: TYPE_NORMAL
- en: 1\. Deltas with LEAD() and LAG()
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: LEAD() and LAG() are mostly used when comparing one period of time with the
    previous period of time for a given metric. To give a few examples...
  prefs: []
  type: TYPE_NORMAL
- en: You can get the delta between each year’s sales and the previous year’s sales
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: You can get the delta in the number of sign-ups/conversions/website visits on
    a month to month basis
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: You can compare user churn on a monthly basis
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Example:**'
  prefs: []
  type: TYPE_NORMAL
- en: The following query shows how you can query the monthly percent change in costs
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: 2\. Cumulative Sums with SUM() or COUNT()
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'Calculating running totals can be simply done through a windows function that
    starts with SUM() or COUNT(). This is a powerful tool when you want to show the
    growth of a particular metric over time. More specifically, it’s useful in the
    following circumstances:'
  prefs: []
  type: TYPE_NORMAL
- en: Get a running total of revenue and costs over time
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Get a running total of time-spent-on-app per user
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Get a running total of conversions over time
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Example:**'
  prefs: []
  type: TYPE_NORMAL
- en: 'The following example shows how you can include a cumulative sum column of
    monthly costs:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs: []
  type: TYPE_PRE
- en: 3\. Moving Averages with AVG()
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: AVG() is really powerful in windows functions as it allows you to compute [moving
    averages](https://en.wikipedia.org/wiki/Moving_average) over time.
  prefs: []
  type: TYPE_NORMAL
- en: Moving averages are a simple, yet effective, way to forecast values in the short
    term. They’re also extremely useful at smoothing out volatile curves on a graph.
    Generally, moving averages are used to gauge the general direction of where things
    are moving.
  prefs: []
  type: TYPE_NORMAL
- en: More specifically...
  prefs: []
  type: TYPE_NORMAL
- en: They can be used to get the general trend of weekly sales (is the average going
    up over time?). This would indicate growth as a company.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: They can likewise be used to get the general trend of weekly conversions or
    website visits.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Example:**'
  prefs: []
  type: TYPE_NORMAL
- en: The following query is an example of getting the 10-day moving average for conversions.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE2]'
  prefs: []
  type: TYPE_PRE
- en: 4\. ROW_NUMBER()
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: ROW_NUMBER() is particularly useful when you want to get the first or last record.
    For example, if you have a table of when gym members came to the gym and you want
    to get the date of the first day that they came to the gym, you can PARTITION
    BY customer (name/id) and ORDER BY purchase date. Then, in order to get the first
    row, you can simply filter for the rows with rowNumber equal to one.
  prefs: []
  type: TYPE_NORMAL
- en: '**Example:**'
  prefs: []
  type: TYPE_NORMAL
- en: This example shows how you can use ROW_NUMBER() to get the first date of when
    each member (user) visited.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE3]'
  prefs: []
  type: TYPE_PRE
- en: To recap, if you ever need to get the first or last record, ROW_NUMBER() is
    a great way to achieve that.
  prefs: []
  type: TYPE_NORMAL
- en: 5\. Record Ranking with DENSE_RANK()
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'DENSE_RANK() is similar to ROW_NUMBER() except that it returns the same rank
    for equal values. Dense ranking is quite useful when it comes to retrieving the
    top records, for example:'
  prefs: []
  type: TYPE_NORMAL
- en: If you want to pull the top 10 most-watched Netflix shows this week
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: If you want to get the top 100 users based on dollars spent
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: If you want to see the behavior of the 1000 least active users
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Example:**'
  prefs: []
  type: TYPE_NORMAL
- en: If you wanted to rank your top customers by total sales, DENSE_RANK() would
    be an appropriate function to use.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE4]'
  prefs: []
  type: TYPE_PRE
- en: Thanks for Reading!
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: And that’s all! I hope that this helps you in your interview prep — I’m sure
    that if you know these 5 concepts inside-out, you’ll do great when it comes to
    most SQL window function problems out there.
  prefs: []
  type: TYPE_NORMAL
- en: As always, I wish you the best in your learning endeavors!
  prefs: []
  type: TYPE_NORMAL
- en: '**[Terence Shin](https://www.linkedin.com/in/terenceshin/)** is a data enthusiast
    with 3+ years of experience in SQL and 2+ years of experience in Python, and a
    blogger on Towards Data Science and KDnuggets.'
  prefs: []
  type: TYPE_NORMAL
- en: '[Original](https://towardsdatascience.com/top-five-sql-window-functions-you-should-know-for-data-science-interviews-b8b334af437).
    Reposted with permission.'
  prefs: []
  type: TYPE_NORMAL
- en: More On This Topic
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: '[KDnuggets™ News 22:n03, Jan 19: A Deep Look Into 13 Data…](https://www.kdnuggets.com/2022/n03.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[SQL Window Functions](https://www.kdnuggets.com/2022/04/sql-window-functions.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[7 SQL Concepts You Should Know For Data Science](https://www.kdnuggets.com/2022/11/7-sql-concepts-needed-data-science.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[10 Essential Pandas Functions Every Data Scientist Should Know](https://www.kdnuggets.com/10-essential-pandas-functions-every-data-scientist-should-know)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[KDnuggets News, April 13: Python Libraries Data Scientists Should…](https://www.kdnuggets.com/2022/n15.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[SQL Interviews Preparations Material Resources](https://www.kdnuggets.com/2023/02/sql-interviews-preparations-material-resources.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
