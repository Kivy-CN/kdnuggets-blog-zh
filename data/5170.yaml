- en: SQL Interview Questions for Experienced Professionals
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 经验丰富的 SQL 面试问题
- en: 原文：[https://www.kdnuggets.com/2022/01/sql-interview-questions-experienced-professionals.html](https://www.kdnuggets.com/2022/01/sql-interview-questions-experienced-professionals.html)
  id: totrans-1
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 原文：[https://www.kdnuggets.com/2022/01/sql-interview-questions-experienced-professionals.html](https://www.kdnuggets.com/2022/01/sql-interview-questions-experienced-professionals.html)
- en: '![SQL Interview Questions for Experienced Professionals](../Images/f143ab433b355c0aa77f2582cbd24965.png)'
  id: totrans-2
  prefs: []
  type: TYPE_IMG
  zh: '![SQL 经验丰富的专业人士面试问题](../Images/f143ab433b355c0aa77f2582cbd24965.png)'
- en: Introduction
  id: totrans-3
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 介绍
- en: If you’re an experienced data scientist looking for a job, you could not have
    picked a better time. As of right now, many established organizations are looking
    for data scientists who know their craft inside and out. However, the high demand
    doesn’t mean that you can, or should jump through hoops and apply for senior positions
    without a certain skill set. When hiring experienced data scientists, companies
    expect them to work on the most difficult tasks at hand. These employees should
    have a good grasp of even the most obscure features so that they can use them
    when necessary.
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你是一个经验丰富的数据科学家正在寻找工作，那么现在是最佳时机。目前，许多知名组织正在寻找对数据科学领域了如指掌的数据科学家。然而，高需求并不意味着你可以或应该轻松申请高级职位而没有某些技能。公司在招聘经验丰富的数据科学家时，期望他们能处理最困难的任务。这些员工应该对即使是最晦涩的功能也有良好的掌握，以便在必要时使用它们。
- en: '* * *'
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: '* * *'
- en: Our Top 3 Course Recommendations
  id: totrans-6
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 我们的三大课程推荐
- en: '![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 1\. [Google Cybersecurity
    Certificate](https://www.kdnuggets.com/google-cybersecurity) - Get on the fast
    track to a career in cybersecurity.'
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: '![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 1\. [Google 网络安全证书](https://www.kdnuggets.com/google-cybersecurity)
    - 快速进入网络安全职业生涯。'
- en: '![](../Images/e225c49c3c91745821c8c0368bf04711.png) 2\. [Google Data Analytics
    Professional Certificate](https://www.kdnuggets.com/google-data-analytics) - Up
    your data analytics game'
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: '![](../Images/e225c49c3c91745821c8c0368bf04711.png) 2\. [Google 数据分析专业证书](https://www.kdnuggets.com/google-data-analytics)
    - 提升你的数据分析能力'
- en: '![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 3\. [Google IT Support
    Professional Certificate](https://www.kdnuggets.com/google-itsupport) - Support
    your organization in IT'
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: '![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 3\. [Google IT 支持专业证书](https://www.kdnuggets.com/google-itsupport)
    - 支持你的组织 IT 工作'
- en: '* * *'
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: '* * *'
- en: It shouldn’t be surprising that when interviewing for senior positions, experienced
    data scientists tend to get asked much harder questions. Often, when working on
    a single job for a couple of years, data scientists become very skilled at performing
    certain repetitive tasks. It's essential for professionals to realize that SQL
    doesn’t stop and end with their existing knowledge. When it comes to advanced
    SQL concepts, there may still be some gaps in their knowledge. So it doesn’t hurt
    to get help for succeeding at your data scientist interview.
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 当面试高级职位时，经验丰富的数据科学家被问到更难的问题并不奇怪。通常，在同一职位上工作几年后，数据科学家会非常擅长执行某些重复性任务。专业人士需要意识到
    SQL 不仅仅停留在现有的知识上。在高级 SQL 概念方面，他们的知识可能仍有一些空白。因此，寻求帮助以便在数据科学家面试中成功并没有坏处。
- en: SQL is the primary language for managing databases, so performing SQL operations
    is at the heart of data scientists’ jobs. Most data scientist interviews are arranged
    to determine a candidate's knowledge of SQL.
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: SQL 是管理数据库的主要语言，因此执行 SQL 操作是数据科学家工作的重要部分。大多数数据科学家面试都安排以确定候选人对 SQL 的知识。
- en: The everyday job might not include writing complex queries, but you must show
    that if such skills are needed, you’re the person capable of doing it. So it shouldn’t
    be surprising that interviewers ask a diverse set of [SQL interview questions](https://www.stratascratch.com/blog/sql-interview-questions-you-must-prepare-the-ultimate-guide/?utm_source=kdn&utm_medium=click&utm_campaign=kdn)
    to test the candidate’s fluency in SQL.
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 日常工作中可能不包括编写复杂查询，但你必须展示当需要这些技能时，你是能够做到的。因此，面试官询问各种 [SQL 面试问题](https://www.stratascratch.com/blog/sql-interview-questions-you-must-prepare-the-ultimate-guide/?utm_source=kdn&utm_medium=click&utm_campaign=kdn)
    来测试候选人的 SQL 流利程度也就不足为奇了。
- en: In this article, we wanted to summarize some of the complex questions and concepts
    asked in interviews with experienced professionals. Even if you’re confident in
    your SQL knowledge, it doesn’t hurt to scan the keywords and make sure you’ve
    got everything covered.
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 在这篇文章中，我们总结了一些在面试中会问到的复杂问题和概念。即使你对自己的 SQL 知识充满信心，浏览这些关键词并确保你已经掌握所有内容也无妨。
- en: Bare minimum concepts for experienced professionals
  id: totrans-15
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 经验丰富的专业人员的基本概念
- en: CASE / WHEN
  id: totrans-16
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: CASE / WHEN
- en: Thoroughly understanding the concept of CASE (and its accompanying When statement)
    is essential for achieving complete mastery of SQL. A case statement allows us
    to check certain conditions and return a value based on whether those conditions
    evaluate as true or false. In combination with clauses, such as WHERE and ORDER
    BY, CASE allows us to bring logic, conditions, and order into our SQL queries.
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 彻底理解 CASE（及其伴随的 When 语句）的概念对于完全掌握 SQL 至关重要。CASE 语句允许我们检查某些条件，并根据这些条件是否为真或假返回一个值。结合
    WHERE 和 ORDER BY 等子句，CASE 允许我们将逻辑、条件和顺序引入 SQL 查询中。
- en: The value of CASE statements is not limited to providing a simple conditional
    logic in our queries. Experienced data scientists should have more than a surface-level
    understanding of the CASE statement and its uses. Interviewers are likely to ask
    you questions about different types of CASE expressions and how to write them.
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: CASE 语句的价值不仅限于在查询中提供简单的条件逻辑。经验丰富的数据科学家应该对 CASE 语句及其用途有超过表面层次的理解。面试官可能会问你关于不同类型
    CASE 表达式的问题以及如何编写它们。
- en: Experienced candidates should be prepared to answer theoretical questions, such
    as to explain the differences between Valued and Searched CASE statements, how
    they work and how to write them. This requires a strong understanding of their
    syntax and common practices. Needless to say, this also includes the proper use
    of the ELSE clause.
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 经验丰富的候选人应该准备回答理论性问题，例如解释 Valued 和 Searched CASE 语句之间的区别，它们是如何工作的以及如何编写它们。这需要对它们的语法和常见实践有深入的理解。不用说，这也包括正确使用
    ELSE 子句。
- en: Experienced data scientists will be expected to know how to use CASE with aggregate
    functions as well. You might also get asked to write a shorthand CASE statement,
    which is less repetitive and easier to understand. You should be able to intelligently
    talk about caveats and possible risks of using shorthand CASE statements.
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 经验丰富的数据科学家需要知道如何使用 CASE 语句与聚合函数一起使用。你还可能会被要求编写简洁的 CASE 语句，这种语句重复性较少且更易于理解。你应该能够智能地讨论使用简洁
    CASE 语句的注意事项和可能的风险。
- en: In general, an experienced data scientist must be able to use CASE to write
    more efficient queries. After all, the entire purpose of the CASE statement is
    to avoid writing too many individual queries to consolidate the data.
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 一般来说，经验丰富的数据科学家必须能够使用 CASE 编写更高效的查询。毕竟，CASE 语句的整个目的是避免编写过多的单独查询来整合数据。
- en: 'Here’s an example of the question that can be solved using CASE / WHEN statements:
    [https://platform.stratascratch.com/coding/9634-host-response-rates-with-cleaning-fees?python=](https://platform.stratascratch.com/coding/9634-host-response-rates-with-cleaning-fees?python=)'
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: 这里有一个可以使用 CASE / WHEN 语句解决的问题的示例：[https://platform.stratascratch.com/coding/9634-host-response-rates-with-cleaning-fees?python=](https://platform.stratascratch.com/coding/9634-host-response-rates-with-cleaning-fees?python=)
- en: This is a difficult question asked in Airbnb interviews, where candidates have
    to find the average host response rate, the zip code, and its corresponding cleaning
    fee.
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: 这是在 Airbnb 面试中提出的一个难题，候选人需要找出平均房东响应率、邮政编码及其对应的清洁费用。
- en: In this case, the CASE/ WHEN statement is used to format the result as a number
    and present it as a percentage value, in addition to the ZIP code.
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: 在这种情况下，CASE/ WHEN 语句用于将结果格式化为数字并将其表示为百分比值，此外还包括邮政编码。
- en: SQL Joins
  id: totrans-25
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: SQL 连接
- en: It’s easy to feel confident in your knowledge of SQL Joins, but the more you
    explore this topic, the more you’ll discover that you don’t know. Interviewers
    often ask [interview questions about advanced aspects of SQL Joins](https://www.stratascratch.com/blog/sql-join-interview-questions/?utm_source=kdn&utm_medium=click&utm_campaign=kdn)
    that are often overlooked. So it’s important to delve into this concept and master
    it thoroughly.
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: 对 SQL 连接的知识感到自信是很容易的，但你越是深入探讨这个话题，就会发现自己不知道的东西越多。面试官经常会问一些关于 SQL 连接高级方面的[面试问题](https://www.stratascratch.com/blog/sql-join-interview-questions/?utm_source=kdn&utm_medium=click&utm_campaign=kdn)，这些问题常常被忽视。因此，深入研究这个概念并彻底掌握它是很重要的。
- en: Besides the basic concepts, interviewers might inquire what self cross joins
    are, and find out the depth of your knowledge by asking to solve practical questions.
    You should know all the different types of joins, including the more complex types,
    such as hash joins, or composite joins. You could also be asked to explain what
    natural joins are, and when they are the most useful. Sometimes you’ll have to
    explain the differences between natural and inner joins.
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 除了基本概念，面试官可能会询问什么是自交叉连接，并通过要求解决实际问题来了解你的知识深度。你应该知道所有不同类型的连接，包括更复杂的类型，如哈希连接或复合连接。你也可能会被要求解释自然连接是什么，以及它们在什么情况下最有用。有时你需要解释自然连接和内连接之间的区别。
- en: You should, in general, have a thorough experience and mastery of using joins
    in combination with other statements to achieve the desired results. For instance,
    you should know how to use the WHERE clause to utilize Cross Join as if it was
    an Inner Join. You will also be expected to know how to use joins to produce new
    tables without putting too much pressure on the server. Or how to use outer joins
    to identify and fill in the missing values when querying the database. Or the
    inner workings of outer joins, such as the fact that rearranging their order can
    change the output.
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: 一般来说，你应该对将连接与其他语句结合使用以实现期望结果有深入的经验和掌握。例如，你应该知道如何使用 WHERE 子句将 Cross Join 当作 Inner
    Join 来使用。你还需要知道如何使用连接来生成新表，而不会对服务器施加过大压力。或者如何使用外连接来识别和填补查询数据库时的缺失值。或者外连接的内部工作原理，例如重新排列其顺序可能会改变输出。
- en: '[Here’s an example of the question that involves writing an inner joint statement](https://platform.stratascratch.com/coding/9899-percentage-of-total-spend?python).'
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: '[这是一个涉及编写内连接语句的问题的示例](https://platform.stratascratch.com/coding/9899-percentage-of-total-spend?python)。'
- en: This is a fairly difficult question, where the candidates are asked to display
    the order size as a percentage of total spending.
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: 这是一个相当困难的问题，要求候选人显示订单大小占总支出的百分比。
- en: 'Advanced Concept N1: Date-time Manipulation'
  id: totrans-31
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 高级概念 N1：日期时间处理
- en: '![SQL Interview Questions for Experienced Professionals](../Images/ee6b088b74a74d5acb0f42a990897272.png)'
  id: totrans-32
  prefs: []
  type: TYPE_IMG
  zh: '![针对有经验专业人士的 SQL 面试问题](../Images/ee6b088b74a74d5acb0f42a990897272.png)'
- en: It is common for databases to include dates and times, so any experienced data
    scientist should have deep knowledge of working with them. This type of data allows
    us to track the order in which the events occur, changes in frequency, calculate
    intervals, and gain other important insights. A lot of times performing these
    operations requires a complete mastery of date-time manipulation in SQL. So the
    professionals with such a set of skills are going to have an advantage over competing
    candidates. If you’re not 100% confident in your skills, look over the concepts
    described below and see how many of them sound familiar.
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: 数据库中包含日期和时间是很常见的，因此任何有经验的数据科学家都应该对如何处理这些数据有深入的了解。这种数据使我们能够跟踪事件发生的顺序、频率变化、计算时间间隔，并获得其他重要见解。很多时候，执行这些操作需要完全掌握
    SQL 中的日期时间处理。因此，拥有这些技能的专业人士将在竞争中占据优势。如果你对自己的技能没有 100% 的信心，可以查看下面描述的概念，看看有多少个听起来很熟悉。
- en: Since there are many different (but valid) approaches to formatting data in
    SQL, great coders should be at least familiar with them all. During the interviews,
    hiring managers expect knowledge of basic data formatting concepts and the ability
    to talk intelligently about choosing the right function for the task. This includes
    the knowledge of an important FORMAT() function and the associated syntax to make
    full use of the function. The knowledge of other basic functions, such as NOW()
    is also expected. Also, it wouldn’t be out of the blue for experienced professionals
    to get asked about basic concepts like time-series data and its purpose.
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 由于在 SQL 中有许多不同（但有效）的方法来格式化数据，优秀的编码人员应该至少熟悉它们。面试中，招聘经理期望了解基本的数据格式化概念以及能够聪明地讨论选择合适函数的能力。这包括了解重要的
    FORMAT() 函数及其相关语法，以充分利用该函数。还期望了解其他基本函数，例如 NOW()。此外，有经验的专业人士也可能会被问及基本概念，如时间序列数据及其目的。
- en: It’s also important to consider the context of the job you’re applying for.
    An AI or IoT company would be more concerned with tracking data collected from
    the sensors, whereas a stock trading app might require you to track the price
    fluctuations during the day, week, or month.
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: 同样，考虑你申请的职位的背景也很重要。一个 AI 或物联网公司可能更关注从传感器收集的数据，而一个股票交易应用可能需要你追踪日、周或月内的价格波动。
- en: In some cases, employers might ask about more advanced date/time functions in
    SQL, such as CAST(), EXTRACT(), or DATE_TRUNC(). These functions can be invaluable
    when you’re working with a large volume of data that contains dates. An experienced
    data scientist should know the purpose of each function and its applications.
    In an ideal scenario, he or she should have experience of using them in the past.
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: 在某些情况下，雇主可能会询问关于 SQL 的更高级的日期/时间函数，例如 CAST()、EXTRACT() 或 DATE_TRUNC()。这些函数在处理包含日期的大量数据时非常有用。经验丰富的数据科学家应该了解每个函数的目的及其应用。在理想情况下，他或她应该有使用这些函数的经验。
- en: The most complex date-time manipulation in SQL is going to involve the combination
    of basic and advanced functions. So it’s necessary to know them all, starting
    from the more basic FORMAT(), NOW(),CURRENT_DATE, and CURRENT_TIME, and including
    more advanced functions mentioned above. As an experienced data scientist, you
    should also know what INTERVAL does and when to use it.
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: SQL 中最复杂的日期时间操作将涉及基本函数和高级函数的组合。因此，了解所有这些函数是必要的，从更基础的 FORMAT()、NOW()、CURRENT_DATE
    和 CURRENT_TIME 开始，包括上述的更高级函数。作为一名经验丰富的数据科学家，你还应该知道 INTERVAL 的作用及其使用时机。
- en: '[Here’s an example of a question asked in Airbnb interviews](https://platform.stratascratch.com/coding/9637-growth-of-airbnb?python),
    where the candidates must use the available data to track the growth of Airbnb.'
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: '[这里有一个在 Airbnb 面试中提出的问题示例](https://platform.stratascratch.com/coding/9637-growth-of-airbnb?python)，要求候选人利用可用数据追踪
    Airbnb 的增长情况。'
- en: 'The Premise:'
  id: totrans-39
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 前提：
- en: In this question, the candidates are asked to track the growth of Airbnb based
    on changes in the number of hosts signed up each year. In other words, we’ll use
    the number of newly registered hosts as an indicator of growth for each year.
    We’ll find the growth rate by calculating the difference in the number of hosts
    between the last and current year and dividing that number by the number of hosts
    registered during the previous year. Then we’ll find the percentage value by multiplying
    the result by 100.
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个问题中，要求候选人根据每年注册的房东数量变化来追踪 Airbnb 的增长。换句话说，我们将使用每年新增注册的房东数量作为增长的指标。我们通过计算上一年与当前年房东数量之间的差异，并将该数字除以前一年注册的房东数量来找出增长率。然后，我们通过将结果乘以
    100 来找出百分比值。
- en: The output table should have columns and the corresponding data for the number
    of hosts in the current year, in the previous year, and the percentage of growth
    from year to year. The percentage must be rounded to the nearest whole number
    and the rows must be ordered in ascending order depending on the year.
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: 输出表格应包含当前年、上一年房东数量以及逐年增长百分比的列。百分比必须四舍五入到最接近的整数，行必须按年份升序排列。
- en: 'Solution:'
  id: totrans-42
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 解决方案：
- en: To answer this question, a candidate must work with the table called ‘airbnb_search_details’,
    which includes many columns. The column that we need is labeled ‘host_since’,
    which denotes the year, month, and the day when the host first signed up for the
    website. For this exercise, the month and the day are irrelevant, so the first
    thing we’ll need to do is to extract the year from the value. Then we’ll have
    to create a view that includes separate columns for the current year, previous
    year, and the total number of hosts in that year.
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: 要回答这个问题，候选人必须使用名为 ‘airbnb_search_details’ 的表格，该表格包含许多列。我们需要的列标记为 ‘host_since’，它表示房东首次注册网站的年份、月份和日期。对于这个练习，月份和日期无关紧要，因此我们需要做的第一件事是从值中提取年份。然后，我们必须创建一个视图，其中包含当前年、上一年以及该年的总房东数量的单独列。
- en: '[PRE0]'
  id: totrans-44
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'So far, we have done two things:'
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: 到目前为止，我们已经完成了两件事：
- en: We’ve made sure to only include the rows where the host_since column is not
    empty.
  id: totrans-46
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 我们确保只包含 host_since 列不为空的行。
- en: We’ve extracted the year from the data and cast it as the DATE value.
  id: totrans-47
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 我们从数据中提取年份并将其转换为 DATE 值。
- en: '[PRE1]'
  id: totrans-48
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: Then we proceed to count the ids and set up the GROUP BY clause for every year.
    And make it display in ascending order.
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: 然后我们继续计算 ID，并为每年设置 GROUP BY 子句，并按升序显示。
- en: 'This should give us a table with two columns: the year, and the number of hosts
    registered that year. We still don''t have a full picture needed to solve the
    question, but it’s a step in the right direction. We also need separate columns
    for hosts signed up during the previous year. This is where the LAG() function
    comes in.'
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: 这将为我们提供一个包含两列的表格：年份和注册该年的主机数量。我们仍然没有解决问题所需的完整信息，但这是朝着正确方向的一步。我们还需要针对前一年注册的主机的单独列。这就是
    LAG() 函数的作用。
- en: '[PRE2]'
  id: totrans-51
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: 'Here, we added the third column, which will be labeled ‘prev_year_host’ and
    its values are going to come from ‘current_year_host’, except for the delay of
    one row. Here’s what that might look like:'
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: 在这里，我们添加了第三列，标记为“prev_year_host”，其值将来自“current_year_host”，但延迟一行。这可能是这样的：
- en: '![SQL Interview Questions for Experienced Professionals](../Images/650e8090ee481469b8c536cc39809fdd.png)'
  id: totrans-53
  prefs: []
  type: TYPE_IMG
  zh: '![SQL 面试问题针对有经验的专业人士](../Images/650e8090ee481469b8c536cc39809fdd.png)'
- en: 'Arranging the table in this way makes it very convenient to calculate the final
    growth rate. We have a separate column for every value in the equation. Ultimately,
    our code should look something like this:'
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: 以这种方式排列表格可以非常方便地计算最终的增长率。我们为方程中的每个值都有一个单独的列。最终，我们的代码应该类似于以下内容：
- en: '[PRE3]'
  id: totrans-55
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: Here, we add another query and another column where we calculate the growth
    rate. We must multiply the initial result by 100 and round it to satisfy the requirements
    of the task.
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: 在这里，我们添加了另一个查询和另一个列来计算增长率。我们必须将初始结果乘以 100 并四舍五入，以满足任务的要求。
- en: That’s the solution to this task. It’s clear that date-time manipulation functions
    were essential for completing the task.
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: 这就是解决此任务的方法。很明显，日期时间处理函数对于完成任务至关重要。
- en: 'Advanced Concept N2: Window Functions and Partitions'
  id: totrans-58
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 高级概念 N2：窗口函数和分区
- en: '![SQL Interview Questions for Experienced Professionals](../Images/e112a727a805ff5dc22f561f0f0a1d28.png)'
  id: totrans-59
  prefs: []
  type: TYPE_IMG
  zh: '![SQL 面试问题针对有经验的专业人士](../Images/e112a727a805ff5dc22f561f0f0a1d28.png)'
- en: '[SQL Window Functions](https://www.stratascratch.com/blog/the-ultimate-guide-to-sql-window-functions/?utm_source=kdn&utm_medium=click&utm_campaign=kdn)
    are one of the most important concepts for writing complex, yet efficient SQL
    queries. Experienced professionals are expected to have a deep practical and theoretical
    knowledge of window functions. This includes knowing what the over clause is and
    mastering its use. Interviewers might ask how the OVER clause can turn aggregate
    functions into window functions. You might also get asked about the three aggregate
    functions that can be used as window functions. Experienced data scientists should
    be aware of other, non-aggregate window functions as well.'
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: '[SQL 窗口函数](https://www.stratascratch.com/blog/the-ultimate-guide-to-sql-window-functions/?utm_source=kdn&utm_medium=click&utm_campaign=kdn)是编写复杂而高效的
    SQL 查询的最重要概念之一。经验丰富的专业人士应对窗口函数有深入的实践和理论知识。这包括了解 OVER 子句是什么并掌握其使用。面试官可能会问 OVER
    子句如何将聚合函数转换为窗口函数。你还可能被问到可以作为窗口函数使用的三种聚合函数。经验丰富的数据科学家还应了解其他非聚合的窗口函数。'
- en: To make the best use of window functions, one must also know what the PARTITION
    BY clause is and how to use it. You may be asked to explain it and provide examples
    of a few use cases. Sometimes you’ll have to organize rows within partitions using
    the ORDER_BY clause.
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: 为了最好地利用窗口函数，必须了解 PARTITION BY 子句是什么以及如何使用它。你可能会被要求解释它并提供一些使用案例的示例。有时，你需要使用 ORDER_BY
    子句在分区内组织行。
- en: Candidates who can demonstrate a thorough knowledge of every individual window
    function, such as ROW_NUMBER() will have an advantage. Needless to say, the theoretical
    knowledge alone isn’t enough - professionals should also have experience of using
    them in practice, with or without partitions. For instance, an experienced professional
    should be able to explain the differences between RANK() and DENSE_RANK(). An
    ideal candidate should know some of the most advanced concepts, such as frames
    within partitions, and be able to explain them clearly.
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: 能够展示每一个窗口函数的全面知识的候选人，如 ROW_NUMBER()，将具有优势。不用说，单靠理论知识是不够的——专业人士还应具备实际使用这些函数的经验，无论是否涉及分区。例如，一位经验丰富的专业人士应该能够解释
    RANK() 和 DENSE_RANK() 之间的区别。理想的候选人应了解一些最先进的概念，如分区中的帧，并能够清晰地解释它们。
- en: Great candidates should also explain the use of the NTH_VALUE() function. It
    wouldn’t hurt to mention the alternatives to this function, such as FIRST_VALUE()
    and LAST_VALUE() functions. Companies often like to measure quartiles, quantiles,
    and percentiles in general. To perform this operation, data scientists must know
    how to use the NTILE() window function as well.
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: 优秀的候选人还应解释 NTH_VALUE() 函数的用法。提到该函数的替代方案，如 FIRST_VALUE() 和 LAST_VALUE() 函数，也不会有坏处。公司通常喜欢衡量四分位数、分位数和百分位数。执行此操作时，数据科学家还必须知道如何使用
    NTILE() 窗口函数。
- en: 'In SQL, there are usually many ways to approach a task. Still, window functions
    provide the easiest way to perform common, but complex operations. A good example
    of such a window function is LAG() or LEAD(), so you should be familiar with them
    as well. For instance, let’s look at an example from the previous solution to
    a difficult Airbnb interview question:'
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: 在 SQL 中，通常有许多方法来处理任务。然而，窗口函数提供了执行常见但复杂操作的最简单方法。一个好的窗口函数例子是 LAG() 或 LEAD()，因此你也应该熟悉它们。例如，我们来看看之前解决的一个难度较大的
    Airbnb 面试题：
- en: 'To display the number of hosts in the previous year, we used the LAG() function
    with the OVER statement. This could’ve been done in many other ways, but window
    functions allowed us to get the desired result in just one line of SQL code:'
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: 为了显示前一年主机的数量，我们使用了带有 OVER 语句的 LAG() 函数。这可以通过许多其他方式完成，但窗口函数允许我们只用一行 SQL 代码就能获得所需的结果：
- en: '[PRE4]'
  id: totrans-66
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: Lots of companies need to calculate growth over a certain period of time. The
    LAG() function can be invaluable for completing such assignments.
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: 许多公司需要计算某一时间段的增长。LAG() 函数在完成这种任务时可以非常有用。
- en: 'Advanced Concept N3: Month Over Month Growth'
  id: totrans-68
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 高级概念 N3：月度增长
- en: '![SQL Interview Questions for Experienced Professionals](../Images/881f00abd3dff325f9da9cbac80bddd1.png)'
  id: totrans-69
  prefs: []
  type: TYPE_IMG
  zh: '![SQL 面试问题（经验丰富的专业人士）](../Images/881f00abd3dff325f9da9cbac80bddd1.png)'
- en: Many organizations use data analysis to measure their own performance. This
    may entail measuring the effectiveness of marketing campaigns or ROI on a specific
    investment. Performing such analysis requires an in-depth knowledge of SQL, such
    as date, time, and window functions.
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: 许多组织使用数据分析来衡量自己的绩效。这可能涉及衡量营销活动的效果或特定投资的 ROI。执行这种分析需要深入了解 SQL，例如日期、时间和窗口函数。
- en: Data scientists will also have to prove their skills in formatting the data
    and displaying it as percentages or in any other form. In general, to solve the
    practical questions where you have to calculate month-over-month growth, you must
    use the combination of multiple skill sets. Some of the required concepts will
    be advanced (window functions, date-time manipulation), while others will be basic
    (aggregate functions and common SQL statements).
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: 数据科学家还必须证明他们在格式化数据和以百分比或其他形式显示数据的技能。通常，要解决涉及计算月度增长的实际问题，你必须使用多种技能的组合。一些所需的概念将是高级的（窗口函数、日期时间操作），而其他的则是基础的（聚合函数和常见
    SQL 语句）。
- en: Let’s look at one example question asked by Interviewers at Amazon.
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: 我们来看看亚马逊面试官提出的一个例题。
- en: 'The Premise:'
  id: totrans-73
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 前提：
- en: In this question, we have to work with a table of purchases and calculate monthly
    growth or decline in revenue. The end result must be formatted in a specific way
    (YYYY-MM format) and the percentages should be rounded to the second nearest decimal.
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个问题中，我们必须处理一个购买表并计算月度收入的增长或下降。最终结果必须以特定的方式格式化（YYYY-MM 格式），并且百分比应四舍五入到第二位小数。
- en: 'Solution:'
  id: totrans-75
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 解决方案：
- en: When working on a task like this, the first thing you need to do is understand
    the table. You should also identify the columns you need to work with to answer
    the question. And what your output is going to look like.
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: 在处理类似任务时，首先需要了解表的结构。你还应该确定需要处理的列，以回答问题，并确定输出的形式。
- en: In our example, the data values have the object type, so we’ll have to use the
    CAST() function to transform them into date types.
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: 在我们的例子中，数据值具有对象类型，因此我们需要使用 CAST() 函数将其转换为日期类型。
- en: '[PRE5]'
  id: totrans-78
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: The question also specifies a format for dates, so we can use theTO_CHAR() function
    in SQL to output the date in this format.
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: 问题还指定了日期的格式，因此我们可以在 SQL 中使用 TO_CHAR() 函数将日期输出为这种格式。
- en: To calculate the growth, we should also select the created_at and SUM() aggregate
    function to get the volume of total sales for that date.
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: 要计算增长，我们还应选择 created_at 和 SUM() 聚合函数以获取该日期的总销售量。
- en: '[PRE6]'
  id: totrans-81
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: At this point, we have to use window functions again. Specifically, we’re going
    to use the LAG() function to access last month’s volume and display it as a separate
    column. For that, we’ll also need an OVER clause.
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: 这时，我们必须再次使用窗口函数。具体来说，我们将使用 LAG() 函数来访问上个月的数量，并将其显示为单独的列。为此，我们还需要一个 OVER 子句。
- en: '[PRE7]'
  id: totrans-83
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: 'Based on the code we’ve written so far, our table will look something like
    this:'
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: 根据我们目前编写的代码，我们的表格将如下所示：
- en: '![SQL Interview Questions for Experienced Professionals](../Images/43282c12f6fe23a929718ebc47994b99.png)'
  id: totrans-85
  prefs: []
  type: TYPE_IMG
  zh: '![有经验的专业人士 SQL 面试问题](../Images/43282c12f6fe23a929718ebc47994b99.png)'
- en: Here, we have the dates and corresponding total values in the sum column, and
    the last date’s values in the lag column. Now we can plug the values into the
    formula and display the growth rate in a separate column.
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: 在这里，我们有日期和总值的对应关系在 sum 列中，以及最后一个日期的值在 lag 列中。现在我们可以将这些值代入公式，并在单独的列中显示增长率。
- en: We should also remove the unnecessary created_at column, and change the GROUP
    BY and ORDER BY clauses to year_month.
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: 我们还应该删除不必要的 created_at 列，并将 GROUP BY 和 ORDER BY 子句更改为 year_month。
- en: '[PRE8]'
  id: totrans-88
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: Once we run the code, our table should only include the columns that are essential
    for our calculation.
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦我们运行代码，我们的表格应该只包含对计算至关重要的列。
- en: '![SQL Interview Questions for Experienced Professionals](../Images/43282c12f6fe23a929718ebc47994b99.png)'
  id: totrans-90
  prefs: []
  type: TYPE_IMG
  zh: '![有经验的专业人士 SQL 面试问题](../Images/43282c12f6fe23a929718ebc47994b99.png)'
- en: 'Now we can finally arrive at the solution. Here’s what the final code would
    look like:'
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们终于可以得到解决方案了。这是最终代码的样子：
- en: '[PRE9]'
  id: totrans-92
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: In this code, we take two column values from the previous example and calculate
    the difference between them. Note that we also make use of window aliases to reduce
    the repetitiveness of our code.
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: 在这段代码中，我们取用之前示例中的两个列值，并计算它们之间的差异。注意，我们还利用了窗口别名来减少代码的重复性。
- en: Then, in accordance with the algorithm, we divide it by the current month’s
    revenue and multiply it by 100 to get the percentage value. Finally, we round
    the percentage value to two decimal points. We arrive at the answer that satisfies
    all the requirements of the task.
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: 然后，根据算法，我们将其除以本月的收入，并乘以 100 以获得百分比值。最后，我们将百分比值四舍五入到小数点后两位。我们得出一个满足所有任务要求的答案。
- en: 'Advanced Concept N4: Churn rates'
  id: totrans-95
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 高级概念 N4：流失率
- en: Even though it's the opposite of growth, churn is an important metric as well.
    Many companies keep track of their churn rates, especially if their business model
    is subscription-based. This way, they can track the number of lost subscriptions
    or accounts, and predict the reasons that caused it. An experienced data scientist
    will be expected to know which functions, statements, and clauses to use to calculate
    churn rates.
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: 尽管与增长相反，流失率也是一个重要的指标。许多公司都会追踪其流失率，尤其是当其商业模式是基于订阅时。通过这种方式，他们可以跟踪丢失的订阅或账户数量，并预测造成这些流失的原因。一位经验丰富的数据科学家应该知道使用哪些函数、语句和子句来计算流失率。
- en: Subscription data is very private and contains private user information. It
    is also important for data scientists to know how to work with such data without
    exposing it. Often calculating churn rates involves common table expressions,
    which are a relatively new concept. The best data scientists should know why CTEs
    are useful and when to use them. When working with older databases, where CTEs
    are unavailable, an ideal candidate should still be able to get the job done.
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: 订阅数据非常私密，并包含用户的私人信息。数据科学家还需要知道如何在不暴露数据的情况下处理这些数据。计算流失率通常涉及公用表表达式（CTE），这是一种相对较新的概念。最优秀的数据科学家应该知道
    CTE 的作用以及何时使用它们。当处理旧版数据库时，如果 CTE 不可用，理想的候选人仍然应该能够完成任务。
- en: '[Here’s an example of a difficult task](https://platform.stratascratch.com/coding/10017-year-over-year-churn?python).
    Candidates interviewing at Lyft receive this assignment to calculate drivers’
    churn rate at the company.'
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: '[这里是一个难度较大的任务示例](https://platform.stratascratch.com/coding/10017-year-over-year-churn?python)。在
    Lyft 面试的候选人会收到这个任务，以计算公司司机的流失率。'
- en: To solve this problem, data scientists must use case/when statements, window
    functions such as LAG(), as well as FROM / WHERE, and other basic clauses.
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: 为了解决这个问题，数据科学家必须使用 case/when 语句、窗口函数如 LAG()，以及 FROM / WHERE 和其他基本子句。
- en: Conclusion
  id: totrans-100
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 结论
- en: Working as a data scientist for many years certainly looks impressive on a CV,
    and will get you many interviews. However, once you get your foot in the door,
    you still need to display the knowledge to complement years of experience. Even
    if you have wide-ranging experience in [writing queries in SQL](https://www.stratascratch.com/blog/best-practices-to-write-sql-queries-how-to-structure-your-code/?utm_source=kdn&utm_medium=click&utm_campaign=kdn),
    it doesn’t hurt to use resources like [StrataScratch](https://www.stratascratch.com/?utm_source=kdn&utm_medium=click&utm_campaign=kdn)
    to refresh your knowledge.
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: 拥有多年的数据科学家工作经历无疑在简历上显得非常出色，并且能为你赢得许多面试机会。然而，一旦你进入面试阶段，你仍然需要展示出足够的知识来补充多年经验的积累。即便你在[编写
    SQL 查询](https://www.stratascratch.com/blog/best-practices-to-write-sql-queries-how-to-structure-your-code/?utm_source=kdn&utm_medium=click&utm_campaign=kdn)方面经验丰富，利用像[StrataScratch](https://www.stratascratch.com/?utm_source=kdn&utm_medium=click&utm_campaign=kdn)这样的资源来刷新你的知识也不失为一种好方法。
- en: '**[Nate Rosidi](https://www.stratascratch.com)** is a data scientist and in
    product strategy. He''s also an adjunct professor teaching analytics, and is the
    founder of [StrataScratch](https://www.stratascratch.com/), a platform helping
    data scientists prepare for their interviews with real interview questions from
    top companies. Connect with him on [Twitter: StrataScratch](https://twitter.com/StrataScratch)
    or [LinkedIn](https://www.linkedin.com/in/nathanrosidi/).'
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: '**[内特·罗西迪](https://www.stratascratch.com)** 是一名数据科学家，专注于产品战略。他还是一名兼职教授，教授分析学，并且是[StrataScratch](https://www.stratascratch.com/)，一个帮助数据科学家通过顶级公司实际面试问题准备面试的平台的创始人。你可以通过[Twitter:
    StrataScratch](https://twitter.com/StrataScratch) 或 [LinkedIn](https://www.linkedin.com/in/nathanrosidi/)与他联系。'
- en: More On This Topic
  id: totrans-103
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 更多相关话题
- en: '[24 SQL Questions You Might See on Your Next Interview](https://www.kdnuggets.com/2022/06/24-sql-questions-might-see-next-interview.html)'
  id: totrans-104
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[你下一次面试可能会遇到的 24 道 SQL 问题](https://www.kdnuggets.com/2022/06/24-sql-questions-might-see-next-interview.html)'
- en: '[25 Advanced SQL Interview Questions for Data Scientists](https://www.kdnuggets.com/2022/10/25-advanced-sql-interview-questions-data-scientists.html)'
  id: totrans-105
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[数据科学家用的 25 道高级 SQL 面试问题](https://www.kdnuggets.com/2022/10/25-advanced-sql-interview-questions-data-scientists.html)'
- en: '[Top 10 Advanced Data Science SQL Interview Questions You Must Know…](https://www.kdnuggets.com/2023/01/top-10-advanced-data-science-sql-interview-questions-must-know-answer.html)'
  id: totrans-106
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[你必须知道的前 10 个高级数据科学 SQL 面试问题……](https://www.kdnuggets.com/2023/01/top-10-advanced-data-science-sql-interview-questions-must-know-answer.html)'
- en: '[3 More SQL Aggregate Function Interview Questions for Data Science](https://www.kdnuggets.com/2023/01/3-sql-aggregate-function-interview-questions-data-science.html)'
  id: totrans-107
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[数据科学中的 3 道 SQL 聚合函数面试问题](https://www.kdnuggets.com/2023/01/3-sql-aggregate-function-interview-questions-data-science.html)'
- en: '[SQL and Python Interview Questions for Data Analysts](https://www.kdnuggets.com/2023/02/sql-python-interview-questions-data-analysts.html)'
  id: totrans-108
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[数据分析师的 SQL 和 Python 面试问题](https://www.kdnuggets.com/2023/02/sql-python-interview-questions-data-analysts.html)'
- en: '[SQL Notes for Professionals: The Free eBook Review](https://www.kdnuggets.com/2022/05/sql-notes-professionals-free-ebook-review.html)'
  id: totrans-109
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[专业人士的 SQL 笔记：免费的电子书评测](https://www.kdnuggets.com/2022/05/sql-notes-professionals-free-ebook-review.html)'
