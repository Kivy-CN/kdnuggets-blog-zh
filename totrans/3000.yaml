- en: How To Fine Tune Your Machine Learning Models To Improve Forecasting Accuracy
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://www.kdnuggets.com/2019/01/fine-tune-machine-learning-models-forecasting.html](https://www.kdnuggets.com/2019/01/fine-tune-machine-learning-models-forecasting.html)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: '[comments](#comments)'
  prefs: []
  type: TYPE_NORMAL
- en: Fine tuning machine learning predictive model is a crucial step to improve accuracy
    of the forecasted results. In the recent past, I have written a number of articles
    that explain how machine learning works and how to enrich and decompose the feature
    set to improve accuracy of your machine learning models.
  prefs: []
  type: TYPE_NORMAL
- en: 'This article discovers details of:'
  prefs: []
  type: TYPE_NORMAL
- en: Retrieving estimates of a model’s performance using scoring metrics
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Finding and diagnosing the common problems of machine learning algorithms
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Fine-tuning parameters of machine learning models
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '*Please read FinTechExplained'
  prefs: []
  type: TYPE_NORMAL
- en: '[disclaimer](https://medium.com/p/87dba77241c7?source=your_stories_page---------------------------).*'
  prefs: []
  type: TYPE_NORMAL
- en: '**Step 1: Understand what tuning machine learning model is**'
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: '*Sometimes, we have to explore how model parameters can enhance forecasting
    accuracy of our machine learning model.*'
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: ''
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: '*Fine tuning machine learning model is a black art. It can turn out to be an
    exhaustive task. I will be covering a number of methodologies in this article
    that we can follow to get accurate results in a shorter time.*'
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: I am often asked a question on the techniques that can be utilised to tune the
    forecasting models when the features are stable and the feature set is decomposed. **Once
    everything is tried, we should look to tune our machine learning models.**
  prefs: []
  type: TYPE_NORMAL
- en: '*Tuning Machine Learning Model Is Like Rotating TV Switches and Knobs Until
    You Get A Clearer Signal*'
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: This diagram illustrates how parameters can be dependent on one another.
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/c405e98432cd3ba1ebdcfb94ce39f3a9.png)'
  prefs: []
  type: TYPE_IMG
- en: X Train — Training data of independent variables, also known as features
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: X Test — Test data of independent variables
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Y Train — Training data of dependent variable
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Y Test — Test data of dependent variable
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '*For instance, if you are forecasting the volume of waterfall based on the
    temperature and humidity then the volume of water is represented as Y (dependent
    variable) and the Temperature and Humidity are the X (independent variables or
    features). Training data of X is then known as X Train which you can use to train
    your model.*'
  prefs: []
  type: TYPE_NORMAL
- en: Hyperparameters are parameters of the models that can be input as arguments
    to the models.
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: 'Step 2: Cover The Basics'
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Before you fine tune your forecasting model, it is important to briefly understand
    what machine learning is.
  prefs: []
  type: TYPE_NORMAL
- en: 'If you are new to machine learning then please have a look at this article:'
  prefs: []
  type: TYPE_NORMAL
- en: '[Machine Learning In 8 Minutes](https://medium.com/fintechexplained/introduction-to-machine-learning-4b2d7c57613b)'
  prefs: []
  type: TYPE_NORMAL
- en: It is often easier to improve the data that we feed into the models than to
    fine tune parameters of the model. If you want to improve accuracy of your forecasting
    model then please enrich data in the feature set first.
  prefs: []
  type: TYPE_NORMAL
- en: '*If you feed poor quality data in then the model will yield poor results.*'
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: 'Please have a look at this article that highlights common techniques to we
    can use to enrich the features:'
  prefs: []
  type: TYPE_NORMAL
- en: '[Processing Data To Improve Machine Learning Model Accuracy](https://medium.com/fintechexplained/processing-data-to-improve-machine-learning-models-accuracy-de17c655dc8e)'
  prefs: []
  type: TYPE_NORMAL
- en: 'If you are unsure whether your model is the most appropriate model for the
    problem then have a look at this article. It reviews most common algorithms of
    the machine learning model:'
  prefs: []
  type: TYPE_NORMAL
- en: '[Machine Learning Algorithms Comparison](https://medium.com/fintechexplained/machine-learning-algorithm-comparison-f14ce372b855)'
  prefs: []
  type: TYPE_NORMAL
- en: 'Step 3: Find Your Score Metric'
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: The most important pre-requisite is to decide on the metric that you are going
    to use to score the accuracy of the forecasting model.
  prefs: []
  type: TYPE_NORMAL
- en: It could be R squared, Adjusted R squared, Confusion Matrix, F1, Recall, Variance
    etc.
  prefs: []
  type: TYPE_NORMAL
- en: 'Read this article to understand the most important mathematical measures that
    every data scientist should know. These measures are explained in an easy-to-understand
    manner:'
  prefs: []
  type: TYPE_NORMAL
- en: '[Must Know Mathematical Measures For Every Data Scientist](https://medium.com/fintechexplained/must-know-mathematical-measures-for-data-scientist-15bfc4f7f39c)'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: Step 4\. Obtain Accurate Forecasting Score
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Once you have prepared your training set, enriched its features, scaled the
    data, decomposed the feature sets, decided on the scoring metric and trained your
    model on the training data then you should test the accuracy of the model on unseen
    data. The unseen data is known as “test data”.
  prefs: []
  type: TYPE_NORMAL
- en: '*You can utilise cross validation to assess how your model works on unseen
    data. This is known as generalisation error of your model.*'
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Cross Validation
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: There are two common cross validation methodologies
  prefs: []
  type: TYPE_NORMAL
- en: '**Holdout Cross Validation**'
  prefs: []
  type: TYPE_NORMAL
- en: '*It is not a wise machine learning practice to train your model and score its
    accuracy on the same data set. It is a far superior technique to test your model
    with varying model parameter values on an unseen test set.*'
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: 'It is a good practice to divide your data set into three parts:'
  prefs: []
  type: TYPE_NORMAL
- en: Training Set
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Validation Set
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Test Set
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '*Train your model on the training set (60% of the data), then perform model
    selection (tuning parameters) on validation set (20% of the data) and once you
    are ready, test your model on the test set (20% of the data).*'
  prefs: []
  type: TYPE_NORMAL
- en: '*Create your training, validation and test data sets proportions according
    to the needs of your machine learning model and availability of the data.*'
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: '**K Fold Cross Validation**'
  prefs: []
  type: TYPE_NORMAL
- en: K-Fold cross validation is a superior mechanism than using holdout cross validation.
    The way it works is that the data is divided into k folds (parts). k-1 folds are
    used to train the model and the last fold is used to test the model.
  prefs: []
  type: TYPE_NORMAL
- en: This mechanism is then repeated k times. Furthermore, each time a number of
    performance metrics can be used to assess and score the performance. The average
    of the performance metrics are then reported. The class proportions are preserved
    in StratifiedKFold.
  prefs: []
  type: TYPE_NORMAL
- en: '*Choose between 8–12 k folds*'
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs: []
  type: TYPE_PRE
- en: n_jobs parameter controls the number of CPUs used to run the cross validation.
  prefs: []
  type: TYPE_NORMAL
- en: 'Step 5: Diagnose Best Parameter Value Using Validation Curves'
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Once accurate forecasting scores have been established, find out all of the
    parameters that your model requires. You can then use validation curves to explore
    how their values can improve the accuracy of the forecasting models.
  prefs: []
  type: TYPE_NORMAL
- en: '*Before we tune the parameters, we need to diagnose and find if the model is
    suffering from under or overfitting.*'
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Models that have a large number of parameters tends to overfit. We can use validation
    curves to resolve the issue of overfitting and underfitting in machine learning.
  prefs: []
  type: TYPE_NORMAL
- en: '*The parameters are also known as hyperparameters*'
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: '![](../Images/7865807d4b2919a6d632824348392dd2.png)'
  prefs: []
  type: TYPE_IMG
- en: '**Photo by [Dominik Scythe](https://unsplash.com/@drscythe?utm_source=medium&utm_medium=referral) on [Unsplash](https://unsplash.com/?utm_source=medium&utm_medium=referral)**'
  prefs: []
  type: TYPE_NORMAL
- en: Validation curve is utilised to pass in a range of values for model parameters.
    It changes the values of the model parameters one at a time and then the accuracy
    values can be plotted against the model parameter value to assess the accuracy
    of the model.
  prefs: []
  type: TYPE_NORMAL
- en: For example, if your model takes a parameter named “number of trees” then you
    can test your model by passing in 10 different values of the parameter. You can
    use validation curve to report accuracy on each of the parameter value to assess
    the accuracy. Finally take the score that returns highest accuracy and gives you
    your required results within acceptable times.
  prefs: []
  type: TYPE_NORMAL
- en: 'Sci-kit learn offers validation curve module:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE2]'
  prefs: []
  type: TYPE_PRE
- en: 'Step 6: Use Grid Search To Optimise Hyperparameter Combination'
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Once we have retrieved optimum values of individual model parameters then we
    can use grid search to obtain combination of hyperparameter values of a model
    that can give us the highest accuracy.
  prefs: []
  type: TYPE_NORMAL
- en: Grid Search evaluates all possible combinations of the parameter values.
  prefs: []
  type: TYPE_NORMAL
- en: Grid Search is exhaustive and uses brute-force to evaluate the most accurate
    values. Therefore it is computationally intensive task.
  prefs: []
  type: TYPE_NORMAL
- en: Use GridSearchCV of sci-kit learn to perform grid search
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE3]'
  prefs: []
  type: TYPE_PRE
- en: 'Step 7: Continuously Tune The Parameters To Further Improve Accuracy'
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: The key here is to always enhance the training set as soon as more data is available.
  prefs: []
  type: TYPE_NORMAL
- en: Always test your forecasting model on richer test data that the model has not
    seen before.
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/00672f7fdfa86218d6675b45b6e9a87e.png)'
  prefs: []
  type: TYPE_IMG
- en: Always ensure that the right model and parameter values are chosen for the job.
  prefs: []
  type: TYPE_NORMAL
- en: It is important to feed more data as soon as it is available and test the accuracy
    of the model on continuous basis so that the performance and accuracy can be further
    optimised.
  prefs: []
  type: TYPE_NORMAL
- en: '**Summary**'
  prefs: []
  type: TYPE_NORMAL
- en: 'This article discovered details of how we can:'
  prefs: []
  type: TYPE_NORMAL
- en: Retrieve estimates of a model’s performance using scoring metrics
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Find and diagnose the common problems of machine learning algorithms
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Fine-tune parameters of machine learning models to further enhance the accuracy
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Hope it helps.
  prefs: []
  type: TYPE_NORMAL
- en: '[Original](https://medium.com/fintechexplained/how-to-fine-tune-your-machine-learning-models-to-improve-forecasting-accuracy-e18e67e58898).
    Reposted with permission.'
  prefs: []
  type: TYPE_NORMAL
- en: '**Resources:**'
  prefs: []
  type: TYPE_NORMAL
- en: '[On-line and web-based: Analytics, Data Mining, Data Science, Machine Learning
    education](https://www.kdnuggets.com/education/online.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Software for Analytics, Data Science, Data Mining, and Machine Learning](https://www.kdnuggets.com/software/index.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Related:**'
  prefs: []
  type: TYPE_NORMAL
- en: '[An End-to-End Project on Time Series Analysis and Forecasting with Python](https://www.kdnuggets.com/2018/09/end-to-end-project-time-series-analysis-forecasting-python.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Data Science Predicting The Future](https://www.kdnuggets.com/2018/06/data-science-predicting-future.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Sales forecasting using Machine Learning](https://www.kdnuggets.com/2017/05/springml-sales-forecasting-using-machine-learning.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '* * *'
  prefs: []
  type: TYPE_NORMAL
- en: Our Top 3 Course Recommendations
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 1\. [Google Cybersecurity
    Certificate](https://www.kdnuggets.com/google-cybersecurity) - Get on the fast
    track to a career in cybersecurity.'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/e225c49c3c91745821c8c0368bf04711.png) 2\. [Google Data Analytics
    Professional Certificate](https://www.kdnuggets.com/google-data-analytics) - Up
    your data analytics game'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 3\. [Google IT Support
    Professional Certificate](https://www.kdnuggets.com/google-itsupport) - Support
    your organization in IT'
  prefs: []
  type: TYPE_NORMAL
- en: '* * *'
  prefs: []
  type: TYPE_NORMAL
- en: More On This Topic
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: '[How To Fine-Tune ChatGPT 3.5 Turbo](https://www.kdnuggets.com/how-to-finetune-chatgpt-35-turbo)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[How to Use Hugging Face AutoTrain to Fine-tune LLMs](https://www.kdnuggets.com/how-to-use-hugging-face-autotrain-to-finetune-llms)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[How to Fine-Tune BERT for Sentiment Analysis with Hugging Face Transformers](https://www.kdnuggets.com/how-to-fine-tune-bert-sentiment-analysis-hugging-face-transformers)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Sky''s the Limit: Learn how JetBlue uses Monte Carlo and Snowflake…](https://www.kdnuggets.com/2022/12/monte-carlo-jetblue-snowflake-build-trust-improve-model-accuracy.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[7 Ways to Improve Your Machine Learning Models](https://www.kdnuggets.com/7-ways-to-improve-your-machine-learning-models)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Understanding Classification Metrics: Your Guide to Assessing Model…](https://www.kdnuggets.com/understanding-classification-metrics-your-guide-to-assessing-model-accuracy)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
