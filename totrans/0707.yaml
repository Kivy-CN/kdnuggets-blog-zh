- en: Building Data Science Pipelines Using Pandas
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://www.kdnuggets.com/building-data-science-pipelines-using-pandas](https://www.kdnuggets.com/building-data-science-pipelines-using-pandas)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: '![Building Data Science Pipelines Using Pandas](../Images/05c0bb2b8602f22678bebd3cab880760.png)'
  prefs: []
  type: TYPE_IMG
- en: Image generated with ChatGPT
  prefs: []
  type: TYPE_NORMAL
- en: Pandas is one of the most popular data manipulation and analysis tools available,
    known for its ease of use and powerful capabilities. But did you know that you
    can also use it to create and execute data pipelines for processing and analyzing
    datasets?
  prefs: []
  type: TYPE_NORMAL
- en: '* * *'
  prefs: []
  type: TYPE_NORMAL
- en: Our Top 3 Course Recommendations
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 1\. [Google Cybersecurity
    Certificate](https://www.kdnuggets.com/google-cybersecurity) - Get on the fast
    track to a career in cybersecurity.'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/e225c49c3c91745821c8c0368bf04711.png) 2\. [Google Data Analytics
    Professional Certificate](https://www.kdnuggets.com/google-data-analytics) - Up
    your data analytics game'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 3\. [Google IT Support
    Professional Certificate](https://www.kdnuggets.com/google-itsupport) - Support
    your organization in IT'
  prefs: []
  type: TYPE_NORMAL
- en: '* * *'
  prefs: []
  type: TYPE_NORMAL
- en: In this tutorial, we will learn how to use Pandas' `pipe` method to build end-to-end
    data science pipelines. The pipeline includes various steps like data ingestion,
    data cleaning, data analysis, and data visualization. To highlight the benefits
    of this approach, we will also compare pipeline-based code with non-pipeline alternatives,
    giving you a clear understanding of the differences and advantages.
  prefs: []
  type: TYPE_NORMAL
- en: What is a Pandas Pipe?
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: The Pandas `pipe` method is a powerful tool that allows users to chain multiple
    data processing functions in a clear and readable manner. This method can handle
    both positional and keyword arguments, making it flexible for various custom functions.
  prefs: []
  type: TYPE_NORMAL
- en: 'In short, Pandas `pipe` method:'
  prefs: []
  type: TYPE_NORMAL
- en: Enhances Code Readability
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Enables Function Chaining
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Accommodates Custom Functions
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Improves Code Organization
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Efficient for Complex Transformations
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Here is the code example of the `pipe` function. We have applied `clean` and
    `analysis` Python functions to the Pandas DataFrame. The pipe method will first
    clean the data, perform data analysis, and return the output.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: Pandas Code without Pipe
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: First, we will write a simple data analysis code without using pipe so that
    we have a clear comparison of when we use pipe to simplify our data processing
    pipeline.
  prefs: []
  type: TYPE_NORMAL
- en: For this tutorial, we will be using the [Online Sales Dataset - Popular Marketplace
    Data](https://www.kaggle.com/datasets/shreyanshverma27/online-sales-dataset-popular-marketplace-data)
    from Kaggle that contains information about online sales transactions across different
    product categories.
  prefs: []
  type: TYPE_NORMAL
- en: We will load the CSV file and display the top three rows from the dataset.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs: []
  type: TYPE_PRE
- en: '![Building Data Science Pipelines Using Pandas](../Images/86b5024a87c7367ea47cec510f86b87f.png)'
  prefs: []
  type: TYPE_IMG
- en: Clean the dataset by dropping duplicates and missing values and reset the index.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Convert column types. We will convert “Product Category” and “Product Name”
    to string and “Date” column to date type.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: To perform analysis, we will create a “month” column out of a “Date” column.
    Then, calculate the mean values of units sold per month.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Visualize the bar chart of the average unit sold per month.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE2]'
  prefs: []
  type: TYPE_PRE
- en: '![Building Data Science Pipelines Using Pandas](../Images/ee4399b659b959816f206b0fb511ee1e.png)'
  prefs: []
  type: TYPE_IMG
- en: This is quite simple, and if you are a data scientist or even a data science
    student, you will know how to perform most of these tasks.
  prefs: []
  type: TYPE_NORMAL
- en: Building Data Science Pipelines Using Pandas Pipe
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: To create an end-to-end data science pipeline, we first have to convert the
    above code into a proper format using Python functions.
  prefs: []
  type: TYPE_NORMAL
- en: 'We will create Python functions for:'
  prefs: []
  type: TYPE_NORMAL
- en: '**Loading the data:** It requires a directory of CSV files.'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '**Cleaning the data:** It requires raw DataFrame and returns the cleaned DataFrame.'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '**Convert column types:** It requires a clean DataFrame and data types and
    returns the DataFrame with the correct data types.'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '**Data analysis:** It requires a DataFrame from the previous step and returns
    the modified DataFrame with two columns.'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '**Data visualization:** It requires a modified DataFrame and visualization
    type to generate visualization.'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE3]'
  prefs: []
  type: TYPE_PRE
- en: We will now use the `pipe` method to chain all of the above Python functions
    in series. As we can see, we have provided the path of the file to the `load_data`
    function, data types to the `convert_dtypes` function, and visualization type
    to the `data_visualization` function. Instead of a bar, we will use a visualization
    line chart.
  prefs: []
  type: TYPE_NORMAL
- en: Building the data pipelines allows us to experiment with different scenarios
    without changing the overall code. You are standardizing the code and making it
    more readable.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE4]'
  prefs: []
  type: TYPE_PRE
- en: The end result looks awesome.
  prefs: []
  type: TYPE_NORMAL
- en: '![Building Data Science Pipelines Using Pandas](../Images/56adff4a5b7c2aa4cf43f8d3e64934db.png)'
  prefs: []
  type: TYPE_IMG
- en: Conclusion
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: In this short tutorial, we learned about the Pandas `pipe` method and how to
    use it to build and execute end-to-end data science pipelines. The pipeline makes
    your code more readable, reproducible, and better organized. By integrating the
    pipe method into your workflow, you can streamline your data processing tasks
    and enhance the overall efficiency of your projects. Additionally, some users
    have found that using `pipe` instead of the `.apply()`method results in significantly
    faster execution times.
  prefs: []
  type: TYPE_NORMAL
- en: '[](https://www.polywork.com/kingabzpro)****[Abid Ali Awan](https://www.polywork.com/kingabzpro)****
    ([@1abidaliawan](https://www.linkedin.com/in/1abidaliawan)) is a certified data
    scientist professional who loves building machine learning models. Currently,
    he is focusing on content creation and writing technical blogs on machine learning
    and data science technologies. Abid holds a Master''s degree in technology management
    and a bachelor''s degree in telecommunication engineering. His vision is to build
    an AI product using a graph neural network for students struggling with mental
    illness.'
  prefs: []
  type: TYPE_NORMAL
- en: More On This Topic
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: '[Building Data Pipelines to Create Apps with Large Language Models](https://www.kdnuggets.com/building-data-pipelines-to-create-apps-with-large-language-models)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Answering Questions with HuggingFace Pipelines and Streamlit](https://www.kdnuggets.com/2021/10/simple-question-answering-web-app-hugging-face-pipelines.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Beyond Pipelines: Graphs as Scikit-Learn Metaestimators](https://www.kdnuggets.com/2022/09/graphs-scikitlearn-metaestimators.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Simple NLP Pipelines with HuggingFace Transformers](https://www.kdnuggets.com/2023/02/simple-nlp-pipelines-huggingface-transformers.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Unify Batch and ML Systems with Feature/Training/Inference Pipelines](https://www.kdnuggets.com/2023/09/hopsworks-unify-batch-ml-systems-feature-training-inference-pipelines)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Streamline Your Machine Learning Workflow with Scikit-learn Pipelines](https://www.kdnuggets.com/streamline-your-machine-learning-workflow-with-scikit-learn-pipelines)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
