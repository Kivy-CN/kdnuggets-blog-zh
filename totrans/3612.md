# 何时重新训练机器学习模型？运行这5项检查来决定时间表。

> 原文：[https://www.kdnuggets.com/2021/07/retrain-machine-learning-model-5-checks-decide-schedule.html](https://www.kdnuggets.com/2021/07/retrain-machine-learning-model-5-checks-decide-schedule.html)

[评论](#comments)

**作者** [**Emeli Dral**](https://twitter.com/EmeliDral)**，Evidently AI 的首席技术官兼联合创始人 &** [**Elena Samuylova**](https://twitter.com/elenasamuylova/)**，Evidently AI 的首席执行官兼联合创始人**

世界和数据不是静态的。但大多数机器学习模型是静态的。一旦它们投入生产，它们随着时间变得不那么相关。[数据分布在变化，行为模式也在改变](https://evidentlyai.com/blog/machine-learning-monitoring-data-and-concept-drift)，模型需要更新以跟上新的现实。

* * *

## 我们的前三个课程推荐

![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 1\. [Google网络安全证书](https://www.kdnuggets.com/google-cybersecurity) - 快速进入网络安全职业生涯。

![](../Images/e225c49c3c91745821c8c0368bf04711.png) 2\. [Google数据分析专业证书](https://www.kdnuggets.com/google-data-analytics) - 提升您的数据分析技能

![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 3\. [Google IT支持专业证书](https://www.kdnuggets.com/google-itsupport) - 支持您的组织的IT需求

* * *

通常的过程是在定义的时间间隔重新训练模型。这看起来相当简单：获取新数据、旧的训练流程，并再次拟合模型。

但是我们应该多久做一次呢？是每天、每周还是每月？还是每次获取一批新数据时？

![Image](../Images/6633c2014ec57d3088ba2179d982447e.png)

太多时候，答案基于直觉或便利性。有人选择一个合理的时间间隔并安排定期的重新训练工作。

相反，我们可以采取更数据驱动的方法。为了更精确地规划模型维护，我们可以提前进行一些检查。

根据模型的重要性，您可能需要经历所有这些步骤或仅部分步骤。

### 检查 #1\. 模型是否已经足够好？

在制定重新训练计划之前，检查是否完成了训练是有帮助的！也许，模型还没有达到最佳性能？

实现这一点的简单方法是查看经典的学习曲线。

![Image](../Images/f0988021c2e694e56e03bef78e14da42.png)

如何进行？我们可以固定测试集，用于评估模型性能。然后，通过在不同部分的训练数据上训练模型，运行一系列实验。

我们可以使用随机分割方法并通过更改训练大小来进行迭代。这样，我们可以专注于数据量如何影响性能。

![Image](../Images/1353e1f20c4313d1a9f55092a6d2800a.png)

我们可以从中学到两件事：1）我们需要多少数据才能达到最佳性能 2）模型是否能用现有的训练数据达到这个平稳状态。

**有时候我们会发现模型并不需要我们拥有的所有数据。** 例如，我们有多年的销售数据，但使用仅仅一年的训练数据就能达到相同的质量。

我们可以丢弃额外的数据，使模型更加轻量化。

**在其他情况下，我们可能会看到模型质量持续提升**。模型渴望更多的数据！还有更多步骤需要完成，以将模型调整到最佳状态。

![Image](../Images/7d75b4bc993a559419e6f57d29fb3c70.png)

与其考虑模型重新训练以保持其质量，我们应该计划持续改进。只要我们获得足够的新数据，就可以利用它来获得更好的性能。

第一个测试还提供了数据中信号的规模和“密度”的感觉。我们需要10、100还是1000个观察值来看到对模型性能的有意义的影响？我们需要一天还是一个月来收集这数量的新数据？

这是一个有用的信息！

### 检查 #2\. 事物变化的速度有多快？

当我们创建机器学习模型时，我们假设现实世界的过程是有一定稳定性的。否则，从过去学习就没有多大意义了！

我们也知道事物在变化。当处理一个动态过程时，我们也可以假设这些新模式的积累有一定的速度。

然后我们可以尝试计算一下！

让我们拿到我们的模型，看看如果我们模拟它在过去的应用，它能“持续”多久。

![Image](../Images/f57dc5e2baea3ed6c05cdd2eefc14927.png)

我们可以使用一些较旧的数据来训练模型，然后将其“应用”到后来的时期。就像我们对待保留集一样，但这里我们只是简单地取几个连续的数据。

我们可以从一个单点估计开始，看看性能下降得有多快。

![Image](../Images/886251abc0b3af2682dc5aedba2e68cd.png)

如果我们有足够的历史数据，我们可以多次重复这个检查，然后对结果进行平均。只需留意潜在的异常值和稀有事件！

![Image](../Images/4187c122c80bd37ca886503946959293.png)

**有时候我们会发现一个“旧”模型的表现和新模型一样好。** 一些人喜欢经常重新训练模型以保持其“新鲜”，但这并不总是有理的。

不要修复那些没有坏的东西！

如果不需要频繁的重新训练，你可以选择一个更轻量的服务架构。你也可以减少与任何变化相关的技术错误风险。组织开销也是如此，尤其是当新模型需要审批过程时。

![Image](../Images/7cf2c1d846f0a3770216da28a8ebe87a.png)

**在其他情况下，你可能会发现模型衰老得非常快！** 提前了解这一点是好的，以便设置适当的监控并准备基础设施。

你可能会决定重新考虑你的训练方法，以使模型更加稳定。例如，改变特征工程或模型架构，使其在测试集上的表现稍微逊色，但长期来看更稳定。在其他情况下，你可能会使用较短的训练周期来训练模型，但进行频繁的校准或考虑主动学习。

我们还可能面临重新训练模型能力的限制。

这引出了下一个检查。

### 检查 #3。我们何时获取新数据？

![Image](../Images/ad4cb68a76433b6c053208581142e7d7.png)

在这里，我们关注的是业务流程而非数据。

有时，我们几乎可以立即获得实际反馈。例如，你推荐一篇文章阅读，你很快就知道用户是否点击了链接。

在其他情况下，你可以用来重新训练模型的新数据有延迟。

如果你有较长的预测时间范围，你必须等待以了解你的预测是否正确。对于其他任务，你需要一个单独的标记过程。有时，限制来自数据的移动或生成方式。例如，手动数据输入每月进行一次。

![Image](../Images/4d963f1ef664d1112a0b9573247d2a02.png)

我们可能会发现自己处于两种情况之一。

**在某些情况下，模型在新数据到达之前就已经退化。** 这成为一种限制。

如果我们没有及时获取数据以重新训练模型，我们可能需要再次重新考虑方法。例如，创建一个具有不同重新训练时间的模型集成，或将机器学习与规则或人工参与结合起来。作为最后的手段，我们还可以调整我们的性能期望，并准备应对模型质量下降。

**在其他情况下，新数据在模型退化之前开始积累。** 在这种情况下，我们可以选择。

我们当然可以在数据到达后的任何时间点启动重新训练。如果我们想要更精确，有一种方法可以做到这一点。

继续阅读！

### 检查 #4。我们需要多少数据才能看到改进？

假设新数据每天到达，但模型仅在30天后退化。那么最佳的行动是什么？我们应该每天、每周还是每月重新训练一次？

![Image](../Images/93da0c9a4e5c92b0642fc2c37d89f2a3.png)

我们可以通过检查新的数据桶是否带来了我们想要的改进来做出更精确的判断。

问题是，有时添加一小组新数据点不会改变任何东西。有一个最小的数据量要求，它对性能有明显的影响。

我们可以评估这一点。

为此，我们选择一个已知退化期间的测试集。我们知道何时性能下降：然后可以检查在新数据上重新训练是否能改善性能。

![Image](../Images/36e21e33e0b86cf04f120b86ea13917b.png)

我们可以在数据到达时逐步添加数据。然后，观察它对测试性能的影响。

经常发生的情况是，我们需要等待一段时间才能收集到“有用”的数据——例如，至少一周的数据以捕捉相关的季节性模式。

结果是，我们实际选择的重新训练窗口可能比看起来要狭窄！一方面，它受到数据提供速度的限制；另一方面，则受到收集足够数据以使重新训练产生效果的需求限制。

![图片](../Images/0c8d71d262bc407a56865915a599e208.png)

在这个时间框架内，你可以根据实际情况和使用案例选择适合的周期。

### 检查 #5。我们应该保留旧数据吗？

还有一个经常出现的问题。我们应该如何重新训练模型？是否应该添加一些新数据并丢弃一些旧数据？是否应该持续增加训练集？

这是我们可以运行的一个额外检查。

我们可以在选择的间隔进行模型重新训练，然后检查如果开始丢弃旧数据会发生什么变化。

![图片](../Images/2433693530f83ace89e16563af95b574.png)

我们常常会看到，省略旧数据没有任何影响。那么，保持训练过程更轻量化可能是合理的。

更重要的是，有时这会使模型变得更好！保留旧的无关数据可能会导致性能下降，尤其是当你有一个动态使用案例时。这是值得事先了解的。

当然，我们也可能会发现暂时保留所有数据是有意义的。你可以稍后重复检查。

### 下一步是什么？

通过这些检查，你可以为模型维护做好准备。你可以设置你的重新训练管道，以便在选择的间隔准备好更新。

不过，我们不能仅仅依靠我们的计划。我们还需要进行现实检查。这意味着在模型上线后监控它们。

为了获得可见性，我们可以建立一个 [监控仪表板](https://github.com/evidentlyai/evidently) 或安排定期检查以计算实际模型性能（如果我们有实际数据），或者监控输入数据的统计分布漂移和异常值。

![图片](../Images/19db7390f4ca668c6a5a3a66023ce064.png)

即使是稳定的模型也可能面临 [数据和概念漂移](https://evidentlyai.com/blog/machine-learning-monitoring-data-and-concept-drift) 或某些罕见事件。在这种情况下，我们可能需要比计划更早进行干预。

另一方面，如果情况看起来稳定，我们可以跳过比计划时间更长的更新。

规划定期重新训练并结合持续监控通常是使模型达到承诺性能的最佳策略！

**链接**

你可以在 [这里](https://evidentlyai.com/blog/retrain-or-not-retrain) 找到这篇文章的扩展版本。

[机器学习监控检查清单](/2021/03/machine-learning-model-monitoring-checklist.html)

**Emeli Dral** 是 Evidently AI 的联合创始人兼首席技术官，她在公司开发用于分析和监控机器学习模型的工具。她曾共同创办过一家工业 AI 初创公司，并担任 Yandex Data Factory 的首席数据科学家。她还是 Coursera 机器学习和数据分析课程的共同作者，该课程拥有超过 100,000 名学生。

[https://twitter.com/EmeliDral](https://twitter.com/EmeliDral)

**Elena Samuylova** 是 Evidently AI 的联合创始人兼首席执行官。她曾共同创办过一家工业 AI 初创公司，并在 Yandex Data Factory 负责业务发展。自 2014 年以来，她与从制造业到零售业的公司合作，提供基于 ML 的解决方案。2018 年，Elena 被 Product Management Festival 评选为欧洲 50 位产品女性之一。

[https://twitter.com/elenasamuylova/](https://twitter.com/elenasamuylova/)

**相关：**

+   [从机器学习错误中学习](/2021/03/learning-from-machine-learning-mistakes.html)

+   [机器学习模型监控检查清单：7 个跟踪项](/2021/03/machine-learning-model-monitoring-checklist.html)

+   [MLOps：模型监控 101](/2021/01/mlops-model-monitoring-101.html)

### 更多相关话题

+   [使用 Jupysql 和 GitHub Actions 调度和运行 ETL](https://www.kdnuggets.com/2023/05/schedule-run-etls-jupysql-github-actions.html)

+   [深度学习在合规检查中的新进展](https://www.kdnuggets.com/2022/05/deep-learning-compliance-checks-new.html)

+   [Pandas 中 7 个关键数据质量检查]https://www.kdnuggets.com/7-essential-data-quality-checks-with-pandas)

+   [通过这些 GitHub 仓库学习机器学习](https://www.kdnuggets.com/2023/01/learn-machine-learning-github-repositories.html)

+   [了解如何在您的设备上仅需几个步骤即可运行 Alpaca-LoRA](https://www.kdnuggets.com/2023/05/learn-run-alpacalora-device-steps.html)

+   [在本地使用 LM Studio 运行 LLM](https://www.kdnuggets.com/run-an-llm-locally-with-lm-studio)
