- en: Time Series Forecasting with statsmodels and Prophet
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://www.kdnuggets.com/2023/03/time-series-forecasting-statsmodels-prophet.html](https://www.kdnuggets.com/2023/03/time-series-forecasting-statsmodels-prophet.html)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: '![Time Series Forecasting with statsmodels and Prophet](../Images/4a5c14cb8db13d4f46524c0ca6b33b11.png)'
  prefs: []
  type: TYPE_IMG
- en: Image by [jcomp](https://www.freepik.com/free-vector/businessmen-invest-market-gain-success-from-investing_27306158.htm#query=forecast&position=6&from_view=search&track=sph#position=6&query=forecast)
    on [Freepik](https://www.freepik.com/)
  prefs: []
  type: TYPE_NORMAL
- en: Time series is a unique dataset within the data science field. The data is recorded
    on time-frequency (e.g., daily, weekly, monthly, etc.), and each observation is
    related to the other. The time series data is valuable when you want to analyze
    what happens to your data over time and create future predictions.
  prefs: []
  type: TYPE_NORMAL
- en: '* * *'
  prefs: []
  type: TYPE_NORMAL
- en: Our Top 3 Course Recommendations
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 1\. [Google Cybersecurity
    Certificate](https://www.kdnuggets.com/google-cybersecurity) - Get on the fast
    track to a career in cybersecurity.'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/e225c49c3c91745821c8c0368bf04711.png) 2\. [Google Data Analytics
    Professional Certificate](https://www.kdnuggets.com/google-data-analytics) - Up
    your data analytics game'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 3\. [Google IT Support
    Professional Certificate](https://www.kdnuggets.com/google-itsupport) - Support
    your organization in IT'
  prefs: []
  type: TYPE_NORMAL
- en: '* * *'
  prefs: []
  type: TYPE_NORMAL
- en: Time series forecasting is a method to create future predictions based on historical
    time series data. There are many statistical methods for time series forecasting,
    such as [ARIMA](https://en.wikipedia.org/wiki/Autoregressive_integrated_moving_average)
    or [Exponential Smoothing](https://en.wikipedia.org/wiki/Exponential_smoothing).
  prefs: []
  type: TYPE_NORMAL
- en: Time series forecasting is often encountered in the business, so it’s beneficial
    for the data scientist to know how to develop a time series model. In this article,
    we will learn how to forecast time series using two popular forecastings Python
    packages; statsmodels and Prophet. Let’s get into it.
  prefs: []
  type: TYPE_NORMAL
- en: Time Series Forecasting with statsmodels
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'The [statsmodels](https://www.statsmodels.org/stable/index.html) Python package
    is an open-source package offering various statistical models, including the time
    series forecasting model. Let’s try out the package with an example dataset. This
    article will use the [Digital Currency Time Series](https://www.kaggle.com/datasets/ahmedadam415/digital-currency-time-series)
    data from Kaggle (CC0: Public Domain).'
  prefs: []
  type: TYPE_NORMAL
- en: Let’s clean up the data and take a look at the dataset that we have.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: '![Time Series Forecasting with statsmodels and Prophet](../Images/e2438d8f02379622ea1332c80b63473c.png)'
  prefs: []
  type: TYPE_IMG
- en: For our example, let’s say we want to forecast the ‘close_USD’ variable. Let’s
    see how the data pattern over time.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs: []
  type: TYPE_PRE
- en: '![Time Series Forecasting with statsmodels and Prophet](../Images/20f95d59228f79f03a7303d94d011edf.png)'
  prefs: []
  type: TYPE_IMG
- en: Let’s build the forecast model based on our above data. Before modeling, let’s
    split the data into train and test data.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE2]'
  prefs: []
  type: TYPE_PRE
- en: We don’t split the data randomly because it’s time series data, and we need
    to preserve the order. Instead, we try to have the train data from earlier and
    the test data from the latest data.
  prefs: []
  type: TYPE_NORMAL
- en: Let’s use statsmodels to create a forecast model. The [statsmodel](https://www.statsmodels.org/stable/tsa.html)
    provides many time series model APIs, but we would use the ARIMA model as our
    example.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE3]'
  prefs: []
  type: TYPE_PRE
- en: '![Time Series Forecasting with statsmodels and Prophet](../Images/6d8bb1bef7463a9abc255d3504026004.png)'
  prefs: []
  type: TYPE_IMG
- en: In our example above, we use the ARIMA model from statsmodels as the forecasting
    model and try to predict the next 200 days.
  prefs: []
  type: TYPE_NORMAL
- en: Is the model result good? Let’s try to evaluate them. The time series model
    evaluation usually uses a visualization graph to compare the actual and prediction
    with regression metrics such as Mean Absolute Error (MAE), Root Mean Square Error
    (RMSE), and MAPE (Mean Absolute Percentage Error).
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE4]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE5]'
  prefs: []
  type: TYPE_PRE
- en: The score above looks fine, but let’s see how it is when we visualize them.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE6]'
  prefs: []
  type: TYPE_PRE
- en: '![Time Series Forecasting with statsmodels and Prophet](../Images/287a6cd87f9b674343d562f5b6d2e203.png)'
  prefs: []
  type: TYPE_IMG
- en: As we can see, the forecast was worse as our model can’t forecast the increasing
    trend. The model ARIMA that we use seems too simple for forecasting.
  prefs: []
  type: TYPE_NORMAL
- en: Maybe it’s better if we try using another model outside of statsmodels. Let’s
    try out the famous prophet package from Facebook.
  prefs: []
  type: TYPE_NORMAL
- en: Time Series Forecasting with Prophet
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '[Prophet](https://facebook.github.io/prophet/) is a time series forecasting
    model package that works best on data with seasonal effects. Prophet was also
    considered a robust forecast model because it could handle missing data and outliers.'
  prefs: []
  type: TYPE_NORMAL
- en: Let’s try out the Prophet package. First, we need to install the package.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE7]'
  prefs: []
  type: TYPE_PRE
- en: 'After that, we must prepare our dataset for the forecasting model training.
    Prophet has a specific requirement: the time column needs to be named as ‘ds’
    and the value as ‘y’.'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE8]'
  prefs: []
  type: TYPE_PRE
- en: With our data ready, let’s try to create forecast prediction based on the data.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE9]'
  prefs: []
  type: TYPE_PRE
- en: '![Time Series Forecasting with statsmodels and Prophet](../Images/3d34d319e0a2556190835b0f253327a3.png)'
  prefs: []
  type: TYPE_IMG
- en: What was great about the Prophet was that every forecast data point was detailed
    for us users to understand. However, it is hard to understand the result just
    from the data. So, we could try to visualize them using Prophet.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE10]'
  prefs: []
  type: TYPE_PRE
- en: '![Time Series Forecasting with statsmodels and Prophet](../Images/7d894c1a2dd2a101a478702e2a019f24.png)'
  prefs: []
  type: TYPE_IMG
- en: The predictions plot function from the model would provide us with how confident
    the predictions were. From the above plot, we can see that the prediction has
    an upward trend but with increased uncertainty the longer the predictions are.
  prefs: []
  type: TYPE_NORMAL
- en: It is also possible to examine the forecast components with the following function.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE11]'
  prefs: []
  type: TYPE_PRE
- en: '![Time Series Forecasting with statsmodels and Prophet](../Images/35ada67124732d053e9e2b0442ba5590.png)'
  prefs: []
  type: TYPE_IMG
- en: By default, we would obtain the data trend with yearly and weekly seasonality.
    It’s a good way to explain what happens with our data.
  prefs: []
  type: TYPE_NORMAL
- en: 'Would it be possible to evaluate the Prophet model as well? Absolutely. Prophet
    includes a diagnostic measurement that we can use: [time series cross-validation](https://facebook.github.io/prophet/docs/diagnostics.html#cross-validation).
    The method uses part of the historical data and fits the model each time using
    data up to the cutoff point. Then the Prophet would compare the predictions with
    the actual ones. Let’s try using the code.'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE12]'
  prefs: []
  type: TYPE_PRE
- en: '![Time Series Forecasting with statsmodels and Prophet](../Images/aca174fb6e6da3d9088aed28c1e5389b.png)'
  prefs: []
  type: TYPE_IMG
- en: In the result above, we acquired the evaluation result from the actual result
    compared to the forecast in each forecast day. It’s also possible to visualize
    the result with the following code.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE13]'
  prefs: []
  type: TYPE_PRE
- en: '![Time Series Forecasting with statsmodels and Prophet](../Images/1bf2ff18fca3703cab513326672fb7bf.png)'
  prefs: []
  type: TYPE_IMG
- en: If we see the plot above, we can see the prediction error was vary following
    the days, and it could achieve 50% error at some points. This way, we might want
    to tweak the model further to fix the error. You can check the [documentation](https://facebook.github.io/prophet/docs/)
    for further exploration.
  prefs: []
  type: TYPE_NORMAL
- en: Conclusion
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Forecasting is one of the common cases that occur in the business. One easy
    way to develop a forecasting model is using the statsforecast and Prophet Python
    packages. In this article, we learn how to create a forecast model and evaluate
    them with statsforecast and Prophet.
  prefs: []
  type: TYPE_NORMAL
- en: '**[Cornellius Yudha Wijaya](https://www.linkedin.com/in/cornellius-yudha-wijaya/)**
    is a data science assistant manager and data writer. While working full-time at
    Allianz Indonesia, he loves to share Python and Data tips via social media and
    writing media.'
  prefs: []
  type: TYPE_NORMAL
- en: More On This Topic
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: '[Time Series Forecasting with Ploomber, Arima, Python, and Slurm](https://www.kdnuggets.com/2022/03/time-series-forecasting-ploomber-arima-python-slurm.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Leveraging XGBoost for Time-Series Forecasting](https://www.kdnuggets.com/2023/08/leveraging-xgboost-timeseries-forecasting.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Explainable Forecasting and Nowcasting with State-of-the-art Deep…](https://www.kdnuggets.com/2021/12/sota-explainable-forecasting-and-nowcasting.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Forecasting Future Events: The Capabilities and Limitations of AI and ML](https://www.kdnuggets.com/2023/06/forecasting-future-events-capabilities-limitations-ai-ml.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Learn modern forecasting techniques to help predict future business…](https://www.kdnuggets.com/2022/12/sphere-learn-modern-forecasting-techniques-help-predict-future-business-outcomes.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Market Data and News: A Time Series Analysis](https://www.kdnuggets.com/2022/06/market-data-news-time-series-analysis.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
