# 7 步骤掌握 Python 数据准备

> 原文：[https://www.kdnuggets.com/2017/06/7-steps-mastering-data-preparation-python.html/2](https://www.kdnuggets.com/2017/06/7-steps-mastering-data-preparation-python.html/2)

### 第 4 步：处理异常值

这不是关于在建模时如何处理数据异常值的策略教程；在建模时，有时包括异常值是合适的，有时则不是（无论任何人如何告诉你）。这取决于具体情况，没有人可以对你的情况是属于 A 列还是 B 列做出笼统的断言。

![异常值](../Images/83f05baa9ceceac3e6681aadf81698c0.png)

你能找到异常值吗？

* * *

## 我们的前三个课程推荐

![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 1\. [谷歌网络安全证书](https://www.kdnuggets.com/google-cybersecurity) - 快速进入网络安全职业道路。

![](../Images/e225c49c3c91745821c8c0368bf04711.png) 2\. [谷歌数据分析专业证书](https://www.kdnuggets.com/google-data-analytics) - 提升你的数据分析能力

![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 3\. [谷歌 IT 支持专业证书](https://www.kdnuggets.com/google-itsupport) - 支持你的组织的 IT

* * *

处理异常值的一些讨论：

+   [异常值：去除还是保留](http://www.theanalysisfactor.com/outliers-to-drop-or-not-to-drop/)，来自 The Analysis Factor

+   [从数据中去除异常值是否可行？](https://stats.stackexchange.com/questions/200534/is-it-ok-to-remove-outliers-from-data/200923)，来自 Stack Exchange

异常值可能是数据收集不良的结果，也可能是真正的、异常的数据。这是两种不同的情况，必须以不同的方式处理，因此没有一种“通用”建议适用，就像处理缺失值一样。来自上述 Analysis Factor 文章的一个特别好的见解如下：

> 一个选项是尝试进行转换。平方根和对数转换都可以拉回高数字。如果异常值是因变量，这可以使假设更有效；如果异常值是自变量，这可以减少单个点的影响。

我们将留给你决定是否在数据集中保留异常值。然而，如果你的模型确实需要以某种方式处理异常值数据，以下是一些讨论的方法：

+   [处理异常值的 3 种方法](/2017/01/3-methods-deal-outliers.html)，作者 Alberto Quesada

+   [使用标准差在 Python 中去除异常值](/2017/02/removing-outliers-standard-deviation-python.html)，作者 Punit Jajodia

+   [在 Pandas DataFrame 中使用百分位数去除异常值](https://stackoverflow.com/questions/35827863/remove-outliers-in-pandas-dataframe-using-percentiles)，来自 Stack Overflow

### 第 5 步：处理不平衡数据

那么，如果你的数据集本身强健 -- 没有缺失值和异常值 -- 但由两个类别组成：一个包含95%的实例，另一个仅包含5%？或者更糟 -- 99.8% 对 0.2%？

如果是这样，那么你的数据集是不平衡的，至少在类别方面是这样。这可能会带来问题，我相信这些问题不需要特别指出。但不必立刻抛弃数据；当然，有处理这种情况的策略。

注意，尽管这可能不真正是一个数据准备任务，但这种数据集特征会在数据准备阶段早期显现（EDA的重要性），并且这种数据的有效性可以在准备阶段进行初步评估。

首先，查看Tom Fawcett关于如何处理这一问题的讨论：

+   [从不平衡类别中学习](/2016/08/learning-from-imbalanced-classes.html)，作者：Tom Fawcett

接下来，查看有关处理类别不平衡的技术的讨论：

+   [7 Techniques to Handle Imbalanced Data](/2017/06/7-techniques-handle-imbalanced-data.html)，作者：Ye Wu & Rick Radewagen

![不平衡数据](../Images/c9cbb484ef13d59bff657b921d1b6624.png)

识别和处理不平衡非常重要。

关于为什么我们会遇到不平衡数据，以及为什么在某些领域中这种情况比其他领域更频繁的一个良好解释（见上文链接的《7 Techniques to Handle Imbalanced Data》）：

> 这些领域中使用的数据通常包含不到1%的稀有但“有趣”的事件（例如，使用信用卡的诈骗者、用户点击广告或被破坏的服务器扫描其网络）。然而，大多数机器学习算法在处理不平衡数据集时效果并不好。以下七种技术可以帮助你训练分类器以检测异常类别。

### 第6步：数据转换

维基百科将[数据转换](https://en.wikipedia.org/wiki/Data_transformation_(statistics))定义为：

> 在统计学中，数据转换是将确定性数学函数应用于数据集中的每个点 -- 即，每个数据点 zi 被替换为转换后的值 *y[i]* = *f(z[i])*，其中 *f* 是一个函数。转换通常是为了使数据更接近要应用的统计推断程序的假设，或改善图表的可解释性或外观。

数据转换是数据准备中最重要的方面之一，它需要比其他大多数方法更多的技巧。当数据中出现缺失值时，通常很容易找到，并且可以通过上面提到的一些常见方法（至少是表面上）来处理，或者通过在领域中逐渐获得的更复杂的措施来处理。然而，数据转换何时以及是否需要 -- 更不用说所需的转换类型 -- 通常并不像容易识别的那样明显。

存在大量的变换；与其试图概括何时以及为什么变换是有用的，不如看看一些具体的变换，以便更好地掌握它们。

来自 Scikit-learn 文档的概述给出了一些最重要的预处理变换的理由，即标准化、归一化和二值化（还有一些其他变换）：

+   [数据预处理](http://scikit-learn.org/stable/modules/preprocessing.html)，Scikit-learn 文档

![一热编码](../Images/5fadf8e114fa3bd5734554c29040064e.png)

一热编码变换的示例结果。

一热编码“将分类特征转化为更适合分类和回归算法的格式”（摘自下面的第一个链接）。查看下面关于一热变换的讨论，以及使用 Pandas 的一种方法：

+   [什么是一热编码，何时在数据科学中使用？](https://www.quora.com/What-is-one-hot-encoding-and-when-is-it-used-in-data-science/answer/H%C3%A5kon-Hapnes-Strand)，Quora 上 Håkon Hapnes Strand 的回答

+   [我如何在 Python 中进行一热编码？](http://stackoverflow.com/questions/37292872/how-can-i-one-hot-encode-in-python)，Stack Overflow

如果“你假设一个非线性的模型形式，但可以转化为线性模型”（摘自下文），对数分布变换可能会很有用。请阅读以下关于一种被低估的变换类型的更多内容：

+   [何时（以及为什么）对分布（的数字）进行对数变换？](https://stats.stackexchange.com/questions/18844/when-and-why-should-you-take-the-log-of-a-distribution-of-numbers)，Stack Exchange

如上所述，可能的变换有很多，这取决于数据和你的要求。我希望将来能更深入地探讨数据变换，并在那个时候进行更详细的讨论。

请注意，这整个讨论也完全有意地跳过了特征选择的提及：它在这样一个更广泛的讨论中远远不止几句话。关于特征选择的类似指南即将发布，并将在完成后链接于此。

### 第 7 步：最后的修饰与前进

好的。你的数据现在是“干净的”。对于我们的目的来说，这意味着你现在有一个有效且可用的 Pandas DataFrame。但接下来该如何处理呢？

如果你想直接将数据输入机器学习算法以尝试构建模型，你可能需要将数据转换为更合适的表示形式。在 Python 生态系统中，这通常是一个 numpy ndarray（或矩阵）。你可以查看以下内容，以获得一些初步的想法（从基础的角度来看）：

+   [将 Pandas Dataframe 转换为数组并评估多元线性回归模型](https://stackoverflow.com/questions/28334091/turning-a-pandas-dataframe-to-an-array-and-evaluate-multiple-linear-regression-m)，Stack Overflow

![ML pipeline](../Images/2b1892e803954b3888cf48f32e0c71b7.png)

非常简单的数据准备过程。

一旦你有了适用于 Python 机器学习的干净数据的正确表示形式，何不查看以下这对文章，这些文章正好覆盖了你现在准备深入了解的领域：

+   [掌握 Python 机器学习的 7 个步骤](/2015/11/seven-steps-machine-learning-python.html)，Matthew Mayo 著

+   [掌握 Python 机器学习的 7 个额外步骤](/2017/03/seven-more-steps-machine-learning-python.html)，Matthew Mayo 著

如果你暂时不想继续进行建模怎么办？或者，即使你想进行建模，你也希望将这些数据输出成更适合你情况的存储形式？以下是有关 Pandas DataFrame 存储的一些信息：

+   [将 Pandas DataFrame 写入 MySQL](https://stackoverflow.com/questions/39939716/writing-a-pandas-dataframe-to-mysql)，Stack Overflow

+   [快速 HDF5 与 Pandas](https://dzone.com/articles/quick-hdf5-pandas)，Giuseppe Vettigli 著

别忘了，在继续之前，还有额外的数据集特定和相关的注意事项，包括（特别？）将数据集拆分为训练集和测试集，这一过程适用于各种机器学习任务：

+   [Numpy: 如何将数据集（数组）拆分/分区为训练集和测试集，例如，交叉验证？](https://stackoverflow.com/questions/3674409/numpy-how-to-split-partition-a-dataset-array-into-training-and-test-datasets)，Stack Overflow

+   [是否有 Python 函数可以将数据拆分为训练集、交叉验证集和测试集？](https://www.quora.com/Is-there-a-Python-function-that-splits-data-into-train-cross-validation-and-test-sets/answer/Harizo-Rajaona)，Quora 答案，Harizo Rajaona

作为一种纯粹的惩罚，这里有一些关于数据准备的额外观点：

+   [Python 中的数据整理](/2017/01/tidying-data-python.html)，Jean-Nicholas Hould 著

+   [数据科学实战：Kaggle 演练第 3 部分 – 清理数据](/2016/06/doing-data-science-kaggle-walkthrough-data-cleaning.html)，Brett Romero 著

+   [从头开始的 Python 机器学习工作流 第 1 部分：数据准备](/2017/05/machine-learning-workflows-python-scratch-part-1.html)，Matthew Mayo 著

**相关：**

+   [理解 NoSQL 数据库的 7 个步骤](/2016/07/seven-steps-understanding-nosql-databases.html)

+   [掌握数据科学 SQL 的 7 个步骤](/2016/06/seven-steps-mastering-sql-data-science.html)

+   [理解深度学习的 7 个步骤](/2016/01/seven-steps-deep-learning.html)

### 更多相关主题

+   [每位数据科学家都应了解的三个 R 库（即使你使用 Python）](https://www.kdnuggets.com/2021/12/three-r-libraries-every-data-scientist-know-even-python.html)

+   [使用管道编写干净的Python代码](https://www.kdnuggets.com/2021/12/write-clean-python-code-pipes.html)

+   [是什么使Python成为初创企业理想的编程语言](https://www.kdnuggets.com/2021/12/makes-python-ideal-programming-language-startups.html)

+   [停止学习数据科学以寻找目标，找到目标再…](https://www.kdnuggets.com/2021/12/stop-learning-data-science-find-purpose.html)

+   [成为优秀数据科学家需要的5项关键技能](https://www.kdnuggets.com/2021/12/5-key-skills-needed-become-great-data-scientist.html)

+   [每个初学者数据科学家都应掌握的6种预测模型](https://www.kdnuggets.com/2021/12/6-predictive-models-every-beginner-data-scientist-master.html)
