- en: 'Integrating ChatGPT Into Data Science Workflows: Tips and Best Practices'
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://www.kdnuggets.com/2023/05/integrating-chatgpt-data-science-workflows-tips-best-practices.html](https://www.kdnuggets.com/2023/05/integrating-chatgpt-data-science-workflows-tips-best-practices.html)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: '![Integrating ChatGPT Into Data Science Workflows: Tips and Best Practices](../Images/9d58c8db0a764cd3249d8b8781f59879.png)'
  prefs: []
  type: TYPE_IMG
- en: Image by Author
  prefs: []
  type: TYPE_NORMAL
- en: ChatGPT, its successor GPT-4, and their open-source alternatives have been extremely
    successful. Developers and data scientists are all looking to be more productive
    and use ChatGPT to simplify their day-to-day tasks.
  prefs: []
  type: TYPE_NORMAL
- en: '* * *'
  prefs: []
  type: TYPE_NORMAL
- en: Our Top 3 Course Recommendations
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 1\. [Google Cybersecurity
    Certificate](https://www.kdnuggets.com/google-cybersecurity) - Get on the fast
    track to a career in cybersecurity.'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/e225c49c3c91745821c8c0368bf04711.png) 2\. [Google Data Analytics
    Professional Certificate](https://www.kdnuggets.com/google-data-analytics) - Up
    your data analytics game'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 3\. [Google IT Support
    Professional Certificate](https://www.kdnuggets.com/google-itsupport) - Support
    your organization in IT'
  prefs: []
  type: TYPE_NORMAL
- en: '* * *'
  prefs: []
  type: TYPE_NORMAL
- en: Here, we’ll see how to use ChatGPT for data science through a pair programming
    session with ChatGPT. We’ll build a text classification model, visualize the dataset,
    identify the best hyper parameters for the model, try out different machine learning
    algorithms, and more—all using ChatGPT.
  prefs: []
  type: TYPE_NORMAL
- en: Along the way, we’ll also look at certain tips to structure prompts so as to
    get helpful results. To follow along, you need to have a [free OpenAI account](https://platform.openai.com/signup).
    If you're a GPT-4 user, you can follow along with the same prompts, too.
  prefs: []
  type: TYPE_NORMAL
- en: Build a Working Model Faster
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Let us try to build a news classification model using ChatGPT for the [20 newsgroups
    dataset in scikit-learn](https://scikit-learn.org/0.19/datasets/twenty_newsgroups.html).
  prefs: []
  type: TYPE_NORMAL
- en: 'Here’s the prompt I used: “I’d like to build a news classification model using
    sklearn 20 newsgroups dataset. Do you know about this?”'
  prefs: []
  type: TYPE_NORMAL
- en: 'Though my prompt is not very specific at this point, I’ve stated both the objective
    and the dataset:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Objective: To build a new classification model'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Dataset to use: 20 newsgroups dataset from scikit-learn'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The response from ChatGPT tells us to start by loading the dataset.
  prefs: []
  type: TYPE_NORMAL
- en: '![Integrating ChatGPT Into Data Science Workflows: Tips and Best Practices](../Images/fe589027959bf38fd8e2b786904466df.png)'
  prefs: []
  type: TYPE_IMG
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: As we’ve also stated the objective (to build a text classification model), ChatGPT
    tells us how we can go about doing this.
  prefs: []
  type: TYPE_NORMAL
- en: 'We see that it gives us the following steps:'
  prefs: []
  type: TYPE_NORMAL
- en: Using `TfidfVectorizer` for text preprocessing and coming up with a numerical
    representation. This approach of using the TF-IDF scores is better than using
    the count occurrences using a `CountVectorizer`.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Creating a classification model on the numeric representation of the dataset
    using a Naive Bayes or Support Vector Machine (SVM) classifier.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '![Integrating ChatGPT Into Data Science Workflows: Tips and Best Practices](../Images/6381240f3c3b1ef6ad8c9df7d3ca05ec.png)'
  prefs: []
  type: TYPE_IMG
- en: It also gave the code for a Multinomial Naive Bayes classifier, so let’s use
    it and check if we can have a working model already.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs: []
  type: TYPE_PRE
- en: I went ahead and ran the above code. And it works as expected—without errors.
    We went from a blank screen to a text classification model—in a few minutes—with
    a single prompt.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE2]'
  prefs: []
  type: TYPE_PRE
- en: 'Though we got a working model to solve the problem at hand, here are certain
    tips that can help you when prompting. The prompt could have been better and broken
    down into smaller steps, like so:'
  prefs: []
  type: TYPE_NORMAL
- en: Please tell me more about the scikit-learn 20 newsgroups dataset.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: What are the possible tasks that I can perform with this dataset? Can I build
    a text classification model?
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Can you tell me which machine learning algorithm will be best suited for this
    application?
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Visualize the Dataset
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Okay, we’ve already built a text classification model. But it happened really
    fast, so let's slow down and try to come up with the simple visualization of the
    dataset.
  prefs: []
  type: TYPE_NORMAL
- en: In particular, let’s try to understand the distribution of the training samples
    across the 20 news categories and identify if there is any class imbalance.
  prefs: []
  type: TYPE_NORMAL
- en: 'Here is the prompt that I used: “I’d like to visualize the dataset to understand
    the class distribution and identify class imbalance. Can you help me with the
    visualization?”'
  prefs: []
  type: TYPE_NORMAL
- en: '![Integrating ChatGPT Into Data Science Workflows: Tips and Best Practices](../Images/0f69ed03327d1d0935b9f4c776a938ed.png)'
  prefs: []
  type: TYPE_IMG
- en: ChatGPT suggested that a bar chart or histogram of the number of samples in
    each of the classes would be a good visualization. That sounds reasonable.
  prefs: []
  type: TYPE_NORMAL
- en: 'Here is the code that ChatGPT generated to create a simple bar chart in matplotlib:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE3]'
  prefs: []
  type: TYPE_PRE
- en: Here is the plot. It's neat, the labels are readable. We can also see the number
    of samples in each of the 20 classes.
  prefs: []
  type: TYPE_NORMAL
- en: '![Integrating ChatGPT Into Data Science Workflows: Tips and Best Practices](../Images/64aac09d69178b9420d6ae2c272c0eb3.png)'
  prefs: []
  type: TYPE_IMG
- en: The distribution of training samples across the 20 classes is approximately
    even, and there is no visible class imbalance. Therefore, the model that we obtained
    in the previous step is useful. And we don't need to use any novel [resampling
    techniques to address class imbalance](/2017/06/7-techniques-handle-imbalanced-data.html).
  prefs: []
  type: TYPE_NORMAL
- en: Hyperparameter Tuning
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Next, I would like to tune the hyperparameters of the model. First, I would
    like to understand the different hyperparameters that can be tuned. Then, we can
    do a simple grid search if there are not too many hyperparameters.
  prefs: []
  type: TYPE_NORMAL
- en: 'Here’s the prompt: “Are there any hyperparameters I can tune to make the classifier
    model better?”'
  prefs: []
  type: TYPE_NORMAL
- en: '![Integrating ChatGPT Into Data Science Workflows: Tips and Best Practices](../Images/24f903dd343dc379d6b56bec873e8025.png)'
  prefs: []
  type: TYPE_IMG
- en: In the code that we got, `max_df` for the `TfidfVectorizer` is also tunable.
    We know that TF-IDF score works by assigning higher weight to terms that occur
    frequently in a particular document while assigning substantially lower weight
    to terms that occur frequently in all the documents. The `max_df` uses the percentage
    of occurrence to ignore a particular term.
  prefs: []
  type: TYPE_NORMAL
- en: For example, `max_df` of 0.5 indicates that all terms that occur in at least
    50% of the documents will be ignored. If you’d like, you can remove this. But
    I am going to retain it just to see what  `max_df` I can use.
  prefs: []
  type: TYPE_NORMAL
- en: The code uses a simple grid search and picks the optimal values based on cross-validation
    scores.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE4]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE5]'
  prefs: []
  type: TYPE_PRE
- en: Plugging in the values of these hyperparameters, I got about 2% improvement
    in the classification accuracy.
  prefs: []
  type: TYPE_NORMAL
- en: Here, we didn’t have a lot of hyperparameters to tune. If you have a lot of
    hyperparameters where each can take on a set of values, running grid search might
    be expensive. And it might make sense to run a randomized search instead.
  prefs: []
  type: TYPE_NORMAL
- en: Faster Iteration Over Different Models
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: We saw in one of the first steps that an SVM works fine for such a classification
    problem, too.
  prefs: []
  type: TYPE_NORMAL
- en: I’d now like to build a support vector classifier for the same dataset.
  prefs: []
  type: TYPE_NORMAL
- en: 'The prompt I used: “Can you let me know if I can use an SVM to solve the same
    problem? Can you generate the code to do that?”'
  prefs: []
  type: TYPE_NORMAL
- en: '![Integrating ChatGPT Into Data Science Workflows: Tips and Best Practices](../Images/fee2b969c5c5ace7108f1600dad9c26e.png)'
  prefs: []
  type: TYPE_IMG
- en: 'And here we go:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE6]'
  prefs: []
  type: TYPE_PRE
- en: Given that we have an accuracy score of over 90%, SVM seems to be a good choice
    for this dataset.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE7]'
  prefs: []
  type: TYPE_PRE
- en: As seen, you can use ChatGPT to quickly try out different models to solve the
    same problem.
  prefs: []
  type: TYPE_NORMAL
- en: Exploring Dimensionality Reduction
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Once you’ve doubled down on building a working model, you can as well explore
    other available directions. Let’s look at dimensionality reduction as an example.
  prefs: []
  type: TYPE_NORMAL
- en: At this point, I’m not interested in running dimensionality reduction algorithms
    because I already have a working model. And the feature space is not very high
    dimensional. So we don’t need to reduce the number of dimensions ahead of model
    building.
  prefs: []
  type: TYPE_NORMAL
- en: However, let’s look at the approaches to dimensionality reduction for this specific
    dataset.
  prefs: []
  type: TYPE_NORMAL
- en: 'The prompt I used: “Can you tell me the dimensionality reduction techniques
    that I can use for this dataset?”'
  prefs: []
  type: TYPE_NORMAL
- en: '![Integrating ChatGPT Into Data Science Workflows: Tips and Best Practices](../Images/a799070b573b4cd8a9f0fe38de1982b4.png)'
  prefs: []
  type: TYPE_IMG
- en: 'The following techniques have been suggested by ChatGPT:'
  prefs: []
  type: TYPE_NORMAL
- en: Latent Semantic Analysis or SVD
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Principal Component Analysis (PCA)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Non-negative Matrix Factorization (NMF)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Let's end our discussion by enumerating the best practices to use ChatGPT.
  prefs: []
  type: TYPE_NORMAL
- en: Best Practices to Use ChatGPT for Data Science
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'The following are some of the best practices to keep in mind when using ChatGPT
    for data science:'
  prefs: []
  type: TYPE_NORMAL
- en: '**Don''t input sensitive data and source code**: Do not feed in any sensitive
    data into ChatGPT. When you’re working on data teams in organizations, you’ll
    often build models on customer data—which should be kept confidential. You can
    instead try to build prototypes for similar publicly available datasets and try
    to transpose it onto your dataset or problem. Similarly, refrain from inputting
    sensitive source code or any info that should not be disclosed.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Be specific with your prompts**: Without specific prompts, it is quite difficult
    to get helpful answers from ChatGPT. Therefore, structure your prompt such that
    they’re specific enough. Prompts should at the least, convey the objective clearly.
    one step at a time.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Decompose longer prompts into smaller prompts**: If you have a chain of thought
    on accomplishing a particular task, try to break it down into simpler steps and
    prompt ChatGPT to do each of the steps.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Debug effectively using ChatGPT**: In this example, all the code that we
    got ran without errors; but this may not always be the case. You may run into
    errors because of deprecated features, invalid API references, and more. When
    you run into errors, you can feed in the error message and relevant traceback
    in your prompt. And look at the offered solutions, then proceed to debug your
    code.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Track prompts**: If you use (or plan on using) ChatGPT a lot in your everyday
    data science workflow,  it might be a good idea to keep track of the prompts.
    This can help refine prompts over time and identify prompt engineering techniques
    to get better results from ChatGPT.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Conclusion
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: When using ChatGPT for data science applications, understanding the business
    problem is the first and the most important step. Therefore, ChatGPT is only a
    tool to simplify and automate certain tasks and is *not* a replacement for the
    technical expertise of developers.
  prefs: []
  type: TYPE_NORMAL
- en: However, it’s still an invaluable tool to increase productivity by helping quickly
    build and test out different models and algorithms. So let’s leverage ChatGPT
    to hone our skills and become better developers!
  prefs: []
  type: TYPE_NORMAL
- en: '**[Bala Priya C](https://www.linkedin.com/in/bala-priya/)** is a developer
    and technical writer from India. She likes working at the intersection of math,
    programming, data science, and content creation. Her areas of interest and expertise
    include DevOps, data science, and natural language processing. She enjoys reading,
    writing, coding, and coffee! Currently, she''s working on learning and sharing
    her knowledge with the developer community by authoring tutorials, how-to guides,
    opinion pieces, and more.'
  prefs: []
  type: TYPE_NORMAL
- en: More On This Topic
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: '[Mastering Data Science Workflows with ChatGPT](https://www.kdnuggets.com/mastering-data-science-workflows-with-chatgpt)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Cutting Down Implementation Time by Integrating Jupyter and KNIME](https://www.kdnuggets.com/2021/12/cutting-implementation-time-integrating-jupyter-knime.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Optimizing Data Analytics: Integrating GitHub Copilot in Databricks](https://www.kdnuggets.com/optimizing-data-analytics-integrating-github-copilot-in-databricks)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Integrating Generative AI in Content Creation](https://www.kdnuggets.com/integrating-generative-ai-in-content-creation)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[ChatGPT CLI: Transform Your Command-Line Interface Into ChatGPT](https://www.kdnuggets.com/2023/07/chatgpt-cli-transform-commandline-interface-chatgpt.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Automation in Data Science Workflows](https://www.kdnuggets.com/2023/03/automation-data-science-workflows.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
