# 用于数据分析的 Instagram Python 指南

> 原文：[https://www.kdnuggets.com/2017/08/instagram-python-data-analysis.html](https://www.kdnuggets.com/2017/08/instagram-python-data-analysis.html)

**作者：Nour Galaby，数据爱好者。**

![Instagram 头图](../Images/71fcd40c2f3ae3d1ae9117e7c99aa091.png)

* * *

## 我们的前三大课程推荐

![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 1\. [Google 网络安全证书](https://www.kdnuggets.com/google-cybersecurity) - 快速进入网络安全职业生涯。

![](../Images/e225c49c3c91745821c8c0368bf04711.png) 2\. [Google 数据分析专业证书](https://www.kdnuggets.com/google-data-analytics) - 提升你的数据分析技能

![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 3\. [Google IT 支持专业证书](https://www.kdnuggets.com/google-itsupport) - 支持你所在组织的 IT

* * *

Instagram 是最大的照片分享社交媒体平台，拥有 5 亿月活跃用户，每天上传 9500 万张图片和视频。它拥有大量的数据和巨大的潜力。本指南将帮助你将 Instagram 视为数据来源，而不仅仅是一个平台，并教你如何作为开发者在项目中使用它。

**关于 API 和工具**

Instagram 有一个官方 API，但它已经过时，并且在功能上非常有限。因此，在本指南中，我将使用 [LevPasha 的非官方 Instagram API](https://github.com/LevPasha/Instagram-API-python)，它支持所有主要功能，如点赞、关注、上传照片和视频等！它是用 Python 编写的，但我将仅关注数据方面。

我建议使用 Jupyter 笔记本和 IPython。普通的 Python 也可以，但可能没有显示图片等功能。

**安装**

你可以使用 `pip` 以这种方式安装库：

```py
python -m pip install -e git+https://github.com/LevPasha/Instagram-API-python.git#egg=InstagramAPI
```

如果你没有`ffmpeg`，你需要安装它。在 Linux 上安装的方法：

```py
sudo apt-get install ffmpeg
```

对于 Windows，请在 Python 解释器中运行以下命令：

```py
import imageio
imageio.plugins.ffmpeg.download()
```

**使用 API 登录 Instagram**

```py
from InstagramAPI import InstagramAPI
username="YOURUSERNAME"
InstagramAPI = InstagramAPI(username, "YOURPASSWORD")
InstagramAPI.login()
```

如果成功，你应该会收到“登录成功”的消息。

**简单请求**

既然这些都处理完了，我们就开始我们的第一个请求吧：

```py
InstagramAPI.getProfileData()
result = InstagramAPI.LastJson
```

```py
{u'status': u'ok',
 u'user': {u'biography': u'',
  u'birthday': None,
  u'country_code': 20,
  u'email': aaa@hotmail.com',
  u'external_url': u'',
  u'full_name': u'Nour Galaby',
  u'gender': 1,
  u'has_anonymous_profile_picture': False,
  u'hd_profile_pic_url_info': {u'height': 1080,
   u'url': u'https://instagram.fcai2-1.fna.fbcdn.net/t51.2885-1aaa7448121591_1aa.jpg',
   u'width': 1080},
  u'hd_profile_pic_versions': [{u'height': 320,
    u'url': u'https://instagram.fcai2-1.fna.fbcdn.net/t51.2885-19/s320x320/19aa23237_4337448121591_195310aaa32_a.jpg',
    u'width': 320},
   {u'height': 640,
    u'url': u'https://instagram.fcai2-1.fna.fbcdn.net/t51.2885-19/s640x640/19623237_45581744812153_44_a.jpg',
    u'width': 640}],
  u'is_private': True,
  u'is_verified': False,
  u'national_number': 122,
  u'phone_number': u'+201220',
  u'pk': 22412229,
  u'profile_pic_id': u'1550239680720880455_22',
  u'profile_pic_url': u'https://instagram.fcai2-1.fna.fbcdn.net/t51.2885-19/s150x150/19623237_455817448121591_195310166162_a.jpg',
  u'show_conversion_edit_entry': False,
  u'username': u'nourgalaby'}}
```

如你所见，结果是 JSON 格式，包含了所有请求的数据。

你可以以正常的键/值方式访问它。例如：

![Instagram 图片](../Images/a56de5ee93012382d2e72ac44187abd1.png)

你可以使用任何高级查看工具（如 Notepad++）来查看 JSON 并进行探索。

**获取和查看 Instagram 时间轴**

现在让我们做一些更有趣的事情。我们将请求时间轴中的最新帖子，并在笔记本中查看它们。

使用这一行你可以获取时间轴：

```py
InstagramAPI.timelineFeed()
```

与之前的请求类似，我们将使用 LastJson() 来查看结果。通过检查结果 JSON，我们可以看到它包含一个名为“items”的列表。列表中的每个元素都包含时间轴中特定帖子的相关信息，包括以下内容：

+   [text] - 包含帖子下方的文字内容，包括标签

+   [likes] - 帖子的点赞数量

+   [created_at] - 帖子创建日期

+   [comments] - 帖子评论

+   [image_versions] - 包含实际 JPG 文件的链接，我们将用来在 Jupyter 笔记本中显示它

**函数**

`Get_posts_from_list()` 和 `Get_url()` 将遍历帖子列表，为每个帖子找到 URL 并将其添加到我们的空列表中：

完成后，我们应该会得到如下的 URL 列表：

![Instagram](../Images/eeab5c9613f4809b1074f9151a3b1faa.png)

要查看图片，我们可以使用 `Ipython.display` 模块，如下所示：

![Instagram](../Images/6532b4b589e865b1ab6b4d48877c57fe.png)

![Instagram](../Images/e385c67dee5360a722e15aa86b889761.png)

在笔记本中查看图片非常有用，我们稍后会使用这些函数查看我们的结果，如你所见。

**获取你最喜欢的帖子**

现在我们知道如何进行基本请求，但如果我们想要进行更复杂的请求呢？我们将做类似的事情：获取我们最喜欢的帖子。为此，我们需要首先获取你用户资料中的所有帖子，然后按点赞数量排序：

**获取所有用户帖子**

为了获取所有帖子，我们将使用 `next_max_id` 和 `more_avialable` 值来遍历我们的结果列表：

```py
import time
myposts=[]
has_more_posts = True
max_id=""

while has_more_posts:
    InstagramAPI.getSelfUserFeed(maxid=max_id)
    if InstagramAPI.LastJson['more_available'] is not True:
        has_more_posts = False #stop condition
        print "stopped"

    max_id = InstagramAPI.LastJson.get('next_max_id','')
    myposts.extend(InstagramAPI.LastJson['items']) #merge lists
    time.sleep(2) # Slows the script down to avoid flooding the servers 

print len(myposts)
```

### 更多相关主题

+   [每位数据科学家都应该了解的三种 R 库（即使你使用 Python）](https://www.kdnuggets.com/2021/12/three-r-libraries-every-data-scientist-know-even-python.html)

+   [使用管道编写干净的 Python 代码](https://www.kdnuggets.com/2021/12/write-clean-python-code-pipes.html)

+   [是什么让 Python 成为初创公司的理想编程语言](https://www.kdnuggets.com/2021/12/makes-python-ideal-programming-language-startups.html)

+   [停止学习数据科学以寻找目的，并寻找目的以……](https://www.kdnuggets.com/2021/12/stop-learning-data-science-find-purpose.html)

+   [成为优秀数据科学家所需的 5 项关键技能](https://www.kdnuggets.com/2021/12/5-key-skills-needed-become-great-data-scientist.html)

+   [每位初学数据科学家都应该掌握的 6 种预测模型](https://www.kdnuggets.com/2021/12/6-predictive-models-every-beginner-data-scientist-master.html)
