["```py\nSELECT \n  customers.name, \n  purchases.product, \n  SUM(price) as total_price \nFROM \n  purchases \n  JOIN customers ON purchases.cust_id = customers.id \nWHERE \n  purchases.category = 'kitchen' \nGROUP BY \n  customers.name, \n  purchases.product \nHAVING \n  total_price > 10000 \nORDER BY \n  total_price DESC; \n```", "```py\nWITH customerspending AS (\n  SELECT \n    customers.id, \n    SUM(purchases.price) as total_spending \n  FROM \n    purchases \n    JOIN customers ON purchases.cust_id = customers.id \n  GROUP BY \n    customers.id\n) \nSELECT \n  c.name, \n  pd.product, \n  pd.total_product_price, \n  cs.total_spending \nFROM \n  (\n    SELECT \n      purchases.cust_id, \n      purchases.product, \n      SUM(purchases.price) as total_product_price \n    FROM \n      purchases \n    WHERE \n      purchases.category = 'kitchen' \n    GROUP BY \n      purchases.cust_id, \n      purchases.product \n    HAVING \n      SUM(purchases.price) > 10000\n  ) AS pd \n  JOIN customers c ON pd.cust_id = c.id \n  JOIN customerspending cs ON c.id = cs.id \nORDER BY \n  pd.total_product_price DESC; \n```", "```py\nSELECT \n  purchases.cust_id, \n  purchases.product, \n  SUM(purchases.price) as total_product_price \nFROM \n  purchases \nWHERE \n  purchases.category = 'kitchen' \nGROUP BY \n  purchases.cust_id, \n  purchases.product \nHAVING \n  SUM(purchases.price) > 10000\n```", "```py\nWITH customerspending AS (\n  SELECT \n    customers.id, \n    SUM(purchases.price) as total_spending \n  FROM \n    purchases \n    JOIN customers ON purchases.cust_id = customers.id \n  GROUP BY \n    customers.id\n)\n```"]