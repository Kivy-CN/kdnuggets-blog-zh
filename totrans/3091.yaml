- en: Receiver Operating Characteristic Curves Demystified (in Python)
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://www.kdnuggets.com/2018/07/receiver-operating-characteristic-curves-demystified-python.html](https://www.kdnuggets.com/2018/07/receiver-operating-characteristic-curves-demystified-python.html)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: '![c](../Images/3d9c022da2d331bb56691a9617b91b90.png) [comments](#comments)'
  prefs: []
  type: TYPE_IMG
- en: '**By [Syed Sadat Nazrul](https://www.linkedin.com/in/snazrul1/), Analytic Scientist**'
  prefs: []
  type: TYPE_NORMAL
- en: '![Image](../Images/02f70f95e8cbdccd75cab6f2efaf86c9.png)'
  prefs: []
  type: TYPE_IMG
- en: '* * *'
  prefs: []
  type: TYPE_NORMAL
- en: Our Top 3 Course Recommendations
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 1\. [Google Cybersecurity
    Certificate](https://www.kdnuggets.com/google-cybersecurity) - Get on the fast
    track to a career in cybersecurity.'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/e225c49c3c91745821c8c0368bf04711.png) 2\. [Google Data Analytics
    Professional Certificate](https://www.kdnuggets.com/google-data-analytics) - Up
    your data analytics game'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 3\. [Google IT Support
    Professional Certificate](https://www.kdnuggets.com/google-itsupport) - Support
    your organization in IT'
  prefs: []
  type: TYPE_NORMAL
- en: '* * *'
  prefs: []
  type: TYPE_NORMAL
- en: In Data Science, evaluating model performance is very important and the most
    commonly used performance metric is the classification score. However, when dealing
    with fraud datasets with heavy class imbalance, a classification score does not
    make much sense. Instead, Receiver Operating Characteristic or ROC curves offer
    a better alternative. ROC is a plot of signal (True Positive Rate) against noise
    (False Positive Rate). The model performance is determined by looking at the area
    under the ROC curve (or AUC). The best possible AUC is 1 while the worst is 0.5
    (the 45 degrees random line). Any value less than 0.5 means we can simply do the
    exact opposite of what the model recommends to get the value back above 0.5.
  prefs: []
  type: TYPE_NORMAL
- en: While ROC curves are common, there aren’t that many pedagogical resources out
    there explaining how it is calculated or derived. In this blog, I will reveal,
    step by step, how to plot an ROC curve using Python. After that, I will explain
    the characteristics of a basic ROC curve.
  prefs: []
  type: TYPE_NORMAL
- en: Probability Distribution of Classes
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: First off, let us assume that our hypothetical model produced some probabilities
    for predicting the class of each record. As with most binary fraud models, let’s
    assume our classes are ‘good’ and ‘bad’ and the model produced probabilities of
    P(X=’bad’). To create this, probability distribution, we plot a Gaussian distribution
    with different mean values for each class. For more information on Gaussian distribution,
    read [this blog](https://towardsdatascience.com/understanding-the-68-95-99-7-rule-for-a-normal-distribution-b7b7cbf760c2).
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: Now that we have the distribution, let’s create a function to plot the distributions.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs: []
  type: TYPE_PRE
- en: 'Now let’s use this **plot_pdf** function to generate the plot:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE2]'
  prefs: []
  type: TYPE_PRE
- en: '![](../Images/7a9921ab52c894aab2fe18cf002ba628.png)'
  prefs: []
  type: TYPE_IMG
- en: Now we have the probability distribution of the binary classes, we can now use
    this distribution to derive the ROC curve.
  prefs: []
  type: TYPE_NORMAL
- en: Deriving ROC Curve
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: To derive the ROC curve from the probability distribution, we need to calculate
    the True Positive Rate (TPR) and False Positive Rate (FPR). For a simple example,
    let’s assume the threshold is at P(X=’bad’)=0.6 .
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/86ee109313664de02f85d6b4c2bb54fc.png)'
  prefs: []
  type: TYPE_IMG
- en: 'True positive is the area designated as “bad” on the right side of the threshold.
    False positive denotes the area designated as “good” on the right of the threshold.
    Total positive is the total area under the “bad” curve while total negative is
    the total area under the “good” curve. We divide the value as shown in the diagram
    to derive TPR and FPR. We derive the TPR and FPR different threshold values to
    get the ROC curve. Using this knowledge, we create the ROC plot function:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE3]'
  prefs: []
  type: TYPE_PRE
- en: 'Now let’s use this **plot_roc** function to generate the plot:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE4]'
  prefs: []
  type: TYPE_PRE
- en: '![](../Images/3473fd9e1c1159c53781c36a04da17e5.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Now plotting the probability distribution and the ROC next to eachother for
    visual comparison:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE5]'
  prefs: []
  type: TYPE_PRE
- en: '![](../Images/02f70f95e8cbdccd75cab6f2efaf86c9.png)'
  prefs: []
  type: TYPE_IMG
- en: Effect of Class Separation
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Now that we can derive both plots, let’s see how the ROC curve changes as the
    class separation (i.e. the model performance) improves. We do this by altering
    the mean value of the Gaussian in the probability distributions.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE6]'
  prefs: []
  type: TYPE_PRE
- en: '![](../Images/20818e7120759fbec5979733f40c7320.png)'
  prefs: []
  type: TYPE_IMG
- en: As you can see, the AUC increases as we increase the separation between the
    classes.
  prefs: []
  type: TYPE_NORMAL
- en: Looking Beyond The AUC
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Beyond AUC, the ROC curve can also help debug a model. By looking at the shape
    of the ROC curve, we can evaluate what the model is misclassifying. For example,
    if the bottom left corner of the curve is closer to the random line, it implies
    that the model is misclassifying at X=0\. Whereas, if it is random on the top
    right, it implies the errors are occurring at X=1\. Also, if there are spikes
    on the curve (as opposed to being smooth), it implies the model is not stable.
  prefs: []
  type: TYPE_NORMAL
- en: '**Additional Information**'
  prefs: []
  type: TYPE_NORMAL
- en: '[**Data Science Interview Guide**](https://towardsdatascience.com/data-science-interview-guide-4ee9f5dc778)
    - Data Science is quite a large and diverse field. As a result, it is really difficult
    to be a jack of all trades...'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[**Fraud Detection Under Extreme Class Imbalance**](https://towardsdatascience.com/fraud-detection-under-extreme-class-imbalance-c241854e60c)
    - A popular field in data science is fraud analytics. This might include credit/debit
    card fraud, anti-money laundering...'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Bio: [Syed Sadat Nazrul](https://www.linkedin.com/in/snazrul1/)** is using
    Machine Learning to catch cyber and financial criminals by day... and writing
    cool blogs by night.'
  prefs: []
  type: TYPE_NORMAL
- en: '[Original](https://towardsdatascience.com/receiver-operating-characteristic-curves-demystified-in-python-bd531a4364d0).
    Reposted with permission.'
  prefs: []
  type: TYPE_NORMAL
- en: '**Related:**'
  prefs: []
  type: TYPE_NORMAL
- en: '[Learning Curves for Machine Learning](/2018/01/learning-curves-machine-learning.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Choosing the Right Metric for Evaluating Machine Learning Models – Part 1](/2018/04/right-metric-evaluating-machine-learning-models-1.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Choosing the Right Metric for Evaluating Machine Learning Models — Part 2](/2018/06/right-metric-evaluating-machine-learning-models-2.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: More On This Topic
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: '[Step up your Python game with Fast Python for Data Science!](https://www.kdnuggets.com/2022/06/manning-step-python-game-fast-python-data-science.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Optimizing Python Code Performance: A Deep Dive into Python Profilers](https://www.kdnuggets.com/2023/02/optimizing-python-code-performance-deep-dive-python-profilers.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Python Enum: How To Build Enumerations in Python](https://www.kdnuggets.com/python-enum-how-to-build-enumerations-in-python)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Simplifying Decision Tree Interpretability with Python & Scikit-learn](https://www.kdnuggets.com/2017/05/simplifying-decision-tree-interpretation-decision-rules-python.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Sparse Matrix Representation in Python](https://www.kdnuggets.com/2020/05/sparse-matrix-representation-python.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Top 38 Python Libraries for Data Science, Data Visualization &…](https://www.kdnuggets.com/2020/11/top-python-libraries-data-science-data-visualization-machine-learning.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
