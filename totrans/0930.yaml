- en: How to Merge Pandas DataFrames
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://www.kdnuggets.com/2023/01/merge-pandas-dataframes.html](https://www.kdnuggets.com/2023/01/merge-pandas-dataframes.html)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: '![How to Merge Pandas DataFrames](../Images/dbea643af0f687e6cc05cc962f702313.png)'
  prefs: []
  type: TYPE_IMG
- en: Image by [catalyststuff](https://www.freepik.com/free-vector/cute-panda-writing-book-with-pencil-cartoon-icon-illustration_12158331.htm#query=pandas&position=9&from_view=search&track=sph)
    on [Freepik](https://www.freepik.com/)
  prefs: []
  type: TYPE_NORMAL
- en: Data merging between two datasets or more is typical during data processing.
    In this blog, we will learn how data merging with Pandas is done and various tips
    to improve our data merging skills. Let’s explore the data merge technique.
  prefs: []
  type: TYPE_NORMAL
- en: '* * *'
  prefs: []
  type: TYPE_NORMAL
- en: Our Top 3 Course Recommendations
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 1\. [Google Cybersecurity
    Certificate](https://www.kdnuggets.com/google-cybersecurity) - Get on the fast
    track to a career in cybersecurity.'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/e225c49c3c91745821c8c0368bf04711.png) 2\. [Google Data Analytics
    Professional Certificate](https://www.kdnuggets.com/google-data-analytics) - Up
    your data analytics game'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 3\. [Google IT Support
    Professional Certificate](https://www.kdnuggets.com/google-itsupport) - Support
    your organization in IT'
  prefs: []
  type: TYPE_NORMAL
- en: '* * *'
  prefs: []
  type: TYPE_NORMAL
- en: Merge Pandas DataFrame
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: First; we need to import the Pandas Python package.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: Merging two Pandas DataFrames would require the merge method from the Pandas
    package. This function would merge two DataFrame by the variable or columns we
    intended to join. Let’s try the Pandas merging method with an example DataFrame.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs: []
  type: TYPE_PRE
- en: '![How to Merge Pandas DataFrames](../Images/f1741d44d929df98267213fe4271d2b9.png)'
  prefs: []
  type: TYPE_IMG
- en: Image by Author
  prefs: []
  type: TYPE_NORMAL
- en: In the example above, we create two different DataFrame with slightly different
    columns, and we merge them on the ‘Country’ column. The result is the rows from
    both DataFrame with similar values were merged. With one line, we manage to merge
    two different DataFrame.
  prefs: []
  type: TYPE_NORMAL
- en: Applying Optional Parameters
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Pandas .merge method has various optional parameters we could take advantage
    of. Let’s take a look at some of the useful ones.
  prefs: []
  type: TYPE_NORMAL
- en: Renaming merged columns with the same name
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: In our example above, we can see a column called ‘Location’ which contains suffixes
    _x and _y after the merge. If we want to change the column name when the merge
    happens, we can do that with the following code.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE2]'
  prefs: []
  type: TYPE_PRE
- en: '![How to Merge Pandas DataFrames](../Images/4d0219fe6d346fc5b1b417eff64bd0cc.png)'
  prefs: []
  type: TYPE_IMG
- en: Image by Author
  prefs: []
  type: TYPE_NORMAL
- en: In this code, we pass the suffixes parameter with tuple contain two values;
    the first and second DataFrame name. In my example, we named the first DataFrame
    Population and the second Income.
  prefs: []
  type: TYPE_NORMAL
- en: Merge based on different column names
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: What if we have two DataFrame with two different column names that refer to
    the same definition? We can still merge them, but we need to specify which DataFrame
    and column we want to merge.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE3]'
  prefs: []
  type: TYPE_PRE
- en: '![How to Merge Pandas DataFrames](../Images/9d185ad01291d5e02c3374878f87ba37.png)'
  prefs: []
  type: TYPE_IMG
- en: Image by Author
  prefs: []
  type: TYPE_NORMAL
- en: In the example above, we change the second DataFrame ‘Country’ column as ‘Index’
    then we merge the dataset by specify the column name on each DataFrame. Left_on
    parameter is for the first DataFrame and the right_on for the second DataFrame.
  prefs: []
  type: TYPE_NORMAL
- en: Change the merge type
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'There are five different types merged in the Pandas merge method. By default,
    the merge is an Inner merge which only includes rows with matching values in both
    columns.  However, we can change the merge type by passing the values on the how
    parameter:'
  prefs: []
  type: TYPE_NORMAL
- en: '**Left**'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Left merge uses only the values from the first DataFrame.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE4]'
  prefs: []
  type: TYPE_PRE
- en: '![How to Merge Pandas DataFrames](../Images/f1741d44d929df98267213fe4271d2b9.png)'
  prefs: []
  type: TYPE_IMG
- en: Image by Author
  prefs: []
  type: TYPE_NORMAL
- en: '**Right**'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Right merge uses only the values from the second DataFrame.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE5]'
  prefs: []
  type: TYPE_PRE
- en: '![How to Merge Pandas DataFrames](../Images/5fcec12f1fa210c7e757f0a4d1211573.png)'
  prefs: []
  type: TYPE_IMG
- en: Image by Author
  prefs: []
  type: TYPE_NORMAL
- en: '**Outer**'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Include all rows from both DataFrame by using the union of both DataFrame keys.
  prefs: []
  type: TYPE_NORMAL
- en: '![How to Merge Pandas DataFrames](../Images/d86c365021c730d12231cb1559abb141.png)'
  prefs: []
  type: TYPE_IMG
- en: Image by Author
  prefs: []
  type: TYPE_NORMAL
- en: '**Cross**'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Create a cartesian product from both DataFrame
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE6]'
  prefs: []
  type: TYPE_PRE
- en: '![How to Merge Pandas DataFrames](../Images/d883e108c322609119312c6beabda5db.png)'
  prefs: []
  type: TYPE_IMG
- en: Image by Author
  prefs: []
  type: TYPE_NORMAL
- en: Merge by two or more different columns
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: It is possible with Pandas merge to join two DataFrame with two or more different
    columns. We need to specify within the ‘on’ parameter by passing the list of columns
    we want to merge.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE7]'
  prefs: []
  type: TYPE_PRE
- en: '![How to Merge Pandas DataFrames](../Images/f1e87a18556f05fa453659433aace177.png)'
  prefs: []
  type: TYPE_IMG
- en: Image by Author
  prefs: []
  type: TYPE_NORMAL
- en: Conclusion
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: During data processing, it’s a common activity to merge two different DataFrame.
    To do that, we can use the Pandas method called merge. There are various optional
    parameters we can access within the Pandas merge to perform specific tasks, including
    changing the merged column name, merging DataFrame based on the different column
    name, changing the merge type, and merging by two other columns or more.
  prefs: []
  type: TYPE_NORMAL
- en: '**[Cornellius Yudha Wijaya](https://www.linkedin.com/in/cornellius-yudha-wijaya/)**
    is a data science assistant manager and data writer. While working full-time at
    Allianz Indonesia, he loves to share Python and Data tips via social media and
    writing media.'
  prefs: []
  type: TYPE_NORMAL
- en: More On This Topic
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: '[3 Ways to Merge Pandas DataFrames](https://www.kdnuggets.com/2023/03/3-ways-merge-pandas-dataframes.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[How to Merge Large DataFrames Efficiently with Pandas](https://www.kdnuggets.com/how-to-merge-large-dataframes-efficiently-with-pandas)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Query Your Pandas DataFrames with SQL](https://www.kdnuggets.com/2021/10/query-pandas-dataframes-sql.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Using the apply() Method with Pandas Dataframes](https://www.kdnuggets.com/2022/07/apply-method-pandas-dataframes.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Combining Pandas DataFrames Made Simple](https://www.kdnuggets.com/2022/09/combining-pandas-dataframes-made-simple.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Converting JSONs to Pandas DataFrames: Parsing Them the Right Way](https://www.kdnuggets.com/converting-jsons-to-pandas-dataframes-parsing-them-the-right-way)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
