# 使用 NumPy 和图像分类实现人工神经网络

> 原文：[https://www.kdnuggets.com/2019/02/artificial-neural-network-implementation-using-numpy-and-image-classification.html](https://www.kdnuggets.com/2019/02/artificial-neural-network-implementation-using-numpy-and-image-classification.html)

![c](../Images/3d9c022da2d331bb56691a9617b91b90.png) [评论](/2019/02/artificial-neural-network-implementation-using-numpy-and-image-classification.html?page=2#comments)

![](../Images/5f757b54b8113b34e602f5c2cef47590.png)

本教程通过使用 NumPy 从头构建人工神经网络（ANN），以实现对 Fruits360 数据集的图像分类应用。教程中使用的所有内容（即图像和源代码），除了彩色 Fruits360 图像外，均为我书中的专有权利，书名为 ***"Ahmed Fawzy Gad 'Practical Computer Vision Applications Using Deep Learning with CNNs'. Dec. 2018, Apress, 978-1-4842-4167-7"***。该书可在 Springer 上找到，链接为：[https://springer.com/us/book/9781484241660](https://springer.com/us/book/9781484241660)。

本教程中使用的源代码可以在我的 GitHub 页面找到，地址是：[https://github.com/ahmedfgad/NumPyANN](https://github.com/ahmedfgad/NumPyANN)

书中的示例涉及使用人工神经网络（ANN）对 Fruits360 图像数据集进行分类。该示例并不假设读者已经提取特征或实现了 ANN，因为它讨论了适用于该任务的特征集，并介绍了如何从头开始在 NumPy 中实现 ANN。Fruits360 数据集包含 60 类水果，如苹果、番石榴、鳄梨、香蕉、樱桃、枣、猕猴桃、桃子等。为了简化问题，示例仅使用了 4 个选定的类别，即 Braeburn 苹果、Meyer 柠檬、芒果和覆盆子。每个类别大约有 491 张用于训练的图像和另外 162 张用于测试。图像大小为 100x100 像素。

### 特征提取

这本书首先选择适合的特征集，以实现最高的分类准确性。根据下面显示的 4 个选定类别的样本图像，它们的颜色似乎不同。这就是为什么颜色特征适合用于这项任务的原因。

![](../Images/5144782453ae88a2f3f04a8244732c5f.png)

RGB 颜色空间不会将颜色信息与其他类型的信息（如光照）隔离开来。因此，如果使用 RGB 表示图像，那么 3 个通道都会参与计算。因此，最好使用一个将颜色信息隔离到单个通道的颜色空间，例如 HSV。在这种情况下，颜色通道是色相通道（H）。下图显示了之前展示的 4 个样本的色相通道。我们可以注意到每张图像的色相值与其他图像有所不同。

![](../Images/95d2d57c5c54bab7efe5c74f5d9c5d5f.png)

色调通道的大小仍为100x100。如果将整个通道应用于ANN，则输入层将有10,000个神经元。网络仍然很大。为了减少使用的数据量，我们可以使用直方图来表示色调通道。直方图将有360个箱子，反映色调值的可能值的数量。以下是4张样本图像的直方图。使用360个箱子的色调通道直方图，每种水果似乎都投票到直方图的某些特定箱子中。与使用RGB颜色空间中的任何通道相比，不同类别之间的重叠较少。例如，苹果的直方图箱子范围从0到10，而芒果的箱子范围从90到110。类别之间的间隔使得减少分类中的模糊性变得更容易，从而提高了预测准确性。

![](../Images/6e96815abd2c84e2d0d8b6e32f3d197c.png)

下面是计算4张图像的色调通道直方图的代码。

[PRE0]

通过遍历使用的4个图像类别中的所有图像，我们可以提取所有图像的特征。以下代码实现了这一点。根据4个类别中的图像数量（1,962）和从每张图像中提取的特征向量长度（360），创建了一个全零的NumPy数组，并保存在**dataset_features**变量中。为了存储每张图像的类别标签，还创建了一个名为**outputs**的NumPy数组。苹果的类别标签为0，柠檬为1，芒果为2，覆盆子为3。代码期望在根目录中运行，其中有4个文件夹，文件夹名称按照名为**fruits**的列表中的水果名称命名。它遍历所有文件夹中的所有图像，从每张图像中提取色调直方图，为每张图像分配一个类别标签，并最终使用pickle库保存提取的特征和类别标签。你也可以使用NumPy来保存结果NumPy数组，而不是pickle。

[PRE1]

目前，每张图像都由一个包含360个元素的特征向量表示。这些元素经过筛选，只保留最相关的元素以区分4个类别。减少后的特征向量长度为102，而不是360。使用更少的元素有助于比以前更快地进行训练。**dataset_features**变量的形状将为**1962x102**。有关减少特征向量长度的更多信息，请参阅书籍。

到目前为止，训练数据（特征和类别标签）已经准备好。接下来是使用NumPy实现ANN。

* * *

## 我们的前三大课程推荐

![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 1\. [谷歌网络安全证书](https://www.kdnuggets.com/google-cybersecurity) - 加速进入网络安全职业生涯

![](../Images/e225c49c3c91745821c8c0368bf04711.png) 2\. [谷歌数据分析专业证书](https://www.kdnuggets.com/google-data-analytics) - 提升你的数据分析技能

![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 3\. [谷歌IT支持专业证书](https://www.kdnuggets.com/google-itsupport) - 支持你的组织进行IT管理

* * *

### 更多相关话题

+   [成为出色数据科学家所需的5项关键技能](https://www.kdnuggets.com/2021/12/5-key-skills-needed-become-great-data-scientist.html)

+   [每个初学数据科学家都应该掌握的6种预测模型](https://www.kdnuggets.com/2021/12/6-predictive-models-every-beginner-data-scientist-master.html)

+   [2021年最佳ETL工具](https://www.kdnuggets.com/2021/12/mozart-best-etl-tools-2021.html)

+   [使用管道编写干净的Python代码](https://www.kdnuggets.com/2021/12/write-clean-python-code-pipes.html)

+   [使用卷积神经网络（CNNs）进行图像分类](https://www.kdnuggets.com/2022/05/image-classification-convolutional-neural-networks-cnns.html)

+   [停止学习数据科学以寻找目的，并寻找目的去……](https://www.kdnuggets.com/2021/12/stop-learning-data-science-find-purpose.html)
