- en: Dealing With Noisy Labels in Text Data
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://www.kdnuggets.com/2023/04/dealing-noisy-labels-text-data.html](https://www.kdnuggets.com/2023/04/dealing-noisy-labels-text-data.html)
  id: totrans-1
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: '![Dealing With Noisy Labels in Text Data](../Images/15973e5270fd138ec4bc5d0349e92906.png)'
  id: totrans-2
  prefs: []
  type: TYPE_IMG
- en: Image by Editor
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
- en: With the rising interest in natural language processing, more and more practitioners
    are hitting the wall not because they can’t build or fine-tune LLMs, but because
    their data is messy!
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
- en: 'We will show simple, yet very effective coding procedures for fixing noisy
    labels in text data. We will deal with 2 common scenarios in real-world text data:'
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
- en: Having a category that contains mixed examples from a few other categories.
    I love to call this kind of category a meta category.
  id: totrans-6
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Having 2 or more categories that should be merged into 1 category because texts
    belonging to them refer to the same topic.
  id: totrans-7
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'We will use ITSM (IT Service Management) dataset created for this tutorial
    (CCO license). It’s available on Kaggle from the link below:'
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
- en: '[https://www.kaggle.com/datasets/nikolagreb/small-itsm-dataset](https://www.kaggle.com/datasets/nikolagreb/small-itsm-dataset)'
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
- en: It’s time to start with the import of all libraries needed and basic data examination.
    Brace yourself, code is coming!
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
- en: Import and Data Examination
  id: totrans-11
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '[PRE0]'
  id: totrans-12
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: '[PRE1]'
  id: totrans-13
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: Each row represents one entry in the ITSM database. We will try to predict the
    category of the ticket based on the text of the ticket written by a user. Let’s
    examine deeper the most important fields for described business use cases.
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE2]'
  id: totrans-15
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: '[PRE3]'
  id: totrans-16
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: 'If we take a look at the first two tickets, although one ticket is in German,
    we can see that described problems refer to the same software?—?Asana, but they
    carry different labels. This is starting distribution of our categories:'
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE4]'
  id: totrans-18
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: '[PRE5]'
  id: totrans-19
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: The help needed looks suspicious, like the category that can contain tickets
    from multiple other categories. Also, categories Outlook and Mail sound similar,
    maybe they should be merged into one category. Before diving deeper into mentioned
    categories, we will get rid of missing values in columns of our interest.
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE6]'
  id: totrans-21
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: Assigning Tickets to the Proper Category
  id: totrans-22
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'There isn’t a valid substitute for the examination of data with the bare eye.
    The fancy function to do so in pandas is .sample(), so we will do exactly that
    once more, now for the suspicious category:'
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE7]'
  id: totrans-24
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: '[PRE8]'
  id: totrans-25
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: Obviously, we have tickets talking about Discord, Asana, and CRM. So the name
    of the category should be changed from “Help Needed” to existing, more specific
    categories. For the first step of the reassignment process, we will create the
    new column “Keywords” that gives the information if the ticket has the word from
    the list of categories in the “Text” column.
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE9]'
  id: totrans-27
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: 'Also, note that using "if word in str(words_categories)" instead of "if word
    in words_categories" would catch words from categories with more than 1 word (Internet
    Browser in our case), but would also require more data preprocessing. To keep
    things simple and straight to the point, we will go with the code for categories
    made of just one word. This is how our dataset looks now:'
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE10]'
  id: totrans-29
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: 'output as image:'
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
- en: '![XXXXX](../Images/7f8932ac292c1f768b45f3d6520af4f8.png)'
  id: totrans-31
  prefs: []
  type: TYPE_IMG
- en: 'After extracting the keywords column, we will assume the quality of the tickets.
    Our hypothesis:'
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
- en: Ticket with just 1 keyword in the Text field that is the same as the category
    to the which ticket belongs would be easy to classify.
  id: totrans-33
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Ticket with multiple keywords in the Text field, where at least one of the keywords
    is the same as the category to the which ticket belongs would be easy to classify
    in the majority of cases.
  id: totrans-34
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: The ticket that has keywords, but none of them is equal to the name of the category
    to the which ticket belongs is probably a noisy label case.
  id: totrans-35
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Other tickets are neutral based on keywords.
  id: totrans-36
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE11]'
  id: totrans-37
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: '[PRE12]'
  id: totrans-38
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: We made our new distribution and now is the time to examine tickets classified
    as a potential problem. In practice, the following step would require much more
    sampling and look at the larger chunks of data with the bare eye, but the rationale
    would be the same. You are supposed to find problematic tickets and decide if
    you can improve their quality or if you should drop them from the dataset. When
    you are facing a large dataset stay calm, and don't forget that data examination
    and data preparation usually take much more time than building ML algorithms!
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE13]'
  id: totrans-40
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: '[PRE14]'
  id: totrans-41
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: We understand that tickets from Outlook and Mail categories are related to the
    same problem, so we will merge these 2 categories and improve the results of our
    future ML classification algorithm.
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
- en: Merging into the Cluster
  id: totrans-43
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '[PRE15]'
  id: totrans-44
  prefs: []
  type: TYPE_PRE
  zh: '[PRE15]'
- en: '[PRE16]'
  id: totrans-45
  prefs: []
  type: TYPE_PRE
  zh: '[PRE16]'
- en: Last, but not least, we want to relabel some tickets from the meta category
    “Help Needed” to the proper category.
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE17]'
  id: totrans-47
  prefs: []
  type: TYPE_PRE
  zh: '[PRE17]'
- en: '[PRE18]'
  id: totrans-48
  prefs: []
  type: TYPE_PRE
  zh: '[PRE18]'
- en: We did our data relabeling and cleaning but we shouldn't call ourselves data
    scientists if we don't do at least one scientific experiment and test the impact
    of our work on the final classification. We will do so by implementing The Complement
    Naive Bayes classifier in sklearn. Feel free to try other, more complex algorithms.
    Also, be aware that further data cleaning could be done - for example, we could
    also drop all tickets left in the "Help Needed" category.
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
- en: Testing the Impact of Data Munging
  id: totrans-50
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '[PRE19]'
  id: totrans-51
  prefs: []
  type: TYPE_PRE
  zh: '[PRE19]'
- en: '[PRE20]'
  id: totrans-52
  prefs: []
  type: TYPE_PRE
  zh: '[PRE20]'
- en: Pretty impressive, right? The dataset we used is small (on purpose, so you can
    easily see what happens in each step) so different random seeds might produce
    different results, but in the vast majority of cases, the model will perform significantly
    better on the dataset after cleaning compared to the original dataset. We did
    a good job!
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
- en: '**[Nikola Greb](https://www.linkedin.com/in/ngreb/)** been coding for more
    than four years, and for the past two years he specialized in NLP. Before turning
    to data science, he was successful in sales, HR, writing and chess.'
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: '**[尼古拉·格雷布](https://www.linkedin.com/in/ngreb/)** 编程已有四年多，在过去的两年里，他专注于自然语言处理。在转向数据科学之前，他在销售、人力资源、写作和国际象棋方面取得了成功。'
- en: '* * *'
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: '* * *'
- en: Our Top 3 Course Recommendations
  id: totrans-56
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 我们的前三大课程推荐
- en: '![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 1\. [Google Cybersecurity
    Certificate](https://www.kdnuggets.com/google-cybersecurity) - Get on the fast
    track to a career in cybersecurity.'
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: '![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 1\. [谷歌网络安全证书](https://www.kdnuggets.com/google-cybersecurity)
    - 快速进入网络安全职业生涯。'
- en: '![](../Images/e225c49c3c91745821c8c0368bf04711.png) 2\. [Google Data Analytics
    Professional Certificate](https://www.kdnuggets.com/google-data-analytics) - Up
    your data analytics game'
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: '![](../Images/e225c49c3c91745821c8c0368bf04711.png) 2\. [谷歌数据分析专业证书](https://www.kdnuggets.com/google-data-analytics)
    - 提升你的数据分析技能'
- en: '![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 3\. [Google IT Support
    Professional Certificate](https://www.kdnuggets.com/google-itsupport) - Support
    your organization in IT'
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: '![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 3\. [谷歌 IT 支持专业证书](https://www.kdnuggets.com/google-itsupport)
    - 支持你的组织 IT'
- en: '* * *'
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: '* * *'
- en: More On This Topic
  id: totrans-61
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 更多相关话题
- en: '[Dealing with Position Bias in Recommendations and Search](https://www.kdnuggets.com/2023/03/dealing-position-bias-recommendations-search.html)'
  id: totrans-62
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[处理推荐系统和搜索中的位置偏差](https://www.kdnuggets.com/2023/03/dealing-position-bias-recommendations-search.html)'
- en: '[Transforming AI with LangChain: A Text Data Game Changer](https://www.kdnuggets.com/2023/08/transforming-ai-langchain-text-data-game-changer.html)'
  id: totrans-63
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[利用 LangChain 转变 AI：文本数据的游戏规则改变者](https://www.kdnuggets.com/2023/08/transforming-ai-langchain-text-data-game-changer.html)'
- en: '[How to Use the Hugging Face Tokenizers Library to Preprocess Text Data](https://www.kdnuggets.com/how-to-use-the-hugging-face-tokenizers-library-to-preprocess-text-data)'
  id: totrans-64
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[如何使用 Hugging Face Tokenizers 库来预处理文本数据](https://www.kdnuggets.com/how-to-use-the-hugging-face-tokenizers-library-to-preprocess-text-data)'
- en: '[Cleaning and Preprocessing Text Data in Pandas for NLP Tasks](https://www.kdnuggets.com/cleaning-and-preprocessing-text-data-in-pandas-for-nlp-tasks)'
  id: totrans-65
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[在 Pandas 中清洗和预处理文本数据以用于 NLP 任务](https://www.kdnuggets.com/cleaning-and-preprocessing-text-data-in-pandas-for-nlp-tasks)'
- en: '[Classifying Long Text Documents Using BERT](https://www.kdnuggets.com/2022/02/classifying-long-text-documents-bert.html)'
  id: totrans-66
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[使用 BERT 对长文本文档进行分类](https://www.kdnuggets.com/2022/02/classifying-long-text-documents-bert.html)'
- en: '[How to Use ChatGPT to Convert Text into a PowerPoint Presentation](https://www.kdnuggets.com/2023/08/chatgpt-convert-text-powerpoint-presentation.html)'
  id: totrans-67
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[如何使用 ChatGPT 将文本转换为 PowerPoint 演示文稿](https://www.kdnuggets.com/2023/08/chatgpt-convert-text-powerpoint-presentation.html)'
