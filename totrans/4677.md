# GANs的毕业：从理解生成对抗网络到运行你自己的GAN

> 原文：[https://www.kdnuggets.com/2019/04/graduating-gans-understanding-generative-adversarial-networks.html](https://www.kdnuggets.com/2019/04/graduating-gans-understanding-generative-adversarial-networks.html)

![c](../Images/3d9c022da2d331bb56691a9617b91b90.png) [评论](/2019/04/graduating-gans-understanding-generative-adversarial-networks.html?page=2#comments)

**由[Cecilia Shao](https://www.linkedin.com/in/ceceliashao/)，来自[comet.ml](https://www.comet.ml/)的产品增长**

![mnist-latent-space](../Images/d757d9e5e97d515b566d4f17d11d1070.png)MNIST数据集的潜在空间可视化——你可以在文章后面制作一个生成类似MNIST手写数字的GAN！

生成对抗网络（GANs）已经引起了公众的广泛关注——在流行文化中充斥着[AI生成的名人](https://www.technologyreview.com/the-download/609290/meet-the-fake-celebrities-dreamed-up-by-ai/)并在高雅艺术拍卖会上创作出[售价数千美元的艺术品](https://www.christies.com/features/A-collaboration-between-two-artists-one-human-one-a-machine-9332-1.aspx)。

在这篇文章中，我们将探索：

+   **GANs简要入门**

+   **理解和评估GANs**

+   **运行你自己的GAN**

关于GANs的资源丰富，因此我们本文的重点是理解如何评估GANs。我们还将引导你运行自己的GAN，生成类似MNIST的手写数字。

![figure-name](../Images/73f05e6c26e0c67ae6ecd8b196667f73.png)这是我们稍后将展示给你如何实现的GAN的一次运行——看看它生成的手写数字在训练过程中变得越来越逼真吧！

### **GANs简要入门**

自2014年Ian Goodfellow的《[生成对抗网络](https://arxiv.org/abs/1406.2661)》论文首次提出以来，GANs的发展突飞猛进，产生了越来越逼真的输出。

4.5年的GAN面部生成进展：

[https://t.co/kiQkuYULMC](https://t.co/kiQkuYULMC)

[https://t.co/8di6K6BxVC](https://t.co/8di6K6BxVC)

就在三年前，你可以在[这个Reddit帖子](https://www.reddit.com/r/MachineLearning/comments/40ldq6/generative_adversarial_networks_for_text/)中找到Ian Goodfellow对一个用户询问是否可以将GANs用于文本的回复：

![figure-name](../Images/31214937a5af80aff8525f2b59783624.png)

> “GANs尚未应用于自然语言处理（NLP），因为GANs仅定义于实值数据。
> 
> GANs的工作原理是训练一个生成器网络，该网络输出合成数据，然后在合成数据上运行一个判别器网络。判别器网络输出相对于合成数据的梯度告诉你如何稍微改变合成数据以使其更具现实感。
> 
> 你只能对基于连续数字的合成数据进行细微调整。如果数据基于离散数字，就无法进行细微改变。
> 
> 例如，如果你输出一个像素值为1.0的图像，你可以在下一步将该像素值改为1.0001。
> 
> 如果你输出“penguin”这个词，你不能在下一步将其改为“penguin + .001”，因为“penguin + .001”并不是一个有效的词汇。你必须从“penguin”开始，一直到“ostrich”。
> 
> 由于所有自然语言处理都基于诸如词语、字符或字节的离散值，目前还没有人真正知道如何将GAN应用于自然语言处理。”

现在，GAN被用于创建各种内容，包括图像、视频、音频和（是的）[文本](https://www.semanticscholar.org/paper/Adversarial-Generation-of-Natural-Language-Rajeswar-Subramanian/cea578d555fbc1aa72c04a83f834c4a3add302ef)。这些输出可以作为合成数据，用于训练其他模型，或用于产生有趣的副项目，例如 [thispersondoesnotexist.com](https://thispersondoesnotexist.com)，[thisairbnbdoesnotexist.com/](https://thisairbnbdoesnotexist.com/)，以及 [This Machine Learning Medium post does not exist](https://medium.com/comet-ml/this-machine-learning-medium-post-does-not-exist-c4705215b4a0)。????

### GAN背后的原理

GAN由两个神经网络组成——一个**生成器**，从头开始合成新样本，一个**判别器**，将训练样本与生成器生成的样本进行比较。判别器的目标是区分“真实”和“虚假”输入（即判断样本是来自模型分布还是实际分布）。正如我们所描述的，这些样本可以是图像、视频、音频片段和文本。

![gan-overview](../Images/5521f4e3212e4ed43d468d962ce19069.png)简单的GAN概述来自 [Kiran Sudhir](https://medium.com/@kiransudhir95)

为了合成这些新样本，生成器接收随机噪声，并尝试从训练数据的学习分布中生成逼真的图像。

判别网络（一个卷积神经网络）对合成数据输出的梯度指示如何稍微改变合成数据以使其更具真实性。最终，生成器会收敛到能够重现真实数据分布的参数，而判别器无法检测到差异。

**您可以通过GAN实验室观察并操作这些收敛的数据分布：**

[**GAN实验室：在您的浏览器中玩转生成对抗网络！**](https://www.ganlab.org)

*GAN实验室由Minsuk Kahng, Nikhil Thorat, Polo Chau, Fernanda Viégas和Martin Wattenberg创建，详情见…* [poloclub.github.io](https://poloclub.github.io/ganlab/)

**以下是一些关于GAN的最佳指南：**

+   [斯坦福CS231第13讲 — 生成模型](https://www.youtube.com/watch?v=5WoItGTWV54)

+   [基于风格的GAN](https://www.lyrn.ai/2018/12/26/a-style-based-generator-architecture-for-generative-adversarial-networks/)

+   [理解生成对抗网络](https://towardsdatascience.com/understanding-generative-adversarial-networks-gans-cd6e4651a29)

+   [生成对抗网络简介](https://heartbeat.fritz.ai/introduction-to-generative-adversarial-networks-gans-35ef44f21193)

+   [Lillian Weng: 从 GAN 到 WGAN](https://lilianweng.github.io/lil-log/2017/08/20/from-GAN-to-WGAN.html)

+   [深入了解高级 GANs：探索自注意力和谱范数](https://medium.freecodecamp.org/dive-head-first-into-advanced-gans-exploring-self-attention-and-spectral-norm-d2f7cdb55ede)

+   [Guim Perarnau: 奇妙的 GANs 及其发现方式](http://guimperarnau.com/blog/2017/03/Fantastic-GANs-and-where-to-find-them)（第一部分和第二部分）

### **理解和评估 GANs**

量化 GAN 的进展可能会感觉非常主观——*“这个生成的面孔看起来够真实吗？”*，*“这些生成的图像多样性足够吗？”*——而 GAN 可能会感觉像黑匣子，不清楚模型的哪些组件影响学习或结果质量。

为此，麻省理工学院计算机科学与人工智能实验室（CSAIL）的一个小组最近发布了一篇论文，‘[GAN 剖析：可视化和理解生成对抗网络](https://arxiv.org/abs/1811.10597)’，介绍了一种可视化 GANs 及其单元与图像中物体之间关系的方法，以及物体之间的关系。

![figure-name](../Images/d7b61822362d83148c2dec6eb5067e74.png) 图 1 来自 [Bau et. al 2019](https://arxiv.org/pdf/1811.10597v2.pdf)，展示了通过干预某些 GAN 单元来进行图像修改。

通过使用基于分割的网络剖析方法，本文的框架使我们能够剖析和可视化生成对抗网络的内部工作原理。这是通过查找一组 GAN 单元（称为神经元）与输出图像中的概念（如树、天空、云等）之间的对应关系来实现的。因此，我们能够识别出负责某些物体（如建筑物或云）的神经元。

具有这种级别的神经元细节使得对现有图像进行编辑（例如，如图所示添加或移除树木）成为可能，通过强制激活和去激活（切除）这些物体对应的单元来实现。

然而，目前还不清楚网络是否能够推理场景中的物体，或者只是简单地记住这些物体。接近答案的一种方法是尝试以不现实的方式扭曲图像。或许 [MIT CSAIL 的 GAN Paint 互动网页演示](https://gandissect.csail.mit.edu/) 最令人印象深刻的部分是模型似乎能够将这些编辑限制在“照片级真实”更改上。如果你尝试将草地强加到天空上，会发生如下情况：

![figure-name](../Images/03f687a052952abcca8a603a3b9d25e1.png)

即使我们激活了相应的神经元，但似乎 GAN 在后续层中抑制了信号。

![figure-name](../Images/700d2acc1fbb617c452a50a4bda84775.png)图 11 来自 [Bau et. al. 2019](https://arxiv.org/pdf/1811.10597v2.pdf) 显示了物体的局部上下文如何影响物体合成的可能性（在此案例中，影响门在建筑物上生成的可能性，而不是在树上或天空中）。

另一种有趣的 GAN 可视化方式是进行 **潜在空间插值**（记住，GAN 通过从学习到的潜在空间中采样来生成新实例）。这可以是查看生成样本之间过渡是否平滑的有用方式。

![figure-name](../Images/cf5ee9e58a32b3a50968934fa023895d.png)

**这些可视化可以帮助我们理解 GAN 的内部表示，但找到可量化的方式来理解 GAN 的进展和输出质量仍然是一个活跃的研究领域。**

两个常用的图像质量和多样性的评价指标是：**Inception Score** 和 **Fréchet Inception Distance (FID)**。大多数从业者在 Shane Barratt 和 Rishi Sharma 发布了关于前者主要缺点的论文 ‘[关于 Inception Score 的说明](https://arxiv.org/pdf/1801.01973.pdf)’ 后，已将重点从 Inception Score 转移到 FID。

* * *

## 我们的前三个课程推荐

![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 1\. [Google 网络安全证书](https://www.kdnuggets.com/google-cybersecurity) - 快速进入网络安全职业轨道。

![](../Images/e225c49c3c91745821c8c0368bf04711.png) 2\. [Google 数据分析专业证书](https://www.kdnuggets.com/google-data-analytics) - 提升你的数据分析技能

![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 3\. [Google IT 支持专业证书](https://www.kdnuggets.com/google-itsupport) - 支持组织的 IT

* * *

### 更多相关话题

+   [如何保持对 AI 世界动态的了解](https://www.kdnuggets.com/2022/03/stay-top-going-ai-world.html)

+   [Python 中的情感分析：超越词袋模型](https://www.kdnuggets.com/sentiment-analysis-in-python-going-beyond-bag-of-words)

+   [LangChain 101：创建你自己的 GPT 驱动应用程序](https://www.kdnuggets.com/2023/04/langchain-101-build-gptpowered-applications.html)

+   [使用 LlamaIndex 创建你自己的 PandasAI](https://www.kdnuggets.com/build-your-own-pandasai-with-llamaindex)

+   [使用 ChatGPT 的 GPTs 创建你自己的 GPTs！](https://www.kdnuggets.com/make-your-own-gpts-with-chatgpts-gpts)

+   [什么是对抗性机器学习？](https://www.kdnuggets.com/2022/03/adversarial-machine-learning.html)
