- en: 5 Simple Steps to Automate Data Cleaning with Python
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://www.kdnuggets.com/5-simple-steps-to-automate-data-cleaning-with-python](https://www.kdnuggets.com/5-simple-steps-to-automate-data-cleaning-with-python)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: '![A 5 Simple Steps Pipeline to Automate Data Cleaning with Python. Boxplot.](../Images/c8de18f3bbe0ef673f18b81f8365a312.png)'
  prefs: []
  type: TYPE_IMG
- en: Image by Author
  prefs: []
  type: TYPE_NORMAL
- en: 'It is a widely spread fact among Data Scientists that data cleaning makes up
    a big proportion of our working time. However, it is one of the least exciting
    parts as well.  So this leads to a very natural question:'
  prefs: []
  type: TYPE_NORMAL
- en: '* * *'
  prefs: []
  type: TYPE_NORMAL
- en: Our Top 3 Course Recommendations
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 1\. [Google Cybersecurity
    Certificate](https://www.kdnuggets.com/google-cybersecurity) - Get on the fast
    track to a career in cybersecurity.'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/e225c49c3c91745821c8c0368bf04711.png) 2\. [Google Data Analytics
    Professional Certificate](https://www.kdnuggets.com/google-data-analytics) - Up
    your data analytics game'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 3\. [Google IT Support
    Professional Certificate](https://www.kdnuggets.com/google-itsupport) - Support
    your organization in IT'
  prefs: []
  type: TYPE_NORMAL
- en: '* * *'
  prefs: []
  type: TYPE_NORMAL
- en: '*Is there a way to automate this process?*'
  prefs: []
  type: TYPE_NORMAL
- en: Automating any process is always easier said than done since the steps to perform
    depend mostly on the specific project and goal. But there are always ways to automate,
    at least, some of the parts.
  prefs: []
  type: TYPE_NORMAL
- en: This article aims to generate a pipeline with some steps to make sure our data
    is clean and ready to be used.
  prefs: []
  type: TYPE_NORMAL
- en: Data Cleaning Process
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Before proceeding to generate the pipeline, we need to understand what parts
    of the processes can be automated.
  prefs: []
  type: TYPE_NORMAL
- en: Since we want to build a process that can be used for almost any data science
    project, we need to first determine what steps are performed over and over again.
  prefs: []
  type: TYPE_NORMAL
- en: 'So when working with a new data set, we usually ask the following questions:'
  prefs: []
  type: TYPE_NORMAL
- en: What format does the data come in?
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Does the data contain duplicates?
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Does the  data contain missing values?
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: What data types does the data contain?
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Does the data contain outliers?
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'These 5 questions can easily be converted into 5 blocks of code to deal with
    each of the questions:'
  prefs: []
  type: TYPE_NORMAL
- en: 1.Data Format
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Data can come in different formats, such as JSON, CSV, or even XML. Every format
    requires its own data parser. For instance, pandas provide read_csv for CSV files,
    and read_json for JSON files.
  prefs: []
  type: TYPE_NORMAL
- en: By identifying the format, you can choose the right tool to begin the cleaning
    process.
  prefs: []
  type: TYPE_NORMAL
- en: We can easily identify the format of the file we are dealing with using the
    path.plaintext function from the os library. Therefore, we can create a function
    that first determines what extension we have, and then applies directly to the
    corresponding parser.
  prefs: []
  type: TYPE_NORMAL
- en: 2\. Duplicates
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: It happens quite often that some rows of the data contain the same exact values
    as other rows, what we know as duplicates. Duplicated data can skew results and
    lead to inaccurate analyses, which is not good at all.
  prefs: []
  type: TYPE_NORMAL
- en: This is why we always need to make sure there are no duplicates.
  prefs: []
  type: TYPE_NORMAL
- en: Pandas got us covered with the drop_duplicated() method, which erases all duplicated
    rows of a dataframe.
  prefs: []
  type: TYPE_NORMAL
- en: We can create a straightforward function that utilizes this method to remove
    all duplicates. If necessary, we add a columns input variable that adapts the
    function to eliminate duplicates based on a specific list of column names.
  prefs: []
  type: TYPE_NORMAL
- en: 3\. Missing Values
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Missing data is a common issue when working with data as well. Depending on
    the nature of your data, we can simply delete the observations containing missing
    values, or we can fill these gaps using methods like forward fill, backward fill,
    or substituting with the mean or median of the column.
  prefs: []
  type: TYPE_NORMAL
- en: Pandas offers us the .fillna() and .dropna() methods to handle these missing
    values effectively.
  prefs: []
  type: TYPE_NORMAL
- en: 'The choice of how we handle missing values depends on:'
  prefs: []
  type: TYPE_NORMAL
- en: The type of values that are missing
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The proportion of missing values relative to the number of total records we
    have.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Dealing with missing values is a quite complex task to perform - and usually
    one of the most important ones! - you can learn more about it [in the following
    article. ](https://www.kdnuggets.com/2020/06/missing-values-dataset.html)
  prefs: []
  type: TYPE_NORMAL
- en: 'For our pipeline, we will first check the total number of rows that present
    null values. If only 5% of them or less are affected, we will erase these records.
    In case more rows present missing values, we will check column by column and will
    proceed with either:'
  prefs: []
  type: TYPE_NORMAL
- en: Imputing the median of the value.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Generate a warning to further investigate.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: In this case, we are assessing the missing values with a hybrid human validation
    process. As you already know, assessing missing values is a crucial task that
    can not be overlooked.
  prefs: []
  type: TYPE_NORMAL
- en: When working with regular data types we can proceed to transform the columns
    directly with the pandas .astype() function, so you could actually modify the
    code to generate regular conversations.
  prefs: []
  type: TYPE_NORMAL
- en: Otherwise, it is usually too risky to assume that a transformation will be performed
    smoothly when working with new data.
  prefs: []
  type: TYPE_NORMAL
- en: 5\. Dealing with Outliers
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Outliers can significantly affect the results of your data analysis. Techniques
    to handle outliers include setting thresholds, capping values, or using statistical
    methods like Z-score.
  prefs: []
  type: TYPE_NORMAL
- en: In order to determine if we have outliers in our dataset, we use a common rule
    and consider any record outside of the following range as an outlier. [Q1 — 1.5
    * IQR , Q3 + 1.5 * IQR]
  prefs: []
  type: TYPE_NORMAL
- en: Where IQR stands for the interquartile range and Q1 and Q3 are the 1st and the
    3rd quartiles. Below you can observe all the previous concepts displayed in a
    boxplot.
  prefs: []
  type: TYPE_NORMAL
- en: '![XXX](../Images/ccec7a695870201416f09459b92ed277.png)'
  prefs: []
  type: TYPE_IMG
- en: Image by Author
  prefs: []
  type: TYPE_NORMAL
- en: To detect the presence of outliers, we can easily define a function that checks
    what columns present values that are out of the previous range and generate a
    warning.
  prefs: []
  type: TYPE_NORMAL
- en: Final Thoughts
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Data Cleaning is a crucial part of any data project, however, it is usually
    the most boring and time-wasting phase as well. This is why this article effectively
    distills a comprehensive approach into a practical 5-step pipeline for automating
    data cleaning using Python and.
  prefs: []
  type: TYPE_NORMAL
- en: The pipeline is not just about implementing code. It integrates thoughtful decision-making
    criteria that guide the user through handling different data scenarios.
  prefs: []
  type: TYPE_NORMAL
- en: This blend of automation with human oversight ensures both efficiency and accuracy,
    making it a robust solution for data scientists aiming to optimize their workflow.
  prefs: []
  type: TYPE_NORMAL
- en: You can go check my whole code in the following [GitHub repo.](https://github.com/rfeers/data-science-portfolio/blob/main/data-analytics/automate-data-cleaning/data_cleaning_automation.ipynb)
  prefs: []
  type: TYPE_NORMAL
- en: '**[](https://www.linkedin.com/in/josep-ferrer-sanchez/)**[Josep Ferrer](https://www.linkedin.com/in/josep-ferrer-sanchez)****
    is an analytics engineer from Barcelona. He graduated in physics engineering and
    is currently working in the data science field applied to human mobility. He is
    a part-time content creator focused on data science and technology. Josep writes
    on all things AI, covering the application of the ongoing explosion in the field.'
  prefs: []
  type: TYPE_NORMAL
- en: More On This Topic
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: '[5 Tasks To Automate With Python](https://www.kdnuggets.com/2021/06/5-tasks-automate-python.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Automate Microsoft Excel and Word Using Python](https://www.kdnuggets.com/2021/08/automate-microsoft-excel-word-python.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Automate the Boring Stuff with GPT-4 and Python](https://www.kdnuggets.com/2023/03/automate-boring-stuff-chatgpt-python.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Automate Your Codebase with Promptr and GPT](https://www.kdnuggets.com/2023/04/automate-codebase-promptr-gpt.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Automate Graphic Design Activity with ChatGPT Canva Plugin](https://www.kdnuggets.com/automate-graphic-design-activity-with-chatgpt-canva-plugin)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[AI-Automated Cybersecurity: What to Automate?](https://www.kdnuggets.com/ai-automated-cybersecurity-what-to-automate)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
