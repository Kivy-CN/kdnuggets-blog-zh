# 数据科学家常犯的 10 个编码错误

> 原文：[https://www.kdnuggets.com/2019/04/top-10-coding-mistakes-data-scientists.html](https://www.kdnuggets.com/2019/04/top-10-coding-mistakes-data-scientists.html)

![c](../Images/3d9c022da2d331bb56691a9617b91b90.png) [评论](#comments)

**作者 [Norman Niemer](https://www.linkedin.com/in/normanniemer/)，首席数据科学家**

数据科学家是“比任何软件工程师都擅长统计学，比任何统计学家都擅长软件工程的人”。许多数据科学家有统计学背景，而在软件工程方面经验较少。我是一名高级数据科学家，在 Stackoverflow 上的 Python 编码排名前 1%，并且与很多（初级）数据科学家合作。以下是我经常看到的 10 个常见错误的列表。

* * *

## 我们的前三课程推荐

![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 1\. [Google 网络安全证书](https://www.kdnuggets.com/google-cybersecurity) - 快速进入网络安全职业轨道。

![](../Images/e225c49c3c91745821c8c0368bf04711.png) 2\. [Google 数据分析专业证书](https://www.kdnuggets.com/google-data-analytics) - 提升你的数据分析技能

![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 3\. [Google IT 支持专业证书](https://www.kdnuggets.com/google-itsupport) - 支持你的组织进行 IT

* * *

![Header image](../Images/f1f471b811e4b07b98d166e825945e20.png)

### 1\. 不要共享代码中引用的数据

数据科学需要代码和数据。因此，为了让其他人能够重现你的结果，他们需要访问数据。这看起来很基本，但很多人忘记与代码一起共享数据。

[PRE0]

**解决方案**：使用 [d6tpipe](https://github.com/d6t/d6tpipe) 将数据文件与代码一起共享，或上传到 S3/web/google drive 等，或者保存到数据库中，以便接收者可以检索文件（但不要将其添加到 git 中，见下文）。

### 2\. 硬编码不可访问的路径

类似于错误 1，如果你硬编码了其他人无法访问的路径，他们无法运行你的代码，并且必须在多个地方手动更改路径。哎呀！

[PRE1]

**解决方案**：使用相对路径、全局路径配置变量或 [d6tpipe](https://github.com/d6t/d6tpipe) 来使数据易于访问。

### 3\. 将数据与代码混合

由于数据科学代码需要数据，为什么不将它放在同一目录下？而且在此期间，也将图像、报告和其他杂物一起保存。哎呀，真是一团糟！

[PRE2]

**解决方案**：将你的目录整理成类别，如数据、报告、代码等。请参见 [Cookiecutter 数据科学](https://drivendata.github.io/cookiecutter-data-science/#directory-structure) 或 [d6tflow 项目模板](https://github.com/d6t/d6tflow-template)（参见第 5 点），并使用第 1 点中提到的工具来存储和共享数据。

### 4\. 与源代码一起提交 Git 数据

现在大多数人都对他们的代码进行版本控制（如果你没有，那就是另一个错误！！请参阅 [git](https://git-scm.com/)）。在尝试共享数据时，可能会有将数据文件添加到版本控制中的诱惑。这对于非常小的文件是可以的，但 git 并未针对数据优化，特别是大型文件。

[PRE3]

**解决方案**：使用第 #1 点提到的工具来存储和共享数据。如果你真的想对数据进行版本控制，请参阅 [d6tpipe](https://github.com/d6t/d6tpipe)，[DVC](https://dvc.org/) 和 [Git Large File Storage](https://git-lfs.github.com/)。

### 5. 写函数而不是 DAGs

够了数据，来谈谈实际的代码吧！因为你学习编码时最先学到的就是函数，所以数据科学代码通常是按顺序组织的一系列函数。这会导致几个问题，参见 [4 Reasons Why Your Machine Learning Code is Probably Bad](https://github.com/d6t/d6t-python/blob/master/blogs/reasons-why-bad-ml-code.rst)。

[PRE4]

**解决方案**：与其线性地链式调用函数，不如将数据科学代码编写为一组具有相互依赖的任务。使用 [d6tflow](https://github.com/d6t/d6tflow) 或 [airflow](https://airflow.apache.org/)。

### 6. 写 for 循环

就像函数一样，for 循环是你学习编码时首先学到的东西。易于理解，但它们很慢且冗长，通常表明你对矢量化替代方法不了解。

[PRE5]

**解决方案**： [Numpy](http://www.numpy.org/)，[scipy](https://www.scipy.org/) 和 [pandas](https://pandas.pydata.org/) 为你认为可能需要 for 循环的大多数操作提供了矢量化函数。

### 7. 不写单元测试

随着数据、参数或用户输入的变化，你的代码可能会崩溃，有时你甚至不会察觉。这可能导致输出不佳，如果有人根据你的输出做决策，不良的数据将导致不良的决策！

**解决方案**：使用 `assert` 语句检查数据质量。[pandas](https://pandas.pydata.org/pandas-docs/stable/reference/general_utility_functions.html#testing-functions) 提供了等式测试，[d6tstack](https://github.com/d6t/d6tstack) 提供了数据摄取的检查，[d6tjoin](https://github.com/d6t/d6tjoin/blob/master/examples-prejoin.ipynb) 用于数据连接。示例数据检查的代码：

[PRE6]

### 8. 不记录代码

我明白了，你急于完成一些分析。你将各种东西拼凑在一起以向客户或老板提供结果。然后一周后，他们回来问“能否更改 xyz”或“能否更新这个”。你查看你的代码，却记不起你做了什么。现在想象一下其他人必须运行它的情景。

[PRE7]

**解决方案**：即使在你完成分析后，也要花额外的时间记录你做了什么。你会感谢自己，其他人也会更感谢你！你将看起来像个专家！

### 9. 将数据保存为 csv 或 pickle

备份数据，毕竟这是数据科学。就像函数和循环一样，CSV 和 pickle 文件常被使用，但其实并不好。CSV 不包含模式，所以每个人都得重新解析数字和日期。Pickles 解决了这个问题，但仅适用于 python，并且未压缩。两者都不是存储大数据集的好格式。

[PRE8]

**解决方案**：使用[parquet](https://github.com/dask/fastparquet)或其他具有数据模式的二进制数据格式，理想情况下，使用能压缩数据的格式。[d6tflow](https://github.com/d6t/d6tflow)会自动将任务的输出数据保存为 parquet，因此你无需处理这些数据。

### 10. 使用 jupyter notebooks

让我们以一个有争议的观点总结：jupyter notebooks 和 CSV 一样普遍。很多人使用它们，但这并不意味着它们好。Jupyter notebooks 促进了许多不良的软件工程习惯，特别是：

1.  你很容易将所有文件都放在一个目录中

1.  你写的代码是从上到下运行的，而不是 DAGs

1.  你没有模块化你的代码

1.  难以调试

1.  代码和输出混合在一个文件中

1.  他们的版本控制不好

这感觉很容易入门，但扩展性差。

**解决方案**：使用[pycharm](https://www.jetbrains.com/pycharm/)和/或[spyder](https://www.spyder-ide.org/)。

**简介：[Norman Niemer](https://www.linkedin.com/in/normanniemer/)** 是一家大型资产管理公司的首席数据科学家，提供数据驱动的投资见解。他拥有哥伦比亚大学的金融工程硕士学位和伦敦 Cass 商学院的银行与金融学士学位。

[原文](https://github.com/d6t/d6t-python/blob/master/blogs/top10-mistakes-coding.md)。已获许可转载。

**相关：**

+   [你的机器学习代码可能糟糕的4个原因](/2019/02/4-reasons-machine-learning-code-probably-bad.html)

+   [机器学习项目检查表](/2018/12/machine-learning-project-checklist.html)

+   [初创公司数据科学项目流程](/2019/01/data-science-project-flow-startups.html)

### 更多相关主题

+   [建立一个强大的数据团队](https://www.kdnuggets.com/2021/12/build-solid-data-team.html)

+   [使用管道编写干净的 Python 代码](https://www.kdnuggets.com/2021/12/write-clean-python-code-pipes.html)

+   [在转行到数据科学时犯的5个错误](https://www.kdnuggets.com/2023/07/5-mistakes-made-switching-data-science-career.html)

+   [每个初学者数据科学家应该掌握的6个预测模型](https://www.kdnuggets.com/2021/12/6-predictive-models-every-beginner-data-scientist-master.html)

+   [成为伟大数据科学家所需的5项关键技能](https://www.kdnuggets.com/2021/12/5-key-skills-needed-become-great-data-scientist.html)

+   [2021年最佳ETL工具](https://www.kdnuggets.com/2021/12/mozart-best-etl-tools-2021.html)
