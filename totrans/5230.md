# SQL 案例研究：帮助创业公司 CEO 管理数据

> 原文：[https://www.kdnuggets.com/2018/09/sql-case-study-helping-startup-ceo-manage-data.html](https://www.kdnuggets.com/2018/09/sql-case-study-helping-startup-ceo-manage-data.html)

![c](../Images/3d9c022da2d331bb56691a9617b91b90.png) [评论](/2018/09/sql-case-study-helping-startup-ceo-manage-data.html?page=2#comments)

**作者：[Ezz El Din Abdullah](https://www.linkedin.com/in/ezzeddinabdullah/)，前数据科学实习生及编程导师**

你可能听说过，如果你知道英语，你基本上可以用 SQL 编写查询。这几乎是正确的，因为 SQL 非常直观，确实像简单的英语一样。

在本教程中，你将学习如何创建表格、插入值、使用和理解一些数据类型、使用 SELECT 语句、更新记录、使用一些聚合函数如 COUNT()、MIN()、SUM()、使用 WHERE 子句、从字符串中移除字符、将字符串转换为数值、编写子查询、检索顶部和底部候选者、添加列、执行循环，并制作直方图。

![图片](../Images/64f8ef0e434222d28b74b283fc6e77f2.png)

不过，如果你在学习时更喜欢视频而不是文章，我已经在 Udemy 上发布了这篇文章作为一个实践课程 “[**直观的 SQL 数据库案例研究**](https://www.udemy.com/intuitive-sql-databases-case-study)”。 这个课程包含了这里写的所有代码片段，并以互动方式在 SQL shell 上进行更多操作。

所有之前的任务可以通过展示一个案例研究来完成，帮助你找到一些实际操作数据的指导。阅读本教程时，最好的做法是编写我所写的代码，如果你是初学者，请务必亲自实践，因为这会使你在这门语言中变得出色（实际上，几乎所有你学习的东西都适用）。如果你了解一些 SQL，希望你也能发现这篇文章对你有用，并看到一些可能增加你知识的其他内容。

我使用的是 PostgreSQL，它是一个通用的数据库管理系统，但你仍然可以在 MySQL、Oracle、DB2 等系统上编写所有的代码。如果你发现某段代码无法运行，请向 Google 查询你使用的数据库管理系统的语法。

假设我们希望拥有这样的表格：

| Id | 名称 | 年龄 | 城市 | 薪水 |
| --- | --- | --- | --- | --- |
| 1 | Wael | 23 | 开罗 | 800$ |
| 2 | Ragab | 24 | 吉萨 | 900$ |
| 3 | Ali | 24 | 吉萨 | 1500$ |
| 4 | Othman | 25 | 吉萨 | 2000$ |
| 5 | Waleed | 26 | 开罗 | 2100$ |
| 6 | Abdo | 23 | 亚历克斯 | 900$ |
| 7 | Moetaz | 22 | 开罗 | 800$ |

**创建表格：**

我们可以使用以下查询来创建这样的表：

```py

CREATE TABLE startup(
id int NOT NULL,
name varchar(10) NOT NULL,
age int CHECK(age > 0),
city varchar(10),
salary varchar(5),
PRIMARY KEY(id));

```

让我们更详细地看看我们写的内容发生了什么。我们使用 create() 创建了一个表。这个表叫做 startup，它包括 id 和 city 列，其中 id 的数据类型是整数，且不允许 NULL 值；稍后我们会看到原因。第二列是‘name’，其数据类型是 varchar(10)，即长度为 10 的变长字符，‘Ali’ 在内存中占用 3 个字符大小，而‘Othman’ 占用 6 个字符大小。这个列也可以存储为 char，即固定长度为 10 的字符，但在这种情况下‘Ali’ 在内存中会占用 10 个字符大小，而‘Othman’ 也会占用 10 个字符大小。‘name’ 列也可以存储为 text，但这种存储方式并不明智，因为 text 在内存中可以占用多达 2GB 的数据。当编写查询时，你应该考虑存储，因为你的表可能包含大量数据，检索这些数据可能不会像你期望的那么快。

回到查询中，‘name’ 列不能为空（即，应该包含一个名称而不是空值）。‘age’ 列包含整数值，并且只允许正数。‘city’ 和 ‘salary’ 列分别包含长度为 10 和 5 的变长字符。最后，‘id’ 列包含唯一值（即主键）。这意味着它不能包含重复值（在我们的案例中是整数）。这个语法可以在定义 id 为 int 时完成，因此可以写成‘id int primary key not null’。

请注意，SQL 对大小写不敏感，因此上述查询中的任何关键字都可以是小写，但最好将它们写成大写。

**检索数据：**

现在，我们可以通过以下方式检索到目前为止的数据：

```py

SELECT *
FROM startup;

```

SELECT 子句是 SQL 中最常用的关键字。这个查询可以简单地从启动表中检索所有数据。从结果中可以看出，它包括了我们创建的所有列，并且其中包含 0 行数据。

**插入值到表中：**

让我们填充这张表中的第一行：

```py

INSERT INTO startup
VALUES(1, 'Wael', 23, 'Cairo', '800$');

```

现在第一行已经完成：

| Id | name | age | city | salary |
| --- | --- | --- | --- | --- |
| 1 | Wael | 23 | Cairo | 800$ |

让我们再写一次之前的查询，看看会发生什么：

```py

INSERT INTO startup
VALUES(1, 'Wael', 23, 'Cairo', '800$');

```

我们看到一个错误提示：

```py

ERROR:  duplicate key value violates unique constraint "startup_pkey"
DETAIL:  Key (id)=(1) already exists.

```

这是因为 id 是主键，只能包含唯一值而不是像 id = 1 这样的重复值。

如果你犯了一个错误，并输入了负数作为年龄，例如：

```py

INSERT INTO startup
VALUES(1, 'Wael', -23, 'Cairo', '800$');

```

你将会遇到一个错误：

```py

ERROR:  new row for relation "startup" violates check constraint "startup_age_check"
DETAIL:  Failing row contains (1, 'Wael', -23, 'Cairo', '800$').

```

这是因为你已经设置了一个 CHECK 子句来只包含正数。

让我们做另一个查询以形成第二行：

```py

INSERT INTO startup
VALUES(2, 'Ragab', 24, 'Giza', '900$');

```

让我们看看如果我填充第三行会发生什么：

```py

INSERT INTO startup
VALUES(3, Ali, 24, 'Giza', '1500$');

```

有一个错误提示我们：

```py

ERROR:  column "ali" does not exist

```

这是因为包含‘Ali’的‘name’ 列没有以字符串形式出现，所以我们需要将其放在单引号中。

当形成第四行时：

```py

INSERT INTO startup
VALUES(4, 'Othman', 25, 'Giza', '2000$');

```

让我们填充其余的列：

```py

INSERT INTO startup
VALUES(5, 'Waleed', 26, 'Cairo', '2100$');
INSERT INTO startup
VALUES(6, 'Abdo', 23, 'Alex', '900$');
INSERT INTO startup
VALUES(7, 'Moetaz', 22, 'Cairo', '2000$');

```

在最后一行，我犯了一个错误，把薪水填写为 2000$ 而不是 800$。我们可以通过更新查询来修正这个错误：

```py

UPDATE startup
SET salary = '800$'
WHERE id = 7;

```

UPDATE 子句在表的名称后使用，将薪资设置为 800$，对于一个我们知道它定义了感兴趣行的条件，例如 id = 7。

**插入特定列：**

让我们尝试添加另一个具有特定列的行；id 和薪资值：

```py

INSERT INTO startup(
id, salary)
VALUES(8, '1000$');

```

这将引入一个错误，告诉我们：

```py

ERROR:  null value in column "name" violates not-null constraint
DETAIL:  Failing row contains (8, null, null, null, 1000$).

```

这意味着你必须填充“name”列，因为我们将其定义为 NOT NULL，这意味着我们不能让它为空；它必须有值。

因此，我们可以通过将 name 列添加到查询中来修复此问题：

```py

INSERT INTO startup(
id, name, salary)
VALUES(8, 'Mohammed', '1000$');

```

### 更多关于此主题

+   [使用 Python 的自动化机器学习：案例研究](https://www.kdnuggets.com/2023/04/automated-machine-learning-python-case-study.html)

+   [12 个提示：从数据分析师到创业公司联合创始人](https://www.kdnuggets.com/2021/12/12-tips-data-analyst-to-co-founder.html)

+   [构建深科技创业公司的 10 个障碍，ChatGPT 时代](https://www.kdnuggets.com/2023/04/10-hurdles-building-deep-tech-startup-age-chatgpt.html)

+   [KDnuggets 新闻，8月31日：完整的数据科学学习路线图…](https://www.kdnuggets.com/2022/n35.html)

+   [超级学习指南：免费的算法和数据结构电子书](https://www.kdnuggets.com/2022/06/super-study-guide-free-algorithms-data-structures-ebook.html)

+   [完整的数据科学学习路线图](https://www.kdnuggets.com/2022/08/complete-data-science-study-roadmap.html)
