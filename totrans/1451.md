# 将数据科学应用于网络安全攻击与事件

> 原文：[https://www.kdnuggets.com/2019/09/applying-data-science-cybersecurity-network-attacks-events.html](https://www.kdnuggets.com/2019/09/applying-data-science-cybersecurity-network-attacks-events.html)

[评论](#comments)

**由 [Aakash Sharma](https://www.linkedin.com/in/aakashsharma21/) 提供，数据科学家**

网络世界是一个难以理解的广阔概念。当时，我决定在大学本科期间进入网络安全领域。吸引我的是理解恶意软件、网络安全、渗透测试和加密方面的概念，这些都在网络安全的真正含义中发挥着作用。

* * *

## 我们的前三大课程推荐

![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 1\. [谷歌网络安全证书](https://www.kdnuggets.com/google-cybersecurity) - 快速通道进入网络安全职业。

![](../Images/e225c49c3c91745821c8c0368bf04711.png) 2\. [谷歌数据分析专业证书](https://www.kdnuggets.com/google-data-analytics) - 提升你的数据分析能力

![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 3\. [谷歌 IT 支持专业证书](https://www.kdnuggets.com/google-itsupport) - 支持你的组织的 IT

* * *

保护基础设施是重要的，但无论如何都很有趣。确实有编码，但我从未真正学习过我们如何将代码实施到网络安全原则中。这正是我下一步想要了解的内容，这将扩展我在信息技术和计算机科学方面的知识。我更多地学习了编码，特别是在 Python 方面。我稍微接触了一下 Scala，并且在本科期间已经对 Sequel 和 Java 应用程序有了很好的基础，在训练营中学习它让我感觉更为舒适。

数据科学沉浸式课程教会了我如何通过 Sequel、JSON、HTML 或网页抓取应用程序来收集数据，然后清洗数据，并应用与 Python 相关的代码进行统计分析。随后，我能够对数据进行建模，以发现趋势、进行预测或提供建议/推荐。我希望将这些应用于我的 Cisco NetaCad、网络安全原则和软件开发背景。

![图](../Images/b1cbeb14e9d610cf85aa10111f51dd87.png)

FCC 标志

然后，我希望将这些与我的网络安全背景联系起来。我决定从 Data.org 收集有关联邦通信委员会 (FCC) 的大量网络攻击的数据。在这篇博客文章中，我决定写下如何将我的数据科学知识与我的网络安全背景联系到实际行业中。我将提供一些项目背景、代码示例及对 FCC 如何更好地理解数据的一些见解。这可能对未来的情况或其他政府相关的网络安全项目有用。

据我所知，FCC遵循CSRIC最佳实践搜索工具，该工具允许您使用包括网络类型、行业角色、关键词、优先级和BP编号等各种标准来搜索CSRIC的最佳实践集合。

通信安全、可靠性与互操作性委员会（CSRIC）的使命是向FCC提供建议，以确保，包括电信、媒体和公共安全在内的通信系统的最佳安全性和可靠性。

CSRIC的成员关注一系列与公共安全和国土安全相关的通信事务，包括：（1）通信系统和基础设施的可靠性和安全性，特别是移动系统；（2）911、增强型911（E911）和下一代911（NG911）；以及（3）紧急警报。

CSRIC的建议将涉及预防和修复有害的网络事件，制定改进整体通信可靠性的最佳实践，确保通信服务的可用性和性能，以及在自然灾害、恐怖袭击、网络安全攻击或其他对通信基础设施造成极大压力的事件中的紧急警报，快速恢复通信服务以应对广泛或重大中断，以及通信提供商可以采取的措施以帮助保护最终用户和服务器。

我在处理这个项目的第一步是理解我需要完成的任务以及这个项目让我采取的方向。我记得我需要向FCC提供建议，以确保电信、媒体和公共安全领域通信系统的最佳安全性和可靠性。

在尝试这个项目时，我考虑了不同的方法。第一种是直接深入以更好地理解数据本身，我专注于事件的优先级，并对其应用了大量机器学习分类模型。第二种方法是能够对事件描述应用自然语言处理技术，并查看这与事件优先级的相关性。

通过这个工具，我们可以进行预测，并据此提出建议，以更好地预防、理解或控制事件。我的想法是，如果我们可以通过修复较不复杂的事件来集中精力处理更关键的事件，我们可以节省足够的资源以进一步改进系统，来应对更复杂的事件。

需求：

+   一个Python IDE

+   机器学习和统计包

+   对数据科学概念的深厚知识

+   对网络安全和网络相关概念的一些知识

让我们开始吧！首先导入我们打算使用的所有包，我通常会复制并粘贴一个有助于我之前数据科学项目的有用模块列表。

[PRE0]

然后我们需要加载数据并查看它：

[PRE1]

现在我们可以开始探索、清理和理解数据。下面，我提供了一个用于基本数据探索分析的函数。我们这样做是为了充分理解我们处理的数据以及需要达成的整体目标。

以下函数将允许我们查看任何空值，用下划线替换任何空白字符，重新格式化数据框的索引，查看每列的数据类型，显示任何重复的数据，描述数据的统计分析，并检查数据的形状。

[PRE2]

根据数据，我们说这是一个不平衡的分类问题！我们接下来需要做的是消除任何“NaN”或空值，并在一定程度上平衡我们的类别。根据我们的探索性数据分析，我们可以看到大多数数据在对象类型的列中有“NaN”值。我们可以使用下面的函数来解决这个问题！

[PRE3]

![图像](../Images/00875b80a3ceb8555178033818446813.png)

检查“Priorities”列中的值数量

查看优先级列，我们有一个与对象相关的列，用于按重要性、非常重要和关键来排序事件的严重程度。另一个与优先级列对应的列将它们排序为1到3，其中1为重要，2为非常重要，3为关键。基于优先级的多样性，我们看到数据是不平衡的。我们通过重新命名列以便更好地理解，然后对其进行平衡，重点关注非常重要和关键事件来解决这个问题。

[PRE4]

![图像](../Images/bbc7ce6635439f561897a56d1e140338.png)

在我们平衡了类别之后，上述代码的结果

### **第一种方法（理解数据）**

在接下来的部分中，我将讨论我在理解优先级列方面的初步方法。我很快发现这种方法并不是最好的，但它在我寻找攻击优先级的推荐时提供了很有用的信息。

我的下一步是理解哪些列与我的优先级列的模式和趋势最相关。似乎所有表现良好的列都是二进制的！描述列是与文本相关的，而机器处理文本对象不太喜欢。使用下面的代码，我们可以看到哪些列与我们的预测列最正相关，哪些列最负相关。

[PRE5]

![图像](../Images/63555a72fc10d4e0f147599a5698eda0.png)

最负相关的![图像](../Images/87dc709d7e3fba09a31ae8e2e6793512.png)

最正相关的

现在我们可以开始构建模型，以查看我们所做的是否能提供准确的预测或足够的信息用于推荐。首先从训练-测试拆分开始，这些相关列作为特征，我们的优先级列作为预测变量。

[PRE6]

现在我们已经对特征进行了训练-测试拆分，让我们应用网格搜索以找到最佳参数或特征，以实现**朴素贝叶斯分类器、随机森林分类器、Adaboost/梯度提升分类器**和**Keras 神经网络**的最佳准确度！但这些分类模型究竟意味着什么？

简单来说，**朴素贝叶斯** 分类器假设一个类别中特征的存在与任何其他特征的存在无关。让我们在我们的数据上看看吧！

[PRE7]

**随机森林分类器** 创建了一组从训练集随机选择的子集中生成的决策树，然后汇总不同决策树的投票来决定测试对象的最终类别。随机森林中的每棵树都给出一个类别预测，获得最多票数的类别成为我们模型的预测。让我们建模吧！

[PRE8]

![图示](../Images/091f19d0b69e88e11a54841c6c23f8b7.png)

我们的 Adaboost 模型图，它已经过拟合！

**AdaBoost** 是自适应增强的缩写。它基本上是一个用于分类的机器学习算法。当你有大量数据并且想将其分成不同类别时，我们需要一个好的分类算法。因此，“增强”一词，因为它能增强其他算法！

[PRE9]

**神经网络** 是一组算法， loosely 模仿人脑设计，旨在识别模式。它们通过一种机器感知解释感官数据，对原始输入进行标记或聚类。我们甚至可以应用正则化来应对**过拟合**问题！

![图示](../Images/1d09ab2060c853b6e6407693f94189ed.png)

我们的正则化神经网络，它已经过拟合！

[PRE10]

![图示](../Images/113883da063f2e405f4c0c7d3b679bb6.png)

我们模型的准确度

这告诉我们什么？！根据训练分数和测试分数，我们可以看到我们的模型是**过拟合**的，在做预测或分析趋势方面表现不佳。模型**过拟合**是什么意思？我们有**高方差**和**低偏差**！**高方差**可能导致算法对训练数据中的随机噪声进行建模，而不是目标输出。我们仍然不能根据这个做出推荐，因为它实际上没有提供太多信息！

### 第二种方法（自然语言处理）——最佳路径

我的第二种方法是专注于描述列。在我的第一种方法之后，我想看看攻击的优先级与描述中给出的内容的相关性。描述列给出了事件发生的简短解释和建议的 FCC 合规解决方案，即他们可能会如何阻止类似事件的发生。

为了更好地理解描述列，我需要应用自然语言处理（NLP），因为计算机和统计模型不喜欢处理文本和词汇。但我们可以绕过这一点！我的方法类似于清理数据和调整优先级列，但我应用了一些NLP概念，以更好地理解描述、分析它、提出建议，甚至预测基于特定事件词汇的下一个事件。

一些概念包括：

+   **预处理**是将原始数据转换为清洁数据集的技术。

+   **正则表达式**是一种允许你创建模式以帮助匹配、定位和管理文本的字符串。另一种清理文本的方法。

+   **词形还原**是将一个词的屈折形式组合在一起以便可以作为一个单一术语进行分析的过程。

+   **词干化** 是将屈折词还原为词根、基本或原始形式的过程。

+   **Countvectorize** 计算词频。

+   **TFIDFVectorizer** 是词的值与词频成正比，但会受到语料库中词频的影响。

让我们首先对已经清理的数据应用正则表达式概念。我们还希望去除或清理那些有用但在每个描述中零散出现的常见词汇。

[PRE11]

现在我们已经清理了数据，我们应该应用一些预处理技术，以更好地理解每个事件描述中给定的词汇。

[PRE12]

然后我们希望在我们的词干化、词形还原和分词后的描述词上应用`countvectorize`，以控制英语中的常见停用词，我们可以使用以下代码来实现。然后我们可以看到整个数据集中的最常见词汇是什么。

[PRE13]

![图示](../Images/f5c1a6526d8e53db4a11ca3ad0dc150a.png)

整个数据集中的最高词频

我们可以看到出现的词汇大多数与网络或安全相关。我们可以利用这些信息更好地理解这些事件的范围！这些是网络攻击吗？它们与网络仓库相关吗？等等。

但如果我们想要更多的信息怎么办？我们可以根据事件的重要性或紧急程度对描述进行分组。也许这些事件不严重，因此它们被标记为0（不重要），或者非常严重被标记为1（非常重要）。我们可以使用下面的代码根据我们的预处理列来实现这一点。然后我们可以可视化最常见的真正重要的词汇。

[PRE14]

![图示](../Images/a5b0249a84ab149056d3d6a93b280bc3.png)

真的重要的词汇的最高词频

最后，我们可以开始在标记化数据上建模回归和分类指标。让我们从通过管道应用逻辑回归模型开始，在其中应用网格搜索工具，以调整我们的最佳特征或最佳参数。让我们建立我们的 X 变量，我们的特征！我们将使用处理后的数据框中标记化列的词语或特征。处理后的数据框是一个全新的数据框，包含我们的标记化、词干化和词形还原列。

在这里我决定专注于标记化的列，因为这个特定列在参数调整和准确性方面表现最好。为了缩短这篇博客的时间长度，我决定专注于标记化的内容，以及最有效的方法。让我们也进行训练-测试分割。

[PRE15]

现在让我们创建一个使用网格搜索概念的**管道**，以获得最佳超参数。一旦网格搜索完成（这可能需要一些时间！），我们可以从网格搜索对象中提取各种信息和有用的对象。通常，我们会想对数据集应用几个转换器，然后最终构建模型。如果你独立执行所有这些步骤，你的代码在预测测试数据时可能会很混乱，并且容易出错。幸运的是，我们有**管道**！

在这里，我们将应用一个逻辑回归模型，它可以考虑 LASSO 和 Ridge 惩罚。

**你应该：**

1.  适配并验证默认逻辑回归模型在数据上的准确性。

1.  对不同的正则化强度、Lasso 和 Ridge 惩罚执行网格搜索。

1.  比较优化后的逻辑回归模型在测试集上的准确性与基线准确性和默认模型的准确性。

1.  查看找到的最佳参数。选择了什么？这对我们的数据有什么启示？

1.  查看（如果 Lasso 被选为最佳的）非零系数和相关预测器。哪个预测器似乎最重要？

[PRE16]

现在我们可以在网格搜索对象中应用管道到我们的逻辑回归模型。注意到 `countvectorize` 模型正在实例化。我们这样做是因为我们想了解这些因素如何影响我们的准确性以及我们与网络攻击相关的词语的重要性。

[PRE17]

![图示](../Images/decbbb88ade18117d56b64ad0fc88c23.png)

我们改进了逻辑回归模型的准确性

那么我们可以从中推断出什么？看起来我们在训练数据上的模型准确性有了显著提升，并且测试数据的准确性提高了 10%。然而，模型仍然**过拟合**！但仍然做得很棒！我们的最佳参数是什么？我们可以利用这些信息来调整未来的逻辑回归模型！下面的代码将展示给我们！

[PRE18]

![图示](../Images/d40ca1a01a557a1969435a75fbb8c5a8.png)

我们从管道中的逻辑回归网格搜索中获得的最佳超参数

一种使用**L1**正则化技术的**回归**模型被称为Lasso**回归**，而使用**L2**的模型被称为Ridge**回归**。根据我们最佳的超参数，我们的模型倾向于使用Ridge回归技术。现在我们想基于我们的逻辑回归模型进行预测，并能够提出建议。我们该如何进行呢？让我们看看与预测最佳y变量结果相关的特征系数。

[PRE19]

![图示](../Images/dc670ed8a1c26c818a2d5dc00edfceec.png)

基于单词出现频率和重要性的建议预测

### 推荐与结论

现在我已经完成了数据建模和分析，我可以向FCC以及任何其他计划进行类似项目的数据科学家或数据分析师提出建议。

对于未来从事类似项目的数据科学家来说。获取更多数据、提供更好的数据样本、增加/减少模型复杂度并**正则化**。这可以帮助解决**过拟合**的问题，这也是我在这个项目中遇到的。理解不平衡的分类问题。这可以成为解决问题的主要方向。

根据FCC的CSRIC最佳实践，我的最佳建议是先解决简单问题，以避免这些问题频繁发生并消耗资源。这可以让他们专注于更重要和复杂的事件或攻击。根据我能预测的情况和对数据的分析。

![](../Images/01f7dec0f4c03bc987d72b6290a162a2.png)

简单问题：

+   不同的电缆

+   颜色编码电缆

+   改善仓库通风

+   增加电力容量

+   更好的硬件

+   天线间距

![](../Images/b66fa8ec368b2c891e0a298da5eb282c.png)

中等问题：

+   利用网络监控

+   在可行的情况下提供安全的电气软件

+   为新硬件和软件找出阈值

+   病毒防护

![](../Images/ce63df369ea4719967572ba1ca60e2d1.png)

复杂问题：

+   最小化单点故障和软件缺陷

+   设备管理架构

+   安全网络/加密系统

**简介: [Aakash Sharma](https://www.linkedin.com/in/aakashsharma21/)** 是数据科学家、数据分析师、网络安全工程师、全栈软件开发者，以及机器学习与人工智能爱好者。

[原文](https://towardsdatascience.com/reddit-post-classification-b70258d6affe)。经允许转载。

**相关:**

+   [机器学习安全](/2019/01/machine-learning-security.html)

+   [PySyft 和私人深度学习的兴起](/2019/06/pysyft-emergence-deep-learning.html)

+   [大数据分析帮助转变的前5个领域](/2018/11/top-5-domains-big-data-analytics.html)

### 更多相关话题

+   [GPT-4 对提示注入攻击导致虚假信息的脆弱性](https://www.kdnuggets.com/2023/05/gpt4-vulnerable-prompt-injection-attacks-causing-misinformation.html)

+   [准备好通过网络安全硕士学位来管理威胁…](https://www.kdnuggets.com/2022/07/baypath-prepared-manage-threat-ms-cybersecurity.html)

+   [准备好通过网络安全硕士学位来管理威胁…](https://www.kdnuggets.com/2022/12/baypath-prepared-manage-threat-ms-cybersecurity.html)

+   [在 Python 中应用描述性和推断统计](https://www.kdnuggets.com/applying-descriptive-and-inferential-statistics-in-python)

+   [AI 自动化网络安全：应该自动化什么？](https://www.kdnuggets.com/ai-automated-cybersecurity-what-to-automate)

+   [通过构建 15 个神经网络项目学习深度学习（2022 年）](https://www.kdnuggets.com/2022/01/15-neural-network-projects-build-2022.html)
