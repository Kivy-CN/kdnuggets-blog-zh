# 你会在泰坦尼克号上幸存吗？Python 中的机器学习指南 第二部分

> 原文：[https://www.kdnuggets.com/2016/07/titanic-machine-learning-guide-part-2.html](https://www.kdnuggets.com/2016/07/titanic-machine-learning-guide-part-2.html)

**Patrick Triest, SocialCops**。

> **编辑备注**：这是关于使用 Python 进行机器学习的三部分入门系列的第二部分。如果需要，请首先查看 [昨天的文章](/2016/07/titanic-machine-learning-guide-part-1.html)。

**为什么是机器学习？**

我们可以从这些数据中得出一些相当简单的结论：女性、处于头等舱和儿童都是在这场灾难中提高生存几率的因素。

假设我们想编写一个程序来预测给定乘客是否会在灾难中幸存。这可以通过一个复杂的嵌套 if-else 语句系统以及某种加权评分系统来完成，但这样的程序将会很长，编写起来繁琐，难以概括，并且需要广泛的微调。

这就是机器学习的作用所在：我们将构建一个从样本数据中学习的程序，以预测给定乘客是否会生存。

**准备数据**

在将数据集输入到机器学习算法之前，我们必须移除缺失值，并将数据集拆分为训练集和测试集。

如果我们对每一列进行计数，我们会发现某些字段的数据缺失严重。大多数机器学习算法难以处理缺失值，因此我们需要确保每一行在每一列中都有一个值。

```py
titanic_df.count()

```

```py
pclass       1309
survived     1309
name         1309
sex          1309
age          1046
sibsp        1309
parch        1309
ticket       1309
fare         1308
cabin         295
embarked     1307
boat          486
body          121
home.dest     745
dtype: int64
```

```py
titanic_df = titanic_df.drop(['body','cabin','boat'], axis=1)
titanic_df["home.dest"] = titanic_df["home.dest"].fillna("NA")
titanic_df = titanic_df.dropna()
titanic_df.count()

```

```py
pclass       1043
survived     1043
name         1043
sex          1043
age          1043
sibsp        1043
parch        1043
ticket       1043
fare         1043
embarked     1043
home.dest    1043
dtype: int64

```

*[点击这里查看概要。](https://gist.github.com/triestpa/257c261111b03fede4e2580017a21727)*

大多数行缺少“boat”和“cabin”字段的值，因此我们将从数据框中移除这些列。还有大量的行缺少“home.dest”字段；在这里我们将缺失值填充为“NA”。还有相当多的行缺少年龄值。我们上面已经看到，年龄可能会对生存机会产生显著影响，因此我们需要删除所有缺少年龄值的行。当我们再次运行计数命令时，可以看到所有剩余的列现在包含相同数量的值。

现在我们需要以机器学习算法可以接受的方式格式化剩余的数据。

```py
def preprocess_titanic_df(df):
    processed_df = df.copy()
    le = preprocessing.LabelEncoder()
    processed_df.sex = le.fit_transform(processed_df.sex)
    processed_df.embarked = le.fit_transform(processed_df.embarked)
    processed_df = processed_df.drop(['name','ticket','home.dest'],axis=1)
    return processed_df

processed_df = preprocess_titanic_df(titanic_df)

```

*[点击这里查看概要。](https://gist.github.com/triestpa/e10aff22cb9c2945142735dc0d315723)*

“性别”和“登船港口”字段都是对应于类别（即“男性”和“女性”）的字符串值，因此我们将每个字段通过预处理器。这一预处理器将这些字符串转换为整数键，使得分类算法更容易找到模式。例如，“男性”和“女性”将分别转换为0和1。“姓名”、“票号”和“家乡”列包含非类别的字符串值，因此在分类算法中使用起来比较困难，我们将从数据集中删除这些列。

```py
X = processed_df.drop(['survived'], axis=1).values
y = processed_df['survived'].values

X_train, X_test, y_train, y_test = cross_validation.train_test_split(X,y,test_size=0.2)

```

*[点击这里查看要点。](https://gist.github.com/triestpa/0bce50e357c6c5f19811b975c5f9b604)*

接下来，我们将数据集分为两个数组，“X”包含每行的所有值，除了“是否幸存”，而“y”仅包含该行的“是否幸存”值。分类算法将比较“X”的属性值与“y”的对应值，以检测不同属性值如何影响乘客的生存。

最后，我们将“X”和“y”数组分别拆分成两个部分——一个训练集和一个测试集。我们将训练集输入分类算法，以形成一个训练好的模型。模型形成后，我们将使用它来对测试集进行分类，从而确定模型的准确性。在这里，我们进行了20/80的拆分，其中80%的数据集用于训练，20%用于测试。

* * *

## 我们的前三大课程推荐

![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 1\. [谷歌网络安全证书](https://www.kdnuggets.com/google-cybersecurity) - 快速进入网络安全职业轨道。

![](../Images/e225c49c3c91745821c8c0368bf04711.png) 2\. [谷歌数据分析专业证书](https://www.kdnuggets.com/google-data-analytics) - 提升你的数据分析技能

![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 3\. [谷歌IT支持专业证书](https://www.kdnuggets.com/google-itsupport) - 支持你的组织IT工作

* * *

### 更多相关内容

+   [数据科学家需要专业化才能在科技寒冬中生存](https://www.kdnuggets.com/2023/08/data-scientists-need-specialize-survive-tech-winter.html)

+   [如果我必须重新开始学习数据科学，我会怎么做？](https://www.kdnuggets.com/2020/08/start-learning-data-science-again.html)

+   [什么时候集成技术会是一个好的选择？](https://www.kdnuggets.com/2022/07/would-ensemble-techniques-good-choice.html)

+   [数据科学面试指南 - 第2部分：面试资源](https://www.kdnuggets.com/2022/04/data-science-interview-guide-part-2-interview-resources.html)

+   [数据科学面试指南 - 第1部分：结构](https://www.kdnuggets.com/2022/04/data-science-interview-guide-part-1-structure.html)

+   [想成为数据科学家？第1部分：你需要的10项硬技能](https://www.kdnuggets.com/want-to-become-a-data-scientist-part-1-10-hard-skills-you-need)
