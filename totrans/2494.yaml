- en: Introduction to Binary Classification with PyCaret
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: PyCaret 的二分类简介
- en: 原文：[https://www.kdnuggets.com/2021/12/introduction-binary-classification-pycaret.html](https://www.kdnuggets.com/2021/12/introduction-binary-classification-pycaret.html)
  id: totrans-1
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 原文：[https://www.kdnuggets.com/2021/12/introduction-binary-classification-pycaret.html](https://www.kdnuggets.com/2021/12/introduction-binary-classification-pycaret.html)
- en: '[comments](#comments)'
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: '[评论](#comments)'
- en: '**By [Moez Ali](https://www.linkedin.com/in/profile-moez/), Founder & Author
    of PyCaret**'
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: '**由 [Moez Ali](https://www.linkedin.com/in/profile-moez/)，PyCaret 的创始人及作者**'
- en: '![](../Images/48f8e698fa3c51848935be2eaccf13c0.png)'
  id: totrans-4
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/48f8e698fa3c51848935be2eaccf13c0.png)'
- en: Photo by [Mike U](https://unsplash.com/@roguewild?utm_source=medium&utm_medium=referral) on [Unsplash](https://unsplash.com/?utm_source=medium&utm_medium=referral)
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: 由 [Mike U](https://unsplash.com/@roguewild?utm_source=medium&utm_medium=referral)
    在 [Unsplash](https://unsplash.com/?utm_source=medium&utm_medium=referral) 提供的照片
- en: '* * *'
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: '* * *'
- en: Our Top 3 Course Recommendations
  id: totrans-7
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 我们的前三个课程推荐
- en: '![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 1\. [Google Cybersecurity
    Certificate](https://www.kdnuggets.com/google-cybersecurity) - Get on the fast
    track to a career in cybersecurity.'
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: '![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 1. [Google 网络安全证书](https://www.kdnuggets.com/google-cybersecurity)
    - 快速进入网络安全职业。'
- en: '![](../Images/e225c49c3c91745821c8c0368bf04711.png) 2\. [Google Data Analytics
    Professional Certificate](https://www.kdnuggets.com/google-data-analytics) - Up
    your data analytics game'
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: '![](../Images/e225c49c3c91745821c8c0368bf04711.png) 2. [Google 数据分析专业证书](https://www.kdnuggets.com/google-data-analytics)
    - 提升你的数据分析技能'
- en: '![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 3\. [Google IT Support
    Professional Certificate](https://www.kdnuggets.com/google-itsupport) - Support
    your organization in IT'
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: '![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 3. [Google IT 支持专业证书](https://www.kdnuggets.com/google-itsupport)
    - 支持你的组织 IT'
- en: '* * *'
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: '* * *'
- en: 1.0 Introduction
  id: totrans-12
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 1.0 简介
- en: '[PyCaret](https://www.pycaret.org/) is an open-source, low-code machine learning
    library in Python that automates machine learning workflows. It is an end-to-end
    machine learning and model management tool that speeds up the experiment cycle
    exponentially and makes you more productive.'
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: '[PyCaret](https://www.pycaret.org/) 是一个开源的低代码机器学习库，它自动化机器学习工作流。它是一个端到端的机器学习和模型管理工具，可以显著加快实验周期，提高生产力。'
- en: In comparison with the other open-source machine learning libraries, PyCaret
    is an alternate low-code library that can be used to replace hundreds of lines
    of code with few lines only. This makes experiments exponentially fast and efficient.
    PyCaret is essentially a Python wrapper around several machine learning libraries
    and frameworks such as scikit-learn, XGBoost, LightGBM, CatBoost, spaCy, Optuna,
    Hyperopt, Ray, and a few more.
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 与其他开源机器学习库相比，PyCaret 是一个替代的低代码库，可以用少量代码替代成百上千行代码。这使得实验过程极其快速高效。PyCaret 本质上是几个机器学习库和框架的
    Python 包装器，例如 scikit-learn、XGBoost、LightGBM、CatBoost、spaCy、Optuna、Hyperopt、Ray
    等。
- en: The design and simplicity of PyCaret are inspired by the emerging role of citizen
    data scientists, a term first used by Gartner. Citizen Data Scientists are power
    users who can perform both simple and moderately sophisticated analytical tasks
    that would previously have required more technical expertise.
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: PyCaret 的设计和简洁性受到“公民数据科学家”这一新兴角色的启发，这一术语首次由 Gartner 提出。公民数据科学家是能够执行简单和中等复杂度分析任务的高级用户，这些任务之前需要更多技术专长。
- en: To learn more about PyCaret, you can check the official [website](https://www.pycaret.org/) or [GitHub](https://www.github.com/pycaret/pycaret).
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 要了解更多关于 PyCaret 的信息，你可以查看官方 [网站](https://www.pycaret.org/) 或 [GitHub](https://www.github.com/pycaret/pycaret)。
- en: 2.0 Tutorial Objective
  id: totrans-17
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 2.0 教程目标
- en: 'In this tutorial we will learn:'
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 在本教程中，我们将学习：
- en: '**Getting Data:** How to import data from the PyCaret repository'
  id: totrans-19
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**获取数据：** 如何从 PyCaret 仓库导入数据'
- en: '**Setting up Environment:** How to set up an experiment in PyCaret and get
    started with building classification models'
  id: totrans-20
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**设置环境：** 如何在 PyCaret 中设置实验并开始构建分类模型'
- en: '**Create Model:** How to create a model, perform stratified cross-validation
    and evaluate classification metrics'
  id: totrans-21
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**创建模型：** 如何创建模型，进行分层交叉验证并评估分类指标'
- en: '**Tune Model:** How to automatically tune the hyper-parameters of a classification
    model'
  id: totrans-22
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**调整模型：** 如何自动调整分类模型的超参数'
- en: '**Plot Model:** How to analyze model performance using various plots'
  id: totrans-23
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**绘制模型：** 如何使用各种图表分析模型性能'
- en: '**Finalize Model:** How to finalize the best model at the end of the experiment'
  id: totrans-24
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**最终确定模型：** 如何在实验结束时确定最佳模型'
- en: '**Predict Model:** How to make predictions on unseen data'
  id: totrans-25
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**预测模型：** 如何对未见数据进行预测'
- en: '**Save / Load Model:** How to save/load a model for future use'
  id: totrans-26
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**保存/加载模型：** 如何保存/加载模型以供将来使用'
- en: 3.0 Installing PyCaret
  id: totrans-27
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 3.0 安装 PyCaret
- en: Installation is easy and will only take a few minutes. PyCaret’s default installation
    from pip only installs hard dependencies as listed in the [requirements.txt](https://github.com/pycaret/pycaret/blob/master/requirements.txt) file.
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: 安装过程简单，只需几分钟。PyCaret 从 pip 的默认安装仅安装了 [requirements.txt](https://github.com/pycaret/pycaret/blob/master/requirements.txt)
    文件中列出的硬依赖。
- en: '[PRE0]'
  id: totrans-29
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'To install the full version:'
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: 要安装完整版本：
- en: '[PRE1]'
  id: totrans-31
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: 4.0 What is Binary Classification?
  id: totrans-32
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 4.0 什么是二分类？
- en: 'Binary classification is a supervised machine learning technique where the
    goal is to predict categorical class labels which are discrete and unordered such
    as Pass/Fail, Positive/Negative, Default/Not-Default, etc. A few real-world use
    cases for classification are listed below:'
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: 二分类是一种监督式机器学习技术，目标是预测离散且无序的类别标签，如合格/不合格、正面/负面、违约/非违约等。以下是一些分类的实际应用案例：
- en: Medical testing to determine if a patient has a certain disease or not — the
    classification property is the presence of the disease.
  id: totrans-34
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 医疗检测以确定患者是否患有某种疾病——分类属性是疾病的存在。
- en: A “pass or fail” test method or quality control in factories, i.e. deciding
    if a specification has or has not been met — a go/no-go classification.
  id: totrans-35
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 工厂中的“合格或不合格”测试方法或质量控制，即决定是否满足规范——一种合格/不合格的分类。
- en: Information retrieval, namely deciding whether a page or an article should be
    in the result set of a search or not — the classification property is the relevance
    of the article or the usefulness to the user.
  id: totrans-36
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 信息检索，即决定一个页面或文章是否应出现在搜索结果中——分类属性是文章的相关性或对用户的有用性。
- en: 5.0 Overview of the Classification Module in PyCaret
  id: totrans-37
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 5.0 PyCaret中的分类模块概述
- en: PyCaret’s [classification module](https://pycaret.readthedocs.io/en/latest/api/classification.html) (`pycaret.classification`)
    is a supervised machine learning module that is used for classifying the elements
    into a binary group based on various techniques and algorithms. Some common use
    cases of classification problems include predicting customer default (yes or no),
    customer churn (customer will leave or stay), disease found (positive or negative).
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: PyCaret 的 [分类模块](https://pycaret.readthedocs.io/en/latest/api/classification.html)
    (`pycaret.classification`) 是一个监督式机器学习模块，用于根据各种技术和算法将元素分类到二进制组中。一些常见的分类问题的应用包括预测客户违约（是或否）、客户流失（客户是否会离开或留下）、疾病检测（阳性或阴性）。
- en: The PyCaret classification module can be used for Binary or Multi-class classification
    problems. It has over 18 algorithms and 14 plots to analyze the performance of
    models. Be it hyper-parameter tuning, ensembling, or advanced techniques like
    stacking, PyCaret’s classification module has it all.
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: PyCaret的分类模块可用于二分类或多分类问题。它有超过18种算法和14种图表来分析模型的性能。不论是超参数调优、集成方法，还是像堆叠这样的高级技术，PyCaret的分类模块都可以满足需求。
- en: 6.0 Dataset for the Tutorial
  id: totrans-40
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 6.0 教程数据集
- en: 'For this tutorial, we will use a dataset from UCI called [**Default of Credit
    Card Clients Dataset**](https://archive.ics.uci.edu/ml/datasets/default+of+credit+card+clients).
    This dataset contains information on default payments, demographic factors, credit
    data, payment history, and billing statements of credit card clients in Taiwan
    from April 2005 to September 2005\. There are 24,000 samples and 25 features.
    Short descriptions of each column are as follows:'
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: 在本教程中，我们将使用来自 UCI 的数据集，[**信用卡客户违约数据集**](https://archive.ics.uci.edu/ml/datasets/default+of+credit+card+clients)。该数据集包含了2005年4月到2005年9月在台湾的信用卡客户的违约支付信息、人口统计因素、信用数据、支付历史和账单报表，共有24,000个样本和25个特征。每一列的简要描述如下：
- en: '**ID:** ID of each client'
  id: totrans-42
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**ID：** 每个客户的ID'
- en: '**LIMIT_BAL:** Amount of given credit in NT dollars (includes individual and
    family/supplementary credit)'
  id: totrans-43
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**信用额度：** 以新台币为单位的信用额度（包括个人和家庭/附加信用）'
- en: '**SEX:** Gender (1=male, 2=female)'
  id: totrans-44
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**性别：** 性别（1=男，2=女）'
- en: '**EDUCATION:** (1=graduate school, 2=university, 3=high school, 4=others, 5=unknown,
    6=unknown)'
  id: totrans-45
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**教育程度：** （1=研究生，2=大学，3=高中，4=其他，5=未知，6=未知）'
- en: '**MARRIAGE:** Marital status (1=married, 2=single, 3=others)'
  id: totrans-46
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**婚姻状况：** 婚姻状态（1=已婚，2=单身，3=其他）'
- en: '**AGE:** Age in years'
  id: totrans-47
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**年龄：** 年龄（以年为单位）'
- en: '**PAY_0 to PAY_6:** Repayment status by n months ago (PAY_0 = last month …
    PAY_6 = 6 months ago) (Labels: -1=pay duly, 1=payment delay for one month, 2=payment
    delay for two months, … 8=payment delay for eight months, 9=payment delay for
    nine months and above)'
  id: totrans-48
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**PAY_0 到 PAY_6：** 几个月前的还款状态（PAY_0 = 上个月 … PAY_6 = 6 个月前）（标签：-1=按时还款，1=逾期一个月，2=逾期两个月，…
    8=逾期八个月，9=逾期九个月及以上）'
- en: '**BILL_AMT1 to BILL_AMT6:** Amount of bill statement by n months ago ( BILL_AMT1
    = last_month .. BILL_AMT6 = 6 months ago)'
  id: totrans-49
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**BILL_AMT1 到 BILL_AMT6：** 几个月前的账单金额（ BILL_AMT1 = 上个月 .. BILL_AMT6 = 6 个月前）'
- en: '**PAY_AMT1 to PAY_AMT6:** Amount of payment by n months ago ( BILL_AMT1 = last_month
    .. BILL_AMT6 = 6 months ago)'
  id: totrans-50
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**PAY_AMT1 到 PAY_AMT6：** 几个月前的支付金额（ BILL_AMT1 = 上个月 .. BILL_AMT6 = 6 个月前）'
- en: '**default:** Default payment (1=yes, 0=no) `Target Column`'
  id: totrans-51
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**默认值：** 默认支付（1=是，0=否） `Target Column`'
- en: 'Dataset Acknowledgement:'
  id: totrans-52
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 数据集致谢：
- en: 'Lichman, M. (2013). UCI Machine Learning Repository. Irvine, CA: University
    of California, School of Information and Computer Science.'
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: Lichman, M. (2013). UCI 机器学习库。加利福尼亚州欧文市：加利福尼亚大学信息与计算机科学学院。
- en: 7.0 Getting the Data
  id: totrans-54
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 7.0 获取数据
- en: You can download the data from the original source [**found here**](https://archive.ics.uci.edu/ml/datasets/default+of+credit+card+clients) and
    load it using pandas [**(learn how)**](https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.read_csv.html) or
    you can use PyCaret’s data repository to load the data using the `get_data()` function
    (This will require an internet connection).
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以从原始来源下载数据 [**在这里找到**](https://archive.ics.uci.edu/ml/datasets/default+of+credit+card+clients)
    并使用 pandas [**（学习如何）**](https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.read_csv.html)
    加载数据，或者你可以使用 PyCaret 的数据仓库，通过 `get_data()` 函数加载数据（这需要互联网连接）。
- en: '[PRE2]'
  id: totrans-56
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: '![png](../Images/15c6708db0c28339c5fa0fff910992c8.png)'
  id: totrans-57
  prefs: []
  type: TYPE_IMG
  zh: '![png](../Images/15c6708db0c28339c5fa0fff910992c8.png)'
- en: '[PRE3]'
  id: totrans-58
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: In order to demonstrate the use of the `predict_model` function on unseen data,
    a sample of 1200 records (~5%) has been withheld from the original dataset to
    be used for predictions at the end. This should not be confused with a train-test-split,
    as this particular split is performed to simulate a real-life scenario. Another
    way to think about this is that these 1200 customers are not available at the
    time of training of machine learning models.
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: 为了演示 `predict_model` 函数在未见数据上的使用，原始数据集中保留了 1200 条记录（约 5%）以用于最后的预测。这不应与训练-测试-拆分混淆，因为这种特定的拆分是为了模拟真实场景。另一种理解方式是，这
    1200 名客户在训练机器学习模型时不可用。
- en: '[PRE4]'
  id: totrans-60
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: 8.0 Setting up Environment in PyCaret
  id: totrans-61
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 8.0 在 PyCaret 中设置环境
- en: 'The `setup` function in PyCaret initializes the environment and creates the
    transformation pipeline for modeling and deployment. `setup` must be called before
    executing any other function in pycaret. It takes two mandatory parameters: a
    pandas dataframe and the name of the target column. All other parameters are optional
    can be used to customize the preprocessing pipeline.'
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: PyCaret 中的 `setup` 函数初始化环境并创建建模和部署的转换管道。在执行 pycaret 的任何其他函数之前，必须调用 `setup`。它需要两个必需的参数：一个
    pandas dataframe 和目标列的名称。所有其他参数是可选的，可以用于自定义预处理管道。
- en: When `setup` is executed, PyCaret's inference algorithm will automatically infer
    the data types for all features based on certain properties. The data type should
    be inferred correctly but this is not always the case. To handle this, PyCaret
    displays a prompt, asking for data types confirmation, once you execute the `setup`.
    You can press enter if all data types are correct or type `quit` to exit the setup.
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: 当 `setup` 执行时，PyCaret 的推断算法将根据某些属性自动推断所有特征的数据类型。数据类型应该被正确推断，但这并不总是如此。为此，PyCaret
    会在你执行 `setup` 后显示一个提示，要求确认数据类型。如果所有数据类型正确，你可以按回车键，如果要退出设置，输入 `quit`。
- en: Ensuring that the data types are correct is really important in PyCaret as it
    automatically performs multiple type-specific preprocessing tasks which are imperative
    for machine learning models.
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: 确保数据类型正确在 PyCaret 中非常重要，因为它会自动执行多种特定类型的预处理任务，这对机器学习模型至关重要。
- en: Alternatively, you can also use `numeric_features` and `categorical_features` parameters
    in the `setup` to pre-define the data types.
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: 另外，你还可以在 `setup` 中使用 `numeric_features` 和 `categorical_features` 参数来预定义数据类型。
- en: '[PRE5]'
  id: totrans-66
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: '![png](../Images/f5680fa7ac99aa4cf1de46adb02b05af.png)'
  id: totrans-67
  prefs: []
  type: TYPE_IMG
  zh: '![png](../Images/f5680fa7ac99aa4cf1de46adb02b05af.png)'
- en: 'Once the setup has been successfully executed it displays the information grid
    which contains some important information about the experiment. Most of the information
    is related to the pre-processing pipeline which is constructed when `setup` is
    executed. The majority of these features are out of scope for this tutorial, however,
    a few important things to note are:'
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦设置成功执行，它会显示包含实验重要信息的信息网格。大部分信息与执行`setup`时构建的预处理管道相关。这些特性大多数超出了本教程的范围，但需要注意以下几个重要点：
- en: '**session_id:** A pseudo-random number distributed as a seed in all functions
    for later reproducibility. If no `session_id` is passed, a random number is automatically
    generated that is distributed to all functions. In this experiment, the `session_id` is
    set as `123` for later reproducibility.'
  id: totrans-69
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**session_id：** 作为种子分配给所有函数的伪随机数，以便后续可重复性。如果没有传递`session_id`，则会自动生成一个随机数，并分配给所有函数。在本实验中，`session_id`设置为`123`以确保后续可重复性。'
- en: '**Target Type:** Binary or Multiclass. The Target type is automatically detected
    and shown. There is no difference in how the experiment is performed for Binary
    or Multiclass problems. All functionalities are identical.'
  id: totrans-70
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**目标类型：** 二分类或多分类。目标类型会自动检测并显示。二分类和多分类问题在实验执行方式上没有区别。所有功能都是相同的。'
- en: '**Label Encoded:** When the Target variable is of type string (i.e. ‘Yes’ or
    ‘No’) instead of 1 or 0, it automatically encodes the label into 1 and 0 and displays
    the mapping (0: No, 1: Yes) for reference. In this experiment, no label encoding
    is required since the target variable is of type numeric.'
  id: totrans-71
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**标签编码：** 当目标变量是字符串类型（即‘Yes’或‘No’）而不是1或0时，它会自动将标签编码为1和0，并显示映射（0: No, 1: Yes）供参考。在本实验中，由于目标变量是数值型，因此不需要标签编码。'
- en: '**Original Data:** Displays the original shape of the dataset. In this experiment
    (22800, 24) means 22,800 samples and 24 features including the target column.'
  id: totrans-72
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**原始数据：** 显示数据集的原始形状。在本实验中，（22800, 24）表示22,800个样本和包括目标列在内的24个特征。'
- en: '**Missing Values:** When there are missing values in the original data this
    will show as True. For this experiment, there are no missing values in the dataset.'
  id: totrans-73
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**缺失值：** 当原始数据中存在缺失值时，这里会显示为True。在本实验中，数据集中没有缺失值。'
- en: '**Numeric Features:** The number of features inferred as numeric. In this dataset,
    14 out of 24 features are inferred as numeric.'
  id: totrans-74
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**数值特征：** 推断出的数值型特征数量。在此数据集中，24个特征中有14个被推断为数值型。'
- en: '**Categorical Features:** The number of features inferred as categorical. In
    this dataset, 9 out of 24 features are inferred as categorical.'
  id: totrans-75
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**分类特征：** 推断出的分类特征数量。在此数据集中，24个特征中有9个被推断为分类特征。'
- en: '**Transformed Train Set:** Displays the shape of the transformed training set.
    Notice that the original shape of (22800, 24) is transformed into (15959, 91)
    for the transformed train set and the number of features has increased to 91 from
    24 due to one-hot-encoding.'
  id: totrans-76
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**转化后的训练集：** 显示转化后的训练集的形状。注意，原始形状（22800, 24）被转化为（15959, 91），并且由于独热编码，特征数量从24增加到91。'
- en: '**Transformed Test Set:** Displays the shape of the transformed test/hold-out
    set. There are 6841 samples in the test/hold-out set. This split is based on the
    default value of 70/30 that can be changed using the `train_size` parameter in
    the setup.'
  id: totrans-77
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**转化后的测试集：** 显示转化后的测试/持留集的形状。测试/持留集中有6841个样本。这个分割基于默认值70/30，可以通过`train_size`参数在设置中进行更改。'
- en: Notice how a few tasks that are imperative to perform modeling are automatically
    handled such as missing value imputation (in this case there are no missing values
    in the training data, but we still need imputers for unseen data), categorical
    encoding, etc. Most of the parameters in the `setup` are optional and used for
    customizing the pre-processing pipeline. These parameters are out of scope for
    this tutorial but we will cover them in future tutorials.
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: 注意，一些对建模至关重要的任务是自动处理的，例如缺失值插补（在这种情况下，训练数据中没有缺失值，但我们仍然需要插补器来处理未见数据）、分类编码等。`setup`中的大部分参数是可选的，用于自定义预处理管道。这些参数超出了本教程的范围，但我们会在未来的教程中涵盖它们。
- en: 9.0 Comparing All Models
  id: totrans-79
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 9.0 比较所有模型
- en: Comparing all models to evaluate performance is the recommended starting point
    for modeling once the setup is completed (unless you exactly know what kind of
    model you need, which is often not the case). This function trains all models
    in the model library and scores them using stratified cross-validation for metric
    evaluation. The output prints a scoring grid that shows average Accuracy, AUC,
    Recall, Precision, F1, Kappa, and MCC across the folds (10 by default) along with
    training times.
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: 比较所有模型以评估性能是完成设置后的推荐起点（除非你确切知道需要哪种模型，这种情况通常不常见）。此功能会训练模型库中的所有模型，并使用分层交叉验证进行指标评估。输出会打印一个评分网格，显示各折（默认10折）的平均准确率、AUC、召回率、精确率、F1
    分数、Kappa 值和 MCC，以及训练时间。
- en: '[PRE6]'
  id: totrans-81
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: '![](../Images/f55c8b9473ff0d8d18ea4fbad477ffea.png)'
  id: totrans-82
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/f55c8b9473ff0d8d18ea4fbad477ffea.png)'
- en: The scoring grid printed above highlights the highest performing metric for
    comparison purposes only. The grid by default is sorted using `Accuracy `(highest
    to lowest) which can be changed by passing the `sort` parameter. For example `compare_models(sort
    = 'Recall')` will sort the grid by recall instead of accuracy.
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: 上述打印的评分网格仅突出显示了用于比较的最高性能指标。网格默认按 `Accuracy`（从高到低）排序，可以通过传递 `sort` 参数进行更改。例如
    `compare_models(sort = 'Recall')` 将按召回率而不是准确率对网格进行排序。
- en: If you want to change the fold parameter from the default value of `10` to a
    different value then you can use the `fold` parameter. For example `compare_models(fold
    = 5)` will compare all models on 5 fold cross-validation. Reducing the number
    of folds will improve the training time. By default, `compare_models` return the
    best performing model based on default sort order but can be used to return a
    list of top N models by using `n_select` parameter.
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你想将折数参数从默认值 `10` 更改为其他值，可以使用 `fold` 参数。例如 `compare_models(fold = 5)` 将在 5
    折交叉验证上比较所有模型。减少折数将提高训练时间。默认情况下，`compare_models` 返回基于默认排序顺序的最佳表现模型，但也可以通过使用 `n_select`
    参数返回前 N 个模型的列表。
- en: '[PRE7]'
  id: totrans-85
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: 10.0 Create a Model
  id: totrans-86
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 10.0 创建模型
- en: '`create_model` is the most granular function in PyCaret and is often the foundation
    behind most of the PyCaret functionalities. As the name suggests this function
    trains and evaluates a model using cross-validation that can be set with `fold` parameter.
    The output prints a scoring grid that shows Accuracy, AUC, Recall, Precision,
    F1, Kappa, and MCC by fold.'
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: '`create_model` 是 PyCaret 中最细粒度的功能，通常是大多数 PyCaret 功能的基础。顾名思义，此功能使用交叉验证来训练和评估模型，交叉验证的折数可以通过
    `fold` 参数设置。输出会打印一个评分网格，显示各折的准确率、AUC、召回率、精确率、F1 分数、Kappa 值和 MCC。'
- en: For the remaining part of this tutorial, we will work with the below models
    as our candidate models. The selections are for illustration purposes only and
    do not necessarily mean they are the top-performing or ideal for this type of
    data.
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: 在本教程的剩余部分，我们将使用下列模型作为我们的候选模型。选择这些模型仅用于说明目的，并不一定意味着它们在此类型数据中表现最佳或最为理想。
- en: Decision Tree Classifier (‘dt’)
  id: totrans-89
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 决策树分类器（‘dt’）
- en: K Neighbors Classifier (‘knn’)
  id: totrans-90
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: K 近邻分类器（‘knn’）
- en: Random Forest Classifier (‘rf’)
  id: totrans-91
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 随机森林分类器（‘rf’）
- en: There are 18 classifiers available in the model library of PyCaret. To see a
    list of all classifiers either check the documentation or use `models` function
    to see the library.
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: PyCaret 模型库中有 18 个分类器。要查看所有分类器的列表，可以查阅文档或使用 `models` 函数查看库。
- en: '[PRE8]'
  id: totrans-93
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: '![](../Images/34973a5648847757697f30db20a4cd38.png)'
  id: totrans-94
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/34973a5648847757697f30db20a4cd38.png)'
- en: 10.1 Decision Tree Classifier
  id: totrans-95
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 10.1 决策树分类器
- en: '[PRE9]'
  id: totrans-96
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: '![](../Images/0968d4d67efa271f3665869ca1bd65ec.png)'
  id: totrans-97
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/0968d4d67efa271f3665869ca1bd65ec.png)'
- en: '[PRE10]'
  id: totrans-98
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: 10.2 K Neighbors Classifier
  id: totrans-99
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 10.2 K 近邻分类器
- en: '[PRE11]'
  id: totrans-100
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: '![](../Images/c99040f56cd8529088616aa3c46a2897.png)'
  id: totrans-101
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/c99040f56cd8529088616aa3c46a2897.png)'
- en: 10.3 Random Forest Classifier
  id: totrans-102
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 10.3 随机森林分类器
- en: '[PRE12]'
  id: totrans-103
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: '![](../Images/54259896a7c5696c43f0c0dbf4fc3cdc.png)'
  id: totrans-104
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/54259896a7c5696c43f0c0dbf4fc3cdc.png)'
- en: Notice that the mean score of all models matches with the score printed in `compare_models`.
    This is because the metrics printed in the `compare_models` score grid are the
    average scores across all CV folds. Similar to the`compare_models`, if you want
    to change the fold parameter from the default value of 10 to a different value
    then you can use the `fold` parameter. For Example: `create_model('dt', fold =
    5)` will create a Decision Tree Classifier using 5 fold stratified CV.
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: 请注意，所有模型的平均得分与 `compare_models` 中打印的得分一致。这是因为 `compare_models` 评分网格中的指标是所有交叉验证折的平均得分。类似于
    `compare_models`，如果你想将折数参数从默认值 10 更改为其他值，可以使用 `fold` 参数。例如：`create_model('dt',
    fold = 5)` 将使用 5 折分层交叉验证创建决策树分类器。
- en: 11.0 Tune a Model
  id: totrans-106
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 11.0 调整模型
- en: When a model is created using the `create_model` function it uses the default
    hyperparameters to train the model. In order to tune hyperparameters, the `tune_model` function
    is used. This function automatically tunes the hyperparameters of a model using
    random grid search on a pre-defined search space. The output prints a scoring
    grid that shows Accuracy, AUC, Recall, Precision, F1, Kappa, and MCC by fold for
    the best model. To use the custom search grid, you can pass `custom_grid` parameter
    in the `tune_model` function (see 11.2 KNN tuning below).
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: 当使用`create_model`函数创建模型时，它使用默认超参数来训练模型。为了调整超参数，使用`tune_model`函数。该函数通过在预定义的搜索空间上进行随机网格搜索，自动调整模型的超参数。输出会打印一个评分网格，显示最佳模型在各折中的准确度、AUC、召回率、精确度、F1分数、Kappa和MCC。要使用自定义搜索网格，可以在`tune_model`函数中传递`custom_grid`参数（请参见下面的11.2
    KNN调整）。
- en: 11.1 Decision Tree Classifier
  id: totrans-108
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 11.1 决策树分类器
- en: '[PRE13]'
  id: totrans-109
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: '![](../Images/74b345f9e28f7da429e4226b8c01ec64.png)'
  id: totrans-110
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/74b345f9e28f7da429e4226b8c01ec64.png)'
- en: '[PRE14]'
  id: totrans-111
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: 11.2 K Neighbors Classifier
  id: totrans-112
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 11.2 K 最近邻分类器
- en: '[PRE15]'
  id: totrans-113
  prefs: []
  type: TYPE_PRE
  zh: '[PRE15]'
- en: '![](../Images/bf1f90c108efa7e4fefe9b04c9e40744.png)'
  id: totrans-114
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/bf1f90c108efa7e4fefe9b04c9e40744.png)'
- en: '[PRE16]'
  id: totrans-115
  prefs: []
  type: TYPE_PRE
  zh: '[PRE16]'
- en: 11.3 Random Forest Classifier
  id: totrans-116
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 11.3 随机森林分类器
- en: '[PRE17]'
  id: totrans-117
  prefs: []
  type: TYPE_PRE
  zh: '[PRE17]'
- en: '![](../Images/bc41a57e4365ed095755adfc837fa15c.png)'
  id: totrans-118
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/bc41a57e4365ed095755adfc837fa15c.png)'
- en: By default, `tune_model` optimizes `Accuracy` but this can be changed using `optimize` parameter.
    For example: `tune_model(dt, optimize = 'AUC')` will search for the hyperparameters
    of a Decision Tree Classifier that results in the highest `AUC` instead of `Accuracy`.
    For the purposes of this example, we have used the default metric `Accuracy` only
    for the sake of simplicity. Generally, when the dataset is imbalanced (such as
    the credit dataset we are working with) `Accuracy` is not a good metric for consideration.
    The methodology behind selecting the right metric to evaluate a classifier is
    beyond the scope of this tutorial but if you would like to learn more about it,
    you can [**click here**](https://medium.com/@MohammedS/performance-metrics-for-classification-problems-in-machine-learning-part-i-b085d432082b) to
    read an article on how to choose the right evaluation metric.
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: 默认情况下，`tune_model`优化`Accuracy`，但可以通过`optimize`参数进行更改。例如：`tune_model(dt, optimize
    = 'AUC')`将搜索决策树分类器的超参数，以获得最高的`AUC`而不是`Accuracy`。为了简单起见，本示例仅使用了默认指标`Accuracy`。通常，当数据集不平衡（如我们正在处理的信用数据集）时，`Accuracy`不是一个好的评估指标。选择合适的指标来评估分类器的方法超出了本教程的范围，但如果你想了解更多，可以[**点击这里**](https://medium.com/@MohammedS/performance-metrics-for-classification-problems-in-machine-learning-part-i-b085d432082b)阅读一篇关于如何选择正确评估指标的文章。
- en: Metrics alone are not the only criteria you should consider when finalizing
    the best model for production. Other factors to consider include training time,
    the standard deviation of kfolds, etc. As you progress through the tutorial series
    we will discuss those factors in detail at the intermediate and expert levels.
    For now, let’s move forward considering the Tuned Random Forest Classifier `tuned_rf`,
    as our best model for the remainder of this tutorial.
  id: totrans-120
  prefs: []
  type: TYPE_NORMAL
  zh: 单独的指标并不是在最终确定最佳生产模型时唯一需要考虑的标准。其他需要考虑的因素包括训练时间、k折的标准差等。随着教程系列的深入，我们将在中级和高级阶段详细讨论这些因素。现在，让我们继续将调整后的随机森林分类器`tuned_rf`作为本教程剩余部分的最佳模型。
- en: 12.0 Plot a Model
  id: totrans-121
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 12.0 绘制模型
- en: Before model finalization, the `plot_model` function can be used to analyze
    the performance across different aspects such as AUC, confusion_matrix, decision
    boundary, etc. This function takes a trained model object and returns a plot based
    on the test set.
  id: totrans-122
  prefs: []
  type: TYPE_NORMAL
  zh: 在模型最终确定之前，可以使用`plot_model`函数分析各个方面的性能，例如AUC、混淆矩阵、决策边界等。该函数接受一个训练好的模型对象，并返回基于测试集的图形。
- en: There are 15 different plots available, please see the `plot_model` documentation
    for the list of available plots.
  id: totrans-123
  prefs: []
  type: TYPE_NORMAL
  zh: 提供了15种不同的图形，具体可查看`plot_model`文档中的可用图形列表。
- en: 12.1 AUC Plot
  id: totrans-124
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 12.1 AUC图
- en: '[PRE18]'
  id: totrans-125
  prefs: []
  type: TYPE_PRE
  zh: '[PRE18]'
- en: '![png](../Images/260e900d7f7ce14e00835b8521e2e381.png)'
  id: totrans-126
  prefs: []
  type: TYPE_IMG
  zh: '![png](../Images/260e900d7f7ce14e00835b8521e2e381.png)'
- en: 12.2 Precision-Recall Curve
  id: totrans-127
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 12.2 精确度-召回率曲线
- en: '[PRE19]'
  id: totrans-128
  prefs: []
  type: TYPE_PRE
  zh: '[PRE19]'
- en: '![png](../Images/b42330e418d905c9b44d8537032eec66.png)'
  id: totrans-129
  prefs: []
  type: TYPE_IMG
  zh: '![png](../Images/b42330e418d905c9b44d8537032eec66.png)'
- en: 12.3 Feature Importance Plot
  id: totrans-130
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 12.3 特征重要性图
- en: '[PRE20]'
  id: totrans-131
  prefs: []
  type: TYPE_PRE
  zh: '[PRE20]'
- en: '![png](../Images/98cf38d13d31e60982e9a3d7e7ab8583.png)'
  id: totrans-132
  prefs: []
  type: TYPE_IMG
  zh: '![png](../Images/98cf38d13d31e60982e9a3d7e7ab8583.png)'
- en: 12.4 Confusion Matrix
  id: totrans-133
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 12.4 混淆矩阵
- en: '[PRE21]'
  id: totrans-134
  prefs: []
  type: TYPE_PRE
  zh: '[PRE21]'
- en: '![png](../Images/03e51f3afc86070b952151346c2d1346.png)'
  id: totrans-135
  prefs: []
  type: TYPE_IMG
  zh: '![png](../Images/03e51f3afc86070b952151346c2d1346.png)'
- en: '*Another* way to analyze the performance of models is to use the `evaluate_model()` function
    which displays a user interface for all of the available plots for a given model.
    It internally uses the `plot_model()` function.'
  id: totrans-136
  prefs: []
  type: TYPE_NORMAL
  zh: '*另一种* 分析模型性能的方法是使用`evaluate_model()`函数，该函数为给定模型显示所有可用图表的用户界面。它内部使用了`plot_model()`函数。'
- en: '[PRE22]'
  id: totrans-137
  prefs: []
  type: TYPE_PRE
  zh: '[PRE22]'
- en: '![](../Images/c4072017a375237f83ce3b8b5dfce2e7.png)'
  id: totrans-138
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/c4072017a375237f83ce3b8b5dfce2e7.png)'
- en: 13.0 Predict on test / hold-out Sample
  id: totrans-139
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 13.0 对测试/持出样本进行预测
- en: Before finalizing the model, it is advisable to perform one final check by predicting
    the test/hold-out set and reviewing the evaluation metrics. If you look at the
    information grid in Section 8 above, you will see that 30% (6,841 samples) of
    the data has been separated out as a test/hold-out sample. All of the evaluation
    metrics we have seen above are cross-validated results based on the training set
    (70%). Now, using our final trained model stored in the `tuned_rf` we will predict
    the test / hold-out sample and evaluate the metrics to see if they are materially
    different than the CV results.
  id: totrans-140
  prefs: []
  type: TYPE_NORMAL
  zh: 在最终确定模型之前，建议通过预测测试/持出集并审查评估指标进行最后检查。如果你查看上文第8节中的信息网格，你会看到30%（6,841个样本）的数据被分离出来作为测试/持出样本。我们以上看到的所有评估指标都是基于训练集（70%）的交叉验证结果。现在，使用我们最终训练好的模型`tuned_rf`来预测测试/持出样本，并评估指标以查看它们是否与交叉验证结果有显著差异。
- en: '[PRE23]'
  id: totrans-141
  prefs: []
  type: TYPE_PRE
  zh: '[PRE23]'
- en: '![](../Images/b75a08012005a33bb198eef510c49c6b.png)'
  id: totrans-142
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/b75a08012005a33bb198eef510c49c6b.png)'
- en: The accuracy on the test/hold-out set is `**0.8116**` compared to `**0.8203**` achieved
    on the `tuned_rf` CV results (in section 11.3 above). This is not a significant
    difference. If there is a large variation between the test/hold-out and CV results,
    then this would normally indicate over-fitting but could also be due to several
    other factors and would require further investigation. In this case, we will move
    forward with finalizing the model and predicting on unseen data (the 5% that we
    had separated in the beginning and never exposed to PyCaret).
  id: totrans-143
  prefs: []
  type: TYPE_NORMAL
  zh: 测试/持出集上的准确率为`**0.8116**`，相比于`tuned_rf`交叉验证结果中的`**0.8203**`（在第11.3节中）。这不是一个显著的差异。如果测试/持出集和交叉验证结果之间有较大差异，这通常表示过拟合，但也可能由于其他几个因素，需要进一步调查。在这种情况下，我们将继续完成模型并对未见数据进行预测（即最初分离的5%数据，未暴露于PyCaret）。
- en: '(TIP: It’s always good to look at the standard deviation of CV results when
    using `create_model`)'
  id: totrans-144
  prefs: []
  type: TYPE_NORMAL
  zh: （提示：使用`create_model`时查看交叉验证结果的标准差总是好的）
- en: 14.0 Finalize Model for Deployment
  id: totrans-145
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 14.0 完成模型部署
- en: Model finalization is the last step in the experiment. A normal machine learning
    workflow in PyCaret starts with `setup`, followed by comparing all models using
    the `compare_models` and shortlisting a few candidate models (based on the metric
    of interest) to perform several modeling techniques such as hyperparameter tuning,
    ensembling, stacking, etc. This workflow will eventually lead you to the best
    model for use in making predictions on new and unseen data. The `finalize_model` function
    fits the model onto the complete dataset including the test/hold-out sample (30%
    in this case). The purpose of this function is to train the final model on the
    complete dataset before it is deployed in production. (This is optional, you may
    or may not use finalize_model).
  id: totrans-146
  prefs: []
  type: TYPE_NORMAL
  zh: 模型最终确定是实验中的最后一步。在PyCaret中，正常的机器学习工作流程从`setup`开始，然后使用`compare_models`比较所有模型，并基于感兴趣的指标筛选几个候选模型，以执行各种建模技术，如超参数调整、集成、堆叠等。这个工作流程最终将引导你找到最佳模型，用于对新数据和未见数据进行预测。`finalize_model`函数将模型拟合到完整数据集，包括测试/持出样本（在这种情况下是30%）。该函数的目的是在生产环境中部署之前，在完整数据集上训练最终模型。（这是可选的，你可以选择是否使用finalize_model）。
- en: '[PRE24]'
  id: totrans-147
  prefs: []
  type: TYPE_PRE
  zh: '[PRE24]'
- en: '**Caution:** One final word of caution. Once the model is finalized, the entire
    dataset including the test/hold-out set is used for training. As such, if the
    model is used for predictions on the hold-out set after `finalize_model` is used,
    the information grid printed will be misleading as you are trying to predict on
    the same data that was used for modeling. In order to demonstrate this point only,
    we will use `final_rf` under `predict_model` to compare the information grid with
    the one above in section 13.'
  id: totrans-148
  prefs: []
  type: TYPE_NORMAL
  zh: '**注意：** 最后一点提醒。一旦模型被最终确定，整个数据集，包括测试/持出集，都用于训练。因此，如果在使用`finalize_model`后对持出集进行预测，信息网格将会具有误导性，因为你是在尝试预测用于建模的相同数据。为了仅仅展示这一点，我们将使用`final_rf`在`predict_model`下与第13节中的信息网格进行比较。'
- en: '[PRE25]'
  id: totrans-149
  prefs: []
  type: TYPE_PRE
  zh: '[PRE25]'
- en: '![](../Images/a013e2bd953b01eed34d01815befc639.png)'
  id: totrans-150
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/a013e2bd953b01eed34d01815befc639.png)'
- en: Notice how the AUC in `final_rf` has increased to `**0.7526**` from `**0.7407**`,
    even though the model is the same. This is because the `final_rf` variable has
    been trained on the complete dataset including the test/hold-out set.
  id: totrans-151
  prefs: []
  type: TYPE_NORMAL
  zh: 请注意，尽管模型相同，`final_rf`中的AUC已经从`**0.7407**`增加到`**0.7526**`。这是因为`final_rf`变量已经在包括测试/保留集的完整数据集上进行了训练。
- en: 15.0 Predict on unseen data
  id: totrans-152
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 15.0 对未见数据进行预测
- en: The `predict_model` function is also used to predict on the unseen dataset.
    The only difference from section 13 above is that this time we will pass the `data_unseen`.
    It is the variable created at the beginning of this tutorial and contains 5% (1200
    samples) of the original dataset which was never exposed to PyCaret. (see section
    7 for explanation)
  id: totrans-153
  prefs: []
  type: TYPE_NORMAL
  zh: '`predict_model`函数也用于对未见数据集进行预测。与第13节不同的是，这次我们将传递`data_unseen`。这是在本教程开始时创建的变量，包含原始数据集的5%（1200个样本），这些样本从未暴露给PyCaret。（参见第7节了解解释）'
- en: '[PRE26]'
  id: totrans-154
  prefs: []
  type: TYPE_PRE
  zh: '[PRE26]'
- en: '![png](../Images/9bc7878a2506ae2f4784b4f9100094d2.png)'
  id: totrans-155
  prefs: []
  type: TYPE_IMG
  zh: '![png](../Images/9bc7878a2506ae2f4784b4f9100094d2.png)'
- en: 'The `Label` and `Score` columns are added onto the `data_unseen` set. The label
    is the prediction and the score is the probability of the prediction. Notice that
    predicted results are concatenated to the original dataset while all the transformations
    are automatically performed in the background. You can also check the metrics
    on this since you have an actual target column `default` available. To do that
    we will use `pycaret.utils` module. See the example below:'
  id: totrans-156
  prefs: []
  type: TYPE_NORMAL
  zh: '`Label`和`Score`列被添加到`data_unseen`数据集中。标签是预测值，分数是预测的概率。请注意，预测结果被连接到原始数据集中，同时所有的转换都在后台自动执行。由于您有实际的目标列`default`，您也可以检查这些指标。为此，我们将使用`pycaret.utils`模块。请参见下面的示例：'
- en: '[PRE27]'
  id: totrans-157
  prefs: []
  type: TYPE_PRE
  zh: '[PRE27]'
- en: 16.0 Saving the model
  id: totrans-158
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 16.0 保存模型
- en: 'We have now finished the experiment by finalizing the `tuned_rf` model which
    is now stored in `final_rf` variable. We have also used the model stored in `final_rf` to
    predict `data_unseen`. This brings us to the end of our experiment, but one question
    is still to be asked: What happens when you have more new data to predict? Do
    you have to go through the entire experiment again? The answer is no, PyCaret''s
    inbuilt function `save_model()` allows you to save the model along with the entire
    transformation pipeline for later use.'
  id: totrans-159
  prefs: []
  type: TYPE_NORMAL
  zh: 我们现在通过最终确定`tuned_rf`模型完成了实验，该模型现在存储在`final_rf`变量中。我们还使用存储在`final_rf`中的模型对`data_unseen`进行了预测。这标志着实验的结束，但仍有一个问题需要解决：当您有更多新的数据需要预测时会发生什么？您是否需要重新进行整个实验？答案是否定的，PyCaret内置的`save_model()`函数允许您保存模型及整个转换管道以备后用。
- en: '[PRE28]'
  id: totrans-160
  prefs: []
  type: TYPE_PRE
  zh: '[PRE28]'
- en: 17.0 Loading the saved model
  id: totrans-161
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 17.0 加载保存的模型
- en: To load a saved model at a future date in the same or an alternative environment,
    we would use PyCaret’s `load_model()` function and then easily apply the saved
    model on new unseen data for prediction.
  id: totrans-162
  prefs: []
  type: TYPE_NORMAL
  zh: 若要在将来在相同或其他环境中加载保存的模型，我们可以使用PyCaret的`load_model()`函数，然后轻松地在新的未见数据上应用保存的模型进行预测。
- en: '[PRE29]'
  id: totrans-163
  prefs: []
  type: TYPE_PRE
  zh: '[PRE29]'
- en: Once the model is loaded in the environment, you can simply use it to predict
    on any new data using the same `predict_model()` function. Below we have applied
    the loaded model to predict the same `data_unseen` that we used in section 13
    above.
  id: totrans-164
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦模型加载到环境中，您可以简单地使用相同的`predict_model()`函数对任何新数据进行预测。以下是我们将加载的模型应用于第13节中使用的相同`data_unseen`进行预测的示例。
- en: '[PRE30]'
  id: totrans-165
  prefs: []
  type: TYPE_PRE
  zh: '[PRE30]'
- en: '![png](../Images/9bc7878a2506ae2f4784b4f9100094d2.png)'
  id: totrans-166
  prefs: []
  type: TYPE_IMG
  zh: '![png](../Images/9bc7878a2506ae2f4784b4f9100094d2.png)'
- en: Notice that the results of `unseen_predictions` and `new_prediction` are identical.
  id: totrans-167
  prefs: []
  type: TYPE_NORMAL
  zh: 请注意，`unseen_predictions`和`new_prediction`的结果是相同的。
- en: '[PRE31]'
  id: totrans-168
  prefs: []
  type: TYPE_PRE
  zh: '[PRE31]'
- en: 18.0 Wrap-up / Next Steps?
  id: totrans-169
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 18.0 总结 / 下一步？
- en: This tutorial has covered the entire machine learning pipeline from data ingestion,
    pre-processing, training the model, hyperparameter tuning, prediction, and saving
    the model for later use. We have completed all of these steps in less than 10
    commands which are naturally constructed and very intuitive to remember such as `create_model()`, `tune_model()`, `compare_models()`.
    Re-creating the entire experiment without PyCaret would have taken well over 100
    lines of code in most libraries.
  id: totrans-170
  prefs: []
  type: TYPE_NORMAL
  zh: 本教程涵盖了整个机器学习流程，从数据摄取、预处理、训练模型、超参数调优、预测，到保存模型以备后用。我们在不到10个命令中完成了所有这些步骤，这些命令自然构造且易于记忆，如`create_model()`、`tune_model()`、`compare_models()`。没有PyCaret，重新创建整个实验将需要超过100行代码。
- en: We have only covered the basics of `pycaret.classification`. In the future tutorials
    we will go deeper into advanced pre-processing, ensembling, generalized stacking,
    and other techniques that allow you to fully customize your machine learning pipeline
    and are must know for any data scientist.
  id: totrans-171
  prefs: []
  type: TYPE_NORMAL
  zh: 我们仅覆盖了 `pycaret.classification` 的基础知识。在未来的教程中，我们将深入探讨高级预处理、集成、广义堆叠和其他技术，这些技术能够让你完全自定义你的机器学习管道，是任何数据科学家必须掌握的。
- en: Thank you for reading [????](https://emojipedia.org/folded-hands/)
  id: totrans-172
  prefs: []
  type: TYPE_NORMAL
  zh: 感谢阅读 [????](https://emojipedia.org/folded-hands/)
- en: Important Links
  id: totrans-173
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 重要链接
- en: ⭐ [Tutorials](https://github.com/pycaret/pycaret/tree/master/tutorials) New
    to PyCaret? Check out our official notebooks!
  id: totrans-174
  prefs: []
  type: TYPE_NORMAL
  zh: ⭐ [教程](https://github.com/pycaret/pycaret/tree/master/tutorials) 刚接触 PyCaret？查看我们的官方笔记本！
- en: ???? [Example Notebooks](https://github.com/pycaret/pycaret/tree/master/examples) created
    by the community.
  id: totrans-175
  prefs: []
  type: TYPE_NORMAL
  zh: ???? [示例笔记本](https://github.com/pycaret/pycaret/tree/master/examples) 由社区创建。
- en: ???? [Blog](https://github.com/pycaret/pycaret/tree/master/resources) Tutorials
    and articles by contributors.
  id: totrans-176
  prefs: []
  type: TYPE_NORMAL
  zh: ???? [博客](https://github.com/pycaret/pycaret/tree/master/resources) 由贡献者撰写的教程和文章。
- en: ???? [Documentation](https://pycaret.readthedocs.io/en/latest/index.html) The
    detailed API docs of PyCaret
  id: totrans-177
  prefs: []
  type: TYPE_NORMAL
  zh: ???? [文档](https://pycaret.readthedocs.io/en/latest/index.html) PyCaret 的详细 API
    文档
- en: ???? [Video Tutorials](https://www.youtube.com/channel/UCxA1YTYJ9BEeo50lxyI_B3g) Our
    video tutorial from various events.
  id: totrans-178
  prefs: []
  type: TYPE_NORMAL
  zh: ???? [视频教程](https://www.youtube.com/channel/UCxA1YTYJ9BEeo50lxyI_B3g) 我们在各种活动中的视频教程。
- en: ???? [Discussions](https://github.com/pycaret/pycaret/discussions) Have questions?
    Engage with community and contributors.
  id: totrans-179
  prefs: []
  type: TYPE_NORMAL
  zh: ???? [讨论](https://github.com/pycaret/pycaret/discussions) 有问题？与社区和贡献者互动。
- en: ????️ [Changelog](https://github.com/pycaret/pycaret/blob/master/CHANGELOG.md) Changes
    and version history.
  id: totrans-180
  prefs: []
  type: TYPE_NORMAL
  zh: ????️ [更新日志](https://github.com/pycaret/pycaret/blob/master/CHANGELOG.md) 变更和版本历史。
- en: ???? [Roadmap](https://github.com/pycaret/pycaret/issues/1756) PyCaret’s software
    and community development plan.
  id: totrans-181
  prefs: []
  type: TYPE_NORMAL
  zh: ???? [路线图](https://github.com/pycaret/pycaret/issues/1756) PyCaret 的软件和社区发展计划。
- en: '**Bio: [Moez Ali](https://www.linkedin.com/in/profile-moez/)** writes about
    PyCaret and its use-cases in the real world, If you would like to be notified
    automatically, you can follow Moez on [Medium](https://medium.com/@moez-62905),
    [LinkedIn](https://www.linkedin.com/in/profile-moez/), and [Twitter](https://twitter.com/moezpycaretorg1).'
  id: totrans-182
  prefs: []
  type: TYPE_NORMAL
  zh: '**简介：[Moez Ali](https://www.linkedin.com/in/profile-moez/)** 撰写关于 PyCaret 及其实际应用的文章。如果你希望自动接收通知，可以关注
    Moez 的 [Medium](https://medium.com/@moez-62905)、[LinkedIn](https://www.linkedin.com/in/profile-moez/)
    和 [Twitter](https://twitter.com/moezpycaretorg1)。'
- en: '[Original](https://towardsdatascience.com/introduction-to-binary-classification-with-pycaret-a37b3e89ad8d).
    Reposted with permission.'
  id: totrans-183
  prefs: []
  type: TYPE_NORMAL
  zh: '[原文](https://towardsdatascience.com/introduction-to-binary-classification-with-pycaret-a37b3e89ad8d)。经许可转载。'
- en: '**Related:**'
  id: totrans-184
  prefs: []
  type: TYPE_NORMAL
  zh: '**相关：**'
- en: '[A Beginner’s Guide to End to End Machine Learning](/2021/12/beginner-guide-end-end-machine-learning.html)'
  id: totrans-185
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[初学者端到端机器学习指南](/2021/12/beginner-guide-end-end-machine-learning.html)'
- en: '[PyCaret 2.3.5 Is Here! Learn What’s New](/2021/11/pycaret-here-learn-new.html)'
  id: totrans-186
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[PyCaret 2.3.5 发布！了解新功能](/2021/11/pycaret-here-learn-new.html)'
- en: '[Using PyCaret’s New Time Series Module](/2021/12/pycaret-new-time-series-module.html)'
  id: totrans-187
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[使用 PyCaret 的新时间序列模块](/2021/12/pycaret-new-time-series-module.html)'
- en: More On This Topic
  id: totrans-188
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 更多相关内容
- en: '[Introduction to Clustering in Python with PyCaret](https://www.kdnuggets.com/2021/12/introduction-clustering-python-pycaret.html)'
  id: totrans-189
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[使用 PyCaret 进行 Python 中的聚类介绍](https://www.kdnuggets.com/2021/12/introduction-clustering-python-pycaret.html)'
- en: '[Multilabel Classification: An Introduction with Python''s Scikit-Learn](https://www.kdnuggets.com/2023/08/multilabel-classification-introduction-python-scikitlearn.html)'
  id: totrans-190
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[多标签分类：使用 Python 的 Scikit-Learn 进行介绍](https://www.kdnuggets.com/2023/08/multilabel-classification-introduction-python-scikitlearn.html)'
- en: '[Announcing PyCaret 3.0: Open-source, Low-code Machine Learning in Python](https://www.kdnuggets.com/2023/03/announcing-pycaret-30-opensource-lowcode-machine-learning-python.html)'
  id: totrans-191
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[宣布 PyCaret 3.0：Python 中的开源、低代码机器学习](https://www.kdnuggets.com/2023/03/announcing-pycaret-30-opensource-lowcode-machine-learning-python.html)'
- en: '[Getting Started with PyCaret](https://www.kdnuggets.com/2022/11/getting-started-pycaret.html)'
  id: totrans-192
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[开始使用 PyCaret](https://www.kdnuggets.com/2022/11/getting-started-pycaret.html)'
- en: '[More Performance Evaluation Metrics for Classification Problems You…](https://www.kdnuggets.com/2020/04/performance-evaluation-metrics-classification.html)'
  id: totrans-193
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[分类问题的更多性能评估指标](https://www.kdnuggets.com/2020/04/performance-evaluation-metrics-classification.html)'
- en: '[Fine-Tuning BERT for Tweets Classification with HuggingFace](https://www.kdnuggets.com/2022/01/finetuning-bert-tweets-classification-ft-hugging-face.html)'
  id: totrans-194
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[使用 HuggingFace 对 BERT 进行推文分类的微调](https://www.kdnuggets.com/2022/01/finetuning-bert-tweets-classification-ft-hugging-face.html)'
