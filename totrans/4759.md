# 多类别文本分类模型比较与选择

> 原文：[https://www.kdnuggets.com/2018/11/multi-class-text-classification-model-comparison-selection.html](https://www.kdnuggets.com/2018/11/multi-class-text-classification-model-comparison-selection.html)

![c](../Images/3d9c022da2d331bb56691a9617b91b90.png) [评论](/2018/11/multi-class-text-classification-model-comparison-selection.html?page=2#comments)

**由 [Susan Li](https://www.linkedin.com/in/susanli/), 高级数据科学家**

![图片](../Images/9b64f7c1a5f857cb61411ba48d204dbb.png)

照片来源：Pixabay

在处理一个给定数据集的[有监督机器学习](https://en.wikipedia.org/wiki/Supervised_learning)问题时，我们尝试不同的算法和技术，寻找能生成通用假设的模型，从而对未来实例做出最准确的预测。相同的原则适用于文本（或文档）分类，其中可以使用许多模型来训练文本分类器。[对于“我应该使用哪个机器学习模型？”这个问题的答案始终是“这要看情况。”即使是经验最丰富的数据科学家也无法在实验之前确定哪个算法表现最佳](https://docs.microsoft.com/en-us/azure/machine-learning/studio/algorithm-choice)。

今天我们要做的是：利用我们在之前文章中介绍的关于文本分类的所有内容（以及更多），并比较我们训练的文本分类模型，以选择最准确的一个来解决我们的问题。

### 数据

我们使用的是一个相对较大的Stack Overflow问题和标签数据集。数据可以在[Google BigQuery](https://bigquery.cloud.google.com/dataset/bigquery-public-data:stackoverflow)中获取，也可以通过这个Cloud Storage URL公开获取：[https://storage.googleapis.com/tensorflow-workshop-examples/stack-overflow-data.csv](https://storage.googleapis.com/tensorflow-workshop-examples/stack-overflow-data.csv)。

### 探索数据

![](../Images/a5cabad690901acd935be6fd74d840d2.png)

图1

***10276752***

我们的数据中有超过1000万字。

```py
my_tags = ['java','html','asp.net','c#','ruby-on-rails','jquery','mysql','php','ios','javascript','python','c','css','android','iphone','sql','objective-c','c++','angularjs','.net']
plt.figure(figsize=(10,4))
df.tags.value_counts().plot(kind='bar');
```

![](../Images/452d3fe88135ada3e259b741efa43955.png)

图2

类别非常均衡。

我们想看看几个帖子和标签对。

```py
def print_plot(index):
    example = df[df.index == index][['post', 'tags']].values[0]
    if len(example) > 0:
        print(example[0])
        print('Tag:', example[1])

print_plot(10)
```

![](../Images/9be95e3d1a25f01dd32295fac28865e9.png)

图3

```py
print_plot(30)
```

![](../Images/00beb827a9a27fc750727df3b6562c61.png)

图4

如你所见，文本需要清理。

### 文本预处理

目前我们看到的文本清理技术在实践中效果很好。根据你可能遇到的文本类型，可能需要包括更复杂的文本清理步骤。但请记住，步骤越多，文本清理所需的时间就越长。

对于这个特定的数据集，我们的文本清理步骤包括HTML解码、去除停用词、将文本转换为小写、去除标点符号、删除坏字符等。

现在我们可以看看清理后的帖子：

![](../Images/dec6390974584bf90a0941482a627b0c.png)

图 5

好得多了！

```py
df['post'].apply(lambda x: len(x.split(' '))).sum()
```

***3421180***

在文本清理和去除停用词之后，我们只有超过300万个词汇可供使用！

在拆分数据集之后，下一步包括特征工程。我们将把文本文档转换为词频矩阵（CountVectorizer），然后将词频矩阵转换为标准化的tf-idf表示（tf-idf transformer）。之后，我们将从[Scikit-Learn库](http://scikit-learn.org/stable/)中训练几个分类器。

```py
X = df.post
y = df.tags
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.3, random_state = 42)
```

### **多项式模型的朴素贝叶斯分类器**

在获得特征之后，我们可以训练一个分类器来尝试预测帖子标签。我们将从一个[朴素贝叶斯](http://scikit-learn.org/stable/modules/naive_bayes.html#naive-bayes)分类器开始，这为这个任务提供了一个很好的基线。`scikit-learn`包括几种这种分类器的变体；最适合文本的变体是多项式变体。

为了使向量化器 => 转换器 => 分类器更易于使用，我们将使用`Pipeline`类，该类在Scikit-Learn中表现得像一个复合分类器。

![](../Images/c3a81dd575687d97955c8bea7f4b2346.png)

图 6

我们达到了74%的准确率。

### **线性支持向量机**

[线性支持向量机](http://scikit-learn.org/stable/modules/svm.html#svm)被广泛认为是最好的文本分类算法之一。

![](../Images/8a17b5a7232e05f83bf4c7e26052b9d4.png)

图 7

我们实现了79%的更高准确率，比朴素贝叶斯提高了5%。

### 逻辑回归

逻辑回归是一种简单且易于理解的分类算法，并且逻辑回归可以很容易地推广到多类分类问题。

![](../Images/d7389cf061c3db22f58eda8311724fd2.png)

图 8

我们实现了78%的准确率，比朴素贝叶斯高4%，比SVM低1%。

正如你所见，通过一些非常基本的步骤和使用简单的线性模型，我们能够在这个多类文本分类数据集上达到79%的准确率。

使用相同的数据集，我们将尝试一些高级技术，如词嵌入和神经网络。

现在，让我们尝试一些比简单计数单词更复杂的特征。

* * *

## 我们的前三个课程推荐

![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 1\. [谷歌网络安全证书](https://www.kdnuggets.com/google-cybersecurity) - 快速进入网络安全职业道路。

![](../Images/e225c49c3c91745821c8c0368bf04711.png) 2\. [谷歌数据分析专业证书](https://www.kdnuggets.com/google-data-analytics) - 提升您的数据分析技能

![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 3\. [谷歌IT支持专业证书](https://www.kdnuggets.com/google-itsupport) - 支持您的组织IT

* * *

### 更多相关话题

+   [Python和R中的机器学习算法比较](https://www.kdnuggets.com/2023/06/machine-learning-algorithms-python-r.html)

+   [线性回归模型选择：平衡简洁性与复杂性](https://www.kdnuggets.com/2023/02/linear-regression-model-selection-balancing-simplicity-complexity.html)

+   [什么是文本分类？](https://www.kdnuggets.com/2022/07/text-classification.html)

+   [适用于你的文本分类任务的最佳架构：基准测试…](https://www.kdnuggets.com/2023/04/best-architecture-text-classification-task-benchmarking-options.html)

+   [ChatGPT 与 Google Bard：技术差异的比较](https://www.kdnuggets.com/2023/03/chatgpt-google-bard-comparison-technical-differences.html)

+   [深入了解 GPT 模型：演变与性能比较](https://www.kdnuggets.com/2023/05/deep-dive-gpt-models.html)
