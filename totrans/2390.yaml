- en: How to Deal with Categorical Data for Machine Learning
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://www.kdnuggets.com/2021/05/deal-with-categorical-data-machine-learning.html](https://www.kdnuggets.com/2021/05/deal-with-categorical-data-machine-learning.html)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: '![How to Deal with Categorical Data for Machine Learning](../Images/6322628f527456028b1a4b9a7ff78f6b.png)'
  prefs: []
  type: TYPE_IMG
- en: '**In this blog we will explore and implement:**'
  prefs: []
  type: TYPE_NORMAL
- en: 'One-hot Encoding using:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Python’s category_encoding library
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Scikit-learn preprocessing
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Pandas' get_dummies
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Binary Encoding
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Frequency Encoding
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Label Encoding
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Ordinal Encoding
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '* * *'
  prefs: []
  type: TYPE_NORMAL
- en: Our Top 3 Course Recommendations
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 1\. [Google Cybersecurity
    Certificate](https://www.kdnuggets.com/google-cybersecurity) - Get on the fast
    track to a career in cybersecurity.'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/e225c49c3c91745821c8c0368bf04711.png) 2\. [Google Data Analytics
    Professional Certificate](https://www.kdnuggets.com/google-data-analytics) - Up
    your data analytics game'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 3\. [Google IT Support
    Professional Certificate](https://www.kdnuggets.com/google-itsupport) - Support
    your organization in IT'
  prefs: []
  type: TYPE_NORMAL
- en: '* * *'
  prefs: []
  type: TYPE_NORMAL
- en: What is Categorical Data?
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Categorical data is a type of data that is used to group information with similar
    characteristics, while numerical data is a type of data that expresses information
    in the form of numbers.
  prefs: []
  type: TYPE_NORMAL
- en: 'Example of categorical data: **gender**'
  prefs: []
  type: TYPE_NORMAL
- en: '**Why do we need encoding?**'
  prefs: []
  type: TYPE_NORMAL
- en: Most machine learning algorithms cannot handle categorical variables unless
    we convert them to numerical values
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Many algorithm’s performances even vary based upon how the categorical variables
    are encoded
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Categorical variables can be divided into two categories:**'
  prefs: []
  type: TYPE_NORMAL
- en: 'Nominal: no particular order'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Ordinal: there is some order between values'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: We will also refer to a cheat sheet that shows when to use which type of encoding.
  prefs: []
  type: TYPE_NORMAL
- en: 'Method 1: Using Python’s Category Encoder Library'
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: category_encoders is an amazing Python library that provides 15 different encoding
    schemes.
  prefs: []
  type: TYPE_NORMAL
- en: '**Here is the list of the 15 types of encoding the library supports:**'
  prefs: []
  type: TYPE_NORMAL
- en: One-hot Encoding
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Label Encoding
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Ordinal Encoding
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Helmert Encoding
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Binary Encoding
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Frequency Encoding
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Mean Encoding
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Weight of Evidence Encoding
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Probability Ratio Encoding
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Hashing Encoding
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Backward Difference Encoding
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Leave One Out Encoding
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: James-Stein Encoding
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: M-estimator Encoding
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Thermometer Encoder
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Importing libraries:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: 'Creating a dataframe:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs: []
  type: TYPE_PRE
- en: '![Figure](../Images/8cf59ccc89dbc94e8940e4ef6d8f1cec.png)'
  prefs: []
  type: TYPE_IMG
- en: Image By Author
  prefs: []
  type: TYPE_NORMAL
- en: '**Implementing one-hot encoding through category_encoder**'
  prefs: []
  type: TYPE_NORMAL
- en: In this method, each category is mapped to a vector that contains 1 and 0 denoting
    the presence or absence of the feature. The number of vectors depends on the number
    of categories for features.
  prefs: []
  type: TYPE_NORMAL
- en: 'Create an object of the one-hot encoder:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE2]'
  prefs: []
  type: TYPE_PRE
- en: '![Figure](../Images/7d4fa552c9a733a558105561be2314f6.png)'
  prefs: []
  type: TYPE_IMG
- en: Image By Author
  prefs: []
  type: TYPE_NORMAL
- en: '**Binary Encoding**'
  prefs: []
  type: TYPE_NORMAL
- en: Binary encoding converts a category into binary digits. Each binary digit creates
    one feature column.
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure](../Images/8aa6cbf7c85b8903cf0fa35e9cfffa16.png)'
  prefs: []
  type: TYPE_IMG
- en: '[Image Ref](https://towardsdatascience.com/all-about-categorical-variable-encoding-305f3361fd02)'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE3]'
  prefs: []
  type: TYPE_PRE
- en: '![Figure](../Images/2d3d6da3ab40c5bcc269b64f18bf2792.png)'
  prefs: []
  type: TYPE_IMG
- en: Image By Author
  prefs: []
  type: TYPE_NORMAL
- en: Similarly, there are another 14 types of encoding provided by this library.
  prefs: []
  type: TYPE_NORMAL
- en: 'Method 2: Using Pandas'' Get Dummies'
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '[PRE4]'
  prefs: []
  type: TYPE_PRE
- en: '![Figure](../Images/8487fc1978e7bc43233e90125815090e.png)'
  prefs: []
  type: TYPE_IMG
- en: Image By Author
  prefs: []
  type: TYPE_NORMAL
- en: We can assign a prefix if we want to, if we do not want the encoding to use
    the default.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE5]'
  prefs: []
  type: TYPE_PRE
- en: '![Figure](../Images/b493f95a98e4568c9532722c2ccd6cc7.png)'
  prefs: []
  type: TYPE_IMG
- en: Image By Author
  prefs: []
  type: TYPE_NORMAL
- en: 'Method 3: Using Scikit-learn'
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Scikit-learn also has 15 different types of built-in encoders, which can be
    accessed from sklearn.preprocessing.
  prefs: []
  type: TYPE_NORMAL
- en: Scikit-learn One-hot Encoding
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'Let''s first get the list of categorical variables from our data:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE6]'
  prefs: []
  type: TYPE_PRE
- en: 'Applying on the gender column:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE7]'
  prefs: []
  type: TYPE_PRE
- en: '![Figure](../Images/b71fbfc60524485cda26dec1cf2cc2f3.png)'
  prefs: []
  type: TYPE_IMG
- en: Image By Author
  prefs: []
  type: TYPE_NORMAL
- en: 'Applying on the city column:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE8]'
  prefs: []
  type: TYPE_PRE
- en: '![Figure](../Images/89e995edc0d8ef8119ca95db1e464b96.png)'
  prefs: []
  type: TYPE_IMG
- en: Image By Author
  prefs: []
  type: TYPE_NORMAL
- en: 'Applying on the class column:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE9]'
  prefs: []
  type: TYPE_PRE
- en: '![Figure](../Images/2252a75c773a03c90cda6c45f9cefc70.png)'
  prefs: []
  type: TYPE_IMG
- en: Image By Author
  prefs: []
  type: TYPE_NORMAL
- en: This is because the class column has 4 unique values.
  prefs: []
  type: TYPE_NORMAL
- en: 'Applying to the list of categorical variables:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE10]'
  prefs: []
  type: TYPE_PRE
- en: '![Figure](../Images/245e25af4d01851981273dc3395c0944.png)'
  prefs: []
  type: TYPE_IMG
- en: Image By Author
  prefs: []
  type: TYPE_NORMAL
- en: Here the first 2 columns represent gender, the next 4 columns represent class,
    and the remaining 2 represent city.
  prefs: []
  type: TYPE_NORMAL
- en: Scikit-learn Label Encoding
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: In label encoding, each category is assigned a value from 1 through N where
    N is the number of categories for the feature. There is no relation or order between
    these assignments.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE11]'
  prefs: []
  type: TYPE_PRE
- en: '**Comparing with one-hot encoding**'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE12]'
  prefs: []
  type: TYPE_PRE
- en: '![Figure](../Images/2252a75c773a03c90cda6c45f9cefc70.png)'
  prefs: []
  type: TYPE_IMG
- en: Image By Author
  prefs: []
  type: TYPE_NORMAL
- en: Ordinal Encoding
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Ordinal encoding’s encoded variables retain the ordinal (ordered) nature of
    the variable. It looks similar to label encoding, the only difference being that
    label coding doesn't consider whether a variable is ordinal or not; it will then
    assign a sequence of integers.
  prefs: []
  type: TYPE_NORMAL
- en: '**Example: Ordinal encoding will assign values as Very Good(1) < Good(2) <
    Bad(3) < Worse(4)**'
  prefs: []
  type: TYPE_NORMAL
- en: First, we need to assign the original order of the variable through a dictionary.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE13]'
  prefs: []
  type: TYPE_PRE
- en: '![Figure](../Images/d39a870d7c717360bf6b97d521cb97b8.png)'
  prefs: []
  type: TYPE_IMG
- en: Image By Author
  prefs: []
  type: TYPE_NORMAL
- en: Then we can map each row for the variable as per the dictionary.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE14]'
  prefs: []
  type: TYPE_PRE
- en: '![Figure](../Images/9963853ad5088d787831007bef6cccba.png)'
  prefs: []
  type: TYPE_IMG
- en: Image By Author
  prefs: []
  type: TYPE_NORMAL
- en: Frequency Encoding
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: The category is assigned as per the frequency of values in its total lot.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE15]'
  prefs: []
  type: TYPE_PRE
- en: 'Grouping by class column:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE16]'
  prefs: []
  type: TYPE_PRE
- en: 'Dividing by length:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE17]'
  prefs: []
  type: TYPE_PRE
- en: 'Mapping and rounding off:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE18]'
  prefs: []
  type: TYPE_PRE
- en: '![Figure](../Images/28ddbb0f094ff1ed7b89bf61b7b08ae8.png)'
  prefs: []
  type: TYPE_IMG
- en: Image By Author
  prefs: []
  type: TYPE_NORMAL
- en: 'In this article, we saw 5 types of encoding schemes. Similarly, there are 10
    other types of encoding which we have not looked at:'
  prefs: []
  type: TYPE_NORMAL
- en: Helmert Encoding
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Mean Encoding
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Weight of Evidence Encoding
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Probability Ratio Encoding
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Hashing Encoding
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Backward Difference Encoding
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Leave One Out Encoding
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: James-Stein Encoding
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: M-estimator Encoding
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Thermometer Encoder
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Which Encoding Method is Best?
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: There is no single method that works best for every problem or dataset. I personally
    think that the get_dummies method has an advantage in its ability to be implemented
    very easily.
  prefs: []
  type: TYPE_NORMAL
- en: If you want to read about all 15 types of encoding, [here is a very good article
    to refer to](https://towardsdatascience.com/all-about-categorical-variable-encoding-305f3361fd02).
  prefs: []
  type: TYPE_NORMAL
- en: 'Here is a cheat sheet on when to use what type of encoding:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure](../Images/be62853cce4ddd9c821bb5928030c26e.png)'
  prefs: []
  type: TYPE_IMG
- en: '[Image Ref](https://towardsdatascience.com/all-about-categorical-variable-encoding-305f3361fd02)'
  prefs: []
  type: TYPE_NORMAL
- en: 'References:'
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '[https://towardsdatascience.com/all-about-categorical-variable-encoding-305f3361fd02](https://towardsdatascience.com/all-about-categorical-variable-encoding-305f3361fd02)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[https://pypi.org/project/category-encoders/](https://pypi.org/project/category-encoders/)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[https://pandas.pydata.org/docs/reference/api/pandas.get_dummies.html](https://pandas.pydata.org/docs/reference/api/pandas.get_dummies.html)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '**[Shelvi Garg](https://www.linkedin.com/in/shelvi-garg-3a7421108/)** is a
    Data Scientist at Spinny'
  prefs: []
  type: TYPE_NORMAL
- en: More On This Topic
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: '[5 Ways to Deal with the Lack of Data in Machine Learning](https://www.kdnuggets.com/2019/06/5-ways-lack-data-machine-learning.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Black Friday Deal - Master Machine Learning for Less with DataCamp](https://www.kdnuggets.com/2022/11/datacamp-black-friday-deal-master-machine-learning-less-datacamp.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Encoding Categorical Features with MultiLabelBinarizer](https://www.kdnuggets.com/2023/01/encoding-categorical-features-multilabelbinarizer.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[How to Deal with Missing Data Using Interpolation Techniques in Pandas](https://www.kdnuggets.com/how-to-deal-with-missing-data-using-interpolation-techniques-in-pandas)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[5 Machine Learning Skills Every Machine Learning Engineer Should…](https://www.kdnuggets.com/2023/03/5-machine-learning-skills-every-machine-learning-engineer-know-2023.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[KDnuggets News, December 14: 3 Free Machine Learning Courses for…](https://www.kdnuggets.com/2022/n48.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
