- en: Applying Python’s Explode Function to Pandas DataFrames
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://www.kdnuggets.com/2021/05/applying-pythons-explode-function-pandas-dataframes.html](https://www.kdnuggets.com/2021/05/applying-pythons-explode-function-pandas-dataframes.html)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: '[comments](#comments)'
  prefs: []
  type: TYPE_NORMAL
- en: '**By [Michael Mosesov](https://www.linkedin.com/in/michael-mosesov-2a04191a6/),
    Data Analyst**'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/c17f6a5e21136f2e36c660d112b1ee87.png)'
  prefs: []
  type: TYPE_IMG
- en: '**Initial csv file**'
  prefs: []
  type: TYPE_NORMAL
- en: '* * *'
  prefs: []
  type: TYPE_NORMAL
- en: Our Top 3 Course Recommendations
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 1\. [Google Cybersecurity
    Certificate](https://www.kdnuggets.com/google-cybersecurity) - Get on the fast
    track to a career in cybersecurity.'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/e225c49c3c91745821c8c0368bf04711.png) 2\. [Google Data Analytics
    Professional Certificate](https://www.kdnuggets.com/google-data-analytics) - Up
    your data analytics game'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 3\. [Google IT Support
    Professional Certificate](https://www.kdnuggets.com/google-itsupport) - Support
    your organization in IT'
  prefs: []
  type: TYPE_NORMAL
- en: '* * *'
  prefs: []
  type: TYPE_NORMAL
- en: In our case we would use a historical data set of Russian leaders since the
    foundation of the Russian Empire in 1696, particularly their names, abbreviation
    of the government and years in power. The aim would be to clone/explode the dataset,
    so that each governor could be accessed by the year. For example, the current
    dataset format would not display who was the leader in year 1700 if you try to
    access that row.
  prefs: []
  type: TYPE_NORMAL
- en: This could be solved by splaying the “Years” column by a hyphen (-) between
    two dates.
  prefs: []
  type: TYPE_NORMAL
- en: '**Our aim is to transform each element of a list-like to a row, while keeping
    the same index that was assigned by Python to each row.**'
  prefs: []
  type: TYPE_NORMAL
- en: '*P.s. There were about 5 years between 1917 and 1922 of civil war with no single
    official state.*'
  prefs: []
  type: TYPE_NORMAL
- en: '*P.s.s. The dataset was cut down to last approximately 300 years, there were
    more leaders of Russia since 862.*'
  prefs: []
  type: TYPE_NORMAL
- en: 'In the beginning, we import the Pandas library into the Jupyter Notebook and
    take a look at the first and last rows of our data. The first step of data manipulation
    process is to create a data frame using the pd.DataFrame:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/488418ea54866050564b9005bf3a43d3.png)'
  prefs: []
  type: TYPE_IMG
- en: '**Quick Jupyter Notebook exploratory data preview**'
  prefs: []
  type: TYPE_NORMAL
- en: The explode() function is used to transform each element of a list-like to a
    row, therefore our first task is to create a list, separated by commas, of the
    values in the “Years” column.
  prefs: []
  type: TYPE_NORMAL
- en: But before that, it is vital to make all values numerical inside the “Years”
    column. Based on the observation of the last row, we see that extra editing is
    required for Python to apply the explode function and splaying the years in the
    “Years” column, converting all of the values to numbers, which means to replace
    the “currently” with “2021”, as this is the year when the article is written.
  prefs: []
  type: TYPE_NORMAL
- en: Replacement of values in such cases could be done using the lambda() function
    and x.replace, as demonstrated in the code below it also works for all the values
    in data frame if you need to change it in many rows.
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/02cb016338c38638ce46238de8841d8b.png)'
  prefs: []
  type: TYPE_IMG
- en: '**Lambda function assists in replacing values in data frames of any size and
    rows at any place**'
  prefs: []
  type: TYPE_NORMAL
- en: 'The next step is to split the dates in the “Years” column by a hyphen in order
    to expand/splay the data frame. The aim of the action, as been mentioned above,
    is to automatically splay and expand the hyphen between the two years. The following
    functions would help us to create lists of dates which is separated by a comma
    instead of hyphen:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/1e74e9eaa8a1b5b51a01f5e527a87525.png)'
  prefs: []
  type: TYPE_IMG
- en: '**Although those steps could be done separately, Python allows to fit them
    in one line of code**'
  prefs: []
  type: TYPE_NORMAL
- en: 'The following result should display after the manipulation with data frame:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/9e3273bf825c03b2b4af30c69834a85e.png)'
  prefs: []
  type: TYPE_IMG
- en: After assuring that all of our values in rows of the “Years” column are in the
    format of lists, we can finally apply the explode function to the whole dataset.
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/e8a213805d892c3155b6d40f1669d992.png)'
  prefs: []
  type: TYPE_IMG
- en: '**Result of applied explode() function to the entire data frame**'
  prefs: []
  type: TYPE_NORMAL
- en: 'Now we are able to see the result of explode function which could be used in
    the cases such as the following when there is a need to splay and expand on column
    in your data frame and make it more accessible. The reset_index() could be applied
    in case there is a need for an extra index in addition to the one initially assigned
    one to the unique row. It is also vital to create a new “exploded” pd.DataFrame
    to save the results to data set in csv format:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/9f55eda8ba31cd396d6b3017dbde2c4e.png)'
  prefs: []
  type: TYPE_IMG
- en: '**Saving new, exploded data frame**'
  prefs: []
  type: TYPE_NORMAL
- en: In result of the explode() the dates in the “Years” column have splayed throughout
    the data set and now each year of governing by each leader represents a new row.
    Prior to that, functions such as lambda(), list() and map() allowed us to save
    time and automatically expand the values (in our case years) between the dates.
    Such approach is useful when manipulating with dates and can be easily applied
    to small or large datasets in any field.
  prefs: []
  type: TYPE_NORMAL
- en: 'Below is the preview of exported data set in csv. While initial “index” was
    left assigned to each unique value (from splayed “Years”), there is an added index
    on the left for each of 348 rows:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/b2fb008b83da219b93af67366983c814.png)'
  prefs: []
  type: TYPE_IMG
- en: '**Preview of the final edited version**'
  prefs: []
  type: TYPE_NORMAL
- en: '**Bio: [Michael Mosesov](https://www.linkedin.com/in/michael-mosesov-2a04191a6/)**
    is a Data Analyst located in Russia.'
  prefs: []
  type: TYPE_NORMAL
- en: '[Original](https://mosesov62.medium.com/applying-python-explode-function-to-pd-dataframe-e5f6dfc20690).
    Reposted with permission.'
  prefs: []
  type: TYPE_NORMAL
- en: '**Related:**'
  prefs: []
  type: TYPE_NORMAL
- en: '[A Simple Way to Time Code in Python](/2021/03/simple-way-time-code-python.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[How to Speed Up Pandas with Modin](/2021/03/speed-up-pandas-modin.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[11 Essential Code Blocks for Complete EDA (Exploratory Data Analysis)](/2021/03/11-essential-code-blocks-exploratory-data-analysis.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: More On This Topic
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: '[Three R Libraries Every Data Scientist Should Know (Even if You Use Python)](https://www.kdnuggets.com/2021/12/three-r-libraries-every-data-scientist-know-even-python.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[What Makes Python An Ideal Programming Language For Startups](https://www.kdnuggets.com/2021/12/makes-python-ideal-programming-language-startups.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Stop Learning Data Science to Find Purpose and Find Purpose to…](https://www.kdnuggets.com/2021/12/stop-learning-data-science-find-purpose.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[A $9B AI Failure, Examined](https://www.kdnuggets.com/2021/12/9b-ai-failure-examined.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Top Resources for Learning Statistics for Data Science](https://www.kdnuggets.com/2021/12/springboard-top-resources-learn-data-science-statistics.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[The 5 Characteristics of a Successful Data Scientist](https://www.kdnuggets.com/2021/12/5-characteristics-successful-data-scientist.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
