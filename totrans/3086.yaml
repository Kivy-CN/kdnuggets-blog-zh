- en: Building Reliable Machine Learning Models with Cross-validation
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://www.kdnuggets.com/2018/08/building-reliable-machine-learning-models-cross-validation.html](https://www.kdnuggets.com/2018/08/building-reliable-machine-learning-models-cross-validation.html)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: '![c](../Images/3d9c022da2d331bb56691a9617b91b90.png) [comments](#comments)'
  prefs: []
  type: TYPE_IMG
- en: '**By [Gideon Mendels](https://www.linkedin.com/in/mendels/), Co-Founder and
    CEO @ [Comet.ml](https://www.comet.ml/)**'
  prefs: []
  type: TYPE_NORMAL
- en: Cross-validation is a technique used to measure and evaluate machine learning
    models performance. During training we create a number of partitions of the training
    set and train/test on different subsets of those partitions.
  prefs: []
  type: TYPE_NORMAL
- en: Cross-validation is frequently used to train, measure and finally select a machine
    learning model for a given dataset because it helps assess how the results of
    a model will generalize to an independent data set* in practice*. Most importantly,
    cross-validation has been shown to produce models with lower bias than other methods.
  prefs: []
  type: TYPE_NORMAL
- en: This tutorial will focus on one variant of cross-validation named** k-fold cross-validation**.
  prefs: []
  type: TYPE_NORMAL
- en: 'In this tutorial we’ll cover the following:'
  prefs: []
  type: TYPE_NORMAL
- en: Overview of K-Fold Cross-Validation
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Example using Scikit-Learn and [Comet.ml](https://www.comet.ml/)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: K-Fold Cross-Validation
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Cross-validation is a resampling technique used to evaluate machine learning
    models on a limited data set.
  prefs: []
  type: TYPE_NORMAL
- en: The most common use of cross-validation is the k-fold cross-validation method.
    Our training set is split into* K* partitions, the model is trained on *K-1 *partitions
    and the test error is predicted and computed on the *Kth* partition. This is repeated
    for each unique group and the test errors are averaged across.
  prefs: []
  type: TYPE_NORMAL
- en: '**The same procedure is described by the following steps:**'
  prefs: []
  type: TYPE_NORMAL
- en: Split the training set into K (K=10 is a common choice) partitions
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'For each partition:'
  prefs: []
  type: TYPE_NORMAL
- en: Set the partition is the test set
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Train a model on the rest of the partitions
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Measure performance on the test set
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Retain the performance metric
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Explore model performance over different folds
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Cross-validation is commonly used since it’s easy to interpret and since it
    generally results in a less biased or less optimistic estimates of the model performance
    than other methods, such as a simple train/test split. One of the biggest downsides
    in using cross-validation is the increased training time as we are essentially
    training K times instead of 1.
  prefs: []
  type: TYPE_NORMAL
- en: Cross-validation example using scikit-learn
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: '[**Scikit-learn**](http://scikit-learn.org/) is a popular machine learning
    library that also provides many tools for data sampling, model evaluation and
    training. We’ll use the `Kfold`class to generate our folds. Here’s a basic overview:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: Now let’s train an end-to-end example using scikit-learn and Comet.ml.
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: 'This example trains a text classifier on the news groups dataset (you can find
    it [here](http://scikit-learn.org/stable/datasets/twenty_newsgroups.html)). Given
    a piece of text (string), the model classifies it to one of the following classes:
    “atheism”,”christian”,”computer graphics”, “medicine”.'
  prefs: []
  type: TYPE_NORMAL
- en: On every fold we report the accuracy to [Comet.ml](https://www.comet.ml/) and
    finally we report the average accuracy of all folds. After the experiment finishes,
    we can [**visit Comet.ml and examine our model**](https://www.comet.ml/gidim/cross-validation/dd73c9696cbc497cb8274abcb883e03e/chart)**:**
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/9c186b05771d604cf5115e3aa2283e35.png)'
  prefs: []
  type: TYPE_IMG
- en: The following chart was automatically generated by Comet.ml. The right most
    bar (in purple) represents the **average** **accuracy across folds.** As you can
    see some folds preform significantly better than the average and shows how important
    k-fold cross validation is.
  prefs: []
  type: TYPE_NORMAL
- en: You might have noticed that we didn’t compute the **test** accuracy. The **test** set
    should not be used in any way until you’re completely finished with all experimentation.
    If we change hyperparameters or model types based on the test accuracy we’re essentially
    over-fitting our hyperparameters to the test distribution.
  prefs: []
  type: TYPE_NORMAL
- en: 'Still curious about cross-validation? Here are some other great resources:'
  prefs: []
  type: TYPE_NORMAL
- en: '[Jason Brownlee](https://medium.com/@jason.brownlee05)’s “[Gentle Introduction
    to Cross-validation](https://machinelearningmastery.com/k-fold-cross-validation/)”'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Prashant Gupta](https://medium.com/@prashantgupta17)’s [>Cross-Validation
    in Machine Learning](https://towardsdatascience.com/cross-validation-in-machine-learning-72924a69872f))'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Found this article useful? Follow us ([Comet.ml](https://medium.com/comet-ml))
    on Medium and check out some other relevant articles below! Please ???? this article
    to share it!**'
  prefs: []
  type: TYPE_NORMAL
- en: '[Comet.ml Release Notes ](https://www.notion.so/cometml/Comet-ml-Release-Notes-93d864bcac584360943a73ae9507bcaa)— updated
    daily with new features and fixes!'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Using fastText and Comet.ml to classify relationships in Knowledge](https://medium.com/comet-ml/using-fasttext-and-comet-ml-to-classify-relationships-in-knowledge-graphs-e73d27b40d67)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Real-time model performance visualizations](https://medium.com/comet-ml/real-time-model-performance-visualizations-with-comet-ml-992fb6226cb6)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '*Thanks to [Cecelia Shao](https://medium.com/@ceceliashao?source=post_page).*'
  prefs: []
  type: TYPE_NORMAL
- en: '**Bio: [Gideon Mendels](https://www.linkedin.com/in/mendels/)** is Co-Founder
    and CEO @ [Comet.ml](https://www.comet.ml/).'
  prefs: []
  type: TYPE_NORMAL
- en: '**[Comet.ml](https://www.comet.ml/)** is doing for ML what Github did for code.
    Our lightweight SDK enables data science teams to automatically track their datasets,
    code changes, experimentation history. This way, data scientists can easily reproduce
    their models and collaborate on model iteration amongst their team!'
  prefs: []
  type: TYPE_NORMAL
- en: '[Original](https://medium.com/comet-ml/building-reliable-machine-learning-models-with-cross-validation-20b2c3e32f3e).
    Reposted with permission.'
  prefs: []
  type: TYPE_NORMAL
- en: '**Related:**'
  prefs: []
  type: TYPE_NORMAL
- en: '[Training Sets, Test Sets, and 10-fold Cross-validation](/2018/01/training-test-sets-cross-validation.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Visualizing Cross-validation Code](/2017/09/visualizing-cross-validation-code.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[How (and Why) to Create a Good Validation Set](/2017/11/create-good-validation-set.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '* * *'
  prefs: []
  type: TYPE_NORMAL
- en: Our Top 3 Course Recommendations
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 1\. [Google Cybersecurity
    Certificate](https://www.kdnuggets.com/google-cybersecurity) - Get on the fast
    track to a career in cybersecurity.'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/e225c49c3c91745821c8c0368bf04711.png) 2\. [Google Data Analytics
    Professional Certificate](https://www.kdnuggets.com/google-data-analytics) - Up
    your data analytics game'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 3\. [Google IT Support
    Professional Certificate](https://www.kdnuggets.com/google-itsupport) - Support
    your organization in IT'
  prefs: []
  type: TYPE_NORMAL
- en: '* * *'
  prefs: []
  type: TYPE_NORMAL
- en: More On This Topic
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: '[Design effective & reliable machine learning systems!](https://www.kdnuggets.com/2023/05/manning-design-effective-reliable-machine-learning-systems.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Ensuring Reliable Few-Shot Prompt Selection for LLMs](https://www.kdnuggets.com/2023/07/ensuring-reliable-fewshot-prompt-selection-llms.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Unlocking Reliable Generations through Chain-of-Verification: A…](https://www.kdnuggets.com/unlocking-reliable-generations-through-chain-of-verification)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Building Data Pipelines to Create Apps with Large Language Models](https://www.kdnuggets.com/building-data-pipelines-to-create-apps-with-large-language-models)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Building Predictive Models: Logistic Regression in Python](https://www.kdnuggets.com/building-predictive-models-logistic-regression-in-python)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Step-by-Step Tutorial to Building Your First Machine Learning Model](https://www.kdnuggets.com/step-by-step-tutorial-to-building-your-first-machine-learning-model)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
