# 将Python的Explode函数应用于Pandas数据框

> 原文：[https://www.kdnuggets.com/2021/05/applying-pythons-explode-function-pandas-dataframes.html](https://www.kdnuggets.com/2021/05/applying-pythons-explode-function-pandas-dataframes.html)

[评论](#comments)

**由 [Michael Mosesov](https://www.linkedin.com/in/michael-mosesov-2a04191a6/) 提供，数据分析师**

![](../Images/c17f6a5e21136f2e36c660d112b1ee87.png)

**初始csv文件**

* * *

## 我们的前3个课程推荐

![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 1\. [Google 网络安全证书](https://www.kdnuggets.com/google-cybersecurity) - 快速入门网络安全职业。

![](../Images/e225c49c3c91745821c8c0368bf04711.png) 2\. [Google 数据分析专业证书](https://www.kdnuggets.com/google-data-analytics) - 提升你的数据分析技能

![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 3\. [Google IT支持专业证书](https://www.kdnuggets.com/google-itsupport) - 支持组织的IT需求

* * *

在我们的案例中，我们将使用自1696年俄罗斯帝国建立以来的俄罗斯领导人的历史数据集，特别是他们的姓名、政府的缩写和在任年限。目标是克隆/展开数据集，以便每位总督都可以按年份访问。例如，当前的数据集格式将无法显示如果你尝试访问1700年的那一行谁是领导人。

这可以通过在两个日期之间用破折号（-）分开“年份”列来解决。

**我们的目标是将列表类型的每个元素转换为一行，同时保持Python为每行分配的相同索引。**

*附注：1917年至1922年之间有约5年的内战期间没有单一官方国家。*

*附注：数据集被削减到大约300年，862年以后还有更多的俄罗斯领导人。*

一开始，我们将Pandas库导入Jupyter Notebook，并查看数据的第一行和最后一行。数据操作过程的第一步是使用pd.DataFrame创建数据框：

![](../Images/488418ea54866050564b9005bf3a43d3.png)

**快速的Jupyter Notebook数据预览**

explode()函数用于将列表类型的每个元素转换为一行，因此我们的第一项任务是创建一个以逗号分隔的“年份”列中的值列表。

但在此之前，必须将“年份”列中的所有值转换为数字。根据最后一行的观察，我们看到Python在应用explode函数并展开“年份”列中的年份时需要额外编辑，将所有值转换为数字，这意味着将“currently”替换为“2021”，因为这是撰写文章的年份。

在这种情况下，值的替换可以通过使用lambda()函数和x.replace来完成，如下代码所示，这种方法也适用于数据框中的所有值，如果需要在多个行中进行更改的话。

![](../Images/02cb016338c38638ce46238de8841d8b.png)

**Lambda函数帮助替换任何大小和任何位置的行中的数据框值**

下一步是通过连字符拆分“Years”列中的日期，以展开/扩展数据框。正如上面提到的，操作的目的是自动展开和扩展两个年份之间的连字符。以下函数将帮助我们创建由逗号而非连字符分隔的日期列表：

![](../Images/1e74e9eaa8a1b5b51a01f5e527a87525.png)

**尽管这些步骤可以单独完成，Python允许将它们合并在一行代码中**

操作数据框后，结果应显示如下：

![](../Images/9e3273bf825c03b2b4af30c69834a85e.png)

在确保“Years”列中的所有值都以列表格式存在之后，我们可以最终将explode函数应用于整个数据集。

![](../Images/e8a213805d892c3155b6d40f1669d992.png)

**应用explode()函数到整个数据框的结果**

现在我们能够看到explode函数的结果，该函数可以用于例如以下情况，当需要在数据框中的列上进行展开和扩展，以使其更易于访问时。可以应用reset_index()，以便在初始分配给唯一行的索引之外需要额外的索引时。创建一个新的“爆炸”pd.DataFrame以将结果保存到csv格式的数据集中也是至关重要的：

![](../Images/9f55eda8ba31cd396d6b3017dbde2c4e.png)

**保存新的“爆炸”数据框**

在explode()的结果中，“Years”列中的日期已在数据集中展开，现在每位领导的每一年代表一行。在此之前，lambda()、list()和map()等函数使我们能够节省时间，并自动扩展日期之间的值（在我们这里是年份）。这种方法在处理日期时非常有用，可以轻松应用于任何领域的小型或大型数据集。

以下是导出数据集的csv预览。虽然初始“index”被保留分配给每个唯一值（来自展开的“Years”），左侧增加了每348行的索引：

![](../Images/b2fb008b83da219b93af67366983c814.png)

**最终编辑版预览**

**简介: [Michael Mosesov](https://www.linkedin.com/in/michael-mosesov-2a04191a6/)** 是一位位于俄罗斯的数据分析师。

[原文](https://mosesov62.medium.com/applying-python-explode-function-to-pd-dataframe-e5f6dfc20690)。经许可转载。

**相关内容：**

+   [在Python中计时代码的简单方法](/2021/03/simple-way-time-code-python.html)

+   [如何使用Modin加速Pandas](/2021/03/speed-up-pandas-modin.html)

+   [完整 EDA（探索性数据分析）的 11 个基本代码块](/2021/03/11-essential-code-blocks-exploratory-data-analysis.html)

### 更多相关主题

+   [每个数据科学家都应该知道的三个 R 库（即使你使用 Python）](https://www.kdnuggets.com/2021/12/three-r-libraries-every-data-scientist-know-even-python.html)

+   [为什么 Python 是初创企业理想的编程语言](https://www.kdnuggets.com/2021/12/makes-python-ideal-programming-language-startups.html)

+   [停止学习数据科学以寻找目标，并找到目标以…](https://www.kdnuggets.com/2021/12/stop-learning-data-science-find-purpose.html)

+   [一项 90 亿美元的 AI 失败，深度剖析](https://www.kdnuggets.com/2021/12/9b-ai-failure-examined.html)

+   [学习数据科学统计的最佳资源](https://www.kdnuggets.com/2021/12/springboard-top-resources-learn-data-science-statistics.html)

+   [成功数据科学家的 5 个特征](https://www.kdnuggets.com/2021/12/5-characteristics-successful-data-scientist.html)
