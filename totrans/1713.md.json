["```py\ncol.box.blue <- colorRampPalette(c('#DBD8E0', '#014477'))(20)\n\ncol.arc.blue <- colorRampPalette(c('#938D8D', '#292929'))(20)\n\nactivities.counts <- activities.basic %>%\n\nselect(act) %>%\n\ngroup_by_all %>%\n\nsummarize(metric=n()) %>%\n\nungroup %>%\n\nmutate(fillcolor=col.box.blue[floor(linMap(metric, 1,20))])\n\nedges.counts <- edges.basic %>%\n\nselect(a.act, b.act) %>%\n\ngroup_by_all %>%\n\nsummarize(metric=n()) %>%\n\nungroup %>%\n\nmutate(color=col.arc.blue[floor(linMap(metric, 1,20))],\n\npenwidth=floor(linMap(metric, 1, 5)),\n\nmetric.char=as.character(metric))\n\n```", "```py\nacts.res <- eventlog %>%\n\nfilter(Activity == \"Analyze Request for Quotation\") %>%\n\nmutate(Duration=Complete-Start) %>%\n\nselect(Duration, Resource, Activity) %>%\n\ngroup_by(Resource, Activity) %>%\n\nsummarize(metric.freq=n(), metric.perf=median(Duration)) %>%\n\nungroup %>%\n\nmutate(color='#75B779',\n\npenwidth=1,\n\nmetric.char=formatSeconds(as.numeric(metric.perf)))\n\n```", "```py\na <- bind_rows(activities.counts %>% select(name=act, metric=metric) %>%\nmutate(type='Activity'),\n\nacts.res %>% select(name=Resource, metric=metric.freq) %>% \nmutate(type='Resource')) %>%\n\ndistinct %>%\n\nrowwise %>%\n\nmutate(fontsize=8,\n\nfontname='Arial',\n\nlabel=paste(name, metric, sep='\\n'),\n\nshape=ifelse(type == 'Activity', 'box', 'ellipse'),\n\nstyle=ifelse(type == 'Activity', 'rounded,filled', 'solid,filled'),\n\nfillcolor=ifelse(type == 'Activity',\nactivities.counts[activities.counts$act==name,]$fillcolor, '#75B779'))\n\nAnd construct a data frame for the edges as well:\n\ne <- bind_rows(edges.counts,\n\nacts.res %>% select(a.act=Resource, b.act=Activity, metric.char, color, penwidth)) %>%\n\nrename(label=metric.char) %>%\n\nmutate(fontsize=8, fontname='Arial')\n\nFinally, we can construct an igraph object as follows:\n\ngh <- graph_from_data_frame(e, vertices=a, directed=T)\n\n```"]