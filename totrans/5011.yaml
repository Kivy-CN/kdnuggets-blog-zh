- en: Using Machine Learning to Detect Malicious URLs
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://www.kdnuggets.com/2016/10/machine-learning-detect-malicious-urls.html](https://www.kdnuggets.com/2016/10/machine-learning-detect-malicious-urls.html)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: '![c](../Images/3d9c022da2d331bb56691a9617b91b90.png) [comments](#comments)'
  prefs: []
  type: TYPE_IMG
- en: '**By Faizan Ahmad, CEO Fsecurify**.'
  prefs: []
  type: TYPE_NORMAL
- en: '![Header](../Images/cd0f8aa5892b3c56ece07f70ea6880e8.png)'
  prefs: []
  type: TYPE_IMG
- en: '* * *'
  prefs: []
  type: TYPE_NORMAL
- en: Our Top 3 Course Recommendations
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 1\. [Google Cybersecurity
    Certificate](https://www.kdnuggets.com/google-cybersecurity) - Get on the fast
    track to a career in cybersecurity.'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/e225c49c3c91745821c8c0368bf04711.png) 2\. [Google Data Analytics
    Professional Certificate](https://www.kdnuggets.com/google-data-analytics) - Up
    your data analytics game'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 3\. [Google IT Support
    Professional Certificate](https://www.kdnuggets.com/google-itsupport) - Support
    your organization in IT'
  prefs: []
  type: TYPE_NORMAL
- en: '* * *'
  prefs: []
  type: TYPE_NORMAL
- en: With the growth of Machine Learning in the past few years, many tasks are being
    done with the help of **machine learning** algorithms. Unfortunately or fortunately,
    there has been little work done on security with machine learning algorithms.
    So I thought of presenting some at [**Fsecurify**](http://fsecurify.com/using-machine-learning-detect-malicious-urls/).
  prefs: []
  type: TYPE_NORMAL
- en: A few days ago, I had this idea about what if we could detect a malicious URL
    from a non-malicious URL using some machine learning algorithm. There has been
    some research done on the topic so I thought that I should give it a go and implement
    something from scratch. So let's start.
  prefs: []
  type: TYPE_NORMAL
- en: '**Gathering Data**'
  prefs: []
  type: TYPE_NORMAL
- en: The first task was gathering data. I did some surfing and found some websites
    offering malicious links. I set up a little crawler and crawled a lot of malicious
    links from various websites. The next task was finding clear URLs. Fortunately,
    I did not have to crawl any. There was a data set available. Don’t worry if I
    am not mentioning the sources of the data. You’ll get the data at the end of this
    post.
  prefs: []
  type: TYPE_NORMAL
- en: So, I gathered around 400,000 URLs out of which around 80,000 were malicious
    and others were clean. There we have it, our data set. Let's move next.
  prefs: []
  type: TYPE_NORMAL
- en: '**Analysis**'
  prefs: []
  type: TYPE_NORMAL
- en: We’ll be using **Logistic Regression** since it is fast. The first part was
    tokenizing the URLs. I wrote my own tokenizer function for this since URLs are
    not like some other document text.
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/b135c873cc912a9e67d1f47ab1ef5933.png)'
  prefs: []
  type: TYPE_IMG
- en: The next step is to load the data and store it into a list.
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/3665cea6de0ac3f99fe7a10adb4756cc.png)'
  prefs: []
  type: TYPE_IMG
- en: Now that we have the data in our list, we have to vectorize our URLs. I used
    **tf-idf** scores instead of using bag of words classification since there are
    words in urls that are more important than other words e.g *‘virus’, ‘.exe’ ,’.dat’*
    etc. Lets convert the URLs into a vector form.
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/f23c14315a9184249d32aea98f46a722.png)'
  prefs: []
  type: TYPE_IMG
- en: We have the vectors. Let's now convert it into test and training data and go
    right about performing logistic regression on it.
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/03275d8ba40e4c9ba4b99e9f91593803.png)'
  prefs: []
  type: TYPE_IMG
- en: That’s it. See, it's that simple yet so effective. **We get an accuracy of 98%.**
    That’s a very high value for a machine to be able to detect a malicious URL with.
    Want to test some links to see if the model gives good predictions? Sure. Let's
    do it.
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/1990f5237d5f3272d6e1375bc5d176e8.png)'
  prefs: []
  type: TYPE_IMG
- en: The results come out to be amazing.
  prefs: []
  type: TYPE_NORMAL
- en: wikipedia.com **(Good Url)**
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: google.com/search=faizanahmad **(Good Url)**
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: pakistanifacebookforever.com/getpassword.php/ **(Bad Url)**
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: www.radsport-voggel.de/wp-admin/includes/log.exe **(Bad Url)**
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: ahrenhei.without-transfer.ru/nethost.exe **(Bad Url)**
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: www.itidea.it/centroesteticosothys/img/_notes/gum.exe **(Bad Url)**
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: This is what a human would have predicted. No?
  prefs: []
  type: TYPE_NORMAL
- en: The data and code is available at [**Github**](https://github.com/faizann24/Using-machine-learning-to-detect-malicious-URLs).
  prefs: []
  type: TYPE_NORMAL
- en: '**Bio: [Faizan Ahmad](http://www.fsecurify.com/)** is a Fulbright computer
    science undergrad and CEO of Fsecurify.'
  prefs: []
  type: TYPE_NORMAL
- en: '**Related:**'
  prefs: []
  type: TYPE_NORMAL
- en: '[5 Best Practices for Big Data Security](/2016/06/5-best-practices-big-data-security.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[How Can Data Scientists Mitigate Sensitive Data Exposure Vulnerability?](/2016/08/data-scientists-mitigate-sensitive-data-exposure-vulnerability.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Big Data and Data Science for Security and Fraud Detection](/2015/12/big-data-science-security-fraud-detection.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: More On This Topic
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: '[20 Questions (with Answers) to Detect Fake Data Scientists: ChatGPT…](https://www.kdnuggets.com/2023/01/20-questions-detect-fake-data-scientists-chatgpt-1.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[20 Questions (with Answers) to Detect Fake Data Scientists: ChatGPT…](https://www.kdnuggets.com/2023/02/20-questions-detect-fake-data-scientists-chatgpt-2.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Why are More Developers Using Python for Their Machine Learning Projects?](https://www.kdnuggets.com/2022/01/developers-python-machine-learning-projects.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Using SHAP Values for Model Interpretability in Machine Learning](https://www.kdnuggets.com/2023/08/shap-values-model-interpretability-machine-learning.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Tackle computer science problems using both fundamental and modern…](https://www.kdnuggets.com/2023/11/packt-tackle-computer-science-problems-fundamental-modern-algorithms-machine-learning)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Building a GPU Machine vs. Using the GPU Cloud](https://www.kdnuggets.com/building-a-gpu-machine-vs-using-the-gpu-cloud)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
