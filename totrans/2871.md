# 如何使用 Flask 轻松部署机器学习模型

> 原文：[https://www.kdnuggets.com/2019/10/easily-deploy-machine-learning-models-using-flask.html](https://www.kdnuggets.com/2019/10/easily-deploy-machine-learning-models-using-flask.html)

[评论](#comments)

当数据科学家/机器学习工程师使用 Scikit-Learn、TensorFlow、Keras、PyTorch 等开发机器学习模型时，最终目标是将其投入生产。许多时候，在进行机器学习项目时，我们会过于关注探索性数据分析（EDA）、特征工程、调整超参数等。但我们往往会忽视我们的主要目标，即从模型预测中提取实际价值。

机器学习模型的部署或将模型投入生产意味着使你的模型对最终用户或系统可用。然而，机器学习模型的部署存在复杂性。本文旨在帮助你开始使用 Flask API 将训练好的机器学习模型投入生产。

* * *

## 我们的前三大课程推荐

![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 1\. [谷歌网络安全证书](https://www.kdnuggets.com/google-cybersecurity) - 快速进入网络安全职业道路

![](../Images/e225c49c3c91745821c8c0368bf04711.png) 2\. [谷歌数据分析专业证书](https://www.kdnuggets.com/google-data-analytics) - 提升你的数据分析技能

![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 3\. [谷歌 IT 支持专业证书](https://www.kdnuggets.com/google-itsupport) - 支持你的组织进行 IT 工作

* * *

我将使用线性回归来预测第三个月的销售值，基于利率和前两个月的销售数据。

### 什么是线性回归

线性回归模型的目标是找到一个或多个特征（自变量）与一个连续目标变量（因变量）之间的关系。当只有一个特征时，称为*单变量*线性回归；如果有多个特征，则称为*多变量*线性回归。

### 线性回归的假设

线性回归模型可以用以下方程表示

![](../Images/66b14abbd4776598a7ca2cd143fe394f.png)

+   *Y* 是预测值

+   *θ*₀ 是偏置项。

+   *θ*₁,…,*θ*ₙ 是模型参数。

+   *x*₁, *x*₂,…,*x*ₙ 是特征值。

![图示](../Images/ea63a8d669e197d57be01f7ab93f9d2c.png)

线性回归示例

### 为什么选择 Flask？

+   使用简单。

+   内置开发服务器和调试器。

+   集成单元测试支持。

+   RESTful 请求调度。

+   文档详尽。

### 项目结构

该项目分为四部分：

1.  model.py — 该文件包含用于基于前两个月的销售预测第三个月销售的机器学习模型代码。

1.  app.py — 这个文件包含了 Flask API，这些 API 通过 GUI 或 API 调用接收销售详情，计算基于我们模型的预测值，并返回结果。

1.  request.py — 这个文件使用 requests 模块调用 app.py 中定义的 API，并显示返回的值。

1.  HTML/CSS — 这个部分包含 HTML 模板和 CSS 样式，使用户能够输入销售详情并显示第三个月的预测销售额。

![图](../Images/381cfc742cb3bbfe4e2116fcd2a28c59.png)

机器学习模型部署管道

### 环境和工具

1.  scikit-learn

1.  pandas

1.  numpy

1.  flask

### 代码在哪里？

不废话，让我们开始编写代码。完整的项目可以在 [这里](https://github.com/abhinavsagar/Machine-Learning-Deployment-Tutorials) 找到。

让我们开始使用 HTML 制作前端界面，以便用户输入值。用户需要填写三个字段——利率、第一月的销售额和第二月的销售额。

接下来，我使用 CSS 对输入按钮、登录按钮和背景进行了样式设置。

我为这个项目创建了一个自定义的销售数据集，包含四列——利率、第一月的销售额、第二月的销售额和第三月的销售额。

现在我们来创建一个机器学习模型，以预测第三个月的销售额。首先，我们用 Pandas 处理缺失值。缺失数据可能发生在一个或多个项目没有提供信息时。如果没有提供值，我将利率列填充为零，第一个月的销售额填充为该列的平均值。我使用了线性回归作为机器学习算法。

### 序列化/反序列化

简而言之，序列化是一种将 Python 对象写入磁盘的方式，这些对象可以被转移到任何地方，之后由 Python 脚本反序列化（读取）。

![图](../Images/02f464ba1e9a94d360e1fd82db4793df.png)

序列化，反序列化

我将模型从 Python 对象形式转换为字符流，使用了 pickling。这个字符流包含了在另一个 Python 脚本中重建对象所需的所有信息。

下一部分是制作一个 API，接收通过 GUI 提交的销售详情，并根据我们的模型计算预测销售值。为此，我反序列化了 pickled 模型，形式为 Python 对象。我使用 `index.html` 设置了主页。通过 POST 请求提交表单值到 `/predict`，我们可以得到预测的销售额。

通过发起另一个 POST 请求到 `/results` 可以显示结果。它接收 JSON 输入，使用训练好的模型进行预测，并以 JSON 格式返回该预测值，可以通过 API 端点访问。

最后，我使用 requests 模块调用了 `app.py` 中定义的 API。它显示了第三个月的返回销售值。

### 结果

使用这个命令运行 web 应用程序。

```py
$ python app.py
```

![](../Images/4827a216adfb49f733a532383308fef3.png)

在你的网络浏览器中打开 [http://127.0.0.1:5000/](http://127.0.0.1:5000/)，应出现如下所示的 GUI。

![图示](../Images/8a10541af2b2ffaa6337a61600c1f546.png)

图形用户界面

### 结论

本文展示了一种非常简单的机器学习模型部署方式。我使用线性回归来预测第三个月的销售值，利用了利率和前两个月的销售数据。通过这篇博客获得的知识可以帮助你制作一些很酷的模型，并将其投入生产，让其他人欣赏你的成果。

### 参考文献/进一步阅读

**[用 80 行代码编写一个简单的 Flask Web 应用](https://towardsdatascience.com/writing-a-simple-flask-web-application-in-80-lines-cb5c386b089a?source=post_page-----b95af8fe34d4----------------------)**

Flask 入门教程示例

[**部署机器学习模型 | Coursera**](https://www.coursera.org/learn/deploying-machine-learning-models?source=post_page-----b95af8fe34d4----------------------)

从加州大学圣地亚哥分校学习部署机器学习模型。在这个课程中，我们将学习…

**[**将机器学习模型简单部署到云端的方式**](https://towardsdatascience.com/simple-way-to-deploy-machine-learning-models-to-cloud-fd58b771fdcf?source=post_page-----b95af8fe34d4----------------------)**

使用简单的技术栈将你的第一个机器学习模型部署到生产环境

[**机器学习模型生产部署的不同方法概述 - KDnuggets**](https://www.kdnuggets.com/2019/06/approaches-deploying-machine-learning-production.html?source=post_page-----b95af8fe34d4----------------------)

有不同的方法将模型投入生产，所带来的好处可能会因具体情况而异…

### 在你离开之前

对应的源代码可以在这里找到。

**[abhinavsagar/Machine-Learning-Deployment-Tutorials](https://github.com/abhinavsagar/Machine-Learning-Deployment-Tutorials?source=post_page-----b95af8fe34d4----------------------)**

从数据收集到将模型投入生产的完整项目示例…

### 联系方式

如果你想及时了解我的最新文章和项目，[请关注我在 Medium 的专栏](https://medium.com/@abhinav.sagar)。以下是我的一些联系方式：

+   [个人网站](https://abhinavsagar.github.io/)

+   [Linkedin](https://in.linkedin.com/in/abhinavsagar4)

+   [Medium 个人资料](https://medium.com/@abhinav.sagar)

+   [GitHub](https://github.com/abhinavsagar)

+   [Kaggle](https://www.kaggle.com/abhinavsagar)

**个人简介： [Abhinav Sagar](https://www.linkedin.com/in/abhinavsagar4)** 是 VIT Vellore 的大四本科生。他对数据科学、机器学习及其在现实世界中的应用感兴趣。

[原文](https://towardsdatascience.com/how-to-easily-deploy-machine-learning-models-using-flask-b95af8fe34d4)。已获许可转载。

**相关：**

+   [构建一个Flask API以使用SpaCy自动提取命名实体](/2019/04/building-flask-api-automatically-extract-named-entities-spacy.html)

+   [将您的PyTorch模型部署到生产环境](/2019/03/deploy-pytorch-model-production.html)

+   [有志数据科学家的黑客松指南](/2019/07/hackathon-guide-aspiring-data-scientists.html)

### 更多相关话题

+   [无代码轻松从网站抓取图像](https://www.kdnuggets.com/2022/06/octoparse-scrape-images-easily-websites-nocoding-way.html)

+   [使用openplayground轻松在笔记本电脑上探索LLMs](https://www.kdnuggets.com/2023/04/explore-llms-easily-laptop-openplayground.html)

+   [使用Scikit-LLM轻松将LLMs集成到您的Scikit-learn工作流中](https://www.kdnuggets.com/easily-integrate-llms-into-your-scikit-learn-workflow-with-scikit-llm)

+   [调查：机器学习项目仍然经常无法部署](https://www.kdnuggets.com/survey-machine-learning-projects-still-routinely-fail-to-deploy)

+   [使用Heroku部署机器学习Web应用](https://www.kdnuggets.com/2022/04/deploy-machine-learning-web-app-heroku.html)

+   [如何成功部署数据科学项目](https://www.kdnuggets.com/2022/01/successfully-deploy-data-science-projects.html)
