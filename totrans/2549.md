# ColabCode：从 Google Colab 部署机器学习模型

> 原文：[https://www.kdnuggets.com/2021/07/colabcode-deploying-machine-learning-models-google-colab.html](https://www.kdnuggets.com/2021/07/colabcode-deploying-machine-learning-models-google-colab.html)

[评论](#comments)

**作者 [Kaustubh Gupta](https://www.linkedin.com/in/kaustubh-gupta/)，Python 开发者**

![](../Images/913a9bd8496fbc48e89ddc7abc34c8cb.png)

图片由 [Niclas Illg](https://unsplash.com/@nicklbaert?utm_source=medium&utm_medium=referral) 提供，来自 [Unsplash](https://unsplash.com/?utm_source=medium&utm_medium=referral)

* * *

## 我们的前三大课程推荐

![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 1\. [Google 网络安全证书](https://www.kdnuggets.com/google-cybersecurity) - 快速进入网络安全职业的快车道。

![](../Images/e225c49c3c91745821c8c0368bf04711.png) 2\. [Google 数据分析专业证书](https://www.kdnuggets.com/google-data-analytics) - 提升你的数据分析技能

![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 3\. [Google IT 支持专业证书](https://www.kdnuggets.com/google-itsupport) - 支持你的组织的 IT 工作

* * *

Google Colab 是 Python 和数据科学爱好者最方便的在线 IDE。2017 年公开发布，它最初是 Google 研究团队用于协作不同 AI 项目的内部项目。从那时起，由于其易于使用的界面、与 Jupyter notebooks 的相似性以及 GPU 支持，使其获得了很大的人气。

大多数流行的机器学习库，如 numpy、pandas、seaborn、matplotlib、sklearn、TensorFlow，已经预装在这个云环境中，因此你不需要任何明确的前置条件。你也可以安装任何你选择的 Python 包来运行你的代码。在这篇文章中，我将向你解释一个简单的方法，使用 FastAPI 和 ngrok 部署你的机器学习模型为 API。

### 什么是 FastAPI？

FastAPI 是一个高性能的 Python API 构建框架。传统上，大多数开发者使用 flask 作为构建 API 的首选，但由于数据验证、身份验证、异步等一些限制，FastAPI 获得了很多人气。FastAPI 提供了自动文档生成功能、身份验证和通过 pydantic 模型的数据验证。要详细了解这两个框架之间的显著差异，你可以查看我在 Analytics Vidya 上的文章：

[**FastAPI：Flask 的最佳替代品？**](https://www.analyticsvidhya.com/blog/2020/11/fastapi-the-right-replacement-for-flask/)

这篇文章作为数据科学博客马拉松的一部分发布。介绍 完成模型构建后……

FastAPI 有助于设置生产就绪的服务器，但如果你想在实际部署到 Heroku 等云平台之前与团队分享该内容怎么办？ngrok 通过隧道化你的本地主机并将其暴露于互联网来拯救你。现在，任何人都可以通过提供的链接访问你的 API 端点，但如果所有这些都可以在 Google Colab 上完成呢？解决方案就是 ColabCode！

### ColabCode 是什么？

这是一个 Python 包，允许你从 Colab 笔记本直接启动代码服务器，而无需在本地系统上设置任何东西。它可以用来启动 VS Code 环境、Jupyter Lab 服务器，或将 FastAPI 服务器隧道到网络中，全部在 colab 笔记本内进行。这对于那些在云端训练模型并希望通过 API 与世界分享成果的热衷编码者来说，是一个很大的优点。我们将在本文结束时讨论 ColabCode 的所有功能。

### 为 ColabCode 准备 FastAPI 代码

我将在这篇文章中使用的问题陈述是一个决策树分类器，用于区分两种音乐类型：Hip-Hop 或 Rock。我已经完成了数据集的清理，并且它在我的 [GitHub 仓库](https://github.com/kaustubhgupta/Technocolab-Final-Project)中可用。现在我有了数据集，我直接将其导入到笔记本中，并训练了一个决策树模型，没有进行任何预处理或 EDA，因为这篇文章更多是关于部署。因此，这个模型可能会返回一些错误的结果！

模型创建代码

1\. 现在，如果你了解 FastAPI 架构，我们将需要一个数据类来处理输入。这个数据类允许 FastAPI 验证发送到模型的输入，如果输入错误，它会直接抛出错误，而不将其传递给模型。

2\. 创建数据类非常简单，只需要接受参数和数据类型。为了进一步自定义，你还可以添加一个自定义示例以快速测试结果。这个类的代码是：

数据类代码

3\. 现在，我们需要创建一个端点来处理所有请求。FastAPI 中的端点创建与 flask 非常相似，只需要端点函数接收数据类进行验证。

FastAPI 代码

如果你希望探索一些有趣的项目，可以查看我的 GitHub 个人资料：

[**kaustubhgupta - 概述**](https://github.com/kaustubhgupta)

???? 我目前正在探索 Python 及其所有功能。 ???? 我正在学习如何工作…

### ColabCode

我们的 FastAPI 已经准备好，现在唯一需要做的就是通过 colab 环境运行它。首先，导入这个包并初始化服务器：

[PRE0]

端口号可以由你选择，代码参数应该设为 false。现在，服务器已准备好接收 FastAPI 对象，并且通过 ngrok 的帮助，本地主机被隧道化，并通过唯一的 URL 公布于公众。

[PRE1]

就这些！你将获得一个 ngrok URL，你可以将其分享给你的社区、团队或其他人。链接将在你终止单元格过程后过期，如果你不终止，Google Colab 会在一段时间后自动终止。以下是此过程的示例 GIF：

![](../Images/ccd77565013f6a536b44e41de4fe72ee.png)

GIF 由作者提供

在这里，点击链接后，我导航到了 FastAPI 自动生成的 /docs 端点，在这里我们可以测试结果。整个笔记本代码在这里提供，如果你想运行和尝试这个功能。只需打开这个笔记本并运行所有单元格。

代码由作者提供

### 其他功能

ColabCode 不仅限于在 Colab 上运行 FastAPI 代码，它还可以提供 VS Code 服务器和 Jupyter Lab 服务器！它可以帮助用户在基于云的服务上拥有一个熟悉的环境。即使是资源非常有限的用户也能从这些服务中受益。这与新推出的 GitHub Codespaces 非常相似，后者在网页上提供 VS Code 环境。要通过 ColabCodes 运行 VS Code 服务器，请执行以下操作：

[PRE2]

你将会得到一个 ngrok URL，加载完成后，你将在你的网页浏览器中看到运行的 VS Code 如下：

![](../Images/18aa268c74ef511ed231ae8d385a4adc.png)

图片由作者提供

类似地，如果你想打开 Jupyter Lab 服务器，将 lab 参数设为 true，将 code 参数设为 false。

[PRE3]

你将获得一个 URL 和一个用于服务器认证的令牌。输入令牌并点击登录，即可获得类似于此的屏幕：

![](../Images/1479a9c7c69c006a302cf9379faa7f59.png)

图片由作者提供

### 结论

在这篇文章中，我解释了 ColabCode 提供的功能，并简要介绍了 FastAPI。目前，v0.2.0 版本由这个软件包的创建者 Abhishek Thakur 发布。如果你希望贡献，查看这个软件包的 [GitHub 仓库](https://github.com/abhishekkrthakur/colabcode)。

说到这里，本文就结束了，希望你能得到一些新的思考，并且我会通过一些其他文章出现在你的阅读流中！

**[我的领英](https://www.linkedin.com/in/kaustubh-gupta/)**

**我其他的热门文章：**

[**用不到 10 行代码构建仪表板！**](https://towardsdatascience.com/build-dashboards-in-less-than-10-lines-of-code-835e9abeae4b)

探索 ExplainerDashBoard，开发交互式仪表板的最简单方法

[**重建我的 7 个 Python 项目**](https://towardsdatascience.com/rebuilding-my-7-python-projects-8c629079c8e6)

这就是我重建 Python 项目的方式：数据科学、网页开发与 Android 应用

[**在网站上运行 Python 代码：探索 Brython**](https://towardsdatascience.com/run-python-code-on-websites-exploring-brython-83c43fb7ac5f)

Python 中的 JavaScript 等效脚本

[**自动生成作品集的 GitHub Action**](https://towardsdatascience.com/github-action-that-automates-portfolio-generation-bc15835862dc)

使用 Python 和基础前端的 Docker 化 GitHub Action。

**个人简介：[Kaustubh Gupta](https://www.linkedin.com/in/kaustubh-gupta/)** 是一位对数据科学和机器学习感兴趣的 Python 开发者，曾参与多个数据相关项目，关注机器学习在现实世界中的应用。

[原文](https://towardsdatascience.com/colabcode-deploying-machine-learning-models-from-google-colab-54e0d37a7b09)。经授权转载。

**相关内容：**

+   [如何通过 API 创建和部署简单的情感分析应用](/2021/06/create-deploy-sentiment-analysis-app-api.html)

+   [使用 Huggingface 和 PyTorch Lightning 的多语言 CLIP](/2021/03/multilingual-clip--huggingface-pytorch-lightning.html)

+   [什么时候需要重新训练机器学习模型？运行这 5 项检查以决定时间表](/2021/07/retrain-machine-learning-model-5-checks-decide-schedule.html)

### 更多相关内容

+   [机器学习模型部署：一步一步教程](https://www.kdnuggets.com/deploying-machine-learning-models-a-step-by-step-tutorial)

+   [从 Google Colab 到 Ploomber 流水线：利用 GPU 扩展机器学习](https://www.kdnuggets.com/2022/03/google-colab-ploomber-pipeline-ml-scale-gpus.html)

+   [在 Google Colab 上免费微调 LLAMAv2 与 QLora](https://www.kdnuggets.com/fine-tuning-llamav2-with-qlora-on-google-colab-for-free)

+   [在 Google Colab 上免费运行 Mixtral 8x7b](https://www.kdnuggets.com/running-mixtral-8x7b-on-google-colab-for-free)

+   [在 Google Colab 上运行 Redis](https://www.kdnuggets.com/2022/01/running-redis-google-colab.html)

+   [在 Google Colab 上使用 RAPIDS cuDF 加速数据科学](https://www.kdnuggets.com/2023/01/rapids-cudf-accelerated-data-science-google-colab.html)
