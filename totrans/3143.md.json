["```py\nimport datetime\nimport pandas as pd\nfrom pandas_datareader import data\nfrom fastai.structured import add_datepart\n\n# Set source and rate of interest\nsource = 'fred'\nrate = 'DEXCAUS'\n\n# Date range is 2016\nstart = datetime.datetime(2016, 1, 1)\nend = datetime.datetime(2016, 12, 31)\ncadusd = data.DataReader(rate, source, start, end)\n\n# Write it to a CSV \ncadusd.to_csv('cadusd.csv')\n\n# Read the CSV back in (there is a peculiarity accounting for this)\ncadusd = pd.read_csv('cadusd.csv')\n\n# Set datetime precision to 'day'\ncadusd['DATE'] = cadusd['DATE'].astype('datetime64[D]')\n\ncadusd['DEXCAUS'].plot(kind='line', grid=True, title='CAD to USD Conversion Rates, 2016')\ncadusd.head()\n```", "```py\ndef add_datepart(df, fldname, drop=True):\n    fld = df[fldname]\n    if not np.issubdtype(fld.dtype, np.datetime64):\n        df[fldname] = fld = pd.to_datetime(fld, infer_datetime_format=True)\n    targ_pre = re.sub('[Dd]ate$', '', fldname)\n    for n in ('Year', 'Month', 'Week', 'Day', 'Dayofweek', 'Dayofyear',\n            'Is_month_end', 'Is_month_start', 'Is_quarter_end', 'Is_quarter_start', 'Is_year_end', 'Is_year_start'):\n        df[targ_pre+n] = getattr(fld.dt,n.lower())\n    df[targ_pre+'Elapsed'] = fld.astype(np.int64) // 10**9\n    if drop: df.drop(fldname, axis=1, inplace=True)\n```", "```py\n\nadd_datepart(cadusd, 'DATE')\n```"]