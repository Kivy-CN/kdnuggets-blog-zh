# 评估 Python 和 R 中预测模型的商业价值

> 原文：[https://www.kdnuggets.com/2018/10/evaluating-business-value-predictive-models-modelplotpy.html/2](https://www.kdnuggets.com/2018/10/evaluating-business-value-predictive-models-modelplotpy.html/2)

**2\. 累计提升图**

累计提升图，通常称为提升图或索引图，帮助你回答这个问题：

***当我们应用模型并选择最佳的 X 十分位时，这比完全不使用模型要好多少倍？***

提升图有助于解释基于你的模型的选择比随机选择要好多少。尤其是在模型尚未在某个组织或领域中使用时，这确实有助于业务理解基于模型的选择能带来什么。

提升图仅有一条参考线：'随机模型'。所谓随机模型，是指每个观察值被分配一个随机数，然后所有案例根据这些随机数划分为十分位。每个十分位中的实际目标类别观察的百分比将等于总数据集中实际目标类别观察的总体百分比。由于提升是这两个数字的比率，所以我们会得到一个值为 1 的水平线。然而，你的模型应该能够做得更好，导致十分位 1 的比率较高。提升的高低取决于你的模型质量，但也取决于数据中目标类别观察的百分比：如果你的数据中 50% 属于感兴趣的目标类别，那么完美模型的表现也只会比随机选择好两倍（提升：2）。如果目标类别的值较小，例如 10%，则模型可能会比随机选择好 10 倍（提升：10）。因此，不能指定一个“好”的提升的通用指南。接近十分位 10 时，由于图是累计的，所有 100% 的案例，我们会再次得到整个数据集，因此累计提升最终总会回到 1 的值。它看起来像这样：

![ ](../Images/a53994e8c72b9d7bf1de6d1aee7e58bf.png)

要生成我们随机森林模型预测定期存款购买的累计提升图，我们调用函数 **plot_cumlift()**。让我们添加一些高亮，以查看基于我们包含十分位 1 和 2 的模型的选择，比随机选择所有客户的 20% 会好多少：

```py
# plot the cumulative lift plot and annotate the plot at decile = 2
mp.plot_cumlift(ps, highlight_decile = 2)

```

```py
When we select 20% with the highest probability according to model random forest in dataset test data, this selection for target class term deposit is 4.01 times than selecting without a model.
The cumulative lift plot is saved in C:\Users\nagelk000\AppData\Local\Temp\intro_modelplotpy.ipynb/Cumulative lift plot.png

```

![Image](../Images/652a0a9ba421cff3ae534937947b6535.png)

```py
<Figure size 432x288 with 0 Axes>
```

```py
<matplotlib.axes._subplots.AxesSubplot at 0x20da4be0>
```

基于我们的随机森林模型，针对所有客户的 20% 的选择进行定期存款营销活动，预期响应率将比随机客户样本高出 4 倍（396%）。不错吧？累计提升确实有助于获得积极的营销投资回报。不过需要注意的是，由于累计提升图是相对的，它并不能告诉我们我们活动的实际响应率会有多高……

**3\. 响应图**

最容易解释的评估图之一是响应图。它简单地绘制了每个分位数中的目标类别观察百分比。它可以用于回答以下业务问题：

***当我们应用模型并选择第X分位数时，该分位数中目标类别观察的预期百分比是多少？***

图表有一条参考线：总集中的目标类别案例的百分比。它看起来是这样的：

![ ](../Images/11b8cc32d913b7f8966befeb340dcc83.png)

一个好的模型在前几个分位数中会有一个高响应值，然后迅速下降到后续分位数的0。这表示目标类别成员之间有很好的区分——获得高模型分数——以及所有其他案例。图表中的一个有趣点是模型线与随机模型线交叉的地点。从那个分位数开始，目标类别案例的百分比低于随机选择的案例所包含的百分比。

要生成我们的定期存款模型的响应图，我们可以简单地调用函数**plot_response()**。让我们立即突出显示图表，以便在图表中添加第1分位数的响应图解释：

```py
# plot the response plot and annotate the plot at decile = 2
mp.plot_response(ps, highlight_decile = 1)

```

```py
When we select decile 1 from model random forest in dataset test data the percentage of term deposit cases in the selection is 58%.
The response plot is saved in C:\Users\nagelk000\AppData\Local\Temp\intro_modelplotpy.ipynb/Response plot.png

```

![Image](../Images/095aeb67a9e7f18f3c69c1c58628a73d.png)

```py
<Figure size 432x288 with 0 Axes>
```

```py
<matplotlib.axes._subplots.AxesSubplot at 0x20e2d240>
```

正如图表所示和图表下方的文本所述：*当我们从模型随机森林中选择第1分位数时，选择中的定期存款案例的百分比为55%*。这相当不错，特别是与整体概率11%相比。第二分位数的响应要低得多，大约为28%。从第3分位数开始，预期响应将低于整体概率10.4%。然而，大多数时候，我们的模型将用于选择最高分位数*直到*某个分位数。这使得查看累积响应图更加相关。你猜怎么着，那就是我们的最终图！

**4\. 累积响应图**

最后，最常用的图之一：累积响应图。它回答了每个业务代表嘴边的燃眉之问：

***当我们应用模型并选择到第X分位数时，选择中的目标类别观察的预期百分比是多少？***

这个图表中的参考线与响应图中的相同：总集中的目标类别案例的百分比。

![ ](../Images/775d60fc6ae97d94309692245d62b05c.png)

当响应图跨过参考线时，在累积响应图中，它从未跨过参考线，而是最终在第10分位数达到相同的点：选择直到第10分位数的所有案例与选择所有案例是相同的，因此目标类别案例的百分比将完全相同。这个图最常用于与业务同事一起决定选择到哪个分位数进行活动。

回到我们的银行业务案例。为了生成累计响应图，我们调用函数**plot_cumresponse()**。让我们在分位点3处突出显示，看看如果我们根据随机森林模型选择潜在客户进行定期存款优惠，整体预期响应将会如何：

```py
# plot the cumulative response plot and annotate the plot at decile = 3
mp.plot_cumresponse(ps, highlight_decile = 3)

```

```py
When we select deciles 1 until 3 according to model random forest in dataset test data the percentage of term deposit cases in the selection is 33%.
The cumulative response plot is saved in C:\Users\nagelk000\AppData\Local\Temp\intro_modelplotpy.ipynb/Cumulative response plot.png

```

![Image](../Images/7f0eea88e054a3a06b346a6e8cdd6e21.png)

```py
<Figure size 432x288 with 0 Axes>
```

```py
<matplotlib.axes._subplots.AxesSubplot at 0x21d8f7f0>
```

*当我们根据模型随机森林在数据集测试数据中选择分位点1到3时，选择中的定期存款案例百分比为33%。* 由于测试数据是一个独立的集，没有用于训练模型，我们可以预期定期存款活动的响应为33%。

给定分位点的累计响应百分比是你的业务同事可以实际操作的数字：考虑到成本和其他期望，这个响应是否足够大以保证成功的活动？出售的定期存款绝对数量是否能达到目标？或者我们是否通过仅选择前30%来失去过多潜在的定期存款买家？为了回答这个问题，我们可以回到累计收益图。这就是为什么这些图表之间没有绝对的赢家，我们建议使用它们所有。为了实现这一点，还有一个功能可以轻松地将所有四个图表合并在一起。

**所有四个图表在一起**

使用**plot_all**函数调用，我们可以在一个网格上获取所有四个图表。我们可以轻松地将其保存到文件中，以便在演示文稿中包含或与同事分享。

```py
# plot all four evaluation plots and save to file
mp.plot_all(ps, save_fig = True, save_fig_filename = 'Selection model Term Deposits')

```

```py
The plot all plot is saved in Selection model Term Deposits

```

![Image](../Images/d09172aa19fbb0daa33a1bb55e2a6256.png)

```py
<Figure size 432x288 with 0 Axes>
```

```py
<matplotlib.axes._subplots.AxesSubplot at 0x21fc9f60>
```

很棒！有了这些图表，我们能够与业务同事讨论我们预测模型的实际价值，而无需让他们厌烦技术细节。我们将模型翻译为业务术语并可视化，以简化解释和沟通。希望这能帮助你们讨论如何充分利用预测模型构建的努力。

### 从 modelplotpy 获取更多：使用不同的范围

正如我们之前讨论的那样，modelplotpy 还可以使用**scope**参数进行有趣的比较。比较不同模型、不同数据集以及（如果是多类别目标）不同目标类别之间的差异。好奇吗？请查看包的文档或阅读我们关于 modelplot 的其他文章。

例如，我们可以比较随机森林是否确实是选择前30%客户以进行定期存款优惠的最佳选择：

```py
# set plotting scope to model comparison
ps2 = obj.plotting_scope(scope = "compare_models", select_dataset_label=['test data'])

# plot the cumulative response plot and annotate the plot at decile = 3
mp.plot_cumresponse(ps2, highlight_decile = 3)

```

```py
compare models
The label with smallest class is ['term deposit']
When we select deciles 1 until 3 according to model multinomial logit in dataset test data the percentage of term deposit cases in the selection is 33%.
When we select deciles 1 until 3 according to model random forest in dataset test data the percentage of term deposit cases in the selection is 33%.
The cumulative response plot is saved in C:\Users\nagelk000\AppData\Local\Temp\intro_modelplotpy.ipynb/Cumulative response plot.png

```

![Image](../Images/3b081ff497ce74b18a080f3bf747004b.png)

```py
<Figure size 432x288 with 0 Axes>
```

```py
<matplotlib.axes._subplots.AxesSubplot at 0x23874c88>
```

看起来在这种情况下，所用算法不会有太大差别。希望你现在已经同意使用这些图表确实可以在解释预测模型的业务价值时带来差异！

如果在使用 modelplotpy 时遇到问题，请通过 [Github 上的 issues 部分](https://github.com/pbmarcus/modelplotpy/issues) 告诉我们。其他反馈或建议，请通过 [pb.marcus@hotmail.com](mailto:pb.marcus@hotmail.com) 或 [jurriaan.nagelkerke@gmail.com](mailto:jurriaan.nagelkerke@gmail.com) 告诉我们。祝你模型绘制愉快！

![ ](../Images/431c94d8b321882b135e87c1ab929b35.png)

```py
from IPython.core.display import display,HTML
display(HTML("<style>.container { width:100% !important; }</style>"))
display(HTML('<style>.prompt{width: 0px; min-width: 0px; visibility: collapse}</style>'))
#np.set_printoptions(linewidth=110)

```

**[Jurriaan Nagelkerke](https://www.linkedin.com/in/jnagelkerke/)** 是 Cmotions（荷兰一家专注于高级分析与数据科学的咨询公司）的高级分析与数据科学顾问。

**[Pieter Marcus](https://www.linkedin.com/in/pieter-marcus/)** 是 De Persgroep Nederland（荷兰最大的出版公司）的数据科学家。

[原始](https://modelplot.github.io/intro_modelplotpy)。经许可转载。

**相关：**

+   [提升分析 – 数据科学家的秘密武器](/2016/03/lift-analysis-data-scientist-secret-weapon.html)

+   [数据科学错觉](/2016/11/data-science-delusion.html)

+   [商业数据科学：你需要学习预期价值框架的 3 个理由](/2018/07/data-science-business-expected-value-framework.html)

* * *

## 我们的前三大课程推荐

![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 1. [谷歌网络安全证书](https://www.kdnuggets.com/google-cybersecurity) - 快速进入网络安全职业生涯。

![](../Images/e225c49c3c91745821c8c0368bf04711.png) 2. [谷歌数据分析专业证书](https://www.kdnuggets.com/google-data-analytics) - 提升你的数据分析技能

![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 3. [谷歌 IT 支持专业证书](https://www.kdnuggets.com/google-itsupport) - 支持你组织的 IT

* * *

### 更多相关话题

+   [超越准确性：使用 NLP 测试库评估和改进模型](https://www.kdnuggets.com/2023/04/john-snow-beyond-accuracy-nlp-test-library.html)

+   [评估计算文档相似度的方法](https://www.kdnuggets.com/evaluating-methods-for-calculating-document-similarity)

+   [机器学习对我的业务没有产生价值。为什么？](https://www.kdnuggets.com/2021/12/machine-learning-produce-value-business.html)

+   [KDnuggets™ 新闻 22:n01，1月5日：跟踪和可视化的 3 个工具…](https://www.kdnuggets.com/2022/n01.html)

+   [构建预测模型：Python 中的逻辑回归](https://www.kdnuggets.com/building-predictive-models-logistic-regression-in-python)

+   [结合数据管理与数据讲述以创造价值](https://www.kdnuggets.com/combining-data-management-and-data-storytelling-to-generate-value)
