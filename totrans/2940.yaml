- en: Analyzing Tweets with NLP in Minutes with Spark, Optimus and Twint
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://www.kdnuggets.com/2019/05/analyzing-tweets-nlp-spark-optimus-twint.html/2](https://www.kdnuggets.com/2019/05/analyzing-tweets-nlp-spark-optimus-twint.html/2)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: '![c](../Images/3d9c022da2d331bb56691a9617b91b90.png) [comments](/2019/05/analyzing-tweets-nlp-spark-optimus-twint.html?page=2#comments)'
  prefs: []
  type: TYPE_IMG
- en: Add sentiment directly to a Spark DataFrame
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: '![figure-name](../Images/eabdee24cdf14bd60dd071a7de661c13.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Transforming this code to Spark code it’s simple. This piece of code can help
    you transform other codes as well. So lets start importing the User Defined Function
    module from Spark:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: 'Then we will transform the code from above to a function:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs: []
  type: TYPE_PRE
- en: 'After that we will register the function as a Spark UDF:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE2]'
  prefs: []
  type: TYPE_PRE
- en: 'Then to apply the function to the whole dataframe we need to write:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE3]'
  prefs: []
  type: TYPE_PRE
- en: 'And we will see:'
  prefs: []
  type: TYPE_NORMAL
- en: '![figure-name](../Images/c0fbc29dac947a6da4de7e7862ac1b43.png)'
  prefs: []
  type: TYPE_IMG
- en: Sentiment analysis, the good programmer way (Making the code modular)
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: '![figure-name](../Images/f5af8055e191c1d84771239be656b72b.png)'
  prefs: []
  type: TYPE_IMG
- en: This is not actually quality code. Let’s transform this into functions to use
    it over and over.
  prefs: []
  type: TYPE_NORMAL
- en: 'The first part is setting up everything:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE4]'
  prefs: []
  type: TYPE_PRE
- en: The last part it’s a class that will remove the automatic printing of Twint
    so we just see the dataframe.
  prefs: []
  type: TYPE_NORMAL
- en: 'All of the things from above can be summarize in these functions:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE5]'
  prefs: []
  type: TYPE_PRE
- en: 'So to get the tweets and add sentiment we use:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE6]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE7]'
  prefs: []
  type: TYPE_PRE
- en: '![figure-name](../Images/7dce97b703c2f1c695e6dc21bd64f0f7.png)'
  prefs: []
  type: TYPE_IMG
- en: And that’s it :)
  prefs: []
  type: TYPE_NORMAL
- en: 'Lets see the distribution of the sentiments:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE8]'
  prefs: []
  type: TYPE_PRE
- en: '![figure-name](../Images/6da0446ebfc1ffe1db4506b3461cd47b.png)'
  prefs: []
  type: TYPE_IMG
- en: Doing more with Twint
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: '![figure-name](../Images/890f9a1a07b7fdc8cd9b7f05ecc1aeb5.png)To see how to
    do this check: [https://amueller.github.io/word_cloud/auto_examples/masked.html](https://amueller.github.io/word_cloud/auto_examples/masked.html)'
  prefs: []
  type: TYPE_IMG
- en: We can do more stuff, here I’ll show you how to create a simple function to
    get tweets, and also how to build a word cloud from them.
  prefs: []
  type: TYPE_NORMAL
- en: 'So to get the tweets from a simple search:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE9]'
  prefs: []
  type: TYPE_PRE
- en: 'With this we can get thousands of tweets very easy:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE10]'
  prefs: []
  type: TYPE_PRE
- en: 'To generate a word cloud this is all we need to do:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE11]'
  prefs: []
  type: TYPE_PRE
- en: 'I added some stopwords that are common in tweets that don’t matter to the analysis.
    To show it we use:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE12]'
  prefs: []
  type: TYPE_PRE
- en: 'And you’ll get:'
  prefs: []
  type: TYPE_NORMAL
- en: '![figure-name](../Images/182827b8880c8342f5736344341ee044.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Pretty but not that much. If we want good code we need modules so, let’s transform
    that into a function:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE13]'
  prefs: []
  type: TYPE_PRE
- en: 'And then we just run:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE14]'
  prefs: []
  type: TYPE_PRE
- en: '![figure-name](../Images/4daddcf0057fb5ca30ea238c25c4c128.png)'
  prefs: []
  type: TYPE_IMG
- en: Try it yourself
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: '![figure-name](../Images/14b930400a5f56a86fe33fcef0670208.png)'
  prefs: []
  type: TYPE_IMG
- en: 'There’s much more things that you can do with the library. Some other functions:'
  prefs: []
  type: TYPE_NORMAL
- en: '`twint.run.Search()` - Fetch Tweets using the search filters (Normal);'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`twint.run.Followers()` - Fetch a Twitter user''s followers;'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`twint.run.Following()` - Fetch who follows a Twitter user;'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`twint.run.Favorites()` - Fetch Tweets a Twitter user has liked;'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`twint.run.Profile()` - Fetch Tweets from a user''s profile (Includes retweets);'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`twint.run.Lookup()` - Fetch informations from a user''s profile (bio, location,
    etc.).'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Actually you can use it from the terminal. For that just run:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE15]'
  prefs: []
  type: TYPE_PRE
- en: 'Then just run go to the twint folder:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE16]'
  prefs: []
  type: TYPE_PRE
- en: 'And finally you can run for example:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE17]'
  prefs: []
  type: TYPE_PRE
- en: 'Here I’m getting all the tweets (845 so far) from the [TDS Team](https://medium.com/@TDSteam)
    of the year. Here is the CSV file if you want it:'
  prefs: []
  type: TYPE_NORMAL
- en: '[**FavioVazquez/twitter_optimus_twint**'
  prefs: []
  type: TYPE_NORMAL
- en: '*Analyzing tweets with Twint, Optimus and Apache Spark. - FavioVazquez/twitter_optimus_twint*github.com](https://github.com/FavioVazquez/twitter_optimus_twint/blob/master/TDS.csv)'
  prefs: []
  type: TYPE_NORMAL
- en: Bonus (scaling the results)
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: '![figure-name](../Images/830f861fdde11d0643424cc41c34c77a.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Let’s get 10k tweets and get their sentiment, because why not. For that:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE18]'
  prefs: []
  type: TYPE_PRE
- en: 'This actually took almost 10 minutes so take your precautions. It may be faster
    to get the tweets from the CLI and then just applying the function. Let’s see
    how many tweets we have:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE19]'
  prefs: []
  type: TYPE_PRE
- en: And we have 10.031 tweets with sentiments! You can use them for training other
    models too.
  prefs: []
  type: TYPE_NORMAL
- en: 'Thanks for reading this, hopefully it can help you with your current job and
    understanding of data science. If you want to know more about me follow me on
    twitter:'
  prefs: []
  type: TYPE_NORMAL
- en: '[**Favio Vázquez (@FavioVaz) | Twitter**'
  prefs: []
  type: TYPE_NORMAL
- en: '*The latest Tweets from Favio Vázquez (@FavioVaz). Data Scientist. Physicist
    and computational engineer. I have a…*twitter.com](https://twitter.com/faviovaz)[m](https://twitter.com/faviovaz)'
  prefs: []
  type: TYPE_NORMAL
- en: '**Bio: [Favio Vazquez](https://www.linkedin.com/in/faviovazquez/)** is a physicist
    and computer engineer working on Data Science and Computational Cosmology. He
    has a passion for science, philosophy, programming, and music. He is the creator
    of Ciencia y Datos, a Data Science publication in Spanish. He loves new challenges,
    working with a good team and having interesting problems to solve. He is part
    of Apache Spark collaboration, helping in MLlib, Core and the Documentation. He
    loves applying his knowledge and expertise in science, data analysis, visualization,
    and automatic learning to help the world become a better place.'
  prefs: []
  type: TYPE_NORMAL
- en: '[Original](https://towardsdatascience.com/analyzing-tweets-with-nlp-in-minutes-with-spark-optimus-and-twint-a0c96084995f).
    Reposted with permission.'
  prefs: []
  type: TYPE_NORMAL
- en: '**Related:**'
  prefs: []
  type: TYPE_NORMAL
- en: '[Data Science with Optimus Part 2: Setting your DataOps Environment](/2019/04/data-science-with-optimus-part-2-setting-dataops-environment.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Data Science with Optimus Part 1: Intro](/2019/04/data-science-with-optimus-part-1-intro.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Optimus v2: Agile Data Science Workflows Made Easy](/2018/08/optimus-v2-agile-data-science-workflows-made-easy.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '* * *'
  prefs: []
  type: TYPE_NORMAL
- en: Our Top 3 Course Recommendations
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 1\. [Google Cybersecurity
    Certificate](https://www.kdnuggets.com/google-cybersecurity) - Get on the fast
    track to a career in cybersecurity.'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/e225c49c3c91745821c8c0368bf04711.png) 2\. [Google Data Analytics
    Professional Certificate](https://www.kdnuggets.com/google-data-analytics) - Up
    your data analytics game'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 3\. [Google IT Support
    Professional Certificate](https://www.kdnuggets.com/google-itsupport) - Support
    your organization in IT'
  prefs: []
  type: TYPE_NORMAL
- en: '* * *'
  prefs: []
  type: TYPE_NORMAL
- en: More On This Topic
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: '[Analyzing Scientific Articles with fine-tuned SciBERT NER Model and Neo4j](https://www.kdnuggets.com/2021/12/analyzing-scientific-articles-finetuned-scibert-ner-model-neo4j.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Data Analytics: The Four Approaches to Analyzing Data and How To…](https://www.kdnuggets.com/2023/04/data-analytics-four-approaches-analyzing-data-effectively.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Analyzing the Probability of Future Success with Intelligence…](https://www.kdnuggets.com/2022/02/analyzing-probability-future-success-intelligence-node-attributes-evolution-model.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Analyzing Diversity & Inclusion with SQL](https://www.kdnuggets.com/2022/11/analyzing-diversity-inclusion-sql.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Master the Power of Data Analytics: The Four Approaches to Analyzing Data](https://www.kdnuggets.com/2023/03/master-power-data-analytics-four-approaches-analyzing-data.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Build AI Chatbot in 5 Minutes with Hugging Face and Gradio](https://www.kdnuggets.com/2023/06/build-ai-chatbot-5-minutes-hugging-face-gradio.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
