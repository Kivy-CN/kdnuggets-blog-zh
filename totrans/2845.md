# 使用 Flask 部署机器学习模型

> 原文：[https://www.kdnuggets.com/2019/12/excelr-deployment-machine-learning-flask.html](https://www.kdnuggets.com/2019/12/excelr-deployment-machine-learning-flask.html)

赞助帖子。

到目前为止，我们已经开发了许多数据科学模型，对测试数据进行了预测，并离线检查了结果。在现实世界中，生成预测只是数据科学项目的一部分。让我们考虑一个使用 CPU/GPU 的机器学习来检测垃圾短信的情况。一个朴素贝叶斯分类器在 CPU/GPU 上用垃圾短信和非垃圾短信进行训练。训练好的模型作为服务部署到网上，供大众或用户使用。

本博客将向我们解释机器学习算法部署的基本知识。在本博客中，我们将专注于开发一个用于垃圾短信识别的朴素贝叶斯模型，并使用 Flask（Flask 是一个 Python 的 Web 服务开发微框架）为模型创建 API。API 允许我们通过 HTTP 请求利用算法的分类能力。

Flask 基于 2 个组件：WSGI（Web 服务器网关接口）工具包和 Jinja2 模板。WSGI 用于 Web 应用程序，Jinja2 提供网页。Flask 总是用于较大规模的机器学习项目。Flask 可用于构建 REST 应用程序、电子邮件服务、聊天应用等。

开始吧！

> **有关 [数据科学课程](https://www.excelr.com/data-science-course-training-in-bangalore) 的更多信息，请关注我们 @ExcelR**

**第 1 步：**

首先，我们将使用一个数据集（messages.csv）来构建一个分类模型，该模型将准确识别哪些文本是垃圾信息。[该分类器模型基于词袋特征来识别垃圾邮件](https://en.wikipedia.org/wiki/Naive_Bayes_spam_filtering)。一旦我们训练好模型，建议保存该模型以便将来使用，从而减少重新训练的时间。为此，我们将模型保存为.pkl 文件以备将来使用。这是一个 pickle 文件，是用于保存和加载 Python 对象文件的原生 Python 库。

![图示](../Images/5fda73b0870dc601a816120d9d068ac5.png)

**第 2 步：**

下一步，我们需要开发一个具有用户友好界面的 Web 应用程序，界面上包含一个用于用户输入的表单字段。在将用户定义的消息输入到 Web 应用程序后，它将把消息传递到结果页面，显示是否为垃圾信息。

**第 3 步：**

为了开发 Web 应用程序，我们在桌面上创建一个名为 Spam Identifier 的项目文件夹，确保在其中创建文件目录。文件夹中的目录结构将如下所示：

[PRE0] [PRE1]py      **步骤 4：**    检查这个`app.py`文件是否包含用于执行Flask网络应用程序的Python源代码，它应该包括用于分类垃圾信息的ML程序（.pkl文件）。此文件是链接到HTML文件和调用模型的API，以显示用户定义输入的输出。      **步骤 5：**    然后将应用程序作为一个模块运行，以使用参数`__name__`初始化一个新的Flask实例，这将帮助Flask在同一文件夹（垃圾识别器）中找到HTML文件夹（包含HTML文件）。   [PRE2]
