# 使用Python进行数据分析的Instagram指南

> 原文：[https://www.kdnuggets.com/2017/08/instagram-python-data-analysis.html](https://www.kdnuggets.com/2017/08/instagram-python-data-analysis.html)

**作者：Nour Galaby，数据爱好者。**

![Instagram header](../Images/71fcd40c2f3ae3d1ae9117e7c99aa091.png)

* * *

## 我们的前三个课程推荐

![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 1\. [谷歌网络安全证书](https://www.kdnuggets.com/google-cybersecurity) - 快速进入网络安全职业。

![](../Images/e225c49c3c91745821c8c0368bf04711.png) 2\. [谷歌数据分析专业证书](https://www.kdnuggets.com/google-data-analytics) - 提升你的数据分析技能

![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 3\. [谷歌IT支持专业证书](https://www.kdnuggets.com/google-itsupport) - 支持你的组织的IT需求

* * *

Instagram是最大的照片分享社交媒体平台，拥有5亿月活跃用户，每天在Instagram上上传9500万张照片和视频。它拥有大量的数据和巨大的潜力。本指南将帮助你将Instagram视为数据源而不仅仅是一个平台，并教你如何作为开发者在项目中使用它。

**关于API和工具**

Instagram有一个官方API，但它已经过时，目前在你能做的事情上非常有限。所以在本指南中，我将使用[LevPasha的非官方Instagram API](https://github.com/LevPasha/Instagram-API-python)，它支持所有主要功能，如点赞、关注、上传照片和视频等！它是用Python编写的，但我将只关注数据部分。

我建议使用Jupyter笔记本和IPython。普通的python也能正常工作，但你可能没有显示图片的功能。

**安装**

你可以通过`pip`以这种方式安装该库：

```py
python -m pip install -e git+https://github.com/LevPasha/Instagram-API-python.git#egg=InstagramAPI
```

如果你没有`ffmpeg`，你需要安装它。在Linux上安装的方法是：

```py
sudo apt-get install ffmpeg
```

对于Windows，在你的Python解释器中运行以下命令：

```py
import imageio
imageio.plugins.ffmpeg.download()
```

**使用API登录Instagram**

```py
from InstagramAPI import InstagramAPI
username="YOURUSERNAME"
InstagramAPI = InstagramAPI(username, "YOURPASSWORD")
InstagramAPI.login()
```

如果成功，你应该会收到一条“登录成功”的消息。

**简单请求**

解决了这些问题后，我们开始进行第一个请求：

```py
InstagramAPI.getProfileData()
result = InstagramAPI.LastJson
```

```py
{u'status': u'ok',
 u'user': {u'biography': u'',
  u'birthday': None,
  u'country_code': 20,
  u'email': aaa@hotmail.com',
  u'external_url': u'',
  u'full_name': u'Nour Galaby',
  u'gender': 1,
  u'has_anonymous_profile_picture': False,
  u'hd_profile_pic_url_info': {u'height': 1080,
   u'url': u'https://instagram.fcai2-1.fna.fbcdn.net/t51.2885-1aaa7448121591_1aa.jpg',
   u'width': 1080},
  u'hd_profile_pic_versions': [{u'height': 320,
    u'url': u'https://instagram.fcai2-1.fna.fbcdn.net/t51.2885-19/s320x320/19aa23237_4337448121591_195310aaa32_a.jpg',
    u'width': 320},
   {u'height': 640,
    u'url': u'https://instagram.fcai2-1.fna.fbcdn.net/t51.2885-19/s640x640/19623237_45581744812153_44_a.jpg',
    u'width': 640}],
  u'is_private': True,
  u'is_verified': False,
  u'national_number': 122,
  u'phone_number': u'+201220',
  u'pk': 22412229,
  u'profile_pic_id': u'1550239680720880455_22',
  u'profile_pic_url': u'https://instagram.fcai2-1.fna.fbcdn.net/t51.2885-19/s150x150/19623237_455817448121591_195310166162_a.jpg',
  u'show_conversion_edit_entry': False,
  u'username': u'nourgalaby'}}
```

如你所见，结果是JSON格式的，包含了所有请求的数据。

你可以以正常的键/值方式访问它。例如：

![Instagram image](../Images/a56de5ee93012382d2e72ac44187abd1.png)

你可以使用任何高级查看工具（如Notepad++）来查看和探索JSON。

**获取并查看Instagram时间线**

现在让我们做一些更有趣的事情。我们将请求时间线中的最后几条帖子，并在我们的笔记本中查看它们。

使用这行命令，你可以获取时间线：

```py
InstagramAPI.timelineFeed()
```

与之前的请求类似，我们将使用LastJson()来查看结果。通过检查结果的JSON，我们可以看到它在一个名为“items”的键中持有一个列表。该列表中的每个元素包含关于时间线中特定帖子的详细信息，包括以下元素：

+   [text] - 包含帖子的标题文本值，包括标签

+   [likes] - 帖子的点赞数量

+   [created_at] - 帖子创建日期

+   [comments] - 帖子评论

+   [image_versions] - 包含实际 JPG 文件的链接，我们将用来在 Jupyter 笔记本中显示它

**函数**

`Get_posts_from_list()` 和 `Get_url()` 将遍历帖子列表，对于每个帖子找到 URL 并将其附加到我们空白列表中：

完成后，我们应该会有一个类似于以下的 URL 列表：

![Instagram](../Images/eeab5c9613f4809b1074f9151a3b1faa.png)

要查看图像，我们可以使用 `Ipython.display` 模块，如下所示：

![Instagram](../Images/6532b4b589e865b1ab6b4d48877c57fe.png)

![Instagram](../Images/e385c67dee5360a722e15aa86b889761.png)

在笔记本中查看图像非常有用，我们稍后会使用这些函数来查看我们的结果，如你将看到的那样。

**获取你最喜欢的帖子**

现在我们知道了如何进行基本请求，但如果我们想要进行更复杂的请求怎么办？在这里，我们将做类似的事情：获取我们最喜欢的帖子。为此，我们首先需要获取你用户资料中的所有帖子，然后按点赞数量排序：

**获取所有用户帖子**

为了获取所有帖子，我们将使用 `next_max_id` 和 `more_available` 值来遍历我们的结果列表：

```py
import time
myposts=[]
has_more_posts = True
max_id=""

while has_more_posts:
    InstagramAPI.getSelfUserFeed(maxid=max_id)
    if InstagramAPI.LastJson['more_available'] is not True:
        has_more_posts = False #stop condition
        print "stopped"

    max_id = InstagramAPI.LastJson.get('next_max_id','')
    myposts.extend(InstagramAPI.LastJson['items']) #merge lists
    time.sleep(2) # Slows the script down to avoid flooding the servers 

print len(myposts)
```

### 更多相关主题

+   [每个数据科学家都应该知道的三个 R 库（即使你使用 Python）](https://www.kdnuggets.com/2021/12/three-r-libraries-every-data-scientist-know-even-python.html)

+   [使用管道编写干净的 Python 代码](https://www.kdnuggets.com/2021/12/write-clean-python-code-pipes.html)

+   [是什么让 Python 成为初创公司的理想编程语言](https://www.kdnuggets.com/2021/12/makes-python-ideal-programming-language-startups.html)

+   [停止学习数据科学以找到目标，并找到目标以…](https://www.kdnuggets.com/2021/12/stop-learning-data-science-find-purpose.html)

+   [成为伟大的数据科学家所需的 5 项关键技能](https://www.kdnuggets.com/2021/12/5-key-skills-needed-become-great-data-scientist.html)

+   [每个初学者数据科学家应该掌握的 6 种预测模型](https://www.kdnuggets.com/2021/12/6-predictive-models-every-beginner-data-scientist-master.html)
