- en: Build Your Own PandasAI with LlamaIndex
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://www.kdnuggets.com/build-your-own-pandasai-with-llamaindex](https://www.kdnuggets.com/build-your-own-pandasai-with-llamaindex)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: '![Build Your Own PandasAI with LlamaIndex](../Images/b773ccebd8917fcf2dbd786cd5f0c3b5.png)'
  prefs: []
  type: TYPE_IMG
- en: Image by Author
  prefs: []
  type: TYPE_NORMAL
- en: Introduction
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '* * *'
  prefs: []
  type: TYPE_NORMAL
- en: Our Top 3 Course Recommendations
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 1\. [Google Cybersecurity
    Certificate](https://www.kdnuggets.com/google-cybersecurity) - Get on the fast
    track to a career in cybersecurity.'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/e225c49c3c91745821c8c0368bf04711.png) 2\. [Google Data Analytics
    Professional Certificate](https://www.kdnuggets.com/google-data-analytics) - Up
    your data analytics game'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 3\. [Google IT Support
    Professional Certificate](https://www.kdnuggets.com/google-itsupport) - Support
    your organization in IT'
  prefs: []
  type: TYPE_NORMAL
- en: '* * *'
  prefs: []
  type: TYPE_NORMAL
- en: '[Pandas AI](/2023/05/pandas-ai-generative-ai-python-library.html) is a Python
    library that leverages the power of generative AI to supercharge Pandas, the popular
    data analysis library. With just a simple prompt, Pandas AI allows you to perform
    complex data cleaning, analysis, and visualization that previously required many
    lines of code.'
  prefs: []
  type: TYPE_NORMAL
- en: Beyond crunching the numbers, Pandas AI understands natural language. You can
    ask questions about your data in plain English, and it will provide summaries
    and insights in everyday language, sparing you from deciphering complex graphs
    and tables.
  prefs: []
  type: TYPE_NORMAL
- en: In the example below, we provided a Pandas dataframe and asked the generative
    AI to create a bar chart. The result is impressive.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: '![Build Your Own PandasAI with LlamaIndex](../Images/6d253faf420a1db7b2c9ec5c53b15609.png)'
  prefs: []
  type: TYPE_IMG
- en: '**Note:** the code example is from [Pandas AI: Your Guide to Generative AI-Powered
    Data Analysis](https://www.datacamp.com/blog/an-introduction-to-pandas-ai) tutorial.'
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: In this post, we will be using LlamaIndex to create similar tools that can understand
    the Pandas data frame and produce complex results as shown above.
  prefs: []
  type: TYPE_NORMAL
- en: '[LlamaIndex](https://www.datacamp.com/tutorial/llama-index-adding-personal-data-to-llms)
    enables natural language querying of data via chat and agents. It allows large
    language models to interpret private data at scale without retraining on new data.
    It integrates large language models with various data sources and tools. LlamaIndex
    is a data framework that allows for the easy creation of Chat with PDF applications
    with just a few lines of code.'
  prefs: []
  type: TYPE_NORMAL
- en: Setting Up
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: You can install the Python library by using the `pip` command.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs: []
  type: TYPE_PRE
- en: By default, LlamaIndex uses OpenAI `gpt-3.5-turbo` model for text generation
    and `text-embedding-ada-002` for retrieval and embeddings. To run the code hassle-free,
    we must set up the `OPENAI_API_KEY`. We can register and get the API key for free
    on [a new API token](https://beta.openai.com/account/api-keys) page.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE2]'
  prefs: []
  type: TYPE_PRE
- en: They also support integrations of Anthropic, Hugging Face, PaLM, and more models.
    You can learn everything about it by reading the [Module's](https://gpt-index.readthedocs.io/en/stable/core_modules/model_modules/llms/modules.html)
    documentation.
  prefs: []
  type: TYPE_NORMAL
- en: Pandas Query Engine
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Let’s get to the main topic of creating your own PandasAI. After installing
    the library and setting up the API key, we will create a simple city dataframe
    with the city name and population as the columns.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE3]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE4]'
  prefs: []
  type: TYPE_PRE
- en: Using the `PandasQueryEngine`, we will create a query engine to load the dataframe
    and index it.
  prefs: []
  type: TYPE_NORMAL
- en: After that, we will write a query and display the response.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE5]'
  prefs: []
  type: TYPE_PRE
- en: As we can see, it has developed the Python code for displaying the least populated
    city in the dataframe.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE6]'
  prefs: []
  type: TYPE_PRE
- en: eval("df.loc[df['population'].idxmin()]['city']")
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE7]'
  prefs: []
  type: TYPE_PRE
- en: And, if you print the response, you will get "Islamabad." It is simple but impressive.
    You don't have to come up with your own logic or experiment around the code. Just
    type the question, and you will get the answer.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE8]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE9]'
  prefs: []
  type: TYPE_PRE
- en: You can also print the code behind the result using the response metadata.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE10]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE11]'
  prefs: []
  type: TYPE_PRE
- en: Global YouTube Statistics Analysis
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In the second example, we will load the Global [YouTube Statistics 2023](https://www.kaggle.com/datasets/nelgiriyewithana/global-youtube-statistics-2023)
    dataset from Kaggle and perform some fundamental analysis. It is a step up from
    the simple examples.
  prefs: []
  type: TYPE_NORMAL
- en: We will use `read_csv` to load the dataset into the query engine. Then we will
    write the prompt to display only columns with missing values and the number of
    missing values.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE12]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE13]'
  prefs: []
  type: TYPE_PRE
- en: df.isnull().sum()[df.isnull().sum() > 0]
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE14]'
  prefs: []
  type: TYPE_PRE
- en: Now, we will ask direct questions about popular channel types. In my opinion,
    the LlamdaIndex query engine is highly accurate and has not yet produced any hallucinations.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE15]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE16]'
  prefs: []
  type: TYPE_PRE
- en: eval("df.groupby('channel_type')['video views'].sum().idxmax()")
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE17]'
  prefs: []
  type: TYPE_PRE
- en: In the end, we will ask it to visualize barchat and the results are amazing.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE18]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE19]'
  prefs: []
  type: TYPE_PRE
- en: eval("df.nlargest(10, 'subscribers')[['Youtuber', 'subscribers']].plot(kind='bar',
    x='Youtuber', y='subscribers', title='Top Ten YouTube Channels Based on Subscribers')")
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE20]'
  prefs: []
  type: TYPE_PRE
- en: '![Build Your Own PandasAI with LlamaIndex](../Images/4d76461fb137d8d1fd413fda40f3fb79.png)'
  prefs: []
  type: TYPE_IMG
- en: With a simple prompt and query engine, we can automate our data analysis and
    perform complex tasks. There is so much more to LamaIndex. I highly recommend
    you to read the [official documentation](https://gpt-index.readthedocs.io/en/stable/index.html)
    and try to build something amazing.
  prefs: []
  type: TYPE_NORMAL
- en: Conclusion
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In summary, LlamaIndex is an exciting new tool that allows developers to create
    their own PandasAI - leveraging the power of large language models for intuitive
    data analysis and conversation. By indexing and embedding your dataset with LlamaIndex,
    you can enable advanced natural language capabilities on your private data without
    compromising security or retraining models.
  prefs: []
  type: TYPE_NORMAL
- en: This is just a start, with LlamaIndex you can build Q&A over documents, Chatbots,
    Automated AI, Knowledge Graph, AI SQL Query Engine, Full-Stack Web Application,
    and build private generative AI applications.
  prefs: []
  type: TYPE_NORMAL
- en: '**[Abid Ali Awan](https://www.polywork.com/kingabzpro)** ([@1abidaliawan](https://www.linkedin.com/in/1abidaliawan/))
    is a certified data scientist professional who loves building machine learning
    models. Currently, he is focusing on content creation and writing technical blogs
    on machine learning and data science technologies. Abid holds a Master''s degree
    in Technology Management and a bachelor''s degree in Telecommunication Engineering.
    His vision is to build an AI product using a graph neural network for students
    struggling with mental illness.'
  prefs: []
  type: TYPE_NORMAL
- en: More On This Topic
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: '[LangChain 101: Build Your Own GPT-Powered Applications](https://www.kdnuggets.com/2023/04/langchain-101-build-gptpowered-applications.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Comparative Analysis of LangChain and LlamaIndex](https://www.kdnuggets.com/comparative-analysis-of-langchain-and-llamaindex)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Make Your Own GPTs with ChatGPT''s GPTs!](https://www.kdnuggets.com/make-your-own-gpts-with-chatgpts-gpts)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Does AI Get its Own Batman?](https://www.kdnuggets.com/2022/05/ai-get-batman.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[It''s alive! Build your first robots with Python and some cheap,…](https://www.kdnuggets.com/2023/06/manning-build-first-robots-python-cheap-basic-components.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[6 Data Science Technologies You Need to Build Your Supply Chain Pipeline](https://www.kdnuggets.com/2022/01/6-data-science-technologies-need-build-supply-chain-pipeline.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
