- en: How to Determine if Your Machine Learning Model is Overtrained
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://www.kdnuggets.com/2021/05/how-determine-machine-learning-model-overtrained.html](https://www.kdnuggets.com/2021/05/how-determine-machine-learning-model-overtrained.html)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: '[comments](#comments)'
  prefs: []
  type: TYPE_NORMAL
- en: '**By [Charles Martin](http://linkedin.com/in/charlesmartin14), Calculation
    Consulting**'
  prefs: []
  type: TYPE_NORMAL
- en: '![Image](../Images/1787251901052638395b820406593fd6.png)'
  prefs: []
  type: TYPE_IMG
- en: Are your models over-trained? The weightwatcher tool can detect the signatures
    of overtraining in specific layers of a pre/trained Deep Neural Networks.
  prefs: []
  type: TYPE_NORMAL
- en: In the Figure above, fig (a) is well trained, whereas fig (b) may be over-trained.
    That orange spike on the far right is the tell-tale clue; it’s what we call a* Correlation
    Trap.*
  prefs: []
  type: TYPE_NORMAL
- en: Weightwatcher can detect the signatures of overtraining in specific layers of
    a pre/trained Deep Neural Networks. In this post, we show how to use the weightwatcher
    tool to do this.
  prefs: []
  type: TYPE_NORMAL
- en: WeightWatcher
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: '**WeightWatcher** (WW): is an open-source, diagnostic tool for analyzing Deep
    Neural Networks (DNN), without needing access to training or even test data. It
    analyzes the weight matrices of a pre/trained DNN, layer-by-layer, to help you
    detect potential problems. Problems that can not be seen by just looking at the
    test accuracy or the training loss.'
  prefs: []
  type: TYPE_NORMAL
- en: '**Installation**:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: '**Usage:**'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs: []
  type: TYPE_PRE
- en: For each layer, Weightwatcher plots the Empirical Spectral Density, or ESD.
    This is just a histogram of the eigenvalues of the layer correlation matrix **X=W^TW**.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE2]'
  prefs: []
  type: TYPE_PRE
- en: By specifying the randomize option, WW randomizes elements of the weight matrix **W**,
    and then computes the it’s ESD. This randomized ESD is overlaid on the orginal
    ESD of **X**, and ploted on a log scale.
  prefs: []
  type: TYPE_NORMAL
- en: This is shown above. The original layer ESD is **green**; the randomized ESD
    is **red**, And the **orange line **depicts the largest eigenvalue ![\lambda{max}](../Images/7c85a772530b2a81bcb7e3e51ad87fa9.png) of
    the randomized ESD.
  prefs: []
  type: TYPE_NORMAL
- en: If the layer is well trained matrix, then when **W** is randomized, it’s ESD
    will look like that of a normally distributed random matrix. This is shown in
    Figure (a), above.
  prefs: []
  type: TYPE_NORMAL
- en: But if the layer is over-trained, then it’s weight matrix **W** may have some
    unusually large elements, where the correlations may concentrated, or become *trapped*.
    In this case, the ESD may have 1 or more unusually large eigenvalues. This is
    shown in Figure (b) above, with the **orange line** extending to the far right
    of the bulk of the **red** ESD.
  prefs: []
  type: TYPE_NORMAL
- en: Notice also that in Figure (a), the **green** ESD is very Heavy Tailed, with
    the histogram extending out to log10=2, or a largest eigenvalue of nearly 100: ![\lambda\sim10^{2}](../Images/f94d58888a858e2da8fbc7a37dddd0ef.png).
    But in Figure (b),, the green ESD has a distinctly different shape and is smaller
    in scale than in Figure (a). In fact, in (b), the **green** (original) and **red** (randomized)
    layer ESDs look almost the same, except for a small shelf of larger **green** eigenvalues,
    extending out to and concentrating around the **orange line**.
  prefs: []
  type: TYPE_NORMAL
- en: '**In cases like this, we can identify the orange line as a *Correlation Trap.***'
  prefs: []
  type: TYPE_NORMAL
- en: This indicates that something went wrong in training this layer, and the model
    did not capture the correlations in this layer in a way that will generalize well
    to other examples.
  prefs: []
  type: TYPE_NORMAL
- en: Conclusion
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Using the Weight Watcher tool, you can detect this and other potential problems
    when training or fine-tuning your Deep Neural Networks.
  prefs: []
  type: TYPE_NORMAL
- en: You can learn more about it on the [WeightWatcher github website.](https://github.com/CalculatedContent/WeightWatcher)
  prefs: []
  type: TYPE_NORMAL
- en: '**Bio: [Dr. Charles Martin](http://linkedin.com/in/charlesmartin14)** has developed
    the weight watcher project as a joint research effort with UC Berkeley. He runs
    a boutique consultancy in San Francisco, CA, helping clients develop AI solutions.
    He has worked with large companies like eBay, Blackrock, GoDaddy, and Walmart
    as well as very successful startups such as Aardvark (acquired by Google) and
    Demand Media (the first Billion dollar IPO since Google). He also advises the
    Page family offices, through the Anthropocene Institute, on areas of AI, nuclear
    physics, and quantum mechanics/computing.'
  prefs: []
  type: TYPE_NORMAL
- en: '[Original](https://calculatedcontent.com/2021/04/04/are-your-models-overtrained/).
    Reposted with permission.'
  prefs: []
  type: TYPE_NORMAL
- en: '**Related:**'
  prefs: []
  type: TYPE_NORMAL
- en: '[Microsoft Uses Transformer Networks to Answer Questions About Images With
    Minimum Training](/2021/01/microsoft-transformer-networks-answer-questions-minimum-training.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Teaching AI to See Like a Human](/2021/03/teaching-ai-see-like-human.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[How to Speed up Scikit-Learn Model Training](/2021/02/speed-up-scikit-learn-model-training.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '* * *'
  prefs: []
  type: TYPE_NORMAL
- en: Our Top 3 Course Recommendations
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 1\. [Google Cybersecurity
    Certificate](https://www.kdnuggets.com/google-cybersecurity) - Get on the fast
    track to a career in cybersecurity.'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/e225c49c3c91745821c8c0368bf04711.png) 2\. [Google Data Analytics
    Professional Certificate](https://www.kdnuggets.com/google-data-analytics) - Up
    your data analytics game'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 3\. [Google IT Support
    Professional Certificate](https://www.kdnuggets.com/google-itsupport) - Support
    your organization in IT'
  prefs: []
  type: TYPE_NORMAL
- en: '* * *'
  prefs: []
  type: TYPE_NORMAL
- en: More On This Topic
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: '[Stop Learning Data Science to Find Purpose and Find Purpose to…](https://www.kdnuggets.com/2021/12/stop-learning-data-science-find-purpose.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Top Resources for Learning Statistics for Data Science](https://www.kdnuggets.com/2021/12/springboard-top-resources-learn-data-science-statistics.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[A $9B AI Failure, Examined](https://www.kdnuggets.com/2021/12/9b-ai-failure-examined.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[The 5 Characteristics of a Successful Data Scientist](https://www.kdnuggets.com/2021/12/5-characteristics-successful-data-scientist.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[What Makes Python An Ideal Programming Language For Startups](https://www.kdnuggets.com/2021/12/makes-python-ideal-programming-language-startups.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Three R Libraries Every Data Scientist Should Know (Even if You Use Python)](https://www.kdnuggets.com/2021/12/three-r-libraries-every-data-scientist-know-even-python.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
