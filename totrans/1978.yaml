- en: 'How Big Data Is Saving Lives in Real Time: IoV Data Analytics Helps Prevent
    Accidents'
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://www.kdnuggets.com/how-big-data-is-saving-lives-in-real-time-iov-data-analytics-helps-prevent-accidents](https://www.kdnuggets.com/how-big-data-is-saving-lives-in-real-time-iov-data-analytics-helps-prevent-accidents)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: '![How Big Data Is Saving Lives in Real Time: IoV Data Analytics Helps Prevent
    Accidents](../Images/807e4f5d57c2f19d7e603e226737eb85.png)'
  prefs: []
  type: TYPE_IMG
- en: Photo by [Roberto Nickson](https://www.pexels.com/photo/person-sitting-inside-car-2526127/)
  prefs: []
  type: TYPE_NORMAL
- en: 'Internet of Vehicles, or IoV, is the product of the marriage between the automotive
    industry and IoT. IoV data is expected to get larger and larger, especially with
    electric vehicles being the new growth engine of the auto market. The question
    is: Is your data platform ready for that? This post shows you what an OLAP solution
    for IoV looks like.'
  prefs: []
  type: TYPE_NORMAL
- en: '* * *'
  prefs: []
  type: TYPE_NORMAL
- en: Our Top 3 Course Recommendations
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 1\. [Google Cybersecurity
    Certificate](https://www.kdnuggets.com/google-cybersecurity) - Get on the fast
    track to a career in cybersecurity.'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/e225c49c3c91745821c8c0368bf04711.png) 2\. [Google Data Analytics
    Professional Certificate](https://www.kdnuggets.com/google-data-analytics) - Up
    your data analytics game'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 3\. [Google IT Support
    Professional Certificate](https://www.kdnuggets.com/google-itsupport) - Support
    your organization in IT'
  prefs: []
  type: TYPE_NORMAL
- en: '* * *'
  prefs: []
  type: TYPE_NORMAL
- en: What is special about IoV data?
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'The idea of IoV is intuitive: to create a network so vehicles can share information
    with each other or with urban infrastructure. What‘s often under-explained is
    the network within each vehicle itself. On each car, there is something called
    Controller Area Network (CAN) that works as the communication center for the electronic
    control systems. For a car traveling on the road, the CAN is the guarantee of
    its safety and functionality, because it is responsible for:'
  prefs: []
  type: TYPE_NORMAL
- en: '**Vehicle system monitoring**: The CAN is the pulse of the vehicle system.
    For example, sensors send the temperature, pressure, or position they detect to
    the CAN; controllers issue commands (like adjusting the valve or the drive motor)
    to the executor via the CAN.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Real-time feedback**: Via the CAN, sensors send the speed, steering angle,
    and brake status to the controllers, which make timely adjustments to the car
    to ensure safety.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Data sharing and coordination**: The CAN allows for data exchange (such as
    status and commands) between various devices, so the whole system can be more
    performant and efficient.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Network management and troubleshooting**: The CAN keeps an eye on devices
    and components in the system. It recognizes, configures, and monitors the devices
    for maintenance and troubleshooting.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: With the CAN being that busy, you can imagine the data size that is traveling
    through the CAN every day. In the case of this post, we are talking about a car
    manufacturer who connects 4 million cars together and has to process 100 billion
    pieces of CAN data every day.
  prefs: []
  type: TYPE_NORMAL
- en: IoV data processing
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'To turn this huge data size into valuable information that guides product development,
    production, and sales is the juicy part. Like most data analytic workloads, this
    comes down to data writing and computation, which are also where challenges exist:'
  prefs: []
  type: TYPE_NORMAL
- en: '**Data writing at scale**: Sensors are everywhere in a car: doors, seats, brake
    lights... Plus, many sensors collect more than one signal. The 4 million cars
    add up to a data throughput of millions of TPS, which means dozens of terabytes
    every day. With increasing car sales, that number is still growing.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Real-time analysis**: This is perhaps the best manifestation of "time is
    life". Car manufacturers collect the real-time data from their vehicles to identify
    potential malfunctions, and fix them before any damage happens.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Low-cost computation and storage**: It''s hard to talk about huge data size
    without mentioning its costs. Low cost makes big data processing sustainable.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'From Apache Hive to Apache Doris: a transition to real-time analysis'
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Like Rome, a real-time data processing platform is not built in a day. The car
    manufacturer used to rely on the combination of a batch analytic engine (Apache
    Hive) and some streaming frameworks and engines (Apache Flink, Apache Kafka) to
    gain near real-time data analysis performance. They didn't realize they needed
    real-time that bad until real-time was a problem.
  prefs: []
  type: TYPE_NORMAL
- en: Near Real-Time Data Analysis Platform
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'This is what used to work for them:'
  prefs: []
  type: TYPE_NORMAL
- en: '![How Big Data Is Saving Lives in Real Time: IoV Data Analytics Helps Prevent
    Accidents](../Images/f0014c2e83f16109e153d931d9bd4f20.png)'
  prefs: []
  type: TYPE_IMG
- en: Data from the CAN and vehicle sensors are uploaded via 4G network to the cloud
    gateway, which writes the data into Kafka. Then, Flink processes this data and
    forwards it to Hive. Going through several data warehousing layers in Hive, the
    aggregated data is exported to MySQL. At the end, Hive and MySQL provide data
    to the application layer for data analysis, dashboarding, etc.
  prefs: []
  type: TYPE_NORMAL
- en: Since Hive is primarily designed for batch processing rather than real-time
    analytics, you can tell the mismatch of it in this use case.
  prefs: []
  type: TYPE_NORMAL
- en: '**Data writing**: With such a huge data size, the data ingestion time from
    Flink into Hive was noticeably long. In addition, Hive only supports data updating
    at the granularity of partitions, which is not enough for some cases.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Data analysis**: The Hive-based analytic solution delivers high query latency,
    which is a multi-factor issue. Firstly, Hive was slower than expected when handling
    large tables with 1 billion rows. Secondly, within Hive, data is extracted from
    one layer to another by the execution of Spark SQL, which could take a while.
    Thirdly, as Hive needs to work with MySQL to serve all needs from the application
    side, data transfer between Hive and MySQL also adds to the query latency.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Real-Time Data Analysis Platform
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'This is what happens when they add a real-time analytic engine to the picture:'
  prefs: []
  type: TYPE_NORMAL
- en: '![How Big Data Is Saving Lives in Real Time: IoV Data Analytics Helps Prevent
    Accidents](../Images/e07a206c858c8f8431db0cacdca2bc9d.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Compared to the old Hive-based platform, this new one is more efficient in
    three ways:'
  prefs: []
  type: TYPE_NORMAL
- en: '**Data writing**: Data ingestion into [Apache Doris](https://doris.apache.org/)
    is quick and easy, without complicated configurations and the introduction of
    extra components. It supports a variety of data ingestion methods. For example,
    in this case, data is written from Kafka into Doris via [Stream Load](https://doris.apache.org/docs/data-operate/import/import-way/stream-load-manual),
    and from Hive into Doris via [Broker Load](https://doris.apache.org/docs/data-operate/import/import-way/broker-load-manual).'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Data analysis**: To showcase the query speed of Apache Doris by example,
    it can return a 10-million-row result set within seconds in a cross-table join
    query. Also, it can work as a [unified query gateway](https://doris.apache.org/docs/lakehouse/multi-catalog/)
    with its quick access to external data (Hive, MySQL, Iceberg, etc.), so analysts
    don''t have to juggle between multiple components.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Computation and storage costs**: Apache Doris uses the Z-Standard algorithm
    that can bring a 3~5 times higher data compression ratio. That''s how it helps
    reduce costs in data computation and storage. Moreover, the compression can be
    done solely in Doris so it won''t consume resources from Flink.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'A good real-time analytic solution not only stresses data processing speed,
    it also considers all the way along your data pipeline and smoothens every step
    of it. Here are two examples:'
  prefs: []
  type: TYPE_NORMAL
- en: 1\. The arrangement of CAN data
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: In Kafka, CAN data was arranged by the dimension of CAN ID. However, for the
    sake of data analysis, analysts had to compare signals from various vehicles,
    which meant to concatenate data of different CAN ID into a flat table and align
    it by timestamp. From that flat table, they could derive different tables for
    different analytic purposes. Such transformation was implemented using Spark SQL,
    which was time-consuming in the old Hive-based architecture, and the SQL statements
    are high-maintenance. Moreover, the data was updated by batch on a daily basis,
    which meant they could only get data from a day ago.
  prefs: []
  type: TYPE_NORMAL
- en: In Apache Doris, all they need is to build the tables with the [Aggregate Key
    model](https://doris.apache.org/docs/data-table/data-model#aggregate-model), specify
    VIN (Vehicle Identification Number) and timestamp as the Aggregate Key, and define
    other data fields by REPLACE_IF_NOT_NULL. With Doris, they don't have to take
    care of the SQL statements or the flat table, but are able to extract real-time
    insights from real-time data.
  prefs: []
  type: TYPE_NORMAL
- en: '![How Big Data Is Saving Lives in Real Time: IoV Data Analytics Helps Prevent
    Accidents](../Images/a0375b73a24a80a493e2c4b0f4ec8fc7.png)'
  prefs: []
  type: TYPE_IMG
- en: 3\. DTC data query
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Of all CAN data, DTC (Diagnostic Trouble Code) deserves high attention and separate
    storage, because it tells you what's wrong with a car. Each day, the manufacturer
    receives around 1 billion pieces of DTC. To capture life-saving information from
    the DTC, data engineers need to relate the DTC data to a DTC configuration table
    in MySQL.
  prefs: []
  type: TYPE_NORMAL
- en: 'What they used to do was to write the DTC data into Kafka every day, process
    it in Flink, and store the results in Hive. In this way, the DTC data and the
    DTC configuration table were stored in two different components. That caused a
    dilemma: a 1-billion-row DTC table was hard to write into MySQL, while querying
    from Hive was slow. As the DTC configuration table was also constantly updated,
    engineers could only import a version of it into Hive on a regular basis. That
    meant they didn''t always get to relate the DTC data to the latest DTC configurations.'
  prefs: []
  type: TYPE_NORMAL
- en: As is mentioned, Apache Doris can work as a unified query gateway. This is supported
    by its [Multi-Catalog](https://doris.apache.org/docs/lakehouse/multi-catalog/)
    feature. They import their DTC data from Hive into Doris, and then they create
    a MySQL Catalog in Doris to map to the DTC configuration table in MySQL. When
    all this is done, they can simply join the two tables within Doris and get real-time
    query response.
  prefs: []
  type: TYPE_NORMAL
- en: '![How Big Data Is Saving Lives in Real Time: IoV Data Analytics Helps Prevent
    Accidents](../Images/415f1de3b2195683b1c5357f15d07a53.png)'
  prefs: []
  type: TYPE_IMG
- en: Conclusion
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: This is an actual real-time analytic solution for IoV. It is designed for data
    at really large scale, and it is now supporting a car manufacturer who receives
    10 billion rows of new data every day in improving driving safety and experience.
  prefs: []
  type: TYPE_NORMAL
- en: Building a data platform to suit your use case is not easy, I hope this post
    helps you in building your own analytic solution.
  prefs: []
  type: TYPE_NORMAL
- en: '**[](https://www.linkedin.com/in/zaki-lu-99a06b148/)**[Zaki Lu](https://www.linkedin.com/in/zaki-lu-99a06b148/)****
    is a former product manager at Baidu and now DevRel for the Apache Doris open
    source community.'
  prefs: []
  type: TYPE_NORMAL
- en: More On This Topic
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: '[90% of Today''s Code is Written to Prevent Failure, and That''s a Problem](https://www.kdnuggets.com/2022/07/90-today-code-written-prevent-failure-problem.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Python in Finance: Real Time Data Streaming within Jupyter Notebook](https://www.kdnuggets.com/python-in-finance-real-time-data-streaming-within-jupyter-notebook)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Why we will always need humans to train AI — sometimes in real-time](https://www.kdnuggets.com/2021/12/why-we-need-humans-training-ai.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Feature Stores for Real-time AI & Machine Learning](https://www.kdnuggets.com/2022/03/feature-stores-realtime-ai-machine-learning.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Real-time Translations with AI](https://www.kdnuggets.com/2022/07/realtime-translations-ai.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[How to Build a Real-Time Recommendation Engine Using Graph Databases](https://www.kdnuggets.com/2023/08/build-realtime-recommendation-engine-graph-databases.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
