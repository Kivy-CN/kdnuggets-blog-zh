# 如何使用机器学习进行异常检测和条件监控

> 原文：[https://www.kdnuggets.com/2020/12/machine-learning-anomaly-detection-conditional-monitoring.html](https://www.kdnuggets.com/2020/12/machine-learning-anomaly-detection-conditional-monitoring.html)

[评论](#comments)

**由[迈克尔·加巴德](https://www.linkedin.com/in/garbade)，教育生态系统首席执行官兼创始人**

**关键要点**

+   异常检测分析的主要目标是识别那些不符合正常行为一般模式的观察值。

+   异常检测可能有助于理解数据问题。

+   在某些领域，异常检测方法是相当有效的。

+   现代机器学习工具包括Isolation Forests和其他类似方法，但你需要理解基本概念才能成功实施。

+   Isolation Forest方法是一种无监督的离群点检测方法，具有可解释的结果。

### **介绍**

在进行任何数据分析之前，需要找出数据集中的任何离群点。这些离群点被称为异常。

本文解释了异常检测的目标，并概述了用于解决特定异常检测和条件监控用例的方法。

### **什么是异常检测？实际应用案例。**

异常检测分析的主要目标是识别那些不符合正常行为一般模式的观察值。例如，*图1*展示了分类和回归问题中的异常值。我们可以看到一些值偏离了大多数示例。

![Figure](../Images/f2730b87f308c3cbf3fb6177e8f0a588.png)

***图1. 分类（a，左）和回归（b，右）问题中的离群点***

数据分析中有两个方向用于寻找异常：离群点检测和新颖性检测。因此，离群点是与训练数据集中其他数据点不同的观察值。新颖性数据点也与数据集中的其他观察值不同，但与离群点不同的是，新颖性点出现在测试数据集中，并且通常在训练数据集中不存在。因此，图1中存在离群点。

离群点的最常见原因是；

+   数据错误（测量不准确、舍入、书写错误等）；

+   噪声数据点；

+   数据集中的隐藏模式（欺诈或攻击请求）。

因此，离群值处理取决于数据的性质和领域。噪声数据点应当被过滤（噪声去除）；数据错误应当被纠正。一些应用关注于异常选择，我们进一步考虑一些应用。

异常检测在各种商业用例中都很有用。例如，入侵检测系统（IDS）基于异常检测。图2显示了NSL-KDD数据集的观察分布，这是一个用于IDS的最先进数据集。我们可以看到，大多数观察值是正常请求，而Probe或U2R是一些异常值。自然地，计算机系统中的大多数请求都是正常的，只有一小部分是攻击尝试。

![图](../Images/835e18c19e149416f7e915d898ab9039.png)

***图2\. IDS观察值分布***

信用卡欺诈检测系统（CCFDS）是另一个异常检测的应用案例。例如，来自kaggle.com的开放数据集（https://www.kaggle.com/mlg-ulb/creditcardfraud）包含了2013年9月由欧洲持卡人使用信用卡进行的交易。该数据集展示了两天内发生的交易。在284,807笔交易中，有492笔是欺诈交易。该数据集高度不平衡。正类（欺诈）占所有交易的0.172%。

异常检测有两种方法：

+   监督方法；

+   无监督方法。

在监督异常检测方法中，数据集具有正常和异常观察值或数据点的标签。IDS和CCFDS数据集适用于监督方法。在这些用例中使用标准的机器学习方法。监督异常检测是一种二分类问题。需要注意的是，异常检测问题的数据集通常是不平衡的。因此，在使用监督分类方法之前，重要的是使用一些数据增强程序（k-近邻算法、ADASYN、SMOTE、随机采样等）。Jordan Sweeney展示了如何在教育生态系统项目中使用k-近邻算法，[旅行推销员 - 最近邻](https://www.education-ecosystem.com/jsweeney91/2oPDm-travelling-salesman-nearest-neighbour)。

当对异常及相关模式没有任何信息时，无监督异常检测非常有用。在这种情况下，会使用Isolation Forests、OneClassSVM或k-means方法。其主要思路是将所有观察值分成几个簇，并分析这些簇的结构和大小。

进行异常检测方法测试的开放数据集有很多种，例如，[异常检测数据集](http://odds.cs.stonybrook.edu/)。

### **使用Isolation Forests的无监督异常检测**

Isolation Forests 方法基于决策树的随机实现和其他结果的集成。每棵决策树的构建会一直进行，直到训练数据集耗尽。在决策树中，选择一个随机特征和一个随机拆分来构建新的分支。该算法通过决策树叶子节点深度的平均值将正常点与异常点分开。此方法已在 scikit-learn 库中实现 ([https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.IsolationForest.html](https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.IsolationForest.html))。

为了说明异常检测方法，我们来考虑一些带有异常值的玩具数据集，如图 3 所示。类 1 的点是异常值。列“类”在分析中未使用，只是为了说明。

![图像](../Images/30caf3b01255575047765b447f3a9b92.png)

***图 3\. 数据集样本和散点图***

让我们对这个玩具例子应用 Isolation Forests，并在一些玩具测试数据集上进行进一步测试。结果如 *图 4* 所示。完整代码在这里： https://www.kaggle.com/avk256/anomaly-detection。

![图像](../Images/ef29303642b6bd78cb8f940a13b47881.png)

***图 4\. 数据集和 Isolation Forests 方法的实现***

应注意，‘y_train’ 和 ‘y_test’ 列未用于方法拟合。因此，Isolation Forests 方法仅使用数据点来确定异常值。因此，‘X_test’ 数据集包含两个正常点和两个异常点，经过预测方法后，我们获得了完全相等的两个簇分布。

### **结论**

总的来说，异常检测方法可用于各种应用场景，例如，从噪声数据点和观察错误中清理数据。另一方面，异常检测方法也可用于业务应用，如入侵检测或信用卡欺诈检测系统。Andrey 在其项目 [机器学习模型：Python Sklearn & Keras](https://www.education-ecosystem.com/andreybu/REaxr-machine-learning-model-python-sklearn-kera/oPGdP-machine-learning-model-python-sklearn-kera/) 中演示了 Isolation Forests 方法，它是无监督异常检测中最简单和有效的方法之一。此外，该方法已在先进的库 Scikit-learn 中实现。

**简历： [迈克尔·加尔巴德](https://www.linkedin.com/in/garbade)** 是 Education Ecosystem 的首席执行官兼创始人。迈克尔是一位前瞻性的全球连续创业者，擅长软件开发、后端架构、数据科学、人工智能、金融科技、区块链和风险投资。他结合了技术、数据、金融和业务发展的经验，拥有令人印象深刻的教育背景和识别新商业模式的才能。作为 Education Ecosystem 的联合创始人兼首席执行官，他的使命是建立全球最大的去中心化学习生态系统，服务于专业开发人员和大学生。他在 Opensource.com、Dzone.com、Cybrary、Businessinsider、Entrepreneur.com、TechinAsia、Coindesk 和 Cointelegraph 等领先博客上撰写主题专家技术和商业文章。

**相关：**

+   [异常检测：AI 和机器学习的关键任务解析](/2019/10/anomaly-detection-explained.html)

+   [介绍 MIDAS：图形中异常检测的新基准](/2020/04/midas-new-baseline-anomaly-detection-graphs.html)

+   [异常检测介绍](/2017/04/datascience-introduction-anomaly-detection.html)

* * *

## 我们的前三个课程推荐

![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 1\. [Google 网络安全证书](https://www.kdnuggets.com/google-cybersecurity) - 快速进入网络安全职业生涯。

![](../Images/e225c49c3c91745821c8c0368bf04711.png) 2\. [Google 数据分析专业证书](https://www.kdnuggets.com/google-data-analytics) - 提升你的数据分析技能

![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 3\. [Google IT 支持专业证书](https://www.kdnuggets.com/google-itsupport) - 支持你在 IT 领域的组织

* * *

### 更多相关话题

+   [BigQuery 中的异常检测：揭示隐藏的洞察并推动行动](https://www.kdnuggets.com/anomaly-detection-in-bigquery-uncover-hidden-insights-and-drive-action)

+   [数据科学中异常检测技术的初学者指南](https://www.kdnuggets.com/2023/05/beginner-guide-anomaly-detection-techniques-data-science.html)

+   [用 AI 对抗 AI：深伪应用的 AI 欺诈监控](https://www.kdnuggets.com/2023/05/fighting-ai-ai-fraud-monitoring-deepfake-applications.html)

+   [如何使用 Pandas 的条件格式化来增强数据可视化](https://www.kdnuggets.com/how-to-use-conditional-formatting-in-pandas-to-enhance-data-visualization)

+   [在 Pandas 中进行条件筛选的五种方法](https://www.kdnuggets.com/2022/12/five-ways-conditional-filtering-pandas.html)

+   [如何使用 Python 执行运动检测](https://www.kdnuggets.com/2022/08/perform-motion-detection-python.html)
