- en: 'Using SQL with Python: SQLAlchemy and Pandas'
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://www.kdnuggets.com/using-sql-with-python-sqlalchemy-and-pandas](https://www.kdnuggets.com/using-sql-with-python-sqlalchemy-and-pandas)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: '![Using SQL with Python: SQLAlchemy and Pandas cover image](../Images/514e8ddb11081ab64e092520e5706977.png)'
  prefs: []
  type: TYPE_IMG
- en: Image by Author
  prefs: []
  type: TYPE_NORMAL
- en: As a data scientist, you need Python for detailed data analysis, data visualization,
    and modeling. However, when your data is stored in a relational database, you
    need to use SQL (Structured Query Language) to extract and manipulate the data.
    But how do you integrate SQL with Python to unlock the full potential of your
    data?
  prefs: []
  type: TYPE_NORMAL
- en: '* * *'
  prefs: []
  type: TYPE_NORMAL
- en: Our Top 3 Course Recommendations
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 1\. [Google Cybersecurity
    Certificate](https://www.kdnuggets.com/google-cybersecurity) - Get on the fast
    track to a career in cybersecurity.'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/e225c49c3c91745821c8c0368bf04711.png) 2\. [Google Data Analytics
    Professional Certificate](https://www.kdnuggets.com/google-data-analytics) - Up
    your data analytics game'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 3\. [Google IT Support
    Professional Certificate](https://www.kdnuggets.com/google-itsupport) - Support
    your organization in IT'
  prefs: []
  type: TYPE_NORMAL
- en: '* * *'
  prefs: []
  type: TYPE_NORMAL
- en: In this tutorial, we will learn to combine the power of SQL with the flexibility
    of Python using SQLAlchemy and Pandas. We will learn how to connect to databases,
    execute SQL queries using SQLAlchemy, and analyze and visualize data using Pandas.
  prefs: []
  type: TYPE_NORMAL
- en: 'Install Pandas and SQLAlchemy using:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: 1\. Saving the Pandas DataFrame as an SQL Table
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'To create the SQL table using the CSV dataset, we will:'
  prefs: []
  type: TYPE_NORMAL
- en: Create a SQLite database using the SQLAlchemy.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Load the CSV dataset using the Pandas. The [countries_poluation](https://www.kaggle.com/datasets/willianoliveiragibin/countries-poluation)
    dataset consists of the Air Quality Index (AQI) for all countries in the world
    from 2017 to 2023.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Convert all the AQI columns from object to numerical and drop row with missing
    values.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs: []
  type: TYPE_PRE
- en: Save the Pandas dataframe as a SQL table. The `to_sql` function requires a table
    name and the engine object.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE2]'
  prefs: []
  type: TYPE_PRE
- en: As a result, your SQLite database is saved in your file directory.
  prefs: []
  type: TYPE_NORMAL
- en: '![Deepnote file manager](../Images/421fd28094b44ace698fb0faef8e6223.png)'
  prefs: []
  type: TYPE_IMG
- en: '**Note:** I am using Deepnote for this tutorial to run the Python code seamlessly.
    Deepnote is a free AI Cloud Notebook that will help you quickly run any data science
    code.'
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: 2\. Loading the SQL Table using Pandas
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'To load the entire table from the SQL database as a Pandas dataframe, we will:'
  prefs: []
  type: TYPE_NORMAL
- en: Establish the connection with our database by providing the database URL.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Use the `pd.read_sql_table` function to load the entire table and convert it
    into a Pandas dataframe. The function requires table anime, engine objects, and
    column names.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Display the top 5 rows.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE3]'
  prefs: []
  type: TYPE_PRE
- en: The SQL table has been successfully loaded as a dataframe. This means that you
    can now use it to perform data analysis and visualization using popular Python
    packages such as Seaborn, Matplotlib, Scipy, Numpy, and more.
  prefs: []
  type: TYPE_NORMAL
- en: '![countries air pollution pandas dataframe](../Images/334a7809a6841a54b9db56493b4f5a3e.png)'
  prefs: []
  type: TYPE_IMG
- en: 3\. Running the SQL Query using Pandas
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Instead of restricting ourselves to one table, we can access the entire database
    by using the `pd.read_sql` function. Just write a simple SQL query and provide
    it with the engine object.
  prefs: []
  type: TYPE_NORMAL
- en: The SQL query will display two columns from the "countries_population" table,
    sort it by the "2023" column, and display the top 5 results.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE4]'
  prefs: []
  type: TYPE_PRE
- en: We got to the top 5 cities in the world with the worst air quality.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE5]'
  prefs: []
  type: TYPE_PRE
- en: 4\. Using the SQL Query Result with Pandas
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: We can also use the results from SQL query and perform further analysis. For
    example, calculate the average of the top five cities using Pandas.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE6]'
  prefs: []
  type: TYPE_PRE
- en: 'Output:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE7]'
  prefs: []
  type: TYPE_PRE
- en: Or, create a bar plot by specifying the x and y arguments and the type of plot.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE8]'
  prefs: []
  type: TYPE_PRE
- en: '![data visualization using pandas](../Images/641625a7e2204e9360c907cfbf20ba18.png)'
  prefs: []
  type: TYPE_IMG
- en: Conclusion
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: The possibilities of using SQLAlchemy with Pandas are endless. You can perform
    simple data analysis using the SQL query, but to visualize the results or even
    train the machine learning model, you have to convert it into a Pandas dataframe.
  prefs: []
  type: TYPE_NORMAL
- en: In this tutorial, we have learned how to load a SQL database into Python, perform
    data analysis, and create visualizations. If you enjoyed this guide, you will
    also appreciate '[A Guide to Working with SQLite Databases in Python](/a-guide-to-working-with-sqlite-databases-in-python)',
    which provides an in-depth exploration of using Python's built-in sqlite3 module.
  prefs: []
  type: TYPE_NORMAL
- en: '[](https://www.polywork.com/kingabzpro)****[Abid Ali Awan](https://www.polywork.com/kingabzpro)****
    ([@1abidaliawan](https://www.linkedin.com/in/1abidaliawan)) is a certified data
    scientist professional who loves building machine learning models. Currently,
    he is focusing on content creation and writing technical blogs on machine learning
    and data science technologies. Abid holds a Master''s degree in technology management
    and a bachelor''s degree in telecommunication engineering. His vision is to build
    an AI product using a graph neural network for students struggling with mental
    illness.'
  prefs: []
  type: TYPE_NORMAL
- en: More On This Topic
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: '[Query Your Pandas DataFrames with SQL](https://www.kdnuggets.com/2021/10/query-pandas-dataframes-sql.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[SQL in Pandas with Pandasql](https://www.kdnuggets.com/sql-in-pandas-with-pandasql)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[How to Select Rows and Columns in Pandas Using [ ], .loc, iloc, .at…](https://www.kdnuggets.com/2019/06/select-rows-columns-pandas.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[How To Speed Up SQL Queries Using Indexes [Python Edition]](https://www.kdnuggets.com/2023/08/speed-sql-queries-indexes-python-edition.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Using the apply() Method with Pandas Dataframes](https://www.kdnuggets.com/2022/07/apply-method-pandas-dataframes.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[How to Deal with Missing Data Using Interpolation Techniques in Pandas](https://www.kdnuggets.com/how-to-deal-with-missing-data-using-interpolation-techniques-in-pandas)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
