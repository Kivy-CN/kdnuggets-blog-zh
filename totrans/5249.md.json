["```py\nJanuary_pool AS\n\n(                \n                SELECT DISTINCT cust_id\n\n                FROM            dataset\n\n                WHERE           month(transaction_date)=1\n\n                AND             year(transaction_date)=2016)\n```", "```py\nSELECT *Year*(transaction_date),\n       *Month*(transaction_date),\n       count (distinct cust_id) AS number\n\nFROM dataset\n\nWHERE year(transaction_date)=2016\n\nAND cust_id IN january_pool\n\nGROUP BY 1,\n\n         2\n```", "```py\nVisit_log AS\n\nSELECT cust_id,\n\n       datediff(month, ‘2000–01–01’, transaction_date) AS visit_month\n\nFROM dataset\n\nGROUP BY 1,\n\n         2\n\nORDER BY 1,\n\n         2\n```", "```py\nTime_lapse AS\n\n    SELECT cust_id,\n\n           visit_month lead(visit_month, 1) over (partition BY cust_id ORDER BY cust_id, visit_month)\n\n    FROM visit_log\n```", "```py\nTime_diff_calculated AS\n\n    SELECT cust_id,\n\n           visit_month,\n\n           lead,\n\n           lead — visit_month AS time_diff\n\n    FROM time_lapse\n```", "```py\nCusts_categorized AS\n\nSELECT cust_id,\n\n       visit_month,\n\n       CASE\n\n             WHEN time_diff=1 THEN ‘retained’,\n\n             WHEN time_diff>1 THEN ‘lagger’,\n\n             WHEN time_diff IS NULL THEN ‘lost’\n\n       END AS cust_type\n\nFROM time_diff_calculated\n```", "```py\nSELECT visit_month,\n\n       count(cust_id where cust_type=’retained’)/count(cust_id) AS retention\n\nFROM custs_categorized\n\nGROUP BY 1\n```"]