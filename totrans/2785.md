# 如何在 3 个简单步骤中对任何 Python 脚本进行超参数调优

> 原文：[https://www.kdnuggets.com/2020/04/hyperparameter-tuning-python.html](https://www.kdnuggets.com/2020/04/hyperparameter-tuning-python.html)

[评论](#comments)

**由 [Jakub Czakon](https://www.linkedin.com/in/jakub-czakon-2b797b69/?originalSubdomain=pl)，Neptune.ai**。

![Python](../Images/48653af31024defdcd657420253f346a.png)

你写了一个训练和评估机器学习模型的 Python 脚本。现在，你希望自动调整超参数以提高其性能？

我明白了！

在这篇文章中，我将展示如何将你的脚本转换为一个可以用任何超参数优化库进行优化的目标函数。

![](../Images/e0074c461140259d5cecec92bd0d7474.png)

只需 3 步，你就能像没有明天一样调整模型参数。

准备好了吗？

开始吧！

我假设你的 ***main.py*** 脚本看起来像这样：

[PRE0]

### 第 1 步：将搜索参数与代码解耦

将你想调整的参数放入脚本顶部的字典中。通过这样做，你有效地将搜索参数与代码的其余部分解耦。

[PRE1]

### 第 2 步：将训练和评估封装到一个函数中

现在，你可以将整个训练和评估逻辑放在 ***train_evaluate*** 函数中。这个函数以参数作为输入，并输出验证得分。

[PRE2]

### 第 3 步：运行超参数调优脚本

我们快到了。

你现在需要做的就是使用这个 ***train_evaluate*** 函数作为你选择的黑箱优化库的目标。

我将使用 [Scikit Optimize](https://neptune.ai/blog/scikit-optimize)，我在另一篇文章中详细描述了它，但你可以使用任何超参数优化库。

简而言之，我：

+   定义搜索 ***SPACE***，

+   创建要最小化的 ***objective*** 函数，

+   运行通过 ***forest_minimize*** 函数进行优化。

在这个例子中，我尝试了 **100** 种不同的配置，从 **10** 个随机选择的参数集合开始。

[PRE3]

就这样。

 ***results*** 对象包含关于 **最佳得分** 和 **产生该得分的参数** 的信息。

**注意：**

如果你想在训练完成后** 可视化你的训练并保存诊断图表**，你可以添加一个回调和一个函数调用，以 **记录每次超参数搜索** 到 Neptune。只需使用这个 [来自 neptune-contrib 的帮助函数](https://neptune-contrib.readthedocs.io/_modules/neptunecontrib/monitoring/skopt.html#NeptuneMonitor) 库。

[PRE4]

现在，当你运行你的参数搜索时，你会看到以下内容：

![](../Images/d3998fa6921a2e0309b148132c5981aa.png)

查看 [skopt 超参数搜索实验](https://ui.neptune.ai/jakub-czakon/blog-hpo/e/BLOG-369/charts) ，其中包含所有代码、图表和结果。

### 最后的想法

在这篇文章中，你已经学会了如何在仅 3 步中优化几乎任何 Python 脚本的超参数。

希望借助这些知识，你能以更少的努力构建更好的机器学习模型。

祝训练愉快！

[原文](https://neptune.ai/blog/hyperparameter-tuning-on-any-python-script)。已获得许可转载。

**相关：**

+   [实用的超参数优化](https://www.kdnuggets.com/2020/02/practical-hyperparameter-optimization.html)

+   [如何自动化超参数优化](https://www.kdnuggets.com/2019/06/automate-hyperparameter-optimization.html)

+   [在 Google Colab 中使用 Hyperas 进行 Keras 超参数调优](https://www.kdnuggets.com/2018/12/keras-hyperparameter-tuning-google-colab-hyperas.html)

* * *

## 我们的三大课程推荐

![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 1\. [Google 网络安全证书](https://www.kdnuggets.com/google-cybersecurity) - 快速进入网络安全职业道路。

![](../Images/e225c49c3c91745821c8c0368bf04711.png) 2\. [Google 数据分析专业证书](https://www.kdnuggets.com/google-data-analytics) - 提升你的数据分析能力

![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 3\. [Google IT 支持专业证书](https://www.kdnuggets.com/google-itsupport) - 支持你的组织 IT 工作

* * *

### 更多相关话题

+   [每个数据科学家都应该知道的三个 R 库（即使你使用 Python）](https://www.kdnuggets.com/2021/12/three-r-libraries-every-data-scientist-know-even-python.html)

+   [是什么让 Python 成为初创公司理想的编程语言](https://www.kdnuggets.com/2021/12/makes-python-ideal-programming-language-startups.html)

+   [停止学习数据科学以找到目的，并找到目的……](https://www.kdnuggets.com/2021/12/stop-learning-data-science-find-purpose.html)

+   [一项 90 亿美元的 AI 失败，详解](https://www.kdnuggets.com/2021/12/9b-ai-failure-examined.html)

+   [学习数据科学统计学的最佳资源](https://www.kdnuggets.com/2021/12/springboard-top-resources-learn-data-science-statistics.html)

+   [成功数据科学家的 5 个特征](https://www.kdnuggets.com/2021/12/5-characteristics-successful-data-scientist.html)
