["```py\nfrom rake_nltk import Rake\nimport pandas as pd\nimport numpy as np\nfrom sklearn.metrics.pairwise import cosine_similarity\nfrom sklearn.feature_extraction.text import CountVectorizerdf = pd.read_csv('IMDB_Top250Engmovies2_OMDB_Detailed.csv')\ndf.head()\n```", "```py\ndf['Director'].value_counts()[0:10].plot('barh', figsize=[8,5], fontsize=15, color='navy').invert_yaxis()\n```", "```py\ndf['Key_words'] = ''\nr = Rake()for index, row in df.iterrows():\n    r.extract_keywords_from_text(row['Plot'])\n    key_words_dict_scores = r.get_word_degrees()\n    row['Key_words'] = list(key_words_dict_scores.keys())\n```", "```py\ndf['Genre'] = df['Genre'].map(lambda x: x.split(','))\ndf['Actors'] = df['Actors'].map(lambda x: x.split(',')[:3])\ndf['Director'] = df['Director'].map(lambda x: x.split(','))for index, row in df.iterrows():\n    row['Genre'] = [x.lower().replace(' ','') for x in row['Genre']]\n    row['Actors'] = [x.lower().replace(' ','') for x in row['Actors']]\n    row['Director'] = [x.lower().replace(' ','') for x in row['Director']]\n```", "```py\ndf['Bag_of_words'] = ''\ncolumns = ['Genre', 'Director', 'Actors', 'Key_words']for index, row in df.iterrows():\n    words = ''\n    for col in columns:\n        words += ' '.join(row[col]) + ' '\n    row['Bag_of_words'] = words\n\ndf = df[['Title','Bag_of_words']]\n```", "```py\ncount = CountVectorizer()\ncount_matrix = count.fit_transform(df['Bag_of_words'])cosine_sim = cosine_similarity(count_matrix, count_matrix)\nprint(cosine_sim)\n```", "```py\nindices = pd.Series(df['Title'])\n```", "```py\ndef recommend(title, cosine_sim = cosine_sim):\n    recommended_movies = []\n    idx = indices[indices == title].index[0]\n    score_series = pd.Series(cosine_sim[idx]).sort_values(ascending = False)\n    top_10_indices = list(score_series.iloc[1:11].index)\n\n    for i in top_10_indices:\n        recommended_movies.append(list(df['Title'])[i])\n\n    return recommended_movies\n```", "```py\nrecommend('The Avengers')\n```"]