# 朴素贝叶斯：机器学习分类性能的基线模型

> 原文：[https://www.kdnuggets.com/2019/04/naive-bayes-baseline-model-machine-learning-classification-performance.html](https://www.kdnuggets.com/2019/04/naive-bayes-baseline-model-machine-learning-classification-performance.html)

![c](../Images/3d9c022da2d331bb56691a9617b91b90.png) [评论](/2019/04/naive-bayes-baseline-model-machine-learning-classification-performance.html?page=2#comments)![scikitlearn-pandas-naive-bayes](../Images/d3fbe85bbd5285ee92f5591fc9b15d6f.png)

### 贝叶斯定理

![方程](../Images/3792011e5ee54c481017b1511c531e4d.png)

* * *

## 我们的前三个课程推荐

![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 1\. [Google 网络安全证书](https://www.kdnuggets.com/google-cybersecurity) - 快速进入网络安全职业生涯。

![](../Images/e225c49c3c91745821c8c0368bf04711.png) 2\. [Google 数据分析专业证书](https://www.kdnuggets.com/google-data-analytics) - 提升您的数据分析能力

![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 3\. [Google IT 支持专业证书](https://www.kdnuggets.com/google-itsupport) - 支持您的组织进行 IT 管理

* * *

上述方程表示了贝叶斯定理，它描述了基于我们对可能与该事件相关的事件 P(B) 的先验知识，事件 A 发生的概率 P(A)。

探讨贝叶斯定理的各个部分：

+   P(A|B) - **后验概率**

    +   事件 A 发生的条件概率，前提是事件 B 已经发生。

+   P(A) - **先验概率**

    +   事件 A 的概率。

+   P(B) - **证据**

    +   事件 B 的概率。

+   P(B|A) - **似然**

    +   给定事件 A 已发生，B 发生的条件概率。

*现在，让我们通过从事机器学习的视角深入探讨贝叶斯定理的各个部分：*

+   P(A|B) - **后验概率**

    +   给定训练数据输入的响应变量 (目标变量) 的条件概率。

+   P(A) - **先验概率**

    +   响应变量 (目标变量) 的概率。

+   P(B) - **证据**

    +   训练数据的概率。

+   P(B|A) - **似然**

    +   给定响应变量的训练数据的条件概率。

![方程](../Images/b132eb838838ec88563bb42acd6e8ded.png)

+   P(c|x) - 给定预测器 (x) 的目标/类别 (c) 的后验概率。

+   P(c) - 类别 (目标) 的先验概率。

+   P(x|c) - 给定类别/目标 (c) 的预测器 (x) 的概率。

+   P(x) - 预测器 (x) 的先验概率。

**贝叶斯定理的例子：**

我将使用 [网球天气数据集](https://www.kaggle.com/pranavpandey2511/naive-bayes-classifier-from-scratch/data)。

[PRE0]

[PRE1]

|  | 天气 | 温度 | 湿度 | 风 | 玩 |
| --- | --- | --- | --- | --- | --- |
| 0 | 晴天 | 热 | 高 | 假 | 否 |
| 1 | 晴天 | 热 | 高 | 真 | 否 |
| 2 | 多云 | 热 | 高 | 假 | 是 |
| 3 | 多雨 | 温和 | 高 | 假 | 是 |
| 4 | rainy | cool | normal | False | yes |
| 5 | rainy | cool | normal | True | no |
| 6 | overcast | cool | normal | True | yes |
| 7 | sunny | mild | high | False | no |
| 8 | sunny | cool | normal | False | yes |
| 9 | rainy | mild | normal | False | yes |
| 10 | sunny | mild | normal | True | yes |
| 11 | overcast | mild | high | True | yes |
| 12 | overcast | hot | normal | False | yes |
| 13 | rainy | mild | high | True | no |

让我们看看每个类别在频率表中的情况：

[PRE2]

[PRE3]

[PRE4]

**在下雨的情况下打网球的概率是多少？**

+   P(rain|play=yes)

    +   频率（outlook=rainy）当（play=yes）/ 频率（play=yes） = 3/9

+   P(play=yes)

    +   频率（play=yes）/ 总计（play） = 9/14

+   P(outlook=rainy)

    +   频率（outlook=rainy）/ 总计（outlook） = 5/14

![方程](../Images/d7a41a03bdc3d8062103dca6c9067ef3.png)

[PRE5]

[PRE6]

当天气下雨时打网球的概率是**60%**。一旦你获取了每个类别的频率，过程就会非常简单。

这里有一个简单的函数来帮助任何新手记住贝叶斯方程的各个部分：

[PRE7]

这里是一个简单的函数来计算后验概率，但你必须自己找到贝叶斯方程的每一部分。

[PRE8]

**让我们看看另一种使用 Python 中的列联表来计算后验概率的方法：**

[PRE9]

[PRE10]

[PRE11]

|  | no | yes | rowtotal |
| --- | --- | --- | --- |
| overcast | 0.000000 | 0.285714 | 0.285714 |
| rainy | 0.142857 | 0.214286 | 0.357143 |
| sunny | 0.214286 | 0.142857 | 0.357143 |
| coltotal | 0.357143 | 0.642857 | 1.000000 |

仅获取列总计

[PRE12]

|  | no | yes | rowtotal |
| --- | --- | --- | --- |
| overcast | 0.0 | 0.444444 | 0.285714 |
| rainy | 0.4 | 0.333333 | 0.357143 |
| sunny | 0.6 | 0.222222 | 0.357143 |
| coltotal | 1.0 | 1.000000 | 1.000000 |

仅获取行总计

[PRE13]

|  | no | yes | rowtotal |
| --- | --- | --- | --- |
| overcast | 0.000000 | 1.000000 | 1.0 |
| rainy | 0.400000 | 0.600000 | 1.0 |
| sunny | 0.600000 | 0.400000 | 1.0 |
| coltotal | 0.357143 | 0.642857 | 1.0 |

这些表格都是 pandas 数据框对象。因此，使用 pandas 子集和我制作的 `bayesposterior` 函数，我们可以得出相同的结论：

[PRE14]

[PRE15]

### 朴素贝叶斯算法

[朴素贝叶斯](https://www.kdnuggets.com/2020/06/naive-bayes-algorithm-everything.html) 是一种受贝叶斯定理启发的监督学习算法。它基于条件概率原理。朴素贝叶斯是一种用于二分类和多分类的分类算法。朴素贝叶斯算法利用每个属性属于每个类别的概率来进行预测。

**例子**

当天气晴朗、炎热、湿度高且有风时打网球的概率是多少？因此，使用网球数据集，我们需要使用朴素贝叶斯方法来预测在上述天气条件下某人打网球的概率。

[PRE16]

| play | no | yes | All |
| --- | --- | --- | --- |
| outlook |  |  |  |
| --- | --- | --- | --- |
| overcast | 0 | 4 | 4 |
| rainy | 2 | 3 | 5 |
| sunny | 3 | 2 | 5 |
| All | 5 | 9 | 14 |

[PRE17]

| play | no | yes | All |
| --- | --- | --- | --- |
| temp |  |  |  |
| --- | --- | --- | --- |
| cool | 1 | 3 | 4 |
| hot | 2 | 2 | 4 |
| mild | 2 | 4 | 6 |
| All | 5 | 9 | 14 |

[PRE18]

| play | no | yes | All |
| --- | --- | --- | --- |
| humidity |  |  |  |
| --- | --- | --- | --- |
| high | 4 | 3 | 7 |
| normal | 1 | 6 | 7 |
| All | 5 | 9 | 14 |

[PRE19]

| play | no | yes | All |
| --- | --- | --- | --- |
| windy |  |  |  |
| --- | --- | --- | --- |
| False | 2 | 6 | 8 |
| True | 3 | 3 | 6 |
| All | 5 | 9 | 14 |

[PRE20]

| col_0 | count | All |
| --- | --- | --- |
| play |  |  |
| --- | --- | --- |
| no | 5 | 5 |
| yes | 9 | 9 |
| All | 14 | 14 |

现在，使用上述列联表，我们将深入探讨朴素贝叶斯算法如何计算后验概率。

1.  1.  计算P(x|play=yes)。在这种情况下，x指代所有预测变量，如'outlook'、'temp'、'humidity'和'windy'。

        1.  P(sunny|play=yes)→2/9

        1.  P(hot|play=yes)→2/9

        1.  P(high|play=yes)→3/9

        1.  P(True|play=yes)→3/9

![方程](../Images/bec5c1f801cc9c8ccf92a161c9dca547.png)

[PRE21]

[PRE22]

1.  1.  使用与上述相同的方法计算P(x|play=no)。

        1.  P(sunny|play=no)→3/5

        1.  P(hot|play=no)→2/5

        1.  P(high|play=no)→4/5

        1.  P(True|play=no)→3/5

![方程](../Images/70fbd367eb381cbabb572a825d6e53c7.png)

[PRE23]

[PRE24]

1.  1.  计算P(play=yes)和P(play=no)

        1.  P(play=yes)→9/14

        1.  P(play=yes)→5/14

[PRE25]

[PRE26]

1.  1.  计算给定预测变量的打球和不打球的概率

![方程](../Images/d596883dd6ccbaa6b96ac83242bc7a7e.png)![方程](../Images/a434b4dc81a82288a4e9667dfd955778.png)

[PRE27]

[PRE28]

1.  1.  预测结果将是概率更高的那个

[PRE29]

[PRE30]

### 朴素贝叶斯算法的类型

Python的Scikit-learn为用户提供了以下3种朴素贝叶斯模型。

1.  高斯

    +   高斯NB算法假设所有连续特征（预测变量）均服从高斯（正态分布）。

1.  多项式

    +   多项式NB适用于具有频率和计数的离散数据。垃圾邮件过滤和文本/文档分类是两个非常著名的用例。

1.  伯努利

    +   伯努利与多项式类似，只是它用于布尔/二进制特征。与多项式方法一样，它可以用于垃圾邮件过滤和文档分类，其中二进制术语（即文档中的词出现情况用True或False表示）。

让我们使用Scikit-learn实现一个多项式和高斯模型

[PRE31]

### 更多相关内容

+   [高斯朴素贝叶斯解释](https://www.kdnuggets.com/2023/03/gaussian-naive-bayes-explained.html)

+   [朴素贝叶斯算法：你需要知道的一切](https://www.kdnuggets.com/2020/06/naive-bayes-algorithm-everything.html)

+   [KDnuggets 新闻，4月13日：数据科学家应该了解的 Python 库](https://www.kdnuggets.com/2022/n15.html)

+   [更多分类问题的性能评估指标](https://www.kdnuggets.com/2020/04/performance-evaluation-metrics-classification.html)

+   [使用 Tensorflow 训练图像分类模型指南](https://www.kdnuggets.com/2022/12/guide-train-image-classification-model-tensorflow.html)

+   [理解分类指标：评估模型准确性的指南](https://www.kdnuggets.com/understanding-classification-metrics-your-guide-to-assessing-model-accuracy)
