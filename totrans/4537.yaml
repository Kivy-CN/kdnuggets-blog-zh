- en: Let’s Build an Intelligent Chatbot
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://www.kdnuggets.com/2019/12/build-intelligent-chatbot.html](https://www.kdnuggets.com/2019/12/build-intelligent-chatbot.html)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: '[comments](#comments)'
  prefs: []
  type: TYPE_NORMAL
- en: In the article [**Build your first chatbot using Python NLTK**](https://towardsdatascience.com/build-your-first-chatbot-using-python-nltk-5d07b027e727)we
    wrote a simple python code and built a chatbot. The questions and answers were
    loosely hardcoded which means the chatbot cannot give satisfactory answers for
    the questions which are not present in your code. So our chatbot is considered
    not an intelligent bot.
  prefs: []
  type: TYPE_NORMAL
- en: Here in this article, we will build a document or information-based chatbot
    that will dive deep into your query and based on that it's going to respond.
  prefs: []
  type: TYPE_NORMAL
- en: '* * *'
  prefs: []
  type: TYPE_NORMAL
- en: Our Top 3 Course Recommendations
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 1\. [Google Cybersecurity
    Certificate](https://www.kdnuggets.com/google-cybersecurity) - Get on the fast
    track to a career in cybersecurity.'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/e225c49c3c91745821c8c0368bf04711.png) 2\. [Google Data Analytics
    Professional Certificate](https://www.kdnuggets.com/google-data-analytics) - Up
    your data analytics game'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 3\. [Google IT Support
    Professional Certificate](https://www.kdnuggets.com/google-itsupport) - Support
    your organization in IT'
  prefs: []
  type: TYPE_NORMAL
- en: '* * *'
  prefs: []
  type: TYPE_NORMAL
- en: Introduction
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: A **chatbot** (also known as a **talkbot**, **chatterbot**, **Bot**, **IM bot**, **interactive
    agent**, or **Artificial Conversational Entity**) is a [computer program](https://en.wikipedia.org/wiki/Computer_program) or
    an [artificial intelligence](https://en.wikipedia.org/wiki/Artificial_intelligence) which
    conducts a [conversation](https://en.wikipedia.org/wiki/Conversation) via auditory
    or textual methods. Such programs are often designed to convincingly simulate
    how a human would behave as a conversational partner, thereby passing the [Turing
    test](https://en.wikipedia.org/wiki/Turing_test). Chatbots are typically used
    in [dialog systems](https://en.wikipedia.org/wiki/Dialog_system) for various practical
    purposes including customer service or information acquisition. — Wikipedia
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Chatbots are hot today. Who doesn't know about them? Chatbots are seen as the
    future way of interacting with your customers, employees and all other people
    out there you want to talk to. The essence is that this communication is a dialogue.
    Contrary to just publishing the information, people who use a chatbot can get
    to the information they desire more directly by asking questions.
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure](../Images/575f2055395fdc5754940de5ec5ced02.png)'
  prefs: []
  type: TYPE_IMG
- en: Source: [outgrow.co](https://outgrow.co/chatbots/)
  prefs: []
  type: TYPE_NORMAL
- en: What do Chatbots do?
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: 'Chatbots are relevant because of the following reasons:'
  prefs: []
  type: TYPE_NORMAL
- en: They make available to people, the right information at the right time, right
    place and most importantly only when they want.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: About 90% of our time on mobile is spent on email and messaging platforms. So
    it makes sense to engage customers using chatbots instead of diverting them to
    a website or a mobile app.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The advancements in [artificial intelligence](https://www.edureka.co/blog/what-is-artificial-intelligence), [machine
    learning](https://www.edureka.co/blog/scikit-learn-machine-learning/), and [natural
    language processing](https://www.youtube.com/watch?v=05ONoGfmKvA), allowing bots
    to converse more and more, like real people.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: With chatbots, firms can be available 24/7 to users and visitors. Now, the sales
    and customer service teams can focus on more complex tasks while the chatbot guides
    people down the funnel.
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure](../Images/ad994e628df547cac960ba27181512b0.png)'
  prefs: []
  type: TYPE_IMG
- en: Source: [edureka.co](https://www.edureka.co/blog/how-to-develop-a-chat-bot-using-amazon-lex/)
  prefs: []
  type: TYPE_NORMAL
- en: Modern chatbots do not rely solely on text, and will often show useful cards,
    images, links, and forms, providing an app-like experience.
  prefs: []
  type: TYPE_NORMAL
- en: 'Depending on way bots are programmed, we can categorize them into two variants
    of chatbots: Rule-Based (dumb bots) & Self Learning (smart bots).'
  prefs: []
  type: TYPE_NORMAL
- en: '**Rule-Based Chatbots**: This variety of bots answer questions based on some
    simple rules that they are trained on.'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '**Self-Learning Chatbots**: This variety of bots rely on [Artificial Intelligence](https://www.edureka.co/blog/what-is-artificial-intelligence)(AI)
    & [Machine Learning](https://www.edureka.co/blog/machine-learning-tutorial/)(MI)
    technologies to converse with users.'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Self-learning Chatbots are further divided into **Retrieval based and Generative.**
  prefs: []
  type: TYPE_NORMAL
- en: '**Retrieval based**'
  prefs: []
  type: TYPE_NORMAL
- en: Retrieval based bots work on the principle of directed flows or graphs.The bot
    is trained to rank the best response from a finite set of predefined responses.
    The responses here are entered manually, or based on a knowledge base of pre-existing
    information.
  prefs: []
  type: TYPE_NORMAL
- en: '**Eg.** What are your store timings?'
  prefs: []
  type: TYPE_NORMAL
- en: '**Answer:** 9 to 5 pm'
  prefs: []
  type: TYPE_NORMAL
- en: These systems can be extended to integrate with 3rd Party systems as well.
  prefs: []
  type: TYPE_NORMAL
- en: '**Eg.** Where is my order?'
  prefs: []
  type: TYPE_NORMAL
- en: '**Answer:** It’s on its way and should reach you in 10 mins'
  prefs: []
  type: TYPE_NORMAL
- en: Retrieval based bots are the most common types of chatbots that you see today.
    They allow bot developers and UX to control the experience and match it to the
    expectations of our customers. They work best for **goal-oriented** bots in customer
    support, lead generation and feedback. We can decide the tone of the bot, and
    design the experience, keeping in mind the customer’s brand and reputation.
  prefs: []
  type: TYPE_NORMAL
- en: '**Generative**'
  prefs: []
  type: TYPE_NORMAL
- en: Another method of building chatbots is using a generative model. These chatbots
    are not built with predefined responses. Instead, they are trained using a large
    number of previous conversations, based upon which responses to the user are generated.
    They require a very large amount of conversational data to train.
  prefs: []
  type: TYPE_NORMAL
- en: Generative models are good for conversational chatbots with whom the user is
    simply looking to exchange banter. These models will virtually always have a response
    ready for you. However, in many cases, the responses might be arbitrary and not
    make a lot of sense to you. The chatbot is also prone to generating answers with
    incorrect grammar and syntax.
  prefs: []
  type: TYPE_NORMAL
- en: Chatbot building
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: There are a few things you need to know before moving forward. **Natural Language
    Processing(NLP) using NLTK, TF-IDF and Cosine similarity.**
  prefs: []
  type: TYPE_NORMAL
- en: '**Natural Language Processing(NLP) using NLTK**'
  prefs: []
  type: TYPE_NORMAL
- en: Natural language processing (NLP) is the ability of a computer program to understand
    human language as it is spoken. NLP is a component of artificial intelligence
    (AI).
  prefs: []
  type: TYPE_NORMAL
- en: The development of NLP applications is challenging because computers traditionally
    require humans to “speak” to them in a programming language that is precise, unambiguous
    and highly structured, or through a limited number of clearly enunciated voice
    commands. Human speech, however, is not always precise — it is often ambiguous
    and the linguistic structure can depend on many complex variables, including slang,
    regional dialects, and social context.
  prefs: []
  type: TYPE_NORMAL
- en: '**Natural Language Toolkit(NLTK)**'
  prefs: []
  type: TYPE_NORMAL
- en: NLTK is a leading platform for building Python programs to work with human language
    data. It provides easy-to-use interfaces to over 50 corpora and lexical resources
    such as WordNet, along with a suite of text processing libraries for classification,
    tokenization, stemming, tagging, parsing, and semantic reasoning, wrappers for
    industrial-strength NLP libraries, and an active discussion forum.
  prefs: []
  type: TYPE_NORMAL
- en: '**TF-IDF**'
  prefs: []
  type: TYPE_NORMAL
- en: We will compute the Term Frequency-Inverse Document Frequency (TF-IDF) vectors
    for each document. This will give you a matrix where each column represents a
    word in the overview vocabulary (all the words that appear in at least one document).
  prefs: []
  type: TYPE_NORMAL
- en: TF-IDF is the statistical method of evaluating the significance of a word in
    a given document.
  prefs: []
  type: TYPE_NORMAL
- en: TF — Term frequency(tf) refers to how many times a given term appears in a document.
  prefs: []
  type: TYPE_NORMAL
- en: IDF — Inverse document frequency(idf) measures the weight of the word in the
    document, i.e if the word is common or rare in the entire document.
  prefs: []
  type: TYPE_NORMAL
- en: The TF-IDF intuition follows that the terms that appear frequently in a document
    are less important than terms that rarely appear.
  prefs: []
  type: TYPE_NORMAL
- en: Fortunately, scikit-learn gives you a built-in `[TfIdfVectorizer](https://scikit-learn.org/stable/modules/generated/sklearn.feature_extraction.text.TfidfVectorizer.html)` class
    that produces the TF-IDF matrix quite easily.
  prefs: []
  type: TYPE_NORMAL
- en: '**Cosine similarity**'
  prefs: []
  type: TYPE_NORMAL
- en: Now we have this matrix, we can easily compute a similarity score. There are
    several options to do this; such as the Euclidean, the Pearson, and the cosine
    similarity scores. Again, there is no right answer to which score is the best.
  prefs: []
  type: TYPE_NORMAL
- en: 'We will be using the cosine similarity to calculate a numeric quantity that
    denotes the similarity between the two words. You use the cosine similarity score
    since it is independent of magnitude and is relatively easy and fast to calculate
    (especially when used in conjunction with TF-IDF scores). Mathematically, it is
    defined as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure](../Images/f2f2e800b977ee176ba1ffcda923f821.png)'
  prefs: []
  type: TYPE_IMG
- en: '[Source](https://en.wikipedia.org/wiki/Cosine_similarity): Cosine similarity'
  prefs: []
  type: TYPE_NORMAL
- en: Since we have used the TF-IDF vectorizer, calculating the dot product will directly
    give us the cosine similarity score. Therefore, we will use `sklearn`'s `linear_kernel()` instead
    of `cosine_similarities()` since it is faster.
  prefs: []
  type: TYPE_NORMAL
- en: '**Let''s start coding…**'
  prefs: []
  type: TYPE_NORMAL
- en: So we’ll copy data from [this website](http://www.whatishumanresource.com/human-resource-management).
    The dataset contains everything related to Human Resource Management. Copy and
    paste the whole data in a text format. We’ll train our model based on this data
    and then check how well the model performs. Apart from this, I have also included [Wikipedia
    python library](https://pypi.org/project/wikipedia/) so you can ask anything.
  prefs: []
  type: TYPE_NORMAL
- en: '**Importing all the required libraries.**'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: '**Load the dataset and convert every text into lowercase.**'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs: []
  type: TYPE_PRE
- en: Let us check what our data looks like.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE2]'
  prefs: []
  type: TYPE_PRE
- en: '**Data pre-processing**'
  prefs: []
  type: TYPE_NORMAL
- en: Let us now start with data cleaning and preprocessing by converting the entire
    data into a list of sentences.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE3]'
  prefs: []
  type: TYPE_PRE
- en: Our next step is to normalize these sentences. Normalization is a process that
    converts a list of words to a more uniform sequence. This is useful in preparing
    the text for later processing. By transforming the words to a standard format,
    other operations are able to work with the data and will not have to deal with
    issues that might compromise the process.
  prefs: []
  type: TYPE_NORMAL
- en: This step involves **word tokenization, Removing ASCII values, Removing tags
    of any kind, Part-of-speech tagging, and Lemmatization.**
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE4]'
  prefs: []
  type: TYPE_PRE
- en: So the data preprocessing part is over now let's define welcome notes or greetings
    that means if a user provides is a greeting message, the chatbot shall respond
    with a greeting as well based on keyword matching.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE5]'
  prefs: []
  type: TYPE_PRE
- en: '**Generate chatbot response**'
  prefs: []
  type: TYPE_NORMAL
- en: To generate a response from our chatbot for input questions, the concept of
    document similarity will be used. As I have already discussed the [TFidf vectorizer](http://scikit-learn.org/stable/modules/generated/sklearn.feature_extraction.text.TfidfVectorizer.html) is
    used to convert a collection of raw documents to a matrix of TF-IDF features and *to* find
    the similarity between words entered by the user and the words in the dataset
    we will use [cosine similarity](http://scikit-learn.org/stable/modules/generated/sklearn.metrics.pairwise.cosine_similarity.html).
  prefs: []
  type: TYPE_NORMAL
- en: We define a function** generateResponse()** which searches the user’s input
    words and returns one of several possible responses. If it doesn’t find the input
    matching any of the keywords then instead of giving just an error message you
    can ask your chatbot to search Wikipedia for you. Just type **“tell me about any_keyword”. **Now
    if it doesn't find anything in Wikipedia the chatbot will generate a message **“No
    content has been found”.**
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE6]'
  prefs: []
  type: TYPE_PRE
- en: Finally defining the chatbot user conversation handler.
  prefs: []
  type: TYPE_NORMAL
- en: 'Note: The program will exit if you type Bye, shutdown, exit or quit.'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE7]'
  prefs: []
  type: TYPE_PRE
- en: Now, let us test our chatbot and see how it responds.
  prefs: []
  type: TYPE_NORMAL
- en: '***Screenshots of conversation with Chatterbot:***'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/039bfa568ce26fceff9c10a388abda78.png)'
  prefs: []
  type: TYPE_IMG
- en: '![](../Images/60ca4e35337ee6c164b893bf12fa8c2a.png)'
  prefs: []
  type: TYPE_IMG
- en: Now if you want your chatbot to search Wikipedia, just type
  prefs: []
  type: TYPE_NORMAL
- en: '**“tell me about ****”**'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/662fa32af01a3a31564384a6b9448862.png)'
  prefs: []
  type: TYPE_IMG
- en: That was pretty cool, isn't it? Though the results were not precise at least
    we reached a milestone :)
  prefs: []
  type: TYPE_NORMAL
- en: 'Conclusion: The future of chatbots'
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: The future of Chatbots is very bright. With so much advancement in the Artificial
    Intelligence sector, chatbots are the future with zero doubt. The current chatbot
    that we just built is obviously not the future I am talking about as this is just
    a stepping stone in chatbot building.
  prefs: []
  type: TYPE_NORMAL
- en: The future chatbot will not be just a Customer Support agent, it will be an
    advance assistant for both the business and consumer.
  prefs: []
  type: TYPE_NORMAL
- en: We as humans are not fond of doing repetitive boring tasks. So in the future
    companies will hire AI Chatbot for the tasks which are repetitive and don’t require
    creativity. With AI Chatbot taking over repetitive boring tasks, Companies will
    utilize their human resources for more creative tasks. With this, we can expect
    more amazing things coming up to us in the future.
  prefs: []
  type: TYPE_NORMAL
- en: Also, Human doesn’t like storing up contents (mugging up) in their mind. And
    today with the Internet they can leverage that part. So tasks that require storing
    the information (data) can be transferred to AI Chatbot.
  prefs: []
  type: TYPE_NORMAL
- en: Well, that's all for this article hope you guys have enjoyed reading this it,
    feel free to share your comments/thoughts/feedback in the comment section.
  prefs: []
  type: TYPE_NORMAL
- en: Please reach me out over [LinkedIn](https://www.linkedin.com/in/nagesh-singh-chauhan-6936bb13b/) for
    any query.
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure](../Images/2c40f521c450f33387afe7346ad47fb6.png)'
  prefs: []
  type: TYPE_IMG
- en: Source:[gfycat.com](https://gfycat.com/gifs/search/edi+cortana)
  prefs: []
  type: TYPE_NORMAL
- en: Thanks for reading!!!
  prefs: []
  type: TYPE_NORMAL
- en: '**Bio: [Nagesh Singh Chauhan](https://www.linkedin.com/in/nagesh-singh-chauhan-6936bb13b/)**
    is a Big data developer at CirrusLabs. He has over 4 years of working experience
    in various sectors like Telecom, Analytics, Sales, Data Science having specialisation
    in various Big data components.'
  prefs: []
  type: TYPE_NORMAL
- en: '[Original](https://towardsdatascience.com/lets-build-an-intelligent-chatbot-7ea7f215ada6).
    Reposted with permission.'
  prefs: []
  type: TYPE_NORMAL
- en: '**Related:**'
  prefs: []
  type: TYPE_NORMAL
- en: '[Deep Learning for NLP: Creating a Chatbot with Keras!](/2019/08/deep-learning-nlp-creating-chatbot-keras.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[BERT is changing the NLP landscape](/2019/09/bert-changing-nlp-landscape.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Getting Started with Automated Text Summarization](/2019/11/getting-started-automated-text-summarization.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: More On This Topic
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: '[Build a ChatGPT-like Chatbot with These Courses](https://www.kdnuggets.com/2023/05/build-chatgptlike-chatbot-courses.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Build AI Chatbot in 5 Minutes with Hugging Face and Gradio](https://www.kdnuggets.com/2023/06/build-ai-chatbot-5-minutes-hugging-face-gradio.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[The Chatbot Transformation: From Failure to the Future](https://www.kdnuggets.com/2021/12/chatbot-transformation-failure-future.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Open Assistant: Explore the Possibilities of Open and Collaborative…](https://www.kdnuggets.com/2023/04/open-assistant-explore-possibilities-open-collaborative-chatbot-development.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Chatbot Arena: The LLM Benchmark Platform](https://www.kdnuggets.com/2023/05/chatbot-arena-llm-benchmark-platform.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Making Intelligent Document Processing Smarter: Part 1](https://www.kdnuggets.com/2023/02/making-intelligent-document-processing-smarter-part-1.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
