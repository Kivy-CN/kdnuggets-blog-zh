# 卷积神经网络的直观解释

> 原文：[https://www.kdnuggets.com/2016/11/intuitive-explanation-convolutional-neural-networks.html](https://www.kdnuggets.com/2016/11/intuitive-explanation-convolutional-neural-networks.html)

**作者：[Ujjwal Karn](https://ujjwalkarn.me/)。**

**什么是卷积神经网络，它们为什么重要？**

卷积神经网络（**ConvNets** 或 **CNNs**）是一类神经网络，在图像识别和分类等领域表现出色。ConvNets 在识别面孔、物体和交通标志方面取得了成功，同时也为机器人和自动驾驶汽车提供了视觉能力。

![convnets use.png](../Images/7748ce554a355790e730098db0a86116.png)

**图1：来源 [1]**

在 **图1** 中，ConvNet 能够识别场景，系统能够建议相关标签，如“桥梁”、“铁路”和“网球”，而 **图2** 显示了 ConvNets 被用于识别日常物品、人类和动物的示例。最近，ConvNets 在多个自然语言处理任务（如句子分类）中也表现有效。

![Screen Shot 2016-08-07 at 4.17.11 PM.png](../Images/ccc07aae6c66f4bb30726c2997a95724.png)

##### 图2：来源 [2]

因此，ConvNets 现在是大多数机器学习从业者的重要工具。然而，理解 ConvNets 并第一次学习使用它们可能是一次令人畏惧的经历。这篇博客文章的主要目的是发展对卷积神经网络如何处理图像的理解。

如果你对神经网络不熟悉，我建议你在继续之前阅读[这篇关于多层感知器的简短教程](http://ujjwalkarn.me/2016/08/09/quick-intro-neural-networks/)，以了解它们的工作原理。多层感知器在这篇文章中被称为“全连接层”。

#### LeNet 架构（1990年代）

LeNet 是最早的卷积神经网络之一，它推动了深度学习领域的发展。Yann LeCun 的这一开创性工作被命名为[LeNet5](http://yann.lecun.com/exdb/publis/pdf/lecun-01a.pdf)，继1988年以来经过多次成功迭代。那时，LeNet 架构主要用于字符识别任务，如读取邮政编码、数字等。

接下来，我们将深入理解 LeNet 架构如何学习识别图像。近年来提出了几种新架构，这些架构对 LeNet 进行了改进，但它们都使用了 LeNet 的主要概念，如果你对前者有清晰的理解，这些新架构相对容易理解。

![Screen Shot 2016-08-07 at 4.59.29 PM.png](../Images/a8fc34dea1cebd5aeb8736caf96e53fe.png)

##### 图3：一个简单的卷积神经网络。来源 [5]

**图3**中的卷积神经网络在结构上类似于原始的LeNet，并将输入图像分类为四类：狗、猫、船或鸟（原始的LeNet主要用于字符识别任务）。从上图可以看出，在接收到船的图像作为输入时，网络正确地将船的概率（0.94）分配为四类中的最高概率。输出层中所有概率的总和应为一（稍后在本帖中解释）。

**图3**中显示了ConvNet的四个主要操作：

1.  卷积

1.  非线性（ReLU）

1.  池化或下采样

1.  分类（全连接层）

这些操作是*每个*卷积神经网络的基本构建块，因此理解这些操作的工作原理是开发对ConvNets的深刻理解的重要步骤。我们将尝试理解下面每个操作的直观原理。

#### 图像是像素值的矩阵

实质上，每个图像都可以表示为一个像素值矩阵。

![8-gif.gif](../Images/95a0b5d309f5a500e50c29884bf02f1b.png)

###### 图4：每个图像是一个像素值矩阵。来源 [6]

[通道](https://en.wikipedia.org/wiki/Channel_(digital_image))是用来指代图像某一组件的传统术语。来自标准数码相机的图像将具有三个通道——红色、绿色和蓝色——你可以把这些想象成三个位于彼此之上的2D矩阵（每种颜色一个），每个矩阵的像素值范围为0到255。

相比之下，[灰度](https://en.wikipedia.org/wiki/Grayscale "Grayscale")图像只有一个通道。为了本帖的目的，我们将只考虑灰度图像，因此我们将有一个代表图像的单一2D矩阵。矩阵中每个像素的值范围从0到255——0表示黑色，255表示白色。

#### 卷积步骤

ConvNets得名于[“卷积”运算符](https://en.wikipedia.org/wiki/Convolution)。在ConvNet中，卷积的主要目的是从输入图像中提取特征。卷积通过使用输入数据的小方块学习图像特征，保持像素之间的空间关系。我们在这里不会深入卷积的数学细节，但会尝试理解它如何在图像上工作。

正如我们上面讨论的，每个图像可以视为一个像素值矩阵。考虑一个5 x 5的图像，其像素值仅为0和1（注意对于灰度图像，像素值范围是0到255，下方的绿色矩阵是一个特殊情况，其中像素值仅为0和1）：

![屏幕截图 2016-07-24 11.25.13 PM](../Images/113af8d18204fc9f1acc99c287a0da88.png)

另外，考虑另一个3 x 3的矩阵，如下所示：

![屏幕截图 2016-07-24 11.25.24 PM](../Images/b7821d30b80d65701e63e230f851dff1.png)

然后，5 x 5 图像与 3 x 3 矩阵的卷积可以如下面 **图 5** 的动画所示计算：![Convolution_schematic](../Images/1a23e603601fbcb937a792689e209f91.png)

###### 图 5：卷积操作。输出矩阵称为卷积特征或 **特征图**。来源 [7]

花一点时间来理解上述计算是如何进行的。我们将橙色矩阵以 1 像素（也称为‘步幅’）的方式滑过原始图像（绿色），并在每个位置计算元素逐一相乘（两个矩阵之间），然后将乘法输出相加，以得到形成输出矩阵（粉色）的单个元素。请注意，3×3 矩阵在每次步幅中“看到”的仅是输入图像的一部分。

在 CNN 术语中，3×3 矩阵称为‘**滤波器**’或‘核’或‘特征检测器’，而通过滑动滤波器在图像上计算点积形成的矩阵称为‘卷积特征’或‘激活图’或‘**特征图**’。需要注意的是，滤波器作为特征检测器从原始输入图像中提取特征。

从上面的动画可以看出，不同的滤波器矩阵值会为相同的输入图像产生不同的特征图。例如，考虑以下输入图像：

![111.png](../Images/fdd2207625369b1488033a9ce74ac160.png)

在下表中，我们可以看到上述图像与不同滤波器的卷积效果。如所示，我们可以通过在卷积操作之前仅改变滤波器矩阵的数值来执行边缘检测、锐化和模糊等操作 [8] —— 这意味着不同的滤波器可以从图像中检测出不同的特征，例如边缘、曲线等。更多这样的示例可在第 8.2.4 节 [这里](http://docs.gimp.org/en/plug-in-convmatrix.html) 查阅。

![Screen Shot 2016-08-05 at 11.03.00 PM.png](../Images/5ba80b2c13837d95579808846e8af58d.png)

* * *

## 我们的三大课程推荐

![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 1\. [Google 网络安全证书](https://www.kdnuggets.com/google-cybersecurity) - 快速进入网络安全职业生涯。

![](../Images/e225c49c3c91745821c8c0368bf04711.png) 2\. [Google 数据分析专业证书](https://www.kdnuggets.com/google-data-analytics) - 提升你的数据分析技能

![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 3\. [Google IT 支持专业证书](https://www.kdnuggets.com/google-itsupport) - 支持你的组织的 IT

* * *

### 更多相关话题

+   [协作过滤的直观解释](https://www.kdnuggets.com/2022/09/intuitive-explanation-collaborative-filtering.html)

+   [使用卷积神经网络（CNNs）的图像分类](https://www.kdnuggets.com/2022/05/image-classification-convolutional-neural-networks-cnns.html)

+   [卷积神经网络的全面指南](https://www.kdnuggets.com/2023/06/comprehensive-guide-convolutional-neural-networks.html)

+   [使用 PyTorch 构建卷积神经网络](https://www.kdnuggets.com/building-a-convolutional-neural-network-with-pytorch)

+   [支持向量机：直观方法](https://www.kdnuggets.com/2022/08/support-vector-machines-intuitive-approach.html)

+   [线性回归与逻辑回归：简明解释](https://www.kdnuggets.com/2022/03/linear-logistic-regression-succinct-explanation.html)
