- en: 'Deep Learning on your phone: PyTorch C++ API for use on Mobile Platforms'
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://www.kdnuggets.com/2021/11/deep-learning-mobile-phone-pytorch-c-api.html](https://www.kdnuggets.com/2021/11/deep-learning-mobile-phone-pytorch-c-api.html)
  id: totrans-1
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: '[comments](#comments)'
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
- en: '**By [Dhruv Matani](https://www.linkedin.com/in/dhruvbird/), software engineer
    at Meta (Facebook)**.'
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/653abbe8932e54f81ab10230ca067d73.png)'
  id: totrans-4
  prefs: []
  type: TYPE_IMG
- en: '* * *'
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
- en: Our Top 3 Course Recommendations
  id: totrans-6
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 1\. [Google Cybersecurity
    Certificate](https://www.kdnuggets.com/google-cybersecurity) - Get on the fast
    track to a career in cybersecurity.'
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/e225c49c3c91745821c8c0368bf04711.png) 2\. [Google Data Analytics
    Professional Certificate](https://www.kdnuggets.com/google-data-analytics) - Up
    your data analytics game'
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/0244c01ba9267c002ef39d4907e0b8fb.png) 3\. [Google IT Support
    Professional Certificate](https://www.kdnuggets.com/google-itsupport) - Support
    your organization in IT'
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
- en: '* * *'
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
- en: '[PyTorch](https://pytorch.org/) is a Deep Learning framework for training and
    running Machine Learning (ML) Models, accelerating the speed from research to
    production.'
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
- en: The [PyTorch C++ API](https://pytorch.org/cppdocs/) can be used to write compact,
    performance sensitive code with Deep Learning capabilities to perform ML inference
    on mobile platforms. For a general introduction on how to deploy a PyTorch model
    to production, please see [this article](https://www.kdnuggets.com/2019/03/deploy-pytorch-model-production.html).
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
- en: '[PyTorch Mobile](https://pytorch.org/mobile/home/) currently supports deploying
    pre-trained models for inference on both [Android](https://pytorch.org/mobile/android/)
    and [iOS](https://pytorch.org/mobile/ios/) platforms.'
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
- en: Steps at a high level
  id: totrans-14
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Train a model (or fetch a pre-trained model), and save in the lite-interpreter
    format. The lite-interpreter format for a PyTorch model makes the model compatible
    for running on mobile platforms. This step is not covered in this article.
  id: totrans-15
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Download the PyTorch source code, and [build PyTorch from source](https://github.com/pytorch/pytorch#from-source).
    This is recommended for mobile deployments.
  id: totrans-16
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Create a .cpp file with code to load your model, run inference using forward(),
    and print the results.
  id: totrans-17
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Build the .cpp file, and link against PyTorch shared object files.
  id: totrans-18
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Run the file and see the output.
  id: totrans-19
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Profit!
  id: totrans-20
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Steps in Detail
  id: totrans-21
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: '**Download and install PyTorch from source on a Linux machine.**'
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
- en: For other platforms, please see [this link](https://github.com/pytorch/pytorch#from-source).
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  id: totrans-24
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: '**Create source .cpp file**'
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
- en: Store the .cpp file in the same folder as your *AddTensorsModelOptimized.ptl*
    file. Let’s call the C++ source file *PTDemo.cpp*. Let’s call this directory */home/$USER/ptdemo/*.
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE1]'
  id: totrans-27
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: 'Note: We use symbols from the *at::* namespace and not the *torch::* namespace
    (which is what is used by tutorials on the PyTorch web-site) since for mobile
    builds, we won’t be including the full-jit (TorchScript) interpreter. Instead,
    we will have access only to the lite-interpreter.'
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
- en: '**Build and Link**'
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE2]'
  id: totrans-30
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: '**Run the application**'
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE3]'
  id: totrans-32
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: 'The command should print the following:'
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE4]'
  id: totrans-34
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: Conclusion
  id: totrans-35
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: In this article, we saw how to use the x-platform C++ PyTorch API to load a
    pre-trained lite-interpreter model with inputs and run inference using that model.
    The C++ code used is platform agnostic and can be built and run on all mobile
    platforms supported by PyTorch.
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
- en: '**References**'
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
- en: '[Introduction to PyTorch For Deep Learning](https://www.kdnuggets.com/2018/11/introduction-pytorch-deep-learning.html)'
  id: totrans-38
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Getting Started With PyTorch](https://www.kdnuggets.com/2020/10/getting-started-pytorch.html)'
  id: totrans-39
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Deploy your PyTorch Model to Production](https://www.kdnuggets.com/2019/03/deploy-pytorch-model-production.html)'
  id: totrans-40
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Contributing to PyTorch: By someone who doesn’t know a ton about PyTorch](https://www.kdnuggets.com/2019/10/contributing-pytorch.html)'
  id: totrans-41
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PyTorch Mobile](https://pytorch.org/mobile/home/)'
  id: totrans-42
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PyTorch C++ API](https://pytorch.org/cppdocs/)'
  id: totrans-43
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Build PyTorch from source](https://github.com/pytorch/pytorch#from-source)'
  id: totrans-44
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PyTorch iOS 101 Video walk through](https://www.youtube.com/watch?v=GjsUWAaBIH8&ab_channel=PyTorch)'
  id: totrans-45
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Bio:** [Dhruv Matani](https://www.linkedin.com/in/dhruvbird/) is a software
    engineer at Meta (Facebook), where he leads projects related to PyTorch (Open
    Source AI Framework). He is an expert on PyTorch internals, PyTorch Mobile, and
    is a significant contributor to PyTorch. His work is impacting billions of users
    across the world. He has extensive experience building and scaling infrastructure
    for the Facebook Data Platform. Of note are contributions to Scuba, a realtime
    data analytics platform at Facebook, used for rapid product and system insights.
    He has a M.S. in Computer Science from Stony Brook University.'
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
- en: '**Related:**'
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
- en: '[How is Machine Learning Beneficial in Mobile App Development?](https://www.kdnuggets.com/2021/09/machine-learning-beneficial-mobile-app-development.html)'
  id: totrans-48
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Facebook Open Sourced New Frameworks to Advance Deep Learning Research](https://www.kdnuggets.com/2020/11/facebook-open-source-frameworks-advance-deep-learning-research.html)'
  id: totrans-49
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Getting Started with PyTorch Lightning](https://www.kdnuggets.com/2021/10/getting-started-pytorch-lightning.html)'
  id: totrans-50
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: More On This Topic
  id: totrans-51
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: '[Free ChatGPT Course: Use The OpenAI API to Code 5 Projects](https://www.kdnuggets.com/2023/05/free-chatgpt-course-openai-api-code-5-projects.html)'
  id: totrans-52
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[How to Access and Use Gemini API for Free](https://www.kdnuggets.com/how-to-access-and-use-gemini-api-for-free)'
  id: totrans-53
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[How Data Science Can Transform Mobile App Development?](https://www.kdnuggets.com/2023/03/data-science-transform-mobile-app-development.html)'
  id: totrans-54
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[How Artificial Intelligence Will Change Mobile Apps](https://www.kdnuggets.com/2022/12/artificial-intelligence-change-mobile-apps.html)'
  id: totrans-55
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[人工智能将如何改变移动应用](https://www.kdnuggets.com/2022/12/artificial-intelligence-change-mobile-apps.html)'
- en: '[Introduction to Deep Learning Libraries: PyTorch and Lightning AI](https://www.kdnuggets.com/introduction-to-deep-learning-libraries-pytorch-and-lightning-ai)'
  id: totrans-56
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[深度学习库简介：PyTorch 和 Lightning AI](https://www.kdnuggets.com/introduction-to-deep-learning-libraries-pytorch-and-lightning-ai)'
- en: '[The Complete Free PyTorch Course for Deep Learning](https://www.kdnuggets.com/2022/10/complete-free-pytorch-course-deep-learning.html)'
  id: totrans-57
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[完整免费的 PyTorch 深度学习课程](https://www.kdnuggets.com/2022/10/complete-free-pytorch-course-deep-learning.html)'
